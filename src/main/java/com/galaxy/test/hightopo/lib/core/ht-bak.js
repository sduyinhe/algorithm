!function(M,Y,l){"use strict";function z(){this.el=[1,0,0,0,1,0,0,0,1]}function b(m){var w={};return{get:function(y){if(w[y]!==l)return w[y];var g;switch(y){case"WEBGL_depth_texture":g=m.getExtension("WEBGL_depth_texture")||m.getExtension("MOZ_WEBGL_depth_texture")||m.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":g=m.getExtension("EXT_texture_filter_anisotropic")||m.getExtension("MOZ_EXT_texture_filter_anisotropic")||m.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":g=m.getExtension("WEBGL_compressed_texture_s3tc")||m.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||m.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":g=m.getExtension("WEBGL_compressed_texture_pvrtc")||m.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":g=m.getExtension("WEBGL_compressed_texture_etc1");break;default:g=m.getExtension(y)}return w[y]=g,g}}}function X(G,E,T){function R(){if(q!==l)return q;var p=E.get("EXT_texture_filter_anisotropic");return q=null!==p?G.getParameter(p.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function L(s){if("highp"===s){if(G.getShaderPrecisionFormat(G.VERTEX_SHADER,G.HIGH_FLOAT).precision>0&&G.getShaderPrecisionFormat(G.FRAGMENT_SHADER,G.HIGH_FLOAT).precision>0)return"highp";s="mediump"}return"mediump"===s&&G.getShaderPrecisionFormat(G.VERTEX_SHADER,G.MEDIUM_FLOAT).precision>0&&G.getShaderPrecisionFormat(G.FRAGMENT_SHADER,G.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var q;T=T||{};var u="undefined"!=typeof WebGL2RenderingContext&&G instanceof WebGL2RenderingContext,J=T.precision!==l?T.precision:"highp",e=L(J);e!==J&&(console.warn("WebGL:",J,"not supported, using",e,"instead."),J=e);var I=T.logarithmicDepthBuffer===!0,F=G.getParameter(G.MAX_TEXTURE_IMAGE_UNITS),K=G.getParameter(G.MAX_VERTEX_TEXTURE_IMAGE_UNITS),n=G.getParameter(G.MAX_TEXTURE_SIZE),m=G.getParameter(G.MAX_CUBE_MAP_TEXTURE_SIZE),j=G.getParameter(G.MAX_VERTEX_ATTRIBS),O=G.getParameter(G.MAX_VERTEX_UNIFORM_VECTORS),s=G.getParameter(G.MAX_VARYING_VECTORS),_=G.getParameter(G.MAX_FRAGMENT_UNIFORM_VECTORS),a=K>0,w=u||!!E.get("OES_texture_float"),d=a&&w,o=u?G.getParameter(G.MAX_SAMPLES):0;return{getMaxAnisotropy:R,getMaxPrecision:L,precision:J,logarithmicDepthBuffer:I,maxTextures:F,maxVertexTextures:K,maxTextureSize:n,maxCubemapSize:m,maxAttributes:j,maxVertexUniforms:O,maxVaryings:s,maxFragmentUniforms:_,vertexTextures:a,floatFragmentTextures:w,floatVertexTextures:d,maxSamples:o}}var W="ht";if(!M[W]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),M.performance&&M.performance.now||function(){var s=Date.now();M.performance||(M.performance={}),M.performance.now=function(){return Date.now()-s}}();for(var L=Date.now(),N=16,b=["ms","moz","webkit","o"],m=0;m<b.length&&!M.requestAnimationFrame;++m)M.requestAnimationFrame=M[b[m]+"RequestAnimationFrame"],M.cancelAnimationFrame=M[b[m]+"CancelAnimationFrame"]||M[b[m]+"CancelRequestAnimationFrame"];M.requestAnimationFrame||(M.requestAnimationFrame=function(d){var P=Date.now(),U=N+L-P;return 0>U&&(U=0),L=P,M.setTimeout(function(){L=Date.now(),d(performance.now())},U)}),M.cancelAnimationFrame||(M.cancelAnimationFrame=function(Q){return M.clearTimeout(Q)}),Y.assign===l&&(Y.assign=function(u){if(u===l||null===u)throw new TypeError("Cannot convert undefined or null to object");for(var e=Y(u),Z=1;Z<arguments.length;Z++){var C=arguments[Z];if(C!==l&&null!==C)for(var L in C)Y.prototype.hasOwnProperty.call(C,L)&&(e[L]=C[L])}return e})}();var D=M.document,Z=null,a=M[W]={},d=M[W+"config"],A=a.Default=d&&d.Default||{},y=a.Style=d&&d.Style||{},P=a.Attr=d&&d.Attr||{},v=a.Color=d&&d.Color||{},O=a.IsGetter=d&&d.IsGetter||{};!function(){var F=!1;try{var G=Y.defineProperty({},"passive",{get:function(){return F=!0,l}});M.addEventListener("test",G,G),M.removeEventListener("test",G,G)}catch(h){F=!1}A.passiveSupported=F}();var r,k,Q,G,e=A.passiveSupported,L=A.eventListenerOptionsFalse=e?{passive:!1,capture:!1}:!1,o=A.eventListenerOptionsTrue=e?{passive:!1,capture:!0}:!0,T=function(D,S,e,w){D.addEventListener(S,e,w?o:L)},K=function(b,Y,O,f){b.removeEventListener(Y,O,f?o:L)},n=Math,h=n.round,H=n.floor,p=n.ceil,w=n.sqrt,j=n.max,C=n.min,t=n.abs,m=n.cos,S=n.acos,E=n.sin,c=n.pow,f=n.asin,s=n.exp,i=n.PI,I=2*i,x=i/2,F=n.tan,R=n.atan2,q=n.random,$=n.log,V=!0,J=!1,N=M.parseInt||global.parseInt,u="2021-02-25",B=M.navigator?M.navigator.platform.indexOf("Win")>-1:!1,g=function(k){return k*k},U=M.setTimeout,_=M.clearTimeout,Aq=M.location,Hb=M.navigator?M.navigator.userAgent.toLowerCase():"",sd=function(c){return c.test(Hb)},Qh=sd(/msie/),Fj=sd(/msie/)||sd(/trident/),Lj=sd(/msie 10/),zo=sd(/edge/),Pc=sd(/firefox/),ep=sd(/mac/),ng=A.isTouchable===l?B?!1:D?"ontouchend"in D:!1:A.isTouchable,aj="default",Yh="single",Xq="multiple",Qj="front",Zd="back",Bc="left",qe="right",Uh="top",Tg="bottom",Jg="center",Ze="eye",_e="middle",yl="east",gm="west",al="north",rg="none",Bd="px",Ck="absolute",oi="border",Lb="triangle",qb="rect",lb="circle",_m="cylinder",vm="shape",pc="items",Xh="normal",nd="remove",Fh="clear",fk="width",Ec="height",Sb="ingroup",Uc="check",Qb="uncheck",ek="radio",$q="radioOn",Zp="radioOff",rd="points",Xc="values",Se="series",Wb="body",Rh="label",kh="label2",sl="note",Am="note2",_q="icons",Pg="labelFont",Yr="labelColor",$n="labelSelectColor",ac="note.expanded",Rc="note2.expanded",zc="edge.expanded",xq="edge.points",vf="edge.type",xg="rotation",ud="hidden",Gj="visible",Dd="tuv",pe="no",xn="draw",ql="select",Zb="currentSubGraph",Dh="selectBackground",bq="autoMakeVisible",Nl="autoHideScrollBar",dr="scrollBarColor",Om="scrollBarSize",bi="indent",Th="rowHeight",fd="columnLineColor",lm="rowLineColor",rj="columnLineVisible",Zg="rowLineVisible",re="visibleFunc",kf="expandIcon",Ql="collapseIcon",ym="checkMode",Yc="sortFunc",Mn="editable",ei="batchEditable",Zl="tristate",Ag="asc",Wd="desc",fh="position",mq="elevation",oj="children",Ok="translateX",Sl="translateY",Mr="dataModel",tj="maxSize",jp="state",Sg="shape3d",qd="shape3d.resolution",oh="shape3d.visible",Qo="shape3d.from.visible",Dc="shape3d.to.visible",Pm="shape3d.top.visible",gi="shape3d.bottom.visible",Do="repeat.uv.length",lo="serializeValue",Kq="deserializeValue",Po="centerUniform",Dq="uniform",dm="rgba(255,255,255,0)",mi="style",Cp="attr",Qi="field",Xp="string",Nr="boolean",ee="color",Jj="int",Tn="number",fc="ew-resize",Pb="ns-resize",Yp="pointer",Wc="auto",Jq="mousedown",ig="mousemove",qr="mouseup",jg="mouseout",tb="touchstart",mm="touchmove",Xk="touchend",zm="keydown",Mb="keyup",fp=["DOMMouseScroll","mousewheel"],wp=Pc?fp[0]:fp[1],ue=[tb,mm,Xk],hs=[Jq,ig,qr,jg,wp,"wheel","mouseenter","mouseleave","mouseover"],Ff=[zm,Mb,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],Pk=ng?ue.concat(Ff):hs.concat(Ff),Zj=Z,Ui=Z,Fn=Z,Ng=qr.length,Ak=function(){Fn&&(_(Fn.timeout),Fn=Z)},jo=function(){Fn&&Vr(Fn.e,Fn.info)};M.addEventListener&&(ng||(T(M,jg,function(){Ak()}),T(M,wp,function(){Kp()})),T(M,Mb,function(S){91===S.keyCode?_n={}:delete _n[S.keyCode]},!0),T(M,zm,function(l){_n[l.keyCode]=!0},!0),T(M,"blur",function(){_n={}}));var ck,kl,fg,ar=0,Vo=Z,zk=function(s,k){var P=U(function(){delete Vo[P],rr(Vo)&&(Vo=Z),s()},k);return P},ti=Z,Wk=Z,Zh={},Di={},Ao={},qj={},Qm={},_n={},en={},wh={},Rb={},Pp={},Rj=/.json$/,$b=/^data:image\/svg\+xml/,mf={},Mp=[],Yn={},Mj=Z,Mi=Z,Wi=function(){},eg=function(){throw"Oops!"},Dj=[0,0,0],oo={x:0,y:0,width:0,height:0},Vm=Z,cc=Z,pm=Z,Cg=function(g,i){Di[g]=i,i&&i.comps&&!i.uuid&&(i.uuid=a.Math.generateUUID()),cm[g]&&(i.cacheRule=cm[g],delete cm[g])},zh=function(j){cc&&!j._72O&&(pm||(pm={}),pm[j._72O=Vc()]=j),ck!=Z?Fi()<.05&&G&&!kl&&(hb=Ak):hb=ej},tf=function(d,w,W,Q){cc||(cc={});var V=cc[d];if(V){if(V.url===w)return;V.image?(V.image.onload=Wi,V.image.onerror=Wi):V.request&&(V.request.onload=Wi,V.request.onerror=Wi)}if(Rj.test(w)){var n=new Ar;if(cc[d]={request:n,url:w},w=A.beforeLoadURL(w,d),w.data){var e=A.parse(w.data);Gb(d,e),A.handleImageLoaded(d,e)}else{n.onload=function(){if(200===this.status||0===this.status){var U=A.parse(n.getResponseText());Gb(d,U),A.handleImageLoaded(d,U)}else Gb(d,A.handleUnfoundImage(d,w)||Z)},n.onerror=function(){Gb(d,A.handleUnfoundImage(d,w)||Z)};var t={};t.url=encodeURI(w),t.sync=!1,n.send(t)}}else{var e=new Image;cc[d]={image:e,url:w},/^data:image/.test(w)||(w=A.beforeLoadURL(w,d),w=A.appendTimeStamp(w),w=encodeURI(w),e.crossOrigin=A.crossOrigin),A.convertImageSrc(w,function(P){Fj&&(w.toLowerCase().indexOf(".svg")>0||$b.test(w))?(D.body.appendChild(e),e.style.visibility="hidden",e.onload=function(){U(function(){if(W&&(e.width=W),Q&&(e.height=Q),!e.width||!e.height){var U=e.width||e.clientWidth,i=e.height||e.clientHeight;e.width=U,e.height=i}A.handleImageLoaded(d,e),Gb(d,e),D.body.removeChild(e),e.style.visibility=""},180)},e.onerror=function(){Gb(d,A.handleUnfoundImage(d,w)||Z),D.body.removeChild(e),e.style.visibility=""}):(e.onload=function(){W&&(e.width=W),Q&&(e.height=Q),A.handleImageLoaded(d,e),Gb(d,e)},e.onerror=function(){Gb(d,A.handleUnfoundImage(d,w)||Z)}),e.src=P})}},Gb=function(F,z){if(Cg(F,z),delete cc[F],rr(cc)&&(cc=Z,pm)){for(var D in pm){var I=pm[D];I._2O&&I._2O[F]&&(I.deleteTexture(F),delete I._2O[F]),I.invalidateAll&&I.invalidateAll(l,"imageLoaded",F),I.redraw&&I.redraw(),I.iv(),delete I._72O}pm=Z}if(z&&pm)for(var D in pm){var I=pm[D];I.invalidateAll&&I.invalidateAll(l,"imageLoading",F),I.redraw&&I.redraw(),I.iv()}},xk=function(){return $=n&&Date,function(){return M.performance&&M.performance.now?M.performance.now():Date.now()}}(),be=function(m,p,c){return{width:m,height:p,comps:sp(c)?c:[c]}},he=function(r,l){return{type:lb,rect:[r,l,1.6,1.6],borderWidth:1,borderColor:Tp,gradient:cs,gradientColor:Yq,background:Tp}},$j=function(h,W){return be(16,16,{type:Lb,rect:[4,4,10,8],background:h,rotation:W?1.57:3.14})},_l=function(d,h){return be(16,16,{type:Lb,rect:[4,4,8,7],background:d,rotation:h?3.14:0})},sh=function(T){var R=T._orientation;return"horizontal"===R||"h"===R},xh=function(D,e){var K=Z||4,T=Z||1,Y=Z||1;0>K?K=0:K>.25&&(K=.25);var S,H,d,u,N,C,b,B=.5,f=[],z=[],F=[],t=I/Y,a=I/T,X=B-K;for(H=0;T>=H;H++)for(u=-i+H*a,C=m(u),N=E(u),S=0;Y>=S;S++)d=S*t,b=X+K*C,f.push(m(d)*b,N*K,-E(d)*b),(k=[D,e])&&z.push(S/Y,1-H/T);for(H=0;T>H;H++){var n=H*(Y+1),x=(H+1)*(Y+1);for(S=0;Y>S;S++)F.push(n+S,x+S+1,x+S,n+S,n+S+1,x+S+1),Oe.z=Qc.z=[D,e]}},qg=function(C){var s=2,D=0;for(var m in C)m.length===s&&N(m,32)===$o&&(Mj=Mi=C[m]),D++;return D},pg=function(Y,t,l,w){return l||(l=ng?5:3,l/=w||1),{x:Y-l,y:t-l,width:2*l,height:2*l}},wm=function(N,b,f,L){var S=this;b||(b=ng?5:3,f=20,L=20);var t={x:N,y:b,width:f,height:L};if(f)for(var n=0;f>n;n++)if(3===f)L=20;else for(var P=0;L>P;P++)S=M?M:f;var m={x:i,y:2*i};if(or(t,m)){var R=Ec[0]+Uh[0]+Fh[1]+Ag.length,e=ud[0]+Zl[0]+Fh[1]+Wb.length;ye[Ze]=[S[R],S[e]],S[R]=zp[Ze],S[e]=zp[Sg]}},kr=function(C){return(/ble$/.test(C)||/ed$/.test(C)||O[C]?"is":"get")+C.charAt(0).toUpperCase()+C.slice(1)},zp=function(Q){return"set"+Q.charAt(0).toUpperCase()+Q.slice(1)},tk=function(d){return typeof d===Xp||d instanceof String},gh=function(x){return typeof x===Tn},ej=function(k){return typeof k===Nr},Bn=function(Z){return Z&&"object"==typeof Z},vi=function(x){return"function"==typeof x},sp=function(e){return e instanceof Array},po=function(Q){return Q instanceof Nj},Un=function(n){return sp(n)?new Nj(n):n},Pr=function(w){return w instanceof Lo},Xi=function(T){return T instanceof Nn},Mf=function(D){return D instanceof Ld},Rm=function(d,U){if(!(d instanceof a.Group))return!1;if(!U)return d.isExpanded();var g=U.getDataUI(d);return g&&g._88I?!0:!1},gs=function(e){return e instanceof Ic},Ah=function(R){return R&&"IFRAME"===R.tagName},wd=function(z){return z==Z||A.numberDigits==Z?z:parseFloat(z.toFixed(A.numberDigits))},Ad=function(w,M,Q){var R,j=M.length;if(Q)for(var F=0;Q>F;F++)if(3===j)w.push(M[0]),w.push(M[1]),w.push(M[2]);else for(R=0;j>R;R++)w.push(M[R]);else if(3===j)w.push(M[0]),w.push(M[1]),w.push(M[2]);else for(R=0;j>R;R++)w.push(M[R])},Zc=function(O){return O?Bn(O)?O:{}:!1},Nh=function(Q,k,G){var b,t=Bn(Q)?Q:Q.prototype;for(b in k)G&&b in t?t[b]===l&&console.warn("class",t,"has own undefined property",b,", keep exist!"):t[b]=k[b];return Q},qf=function(K,j){if(!("wheelDelta"in j)){var R=j.deltaMode;j.wheelDelta=R===j.DOM_DELTA_PIXEL?-j.deltaY:R===j.DOM_DELTA_LINE?40*-j.deltaY:120*-j.deltaY}K.handle_mousewheel(j)},io=function(P){return String.fromCharCode(P)},il=function(Q){for(var W,b=0,d="";b<Q.length;b++)W=Q[Q.length-1-b],"%"===W?W="'":"a"===W?W='"':"]"===W&&(W="\\"),d+=io(W.charCodeAt(0)-1);return d},$f=function(B,f,Z){B.superClass.constructor.apply(f,Z)},rr=function(d){for(var R in d)return!1;return!0},Eb=function(V){return V?0===V.length:!0},Hq=function(){var R="";return[Qb[0],lm[0],Rh[0]].forEach(function(H){R+=zp(H).slice(3)}),Dq=D&&D[R]||Po,function(K,k){return K===k?!0:K.x===k.x&&K.y===k.y&&K.width===k.width&&K.height===k.height}}(),Bq=function(b,i,y){return i>b?i:b>y?y:b},vn=function(u){return 0>u?-1:u>0?1:0},Fi=function(){var B=1e4*E(Ng++);return B-H(B)},Gl=function(Q,B,q){return ff(Q.x,Q.y,B.x,B.y,q.x,q.y,q.x+q.width,q.y,!0)||ff(Q.x,Q.y,B.x,B.y,q.x+q.width,q.y,q.x+q.width,q.y+q.height,!0)||ff(Q.x,Q.y,B.x,B.y,q.x+q.width,q.y+q.height,q.x,q.y+q.height,!0)||ff(Q.x,Q.y,B.x,B.y,q.x,q.y+q.height,q.x,q.y,!0)},ff=function(u,O,A,K,i,w,n,b,T){var h=(n-i)*(O-w)-(b-w)*(u-i),N=(b-w)*(A-u)-(n-i)*(K-O);if(0!==N){var $=h/N,J=u+$*(A-u),P=O+$*(K-O);return T&&(J+Yd<C(u,A)||J-Yd>j(u,A)||J+Yd<C(i,n)||J-Yd>j(i,n)||P+Yd<C(O,K)||P-Yd>j(O,K)||P+Yd<C(w,b)||P-Yd>j(w,b))?Z:[J,P]}return Z},Xg=function(t,F,W){if(t&&W)if(F){if(F===mi)return t.getStyle(W);if(F===Cp)return t.getAttr(W);if(F===Qi)return t[W]}else if(W=kr(W),t[W])return t[W]();return l},On=function(t,n,H,O){if(t&&H)if(n){if(n===mi)t.s(H,O);else if(n===Cp)t.a(H,O);else if(n===Qi){var A=t[H];t[H]=O,t.fp("f:"+H,A,O)}}else H=zp(H),t[H]&&t[H](O)},Wp=function(U,m,X){return m&&"top"!==m?"bottom"===m?{x:U.x,y:U.y,width:U.width,height:U.height*X}:"right"===m?{x:U.x,y:U.y,width:U.width*X,height:U.height}:"left"===m?{x:U.x+U.width*(1-X),y:U.y,width:U.width*X,height:U.height}:void 0:{x:U.x,y:U.y+U.height*(1-X),width:U.width,height:U.height*X}},ii=function(a,L,R,z,E){L&&jq(a,R,z,1,E,L)},Rq=function(c,X,l,x){var W=1-c;return W*W*X+2*c*W*l+c*c*x},Oe=function(n,r,e,I,O){var N=1-n;return N*N*N*r+3*N*N*n*e+3*N*n*n*I+n*n*n*O},gc=function(o){var W,N,m,H,s=0;return o.forEach(function(t){if(W=t.length,W>0)for(N=t[0],H=1;W>H;H++)m=t[H],s+=fm(N,m),N=m}),s},Qd=function(Y,A,l){var G="__"+Y,M=function(q){l.disabled||l["handle_"+Y](q)};l[G]||(l[G]=M,T(A,Y,M))},Md=function(X,A,Z){var E="__"+X,Q=Z[E];Q&&(K(A,X,Q),delete Z[E])},xf=function(q,l){var A="_"+l;q[kr(l)]=function(){return this[A]},q[zp(l)]=function(W){var d=this[A];this[A]=W,this.fp(l,d,W)}},ap=function(J){return Y.create(J)},Kb=function(v){if(!v.element){var t,q;(t=v.textField)?q=qs(Le.TextField,t):(t=v.textArea)?q=qs(Le.TextArea,t):(t=v.button)?q=qs(Le.Button,t):(t=v.comboBox)?q=qs(Le.ComboBox,t):(t=v.checkBox)?q=qs(Le.CheckBox,t):(t=v.radioButton)?q=qs(Le.RadioButton,t):(t=v.slider)?q=qs(Le.Slider,t):(t=v.colorPicker)?q=qs(Le.ColorPicker,t):(t=v.image)&&(q=qs(Le.Image,t)),q&&(v.element=q)}},Wm=function(i,K){var D=Sr(i);return D._ht=K,D},ts=M.top===M?M.top:M||M.document,Sr=function(w,U){var A=D.createElement("div"),o=A.style;return A.tabIndex=-1,A.onkeydown=td,o.msTouchAction=rg,Gi(A,Z,0),ng&&o.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",Z),w&&(o.overflow=ud),U&&Jp(U,A),A},uh=function(S,l){var X=D.createElement("canvas"),k=X.style;return k.msTouchAction=rg,l||(k.pointerEvents=rg),Gi(X,Z,0),S&&Jp(S,X),X},Gi=function(s,_,e){var M=s.style;M.border=_?_+" solid 1px":0,M.outline=0,M.padding=e?"0 "+e+Bd:0,yn(s)},yn=function(p){var x=p.style;x.position=Ck,x.margin=0,x.setProperty("box-sizing","border-box",Z),x.setProperty("-moz-box-sizing","border-box",Z)},wg=function(n,A,W,H){H||(H=vj),A!=Z&&(n.width=A*H,n.style.width=A+Bd),W!=Z&&(n.height=W*H,n.style.height=W+Bd)},Jp=function(H,B,P){H.appendChild(B),P&&(B.style.position=Ck)},jj=function(q,S){S.split||(S+="");for(var o,u=S.split("\n"),Z=0,v=u.length,$=0;v>$;$++){var J=hh(q.font,u[$]);J.width>Z&&(Z=J.width),o||(o=J.height)}return q.ss=u,{width:Z,height:o*v}},Rk=function(Q,c,$,v,q,f){var A=c.length;if(1===A)Gq(Q,c[0],$,v,q);else for(var x=$.height/A,a={x:$.x,y:$.y,width:$.width,height:x},k=0;k<c.length;k++)f?xc(Q,c[k],v,q,a.x,a.y,a.width,a.height,f):Gq(Q,c[k],a,v,q),a.y+=x},Gq=function(H,T,z,D,G){H.font=D?D:yc,H.fillStyle=G?G:md,H.textAlign=Jg,H.textBaseline=_e;var r,E;z?z.width===l?(r=z.x,E=z.y):(r=z.x+z.width/2,E=z.y+z.height/2):(r=0,E=0),H.fillText(T,h(r),h(E))},mc=function(y){y.getView&&(y=y.getView());var c=y.offsetWidth||y.scrollWidth;return!c&&y.style.width&&(c=N(y.style.width)),c},ci=function(J){J.getView&&(J=J.getView());var c=J.offsetHeight||J.scrollHeight;return!c&&J.style.height&&(c=N(J.style.height)),c},Bk=function(B,$,y){var J=$[0].toUpperCase()+$.substring(1,$.length);B["webkit"+J]=y,B["moz"+J]=y,B["ms"+J]=y,B["o"+J]=y,B[$]=y},Zm=function(){var d=function(O){td(O),O.stopPropagation()},h=function(g){td(g)},Y=[tb,zm,Jq];return function(M,P){var L=Sr(),c=L.style;return c.backgroundColor=A.disabledBackground,M&&(c.backgroundImage="url("+M+")",c.backgroundPosition="50% 50%",c.backgroundRepeat="no-repeat no-repeat"),P===!1?Y.forEach(function(R){T(L,R,h)}):Y.forEach(function(n){T(L,n,d)}),L}}(),qq=function(N){var w=N.getContext("2d");return w.save(),w.lineCap=wc,w.lineJoin=xp,w},hb=function(T,Q,l,J){Yf(T,Q*vj,l*vj),J*=vj,1!==J&&T.scale(J,J)},Yf=function(F,k,e){F.translate(k,e)},cr=function(b,C){C&&b.rotate(C)},mg=function(g,B,j){B===l&&(B=1),j===l&&(j=1),(1!==B||1!==j)&&g.scale(B,j)},ul=!1,s=ts[Uc[1]+Ok[0]],Fp=function(T){var W=D.activeElement;if(D.activeElement!==T){W&&W.forceOnblur&&W.forceOnblur();for(var r=[],I=T.parentNode;I;)r.push([I,I.scrollLeft,I.scrollTop]),I=I.parentNode;if(!ul){var S=[],U=[];try{for(var Y=M.parent,m=M;Y!==m;)S.push([Y,Y.scrollX,Y.scrollY]),m=Y,Y=M.parent;var V=M.frameElement;if(V)for(var H=V.parentNode;H;)U.push([H,H.scrollLeft,H.scrollTop]),H=H.parentNode}catch(C){ul=!0}}if(ng)T.focus();else{var L=kg(),O=L.target;T.focus(),O.scrollLeft=L.left,O.scrollTop=L.top}r.forEach(function(R){R[0].scrollLeft=R[1],R[0].scrollTop=R[2]}),ul||(S.forEach(function(u){u[0].scrollTo(u[1],u[2])}),U.forEach(function(P){P[0].scrollLeft=P[1],P[0].scrollTop=P[2]}))}},Kl=function(D){return D&&D.getView?D.getView():D},Vn=function(i,O,q,X,M){if(2===arguments.length&&(q=O.y,X=O.width,M=O.height,O=O.x),i.isSelfViewEvent)i.setX(O),i.setY(q),i.setWidth(X),i.setHeight(M);else{var m=Kl(i),o=m.style;if((D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement)!==m)O!==l&&(o.left=O+Bd),q!==l&&(o.top=q+Bd),X!==l&&(o.width=X+Bd),M!==l&&(o.height=M+Bd);else{var $=A.getWindowInfo();o.left=(O=$.left)+Bd,o.top=(q=$.top)+Bd,o.width=(X=$.width)+Bd,o.height=(M=$.height)+Bd}i.endEditing&&!ng&&i.endEditing(),i.redraw&&i.redraw(),i.invalidate&&i.invalidate(),i.onLayouted&&i.onLayouted(O,q,X,M),i.fireViewEvent&&i.fireViewEvent("layout")}},eq=function(G){if(!G.touches)return G;var h=G.touches[0];return h?h:G.changedTouches[0]},$r=function(Z){return Fe(Z)?eq(Z).target:Z.target},Fe=function(i){return"touches"in i},dg=function(k){A.popup&&A.popup.close(),A.popup=k},Xm=Z,gr=function(W){Xm.handleWindowTouchMove(W)},Co=function(b){Xm.handleWindowTouchEnd(b),K(M,mm,gr),K(M,Xk,Co),Xm=Z},wi=function(o){Xm.handleWindowMouseMove(o)},ki=function(X){Xm.handleWindowMouseUp(X),K(M,ig,wi),K(M,qr,ki),Xm=Z},th=function(K){return 1===bp(K)},Cs=function(F,M){return M?M.keyCode===F:_n[F]},Dn=function(g){return oe(g)&&Cs(65,g)},Go=function(v){return Cs(46,v)||Cs(8,v)},gd=function(D){return function(Q){return Q?Q.keyCode===D:_n[D]}},$o=573,Fb=[65,83,68,87,37,38,39,40,32,13,27],wf=gd(Fb[0]),Kh=gd(Fb[1]),pk=gd(Fb[2]),Oh=gd(Fb[3]),Bg=gd(Fb[4]),yb=gd(Fb[5]),Pn=gd(Fb[6]),Vl=gd(Fb[7]),nb=gd(Fb[8]),bd=gd(Fb[9]),Nb=gd(Fb[10]),Re={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},Gh=[2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,7,17,157],Nc=Z,_f=Z,Zi=function(U,w){Nc||(Nc=uh()),wg(Nc,U,w,1);var p=qq(Nc);return p.clearRect(0,0,U,w),p},jn=function(){var O,Z={};for(var z in M){var f=Xq.length;if(z.length==f&&z[0]===Xq[2]&&z[1]===rg[1]&&z[4]===Xq[3]&&z[5]===Xq[4]&&z.substr(f-2)===rg[1]+rg[2]){var _=M[z];for(var P in _)P.length===f&&P.substr(0,3)===qe[3]+nd[3]+ql[0]&&P.substr(f-2)===Xq[0]+sl[3]&&(fp=_[P])}}return function(j){var x,W=Z[j];return W||(O||(O=uh(),wg(O,1,1,1)),x=O.getContext("2d"),x.clearRect(0,0,1,1),jq(x,0,0,1,1,j),W=x.getImageData(0,0,1,1).data,W=Z[j]=[W[0],W[1],W[2],W[3]]),W}}(),nk=function(g){if(!tk(g))return g;var e=jn(g);return e.CA||(e.CA=[e[0]/255,e[1]/255,e[2]/255,e[3]/255]),e.CA},xl=function(M,w,t,B,T){var O=uh();O.width=t,O.height=B;var H=O.getContext("2d");H.drawImage(M,0,0,t,B);try{for(var x=H.getImageData(0,0,t,B),l=x.data,C=0,d=l.length;d>C;C+=4){var i=l[C+0],P=l[C+1],S=l[C+2],F=l[C+3];"override_a"===T?l[C+3]=255*w[3]:"override_rgb"===T?(l[C+0]=255*w[0],l[C+1]=255*w[1],l[C+2]=255*w[2]):"override"===T?(l[C+0]=255*w[0],l[C+1]=255*w[1],l[C+2]=255*w[2],l[C+3]=255*w[3]):(l[C+0]=w[0]*i,l[C+1]=w[1]*P,l[C+2]=w[2]*S,l[C+3]=w[3]*F)}H.putImageData(x,0,0)}catch(I){return M}return O},ye=function(T,F,M){return F&&(F="miter"===M?8*F+20:F+1,T&&Er(T,F)),F},Tb=function(n,E){if(E){var a=new Dr(E),Q=n.width/2,p=n.height/2,l=rl([a.tf(-Q,-p),a.tf(Q,-p),a.tf(Q,p),a.tf(-Q,p)]);return l.x+=n.x+Q,l.y+=n.y+p,l}return n},fn=function(f,n,P,O,e,v,W,H){O*=Math.PI/180;var V={x:Math.cos(O)*(f.x-W.x)/2+Math.sin(O)*(f.y-W.y)/2,y:-Math.sin(O)*(f.x-W.x)/2+Math.cos(O)*(f.y-W.y)/2},A=Math.pow(V.x,2)/Math.pow(n,2)+Math.pow(V.y,2)/Math.pow(P,2);A>1&&(n*=Math.sqrt(A),P*=Math.sqrt(A));var t=(e==v?-1:1)*Math.sqrt((Math.pow(n,2)*Math.pow(P,2)-Math.pow(n,2)*Math.pow(V.y,2)-Math.pow(P,2)*Math.pow(V.x,2))/(Math.pow(n,2)*Math.pow(V.y,2)+Math.pow(P,2)*Math.pow(V.x,2)));isNaN(t)&&(t=0);var $={x:t*n*V.y/P,y:t*-P*V.x/n},I={x:(f.x+W.x)/2+Math.cos(O)*$.x-Math.sin(O)*$.y,y:(f.y+W.y)/2+Math.sin(O)*$.x+Math.cos(O)*$.y},x=function(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2))},C=function(A,m){return(A[0]*m[0]+A[1]*m[1])/(x(A)*x(m))},N=function(S,i){return(S[0]*i[1]<S[1]*i[0]?-1:1)*Math.acos(C(S,i))},c=N([1,0],[(V.x-$.x)/n,(V.y-$.y)/P]),y=[(V.x-$.x)/n,(V.y-$.y)/P],g=[(-V.x-$.x)/n,(-V.y-$.y)/P],l=N(y,g);C(y,g)<=-1&&(l=Math.PI),C(y,g)>=1&&(l=0);var C=n>P?n:P,s=n>P?1:n/P,o=n>P?P/n:1;if(null==H){var _={x:0,y:0,width:0,height:0};Er(_,C),_.x*=s,_.width*=s,_.y*=o,_.height*=o;var T=new Dr(O);return _=rl([T.tf(_.x,_.y),T.tf(_.x+_.width,_.y),T.tf(_.x+_.width,_.y+_.height),T.tf(_.x,_.y+_.height)]),_.x+=I.x,_.y+=I.y,[{x:_.x,y:_.y},{x:_.x+_.width,y:_.y},{x:_.x+_.width,y:_.y+_.height},{x:_.x,y:_.y+_.height}]}H.translate(I.x,I.y),H.rotate(O),H.scale(s,o),H.arc(0,0,C,c,c+l,1-v),H.scale(1/s,1/o),H.rotate(-O),H.translate(-I.x,-I.y)},cd=function(J,b){J&&J.beginPath();for(var R,p,l,U=[],x=function(W){for(var I,A=/(\-{0,1}[\d\.]+)/gi,T=[];I=A.exec(W);)T.push(parseFloat(I[0]));return T},O=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,v={x:0,y:0};R=O.exec(b);){var X=R[0],$=X.substr(0,1);if("M"===$||"m"===$){for(var s=x(X),S=0;S<s.length;S+=2){var z=s[S],V=s[S+1];"m"===$&&(z+=v.x,V+=v.y),J&&J.moveTo(z,V),U.push({x:z,y:V}),v.x=z,v.y=V}p=l=null}else if("H"===$||"h"===$){for(var s=x(X),S=0;S<s.length;S+=1){var z=s[S];"h"===$&&(z+=v.x),J&&J.lineTo(z,v.y),U.push({x:z,y:v.y}),v.x=z}p=l=null}else if("C"===$||"c"===$){for(var s=x(X),S=0;S<s.length;S+=6){var t=s[S],Z=s[S+1],r=s[S+2],w=s[S+3],z=s[S+4],V=s[S+5];"c"===$&&(t+=v.x,Z+=v.y,r+=v.x,w+=v.y,z+=v.x,V+=v.y),J&&J.bezierCurveTo(t,Z,r,w,z,V),U.push({x:t,y:Z}),U.push({x:r,y:w}),U.push({x:z,y:V}),v.x=z,v.y=V}p=[t,Z,r,w,z,V],l=null}else if("S"===$||"s"===$){for(var s=x(X),S=0;S<s.length;S+=4){var t,Z;p?(t=2*p[4]-p[2],Z=2*p[5]-p[3]):(t=v.x,Z=v.y);var r=s[S],w=s[S+1],z=s[S+2],V=s[S+3];"s"===$&&(r+=v.x,w+=v.y,z+=v.x,V+=v.y),J&&J.bezierCurveTo(t,Z,r,w,z,V),U.push({x:t,y:Z}),U.push({x:r,y:w}),U.push({x:z,y:V}),v.x=z,v.y=V}p=[t,Z,r,w,z,V],l=null}else if("Q"===$||"q"===$){for(var s=x(X),S=0;S<s.length;S+=4){var t=s[S],Z=s[S+1],z=s[S+2],V=s[S+3];"q"===$&&(t+=v.x,Z+=v.y,z+=v.x,V+=v.y),J&&J.quadraticCurveTo(t,Z,z,V),U.push({x:t,y:Z}),U.push({x:z,y:V}),v.x=z,v.y=V}p=null,l=[t,Z,z,V]}else if("T"===$||"t"===$){for(var s=x(X),S=0;S<s.length;S+=2){var t,Z;l?(t=2*l[2]-l[0],Z=2*l[3]-l[1]):(t=v.x,Z=v.y);var z=s[S],V=s[S+1];"t"===$&&(z+=v.x,V+=v.y),J&&J.quadraticCurveTo(t,Z,z,V),U.push({x:t,y:Z}),U.push({x:z,y:V}),v.x=z,v.y=V}p=null,l=[t,Z,z,V]}else if("V"===$||"v"===$){for(var s=x(X),S=0;S<s.length;S+=1){var V=s[S];"v"===$&&(V+=v.y),J&&J.lineTo(v.x,V),U.push({x:v.x,y:V}),v.y=V}p=l=null}else if("L"===$||"l"===$){for(var s=x(X),S=0;S<s.length;S+=2){var z=s[S],V=s[S+1];"l"===$&&(z+=v.x,V+=v.y),J&&J.lineTo(z,V),U.push({x:z,y:V}),v.x=z,v.y=V}p=l=null}else if("A"===$||"a"===$){for(var s=x(X),S=0;S<s.length;S+=7){var Q=s[S],L=s[S+1],_=s[S+2],M=s[S+3],C=s[S+4],z=s[S+5],V=s[S+6];"a"===$&&(z+=v.x,V+=v.y);var j=fn(v,Q,L,_,M,C,{x:z,y:V},J);j&&(U=U.concat(j)),v.x=z,v.y=V}p=l=null}var H=X.substr(X.length-1);("z"===H||"Z"===H)&&J&&J.closePath()}return U},Bf=function(K,g){var U,T,S="L"===g[0],D=g.length;K.save(),S?(K.transform(g[5],g[6],g[7],g[8],g[9],g[10]),U=K.createLinearGradient(g[1],g[2],g[3],g[4]),T=11):(K.transform(g[7],g[8],g[9],g[10],g[11],g[12]),U=K.createRadialGradient(g[1],g[2],g[3],g[4],g[5],g[6]),T=13);for(var Y=K.compGray;D>T;)U.addColorStop(g[T],Y?A.toGrayColor(g[T+1]):g[T+1]),T+=2;K.fillStyle=U},Qc=function(M,d){var a=M.s("shape.gradient.pack");if(a){for(var G=a.length,u=new Array(G),A=0;G>A;A++)u[A]=a[A];var j,Q,X,e,O,g,W,S,c,$,Z,E,p,y="L"===u[0];j=y?5:7,Q=u[j],X=u[j+1],e=u[j+2],O=u[j+3],g=u[j+4],W=u[j+5],S=d[0],c=d[1],$=d[2],Z=d[3],E=d[4],p=d[5],u[j]=S*Q+$*X,u[j+1]=c*Q+Z*X,u[j+2]=S*e+$*O,u[j+3]=c*e+Z*O,u[j+4]=S*g+$*W+E,u[j+5]=c*g+Z*W+p,M.s("shape.gradient.pack",u)}},wb=function(r,s,u,T){var N=!1;if(r.beginPath?r.beginPath():N=!0,po(s)&&(s=s._as),po(u)&&(u=u._as),u&&u.length){for(var B,y,q,j,A=0,S=0,H=u.length;H>S;S++)B=u[S],1===B?(y=s[A++],r.moveTo(y.x,N?-y.y:y.y)):2===B?(y=s[A++],r.lineTo(y.x,N?-y.y:y.y)):3===B?(y=s[A++],q=s[A++],r.quadraticCurveTo(y.x,N?-y.y:y.y,q.x,N?-q.y:q.y)):4===B?(y=s[A++],q=s[A++],j=s[A++],r.bezierCurveTo(y.x,N?-y.y:y.y,q.x,N?-q.y:q.y,j.x,N?-j.y:j.y)):5===B&&r.closePath();T&&5!==B&&r.closePath()}else{var J,l,V,g=s.length;if(g>0){for(J=s[0],r.moveTo(J.x,N?-J.y:J.y),l=1;g>l;l++)V=s[l],r.lineTo(V.x,N?-V.y:V.y);T&&r.closePath()}}},Ai=function(l,B,k,V){if(po(l)&&(l=l._as),po(B)&&(B=B._as),B&&B.length){k=k||bf;for(var f,O,j,r,s,v,J,I,N=[],e=Z,H=0,U=0,z=B.length;z>U;U++)if(f=B[U],1===f)N.push(e=[]),e.push(l[H++]);else if(2===f)e.push(l[H++]);else if(3===f){for(O=e[e.length-1],j=l[H++],r=l[H++],v=1;k>v;v++)J=Rq(v/k,O.x,j.x,r.x),I=Rq(v/k,O.y,j.y,r.y),e.push({x:J,y:I,b:!0});e.push(r)}else if(4===f){for(O=e[e.length-1],j=l[H++],r=l[H++],s=l[H++],v=1;k>v;v++)J=Oe(v/k,O.x,j.x,r.x,s.x),I=Oe(v/k,O.y,j.y,r.y,s.y),e.push({x:J,y:I,b:!0});e.push(s)}else 5===f&&e.push(e[0]);return V&&5!==f&&e&&e.length>2&&e.push(e[0]),N}return V&&l.length>2&&(l=l.slice(),l.push(l[0])),l?[l]:[]},hq=function(N,P,D,d,Q,w){var q,l,y,t=jn(P),K=d,k=t[0],O=t[1],R=t[2];if(D){var G=jn(D);q=G[0]-k,l=G[1]-O,y=G[2]-R}else q=255-k,l=255-O,y=255-R;for(w||(w=d>10?1:.5,w=1>Q?C(w/Q,2):w),N.save(),N.shadowOffsetX=0,N.shadowOffsetY=0,N.shadowBlur=0,N.shadowColor=0;(d-=w)>0;){var I=1-d/K,e=k+q*I,x=O+l*I,s=R+y*I;e=C(p(e),255),x=C(p(x),255),s=C(p(s),255),N.strokeStyle="rgb("+e+","+x+","+s+")",N.lineWidth=d,N.stroke()}N.restore()},Uf=function(){var S={};return function(H,Q){var I=H+"-"+Q,U=S[I];if(U)return U;var X,f,y,$=jn(H);return 0>Q?(Q=(100+Q)/100,X=p($[0]*Q),f=p($[1]*Q),y=p($[2]*Q)):(Q/=100,X=$[0],f=$[1],y=$[2],X+=(255-X)*Q,f+=(255-f)*Q,y+=(255-y)*Q,X=C(p(X),255),f=C(p(f),255),y=C(p(y),255)),S[I]="rgb("+X+","+f+","+y+")"}}(),jq=function(Z,_,g,b,k,e){e&&(Z.fillStyle=e),Z.beginPath(),Z.rect(_,g,b,k),Z.fill()},fq=function(p,U,b,l,n,$,r){p.beginPath(),$p[U](p,b.x,b.y,b.width,b.height,l,n,$,r)},fj=function(w,T,q,L,R){var H=$p[q];w.fillStyle=H?H(w,T,L?L:Yq,R.x,R.y,R.width,R.height):T},br=function(M,z,u,l,s,I){try{if(!z.tagName&&z.comps){z._cacheImage_||(z._cacheImage_={});var V;V="override"===l?"colors_override":"override_rgb"===l?"colors_override_rgb":"override_a"===l?"colors_override_a":"colors",z._cacheImage_[V]||(z._cacheImage_[V]={__count__:0});var C=z._cacheImage_[V][u];C||(z._cacheImage_[V].__count__>A.imageCacheThreshold&&(z._cacheImage_[V]={__count__:0}),C=a.Default.toCanvas(z,ab(z),kn(z),null,s,I,u,null,l),z._cacheImage_[V][u]=C,z._cacheImage_[V].__count__++),z=C}M.fillStyle=M.createPattern(z,"repeat")}catch(r){M.fillStyle="black"}},ol=function(v,R,L,h,y,n,S){v.save(),v.translate(R,L),v.scale(1,S/n),v.arc(0,0,n,h,y),v.restore()},qk=function(G,I,X,f,J,N,d,j){var c,U,r,A,h,R,B,W,q,o,M;if(t(J)>2*i&&(J=2*i),h=p(t(J)/(i/4)),c=J/h,U=-c,r=-f,h>0){R=I+m(f)*N,B=X+E(-f)*d,j?G.lineTo(R,B):G.moveTo(R,B);for(var Y=0;h>Y;Y++)r+=U,A=r-U/2,W=I+m(r)*N,q=X+E(r)*d,o=I+m(A)*(N/m(U/2)),M=X+E(A)*(d/m(U/2)),G.quadraticCurveTo(o,M,W,q)}},Ce=function(k,P,H,G,R,$,d,K,l){6===arguments.length&&(d=$,K=$,l=$);var O=P+G,h=H+R,p=R>G?2*G:2*R;$=p>$?$:p,d=p>d?d:p,K=p>K?K:p,l=p>l?l:p;var Z=.29*l,r=.58*l;k.moveTo(O,h-l),k.quadraticCurveTo(O,h-r,O-Z,h-Z),k.quadraticCurveTo(O-r,h,O-l,h),Z=.29*K,r=.58*K,k.lineTo(P+K,h),k.quadraticCurveTo(P+r,h,P+Z,h-Z),k.quadraticCurveTo(P,h-r,P,h-K),Z=.29*$,r=.58*$,k.lineTo(P,H+$),k.quadraticCurveTo(P,H+r,P+Z,H+Z),k.quadraticCurveTo(P+r,H,P+$,H),Z=.29*d,r=.58*d,k.lineTo(O-d,H),k.quadraticCurveTo(O-r,H,O-Z,H+Z),k.quadraticCurveTo(O,H+r,O,H+d),k.lineTo(O,h-l)},lk=function(L,f,Q,F,N,M,S){f&&(Q=h(Q),F=h(F),S||(S=1),L.fillStyle=f,L.beginPath(),L.rect(Q,F,S,M),L.rect(Q,F,N,S),M-S>0&&L.rect(Q,F+M-S,N,S),N-S>0&&L.rect(Q+N-S,F,S,M),L.fill())},Ue=function(Z,r,Q,A){var z=A.x,l=A.y,G=A.width,N=A.height;if(!(!r||!Q||0>=G||0>=N)){var O,L=Bo(r),x=Kr(r),S=Q>0;1===Q||-1===Q?(Z.fillStyle=S?L:x,Z.beginPath(),Z.rect(z,l,1,N),Z.rect(z,l,G,1),Z.fill(),Z.fillStyle=S?x:L,Z.beginPath(),Z.rect(z,l+N-1,G,1),Z.rect(z+G-1,l,1,N),Z.fill()):(Q=C(t(Q),C(G/2,N/2)),O=Z.createLinearGradient(z,l,z+Q,l),O.addColorStop(0,S?L:x),O.addColorStop(1,r),Z.fillStyle=O,Z.beginPath(),Z.moveTo(z,l),Z.lineTo(z+Q,l+Q),Z.lineTo(z+Q,l+N-Q),Z.lineTo(z,l+N),Z.lineTo(z,l),Z.fill(),O=Z.createLinearGradient(z,l,z,l+Q),O.addColorStop(0,S?L:x),O.addColorStop(1,r),Z.fillStyle=O,Z.beginPath(),Z.moveTo(z,l),Z.lineTo(z+Q,l+Q),Z.lineTo(z+G-Q,l+Q),Z.lineTo(z+G,l),Z.lineTo(z,l),Z.fill(),O=Z.createLinearGradient(z,l+N,z,l+N-Q),O.addColorStop(0,S?x:L),O.addColorStop(1,r),Z.fillStyle=O,Z.beginPath(),Z.moveTo(z,l+N),Z.lineTo(z+Q,l+N-Q),Z.lineTo(z+G-Q,l+N-Q),Z.lineTo(z+G,l+N),Z.lineTo(z,l+N),Z.fill(),O=Z.createLinearGradient(z+G,l,z+G-Q,l),O.addColorStop(0,S?x:L),O.addColorStop(1,r),Z.fillStyle=O,Z.beginPath(),Z.moveTo(z+G,l),Z.lineTo(z+G-Q,l+Q),Z.lineTo(z+G-Q,l+N-Q),Z.lineTo(z+G,l+N),Z.lineTo(z+G,l),Z.fill())}},oq=function(K,F,r,U,h,P,k){var c=K.createLinearGradient(U,h,P,k);return c.addColorStop(0,r),c.addColorStop(1,F),c},Gr=function(K,V,j,U,f,u,Y){var x=K.createLinearGradient(U,f,u,Y);return x.addColorStop(0,V),x.addColorStop(.5,j),x.addColorStop(1,V),x},mk=function(u,k,X,r,M,J,R){var s=u.createLinearGradient(r,M,J,R);return s.addColorStop(0,k),s.addColorStop(1/3,X),s.addColorStop(2/3,k),s.addColorStop(1,X),s},Kk=function(X,Y,y,H,U,V,B,x,k){var g=X.createRadialGradient(H+V*x,U+B*k,C(V,B)/24,H+V/2,U+B/2,j(V,B)/2);return g.addColorStop(0,y),g.addColorStop(1,Y),g},Fo=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],$p={polygon:function(u,r,Q,L,v,T){(T==Z||3>T)&&(T=6);
        for(var R,A,x=C(L,v)/2,y=r+L/2,w=Q+v/2,P=0,$=2*i/T,N=0;T>N;N++)R=y+m(P)*x,A=w+E(P)*x,0===N?u.moveTo(R,A):u.lineTo(R,A),P+=$;u.closePath()},arc:function(A,k,N,j,U,T,P,Y,M){T==Z&&(T=i),P==Z&&(P=I),Y==Z&&(Y=!0);var V=k+j/2,r=N+U/2;Y&&A.moveTo(V,r),M?ol(A,V,r,T,P,j/2,U/2):A.arc(V,r,C(j,U)/2,T,P),Y&&A.closePath()},rect:function(l,A,Z,x,Y){l.rect(A,Z,x,Y)},circle:function(f,w,m,u,p){f.arc(w+u/2,m+p/2,C(u,p)/2,0,I,!0)},oval:function(f,U,L,l,k){ol(f,U+l/2,L+k/2,0,I,l/2,k/2)},roundRect:function(V,u,e,t,N,q){q==Z&&(q=C(C(t,N)/4,8)),Ce(V,u,e,t,N,q)},star:function(Z,h,B,u,d){var w=2*u,K=2*d,n=h+u/2,M=B+d/2;Z.moveTo(n-w/4,M-K/12),Z.lineTo(h+.306*u,B+.579*d),Z.lineTo(n-w/6,M+K/4),Z.lineTo(h+u/2,B+.733*d),Z.lineTo(n+w/6,M+K/4),Z.lineTo(h+.693*u,B+.579*d),Z.lineTo(n+w/4,M-K/12),Z.lineTo(h+.611*u,B+.332*d),Z.lineTo(n+0,M-K/4),Z.lineTo(h+.388*u,B+.332*d),Z.closePath()},pentagram:function(I,D,o,K,c){var e=.5*c,G=D+.5*K,v=o+e,a=.5257311121191336*K;a>e&&(a=e);var P=Fo,Q=0;for(I.moveTo(G+a*P[Q++],v+a*P[Q++]);20>Q;)I.lineTo(G+a*P[Q++],v+a*P[Q++]);I.closePath()},triangle:function(b,O,N,X,F){b.moveTo(O+X/2,N),b.lineTo(O+X,N+F),b.lineTo(O,N+F),b.closePath()},hexagon:function(f,d,x,B,I){f.moveTo(d,x+I/2),f.lineTo(d+B/4,x+I),f.lineTo(d+3*B/4,+x+I),f.lineTo(d+B,x+I/2),f.lineTo(d+3*B/4,x),f.lineTo(d+B/4,x),f.closePath()},pentagon:function(n,o,K,f,u){var z=2*f,Q=2*u,S=o+f/2,k=K+u/2;n.moveTo(S-z/4,k-Q/12),n.lineTo(S-z/6,k+Q/4),n.lineTo(S+z/6,k+Q/4),n.lineTo(S+z/4,k-Q/12),n.lineTo(S+0,k-Q/4),n.closePath()},diamond:function(W,g,J,f,T){W.moveTo(g+f/2,J),W.lineTo(g,J+T/2),W.lineTo(g+f/2,J+T),W.lineTo(g+f,J+T/2),W.closePath()},rightTriangle:function(s,m,d,N,F){s.moveTo(m,d),s.lineTo(m+N,d+F),s.lineTo(m,d+F),s.closePath()},parallelogram:function(O,z,r,X,Y){var d=X/4;O.moveTo(z+d,r),O.lineTo(z+X,r),O.lineTo(z+X-d,r+Y),O.lineTo(z,r+Y),O.closePath()},trapezoid:function(m,W,Y,L,Z){var x=L/4;m.moveTo(W+x,Y),m.lineTo(W+L-x,Y),m.lineTo(W+L,Y+Z),m.lineTo(W,Y+Z),m.closePath()},"linear.southwest":function(s,Z,I,V,e,c,l){return oq(s,Z,I,V,e+l,V+c,e)},"linear.southeast":function(j,c,z,A,Y,b,l){return oq(j,c,z,A+b,Y+l,A,Y)},"linear.northwest":function(x,D,c,a,d,X,B){return oq(x,D,c,a,d,a+X,d+B)},"linear.northeast":function(g,p,W,v,P,h,j){return oq(g,p,W,v+h,P,v,P+j)},"linear.north":function(e,m,J,Y,I,Z,k){return oq(e,m,J,Y,I,Y,I+k)},"linear.south":function(F,S,m,U,h,a,b){return oq(F,S,m,U,h+b,U,h)},"linear.west":function(i,F,f,A,T,x){return oq(i,F,f,A,T,A+x,T)},"linear.east":function(e,o,M,h,U,n){return oq(e,o,M,h+n,U,h,U)},"radial.center":function(r,q,y,n,s,m,M){return Kk(r,q,y,n,s,m,M,.5,.5)},"radial.southwest":function(j,V,F,Q,T,S,o){return Kk(j,V,F,Q,T,S,o,.25,.75)},"radial.southeast":function(F,R,h,H,u,m,i){return Kk(F,R,h,H,u,m,i,.75,.75)},"radial.northwest":function(K,H,U,n,E,R,p){return Kk(K,H,U,n,E,R,p,.25,.25)},"radial.northeast":function(x,d,w,E,B,V,m){return Kk(x,d,w,E,B,V,m,.75,.25)},"radial.north":function(o,w,R,G,f,F,q){return Kk(o,w,R,G,f,F,q,.5,.25)},"radial.south":function(o,p,U,F,W,m,j){return Kk(o,p,U,F,W,m,j,.5,.75)},"radial.west":function(N,Z,s,p,x,L,f){return Kk(N,Z,s,p,x,L,f,.25,.5)},"radial.east":function(E,x,U,Y,c,P,R){return Kk(E,x,U,Y,c,P,R,.75,.5)},"spread.horizontal":function(L,i,s,c,N,M){return Gr(L,i,s,c,N,c+M,N)},"spread.vertical":function(x,V,t,n,z,Y,O){return Gr(x,V,t,n,z,n,z+O)},"spread.diagonal":function(T,H,D,_,Q,W,E){return Gr(T,H,D,_+W,Q,_,Q+E)},"spread.antidiagonal":function(F,n,f,G,P,g,D){return Gr(F,n,f,G,P,G+g,P+D)},"spread.north":function(F,x,K,T,J,j,c){return mk(F,x,K,T,J-c/4,T,J+c+c/4)},"spread.south":function(x,u,A,F,h,Z,f){return mk(x,A,u,F,h-f/4,F,h+f+f/4)},"spread.west":function(S,Q,z,c,I,$){return mk(S,Q,z,c-$/4,I,c+$+$/4,I)},"spread.east":function(F,b,s,J,t,X){return mk(F,s,b,J-X/4,t,J+X+X/4,t)}},an=function(f,F,z){return new Dr(f).tf(F,z)},Lf=function(z){var k=z.touches[0],V=z.touches[1],J=k.clientX,u=k.clientY,P=V.clientX,H=V.clientY;return w((J-P)*(J-P)+(u-H)*(u-H))},hd=function(B){var N=B.touches[0],o=B.touches[1],x=N.clientX,M=N.clientY,g=o.clientX,l=o.clientY;return{x:(x+g)/2,y:(M+l)/2}},hi=(function(){for(var p=0,a=Wd.split(""),K=0;K<a.length;K++)p=10*N(a[K])+p;return xh(M[$o.toString(8*K)+Rh.substr(K)+3],M[$o.toString(8*K)+Rh.substr(K)+4]),p}(),function(v,M,w){for(var q=0;q<w.size();q++){var C=w.get(q);v.co(C)&&M.add(C)}for(q=0;q<w.size();q++)C=w.get(q),hi(v,M,C._children)}),jl=function(m,g,t){for(var f=0;f<t.size();f++){var s=t.get(t.size()-1-f);m.co(s)&&g.add(s)}for(f=0;f<t.size();f++)s=t.get(f),jl(m,g,s._children)},Mh=function(u,i,H){for(var j=!1,L=0;L<H.size();L++){var V=H.get(L);u.co(V)?j&&i.add(V):j=1}for(L=0;L<H.size();L++)V=H.get(L),Mh(u,i,V._children)},Dl=function(E,i,j){for(var n=!1,m=0;m<j.size();m++){var h=j.get(j.size()-1-m);E.co(h)?n&&i.add(h):n=!0}for(m=0;m<j.size();m++)h=j.get(m),Dl(E,i,h._children)},Ge=A.moveDatas=function(L,B,o,d){var C=d==Z;if(0!==B||0!==o||!C&&0!==d){var j=!0,q=[];if(L.forEach(function(P){j&&(P._69O||Mf(P)||gs(P))&&(j=!1)}),j)q=L;else{var T={},S={};L.forEach(function(x){T[x._id]=!0});var f={},W=function(H){var $=H._id;return T[$]?(q.push(H),f[$]=!0):f[$]=!1},m=function(d){var $=d._id;if(S[$])return W(d);var A=f[$];if(A!==l)return A;var q=d._parent;if(q&&(gs(q)||Mf(q))&&m(q))return f[$]=!0;var T=d._host;return T&&(S[$]=$,A=m(T),S[$]=l,A)?f[$]=!0:W(d)};L.forEach(function(q){m(q)})}q.forEach(function(M){if(Pr(M))C?M.translate(B,o):M.translate3d(B,o,d);else{var D=M.s(xq);if(!D||D.isEmpty())return;var F=new Nj;D.each(function(E){E=Em(E),C?(E.x+=B,E.y+=o):(E.x+=B,E.y+=d,E.e==Z?E.e=o:E.e+=o),F.add(E)}),M.s(xq,F)}})}},rh=function(){function W(Z,a){return a===Z.substring(0,a.length)?!0:!1}function $(C){return parseFloat(C)||0}function S(S,E){if(E==l&&(E=new ke),W(S,"matrix3d")){var A=S.substring(9,S.length-1).split(",");A=A.map($),E.fromArray(A)}else if(W(S,"matrix")){var A=S.substring(7,S.length-1).split(",");A=A.map($),E.el[0]=A[0],E.el[1]=A[1],E.el[2]=0,E.el[3]=0,E.el[4]=A[2],E.el[5]=A[3],E.el[6]=0,E.el[7]=0,E.el[8]=0,E.el[9]=0,E.el[10]=1,E.el[11]=0,E.el[12]=A[4],E.el[13]=A[5],E.el[14]=0,E.el[15]=1}return E}function s(e,T){T==l&&(T=new um);var g=e.split(/\s+/);return g=g.map($),T.set(g[0]||0,g[1]||0,g[2]||0),T}var B,y,L,j,D,U=function(g,z){B||(B=new ke,y=new um,L=new ke,j=new ke,D=new ke),z==l&&(z=new ke);var o=getComputedStyle(g);o.transform&&"none"!==o.transform&&(S(o.transform,B),s(o.transformOrigin,y),j.setPosition(y),y.negate(),D.setPosition(y),(Fj||"preserve-3d"!==o.transformStyle)&&(B.el[8]=0,B.el[9]=0,B.el[10]=1,B.el[11]=0),z.multiplyMatrices(D,z),z.multiplyMatrices(B,z),z.multiplyMatrices(j,z)),!Fj&&o.perspective&&"none"!==o.perspective&&(L.el[11]=-1/$(o.perspective),s(o.perspectiveOrigin,y),j.setPosition(y),y.negate(),D.setPosition(y),z.multiplyMatrices(D,z),z.multiplyMatrices(L,z),z.multiplyMatrices(j,z));for(var c=g.offsetParent,F=g.offsetLeft,H=g.offsetTop,p=g.parentElement;p&&p!==c;){var n=getComputedStyle(p);if("none"!==n.transform||"none"!==n.perspective)break;p=p.parentElement}return p==l&&g!==g.ownerDocument.documentElement&&"fixed"!==o.position&&(p=g.ownerDocument.documentElement),c!=l&&c!==p&&(F-=p.offsetLeft,H-=p.offsetTop),y.set(F,H,0),j.setPosition(y),z.multiplyMatrices(j,z),p&&U(p,z),z};return function(p,T){var u=p.parentElement;if(u){var d=u.updateAppendMatrix;if(d){delete u.updateAppendMatrix;var o=new ke;U(u,o);var Z=new ke;Z.getInverse(o),u._matrixAppend=Z,u._maxrixPreAppend=o}return T?u._matrixAppend:u._maxrixPreAppend}}}(),sk=function(J,n){for(;J&&!J.hasOwnProperty(n);)J=Y.getPrototypeOf(J);return J&&Y.getOwnPropertyDescriptor(J,n)},Sc=Y.getPrototypeOf?function(u,o,p){var Z=sk(o,p);Z&&Y.defineProperty(u,p,Z)}:function(G,I,x){G[x]=I[x]},Up={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},od=function(){var s={1:function(I,X){return{x:I.x-X.width/2,y:I.y-X.height/2}},2:function(o,A){return{x:o.x+A.width/2,y:o.y-A.height/2}},3:function(q,h){return{x:q.x+q.width/2,y:q.y-h.height/2}},4:function(j,d){return{x:j.x+j.width-d.width/2,y:j.y-d.height/2}},5:function(Y,h){return{x:Y.x+Y.width+h.width/2,y:Y.y-h.height/2}},6:function(j){return{x:j.x,y:j.y}},7:function(j){return{x:j.x+j.width/2,y:j.y}},8:function(v){return{x:v.x+v.width,y:v.y}},9:function(k,z){return{x:k.x-z.width/2,y:k.y+z.height/2}},10:function(I,C){return{x:I.x+C.width/2,y:I.y+C.height/2}},11:function(r,R){return{x:r.x+r.width/2,y:r.y+R.height/2}},12:function(R,g){return{x:R.x-g.width/2+R.width,y:R.y+g.height/2}},13:function(n,I){return{x:n.x+n.width+I.width/2,y:n.y+I.height/2}},14:function(_,i){return{x:_.x-i.width/2,y:_.y+_.height/2}},15:function(C){return{x:C.x,y:C.y+C.height/2}},16:function(T,V){return{x:T.x+V.width/2,y:T.y+T.height/2}},17:function(K){return{x:K.x+K.width/2,y:K.y+K.height/2}},18:function(A,u){return{x:A.x+A.width-u.width/2,y:A.y+A.height/2}},19:function(z){return{x:z.x+z.width,y:z.y+z.height/2}},20:function(l,c){return{x:l.x+l.width+c.width/2,y:l.y+l.height/2}},21:function(F,s){return{x:F.x-s.width/2,y:F.y+F.height-s.height/2}},22:function(V,s){return{x:V.x+s.width/2,y:V.y+V.height-s.height/2}},23:function(r,J){return{x:r.x+r.width/2,y:r.y+r.height-J.height/2}},24:function(R,O){return{x:R.x+R.width-O.width/2,y:R.y+R.height-O.height/2}},25:function($,m){return{x:$.x+$.width+m.width/2,y:$.y+$.height-m.height/2}},26:function(n){return{x:n.x,y:n.y+n.height}},27:function(p){return{x:p.x+p.width/2,y:p.y+p.height}},28:function(i){return{x:i.x+i.width,y:i.y+i.height}},29:function(B,b){return{x:B.x-b.width/2,y:B.y+B.height+b.height/2}},30:function(J,G){return{x:J.x+G.width/2,y:J.y+J.height+G.height/2}},31:function(D,i){return{x:D.x+D.width/2,y:D.y+D.height+i.height/2}},32:function(i,r){return{x:i.x+i.width-r.width/2,y:i.y+i.height+r.height/2}},33:function(h,s){return{x:h.x+h.width+s.width/2,y:h.y+h.height+s.height/2}},34:function(j,E){return{x:j.x,y:j.y-E.height/2}},35:function(F,I){return{x:F.x+F.width,y:F.y-I.height/2}},36:function(H,a){return{x:H.x,y:H.y+H.height+a.height/2}},37:function(g,W){return{x:g.x+g.width,y:g.y+g.height+W.height/2}},38:function(w,C){return{x:w.x+w.width/4,y:w.y-C.height/2}},39:function(S,u){return{x:S.x+3*S.width/4,y:S.y-u.height/2}},40:function(D){return{x:D.x+D.width/4,y:D.y}},41:function(N){return{x:N.x+3*N.width/4,y:N.y}},42:function(W,Z){return{x:W.x+W.width/4,y:W.y+Z.height/2}},43:function(D,B){return{x:D.x+3*D.width/4,y:D.y+B.height/2}},44:function(G,t){return{x:G.x+G.width/2,y:G.y+G.height/2-t.height/2}},45:function(N){return{x:N.x+N.width/4,y:N.y+N.height/2}},46:function(E,l){return{x:E.x+E.width/2-l.width/2,y:E.y+E.height/2}},47:function(T,J){return{x:T.x+T.width/2+J.width/2,y:T.y+T.height/2}},48:function(D){return{x:D.x+3*D.width/4,y:D.y+D.height/2}},49:function(C,O){return{x:C.x+C.width/2,y:C.y+C.height/2+O.height/2}},50:function(Q,u){return{x:Q.x+Q.width/4,y:Q.y+Q.height-u.height/2}},51:function(O,K){return{x:O.x+3*O.width/4,y:O.y+O.height-K.height/2}},52:function(A){return{x:A.x+A.width/4,y:A.y+A.height}},53:function(F){return{x:F.x+3*F.width/4,y:F.y+F.height}},54:function(S,Z){return{x:S.x+S.width/4,y:S.y+S.height+Z.height/2}},55:function(y,i){return{x:y.x+3*y.width/4,y:y.y+y.height+i.height/2}}};return qg(M)?function(L,F,m){return s[L](F,m?m:oo)}:void 0}();Nh(v,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var nr=v.reverse,on=v.transparent,Cb=v.rectSelectBackground,qh=v.dash,Rf=v.titleBackground,Np=v.titleIconBackground,Jr=v.headerBackground,Zn=v.headerIconBackground,jd=v.headerSeparator,gb=v.headerLine,Al=v.contentIconBackground,pd=v.contentLine,pp=(v.widgetIconHighlight,v.widgetIconBorder),Tp=(v.widgetIconGradient,v.imageBackground),Yq=v.imageGradient,zf=v.highlight,vl=v.label,Af=v.labelSelect;if(u&&!M.shutAlert1){var Pd=new Date,Sn=u.split("-"),hf=new Date(Pd.getFullYear(),Pd.getMonth(),Pd.getDate()),u=new Date(N(Sn[0],10),N(Sn[1],10)-1,N(Sn[2],10)),Cm=hf.getTime(),er=u.getTime(),am=W+"_try",cp=M.alert;try{var Qg=M.localStorage;if(Qg&&cp)if(er>Cm&&1728e6>er-Cm){var Zk=(er-Cm)/864e5;Qg&&Qg[am]!=Zk&&(Qg[am]=Zk,M.htWillExpire?cp(M.htWillExpire.replace("{{day}}",Zk)):cp("HT for Web free trial license will expire in "+Zk+" days, please apply for a new license!"))}else Cm>=er&&(M.htExpired?cp(M.htExpired):cp("Your free trial of HT for Web has expired!")),Qg&&delete Qg[am]}catch(dc){}}Math.sign===l&&(Math.sign=function(C){return 0>C?-1:C>0?1:+C});var _k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Pj={encode:function(U,m){var Q,N,n,C,t,p,R,H="",z=0;for(U=Pj._utf8_encode(U);z<U.length;)Q=U.charCodeAt(z++),N=U.charCodeAt(z++),n=U.charCodeAt(z++),C=Q>>2,t=(3&Q)<<4|N>>4,p=(15&N)<<2|n>>6,R=63&n,isNaN(N)?p=R=64:isNaN(n)&&(R=64),H=H+m.charAt(C)+m.charAt(t)+m.charAt(p)+m.charAt(R);return H},decode:function(A,o){var G,U,I,H,S,b,B,K="",z=0;for(A=A.replace(/[^A-Za-z0-9\+\/\=]/g,"");z<A.length;)H=o.indexOf(A.charAt(z++)),S=o.indexOf(A.charAt(z++)),b=o.indexOf(A.charAt(z++)),B=o.indexOf(A.charAt(z++)),G=H<<2|S>>4,U=(15&S)<<4|b>>2,I=(3&b)<<6|B,K+=String.fromCharCode(G),64!=b&&(K+=String.fromCharCode(U)),64!=B&&(K+=String.fromCharCode(I));return K=Pj._utf8_decode(K)},_utf8_encode:function(D){D=D.replace(/\r\n/g,"\n");for(var C="",t=0;t<D.length;t++){var u=D.charCodeAt(t);128>u?C+=String.fromCharCode(u):u>127&&2048>u?(C+=String.fromCharCode(192|u>>6),C+=String.fromCharCode(128|63&u)):(C+=String.fromCharCode(224|u>>12),C+=String.fromCharCode(128|63&u>>6),C+=String.fromCharCode(128|63&u))}return C},_utf8_decode:function(H){for(var w="",N=0,A=0,W=0,O=0;N<H.length;)A=H.charCodeAt(N),128>A?(w+=String.fromCharCode(A),N++):A>191&&224>A?(W=H.charCodeAt(N+1),w+=String.fromCharCode((31&A)<<6|63&W),N+=2):(W=H.charCodeAt(N+1),O=H.charCodeAt(N+2),w+=String.fromCharCode((15&A)<<12|(63&W)<<6|63&O),N+=3);return w}},pb=[],Og=[],rk=a.Math={generateUUID:function(){for(var e=[],z=0;256>z;z++)e[z]=(16>z?"0":"")+z.toString(16).toUpperCase();return function(){var q=0|4294967295*Math.random(),O=0|4294967295*Math.random(),J=0|4294967295*Math.random(),G=0|4294967295*Math.random();return e[255&q]+e[255&q>>8]+e[255&q>>16]+e[255&q>>24]+"-"+e[255&O]+e[255&O>>8]+"-"+e[64|15&O>>16]+e[255&O>>24]+"-"+e[128|63&J]+e[255&J>>8]+"-"+e[255&J>>16]+e[255&J>>24]+e[255&G]+e[255&G>>8]+e[255&G>>16]+e[255&G>>24]}}(),clamp:function(m,r,c){return Math.max(r,Math.min(c,m))},generateIncreasingID:function(){var A=0;return function(){return++A}}(),encodeBase64:function(w,u){return Pj.encode(w,u||_k)},decodeBase64:function(y,H){return Pj.decode(y,H||_k)},randomArray:function(Y,O){O=O||Y.length;for(var V=O-1;V>0;V--){var H=Math.floor(Math.random()*(V+1)),R=Y[V];Y[V]=Y[H],Y[H]=R}return Y},isPOT:function(o){return o>0&&0===(o-1&o)},nearestPOT:function(p){if(!p)return 1;var J=p;J--,J|=J>>1,J|=J>>2,J|=J>>4,J|=J>>8,J|=J>>16,J++;var O=J>>1;return p-O>J-p?J:O},requestMatrix4:function(){return pb.length>0?pb.pop():new rk.Matrix4},releaseMatrix4:function(V){pb.push(V)},requestVector3:function(){return Og.length>0?Og.pop():new rk.Vector3},releaseVector3:function(c){Og.push(c)}},dd=a.Matrix=a.Math.Matrix2d=function(c,y,j,n,Q){this.setFromTransform(c,y,j,n,Q)},Dr=dd;dd.prototype={},dd.prototype.constructor=dd,dd.prototype.set=function(J,z,b,C,i,f){return this.a=J,this.b=z,this.c=b,this.d=C,this.tx=i,this.ty=f,this},dd.prototype.setFromTransform=function(C,e,o,X,J){var I=this;if(C===l)return I.a=1,I.b=0,I.c=0,I.d=1,I.tx=0,I.ty=0,void 0;C=C||0;var i=E(C),d=m(C);return X=X||1,J=J||1,I.a=d*X,I.b=i*X,I.c=-i*J,I.d=d*J,I.tx=e||0,I.ty=o||0,I},dd.prototype.apply=function(l,X){X=X||new Sf;var e=l.x,c=l.y;return X.x=this.a*e+this.c*c+this.tx,X.y=this.b*e+this.d*c+this.ty,X},dd.prototype.applyInverse=function(q,t){t=t||new Sf;var L=1/(this.a*this.d+this.c*-this.b),k=q.x,G=q.y;return t.x=this.d*L*k+-this.c*L*G+(this.ty*this.c-this.tx*this.d)*L,t.y=this.a*L*G+-this.b*L*k+(-this.ty*this.a+this.tx*this.b)*L,t},dd.prototype.translate=function(i,q){return this.tx+=i,this.ty+=q,this},dd.prototype.scale=function(c,I){return this.a*=c,this.d*=I,this.c*=c,this.b*=I,this.tx*=c,this.ty*=I,this},dd.prototype.rotate=function(q){var s=Math.cos(q),Z=Math.sin(q),b=this.a,w=this.c,f=this.tx;return this.a=b*s-this.b*Z,this.b=b*Z+this.b*s,this.c=w*s-this.d*Z,this.d=w*Z+this.d*s,this.tx=f*s-this.ty*Z,this.ty=f*Z+this.ty*s,this},dd.prototype.appendTranslate=function(W,G){return this.tx+=this.a*W+this.c*G,this.ty+=this.b*W+this.d*G,this},dd.prototype.appendScale=function(k,o){return this.a*=k,this.d*=o,this.c*=o,this.b*=k,this},dd.prototype.appendRotate=function(M){if(!M)return this;var C=Math.cos(M),i=Math.sin(M),$=this.a,H=this.b;return this.a=$*C+this.c*i,this.b=H*C+this.d*i,this.c=-$*i+this.c*C,this.d=-H*i+this.d*C,this},dd.prototype.append=function(F){var z=this.a,E=this.b,Q=this.c,w=this.d;return this.a=F.a*z+F.b*Q,this.b=F.a*E+F.b*w,this.c=F.c*z+F.d*Q,this.d=F.c*E+F.d*w,this.tx=F.tx*z+F.ty*Q+this.tx,this.ty=F.tx*E+F.ty*w+this.ty,this},dd.prototype.setTransform=function(e,N,R,T,I,t,A,h,q){var r,m,$,k,b,f,C,s,l,U;return b=Math.sin(A),f=Math.cos(A),C=Math.cos(q),s=Math.sin(q),l=-Math.sin(h),U=Math.cos(h),r=f*I,m=b*I,$=-b*t,k=f*t,this.a=C*r+s*$,this.b=C*m+s*k,this.c=l*r+U*$,this.d=l*m+U*k,this.tx=e+(R*r+T*$),this.ty=N+(R*m+T*k),this},dd.prototype.prepend=function(I){var $=this.tx;if(1!==I.a||0!==I.b||0!==I.c||1!==I.d){var O=this.a,g=this.c;this.a=O*I.a+this.b*I.c,this.b=O*I.b+this.b*I.d,this.c=g*I.a+this.d*I.c,this.d=g*I.b+this.d*I.d}return this.tx=$*I.a+this.ty*I.c+I.tx,this.ty=$*I.b+this.ty*I.d+I.ty,this},dd.prototype.transform=dd.prototype.prepend,dd.prototype.invert=function(){var b=this.a,B=this.b,Y=this.c,G=this.d,J=this.tx,V=b*G-B*Y;return this.a=G/V,this.b=-B/V,this.c=-Y/V,this.d=b/V,this.tx=(Y*this.ty-G*J)/V,this.ty=-(b*this.ty-B*J)/V,this},dd.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},dd.prototype.clone=function(){var b=new dd;return b.a=this.a,b.b=this.b,b.c=this.c,b.d=this.d,b.tx=this.tx,b.ty=this.ty,b},dd.prototype.copy=function(L){return L.a=this.a,L.b=this.b,L.c=this.c,L.d=this.d,L.tx=this.tx,L.ty=this.ty,L},dd.prototype.tf=function(b,D){1===arguments.length&&(D=b.y,b=b.x);var H=this;return{x:H.a*b+H.c*D+H.tx,y:H.b*b+H.d*D+H.ty}},dd.prototype.tfi=function(h,$){1===arguments.length&&($=h.y,h=h.x);var m=this,z=1/(m.a*m.d+m.c*-m.b);return{x:m.d*z*h+-m.c*z*$+(m.ty*m.c-m.tx*m.d)*z,y:m.a*z*$+-m.b*z*h+(-m.ty*m.a+m.tx*m.b)*z}},dd.IDENTITY=new dd,dd.TEMP_MATRIX=new dd;var Rl=a.Math.Quaternion=function(t,r,k,T){this.set(t,r,k,T)};Y.assign(Rl.prototype,{set:function(u,b,V,X){var x=this;return x._x=u||0,x._y=b||0,x._z=V||0,x._w=X!==l?X:1,x},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(D){var E=this;return E._x=D._x,E._y=D._y,E._z=D._z,E._w=D._w,E},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(c){return this._x*c._x+this._y*c._y+this._z*c._z+this._w*c._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var W=this.length();return 0===W?(this._x=0,this._y=0,this._z=0,this._w=1):(W=1/W,this._x=this._x*W,this._y=this._y*W,this._z=this._z*W,this._w=this._w*W),this},fromArray:function(t,N){N===l&&(N=0);var F=this;return F._x=t[N],F._y=t[N+1],F._z=t[N+2],F._w=t[N+3],this},slerp:function(U,W){if(0===W)return this;if(1===W)return this.copy(U);var H=this._x,P=this._y,o=this._z,c=this._w,k=c*U._w+H*U._x+P*U._y+o*U._z;if(0>k?(this._w=-U._w,this._x=-U._x,this._y=-U._y,this._z=-U._z,k=-k):this.copy(U),k>=1)return this._w=c,this._x=H,this._y=P,this._z=o,this;var i=Math.sqrt(1-k*k);if(Math.abs(i)<.001)return this._w=.5*(c+this._w),this._x=.5*(H+this._x),this._y=.5*(P+this._y),this._z=.5*(o+this._z),this;var t=Math.atan2(i,k),T=Math.sin((1-W)*t)/i,j=Math.sin(W*t)/i;return this._w=c*T+this._w*j,this._x=H*T+this._x*j,this._y=P*T+this._y*j,this._z=o*T+this._z*j,this},setFromAxisAngle:function(i,j){var I=j/2,y=Math.sin(I);return this._x=i.x*y,this._y=i.y*y,this._z=i.z*y,this._w=Math.cos(I),this},setFromEuler:function(J){var H=J._x,M=J._y,T=J._z,K=J._order,s=Math.cos,x=Math.sin,Y=s(H/2),v=s(M/2),F=s(T/2),e=x(H/2),m=x(M/2),h=x(T/2);return"XYZ"===K?(this._x=e*v*F+Y*m*h,this._y=Y*m*F-e*v*h,this._z=Y*v*h+e*m*F,this._w=Y*v*F-e*m*h):"YXZ"===K?(this._x=e*v*F+Y*m*h,this._y=Y*m*F-e*v*h,this._z=Y*v*h-e*m*F,this._w=Y*v*F+e*m*h):"ZXY"===K?(this._x=e*v*F-Y*m*h,this._y=Y*m*F+e*v*h,this._z=Y*v*h+e*m*F,this._w=Y*v*F-e*m*h):"ZYX"===K?(this._x=e*v*F-Y*m*h,this._y=Y*m*F+e*v*h,this._z=Y*v*h-e*m*F,this._w=Y*v*F+e*m*h):"YZX"===K?(this._x=e*v*F+Y*m*h,this._y=Y*m*F+e*v*h,this._z=Y*v*h-e*m*F,this._w=Y*v*F-e*m*h):"XZY"===K&&(this._x=e*v*F-Y*m*h,this._y=Y*m*F-e*v*h,this._z=Y*v*h+e*m*F,this._w=Y*v*F+e*m*h),this},setFromRotationMatrix:function(z){var e,X=z.el,y=X[0],I=X[4],t=X[8],g=X[1],M=X[5],p=X[9],Z=X[2],Y=X[6],v=X[10],Q=y+M+v;return Q>0?(e=.5/Math.sqrt(Q+1),this._w=.25/e,this._x=(Y-p)*e,this._y=(t-Z)*e,this._z=(g-I)*e):y>M&&y>v?(e=2*Math.sqrt(1+y-M-v),this._w=(Y-p)/e,this._x=.25*e,this._y=(I+g)/e,this._z=(t+Z)/e):M>v?(e=2*Math.sqrt(1+M-y-v),this._w=(t-Z)/e,this._x=(I+g)/e,this._y=.25*e,this._z=(p+Y)/e):(e=2*Math.sqrt(1+v-y-M),this._w=(g-I)/e,this._x=(t+Z)/e,this._y=(p+Y)/e,this._z=.25*e),this},setFromToVectors:function(){var Y,H;return function(D,E){return Y===l&&(Y=new um),H=D.dot(E)+1,1e-7>H?(H=0,Math.abs(D.x)>Math.abs(D.z)?Y.set(-D.y,D.x,0):Y.set(0,-D.z,D.y)):Y.crossVectors(D,E),this._x=Y.x,this._y=Y.y,this._z=Y.z,this._w=H,this.normalize()}}(),setFromUnitVectors:function(){var Q,u,z=1e-6;return function(q,p){return Q===l&&(Q=new um),u=q.dot(p)+1,z>u?(u=0,Math.abs(q.x)>Math.abs(q.z)?Q.set(-q.y,q.x,0):Q.set(0,-q.z,q.y)):Q.crossVectors(q,p),this._x=Q.x,this._y=Q.y,this._z=Q.z,this._w=u,this.normalize()}}(),multiply:function(U){return this.multiplyQuaternions(this,U)},premultiply:function(H){return this.multiplyQuaternions(H,this)},multiplyQuaternions:function(R,K){var s=R._x,i=R._y,h=R._z,A=R._w,w=K._x,Y=K._y,r=K._z,N=K._w;return this._x=s*N+A*w+i*r-h*Y,this._y=i*N+A*Y+h*w-s*r,this._z=h*N+A*r+s*Y-i*w,this._w=A*N-s*w-i*Y-h*r,this}});var op=a.Math.Vector4=function(e,t,p,U){this.x=e||0,this.y=t||0,this.z=p||0,this.w=U!==l?U:1};Y.assign(op.prototype,{isVector4:!0,set:function(E,v,F,r){return this.x=E,this.y=v,this.z=F,this.w=r,this},setScalar:function(R){return this.x=R,this.y=R,this.z=R,this.w=R,this},setX:function(g){return this.x=g,this},setY:function(R){return this.y=R,this},setZ:function(c){return this.z=c,this},setW:function(u){return this.w=u,this},setComponent:function(V,_){switch(V){case 0:this.x=_;break;case 1:this.y=_;break;case 2:this.z=_;break;case 3:this.w=_;break;default:throw new Error("index is out of range: "+V)}return this},getComponent:function(D){switch(D){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+D)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(I){return this.x=I.x,this.y=I.y,this.z=I.z,this.w=I.w!==l?I.w:1,this},add:function(X,B){return B!==l?this.addVectors(X,B):(this.x+=X.x,this.y+=X.y,this.z+=X.z,this.w+=X.w,this)},addScalar:function(V){return this.x+=V,this.y+=V,this.z+=V,this.w+=V,this},addVectors:function(Z,u){return this.x=Z.x+u.x,this.y=Z.y+u.y,this.z=Z.z+u.z,this.w=Z.w+u.w,this},addScaledVector:function(s,C){return this.x+=s.x*C,this.y+=s.y*C,this.z+=s.z*C,this.w+=s.w*C,this},sub:function(Y,z){return z!==l?this.subVectors(Y,z):(this.x-=Y.x,this.y-=Y.y,this.z-=Y.z,this.w-=Y.w,this)},subScalar:function(_){return this.x-=_,this.y-=_,this.z-=_,this.w-=_,this},subVectors:function(I,J){return this.x=I.x-J.x,this.y=I.y-J.y,this.z=I.z-J.z,this.w=I.w-J.w,this},multiplyScalar:function(D){return this.x*=D,this.y*=D,this.z*=D,this.w*=D,this},applyMatrix4:function(H){var o=this.x,G=this.y,M=this.z,V=this.w,Z=H.el;return this.x=Z[0]*o+Z[4]*G+Z[8]*M+Z[12]*V,this.y=Z[1]*o+Z[5]*G+Z[9]*M+Z[13]*V,this.z=Z[2]*o+Z[6]*G+Z[10]*M+Z[14]*V,this.w=Z[3]*o+Z[7]*G+Z[11]*M+Z[15]*V,this},divideScalar:function(_){return this.multiplyScalar(1/_)},setAxisAngleFromQuaternion:function(z){this.w=2*Math.acos(z.w);var i=Math.sqrt(1-z.w*z.w);return 1e-4>i?(this.x=1,this.y=0,this.z=0):(this.x=z.x/i,this.y=z.y/i,this.z=z.z/i),this},setAxisAngleFromRotationMatrix:function(U){var W,r,t,w,K=.01,k=.1,q=U.el,o=q[0],$=q[4],D=q[8],n=q[1],I=q[5],e=q[9],X=q[2],l=q[6],f=q[10];if(Math.abs($-n)<K&&Math.abs(D-X)<K&&Math.abs(e-l)<K){if(Math.abs($+n)<k&&Math.abs(D+X)<k&&Math.abs(e+l)<k&&Math.abs(o+I+f-3)<k)return this.set(1,0,0,0),this;W=Math.PI;var C=(o+1)/2,z=(I+1)/2,m=(f+1)/2,L=($+n)/4,c=(D+X)/4,p=(e+l)/4;return C>z&&C>m?K>C?(r=0,t=.707106781,w=.707106781):(r=Math.sqrt(C),t=L/r,w=c/r):z>m?K>z?(r=.707106781,t=0,w=.707106781):(t=Math.sqrt(z),r=L/t,w=p/t):K>m?(r=.707106781,t=.707106781,w=0):(w=Math.sqrt(m),r=c/w,t=p/w),this.set(r,t,w,W),this}var B=Math.sqrt((l-e)*(l-e)+(D-X)*(D-X)+(n-$)*(n-$));return Math.abs(B)<.001&&(B=1),this.x=(l-e)/B,this.y=(D-X)/B,this.z=(n-$)/B,this.w=Math.acos((o+I+f-1)/2),this},min:function(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this.z=Math.min(this.z,s.z),this.w=Math.min(this.w,s.w),this},max:function(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this.z=Math.max(this.z,s.z),this.w=Math.max(this.w,s.w),this},clamp:function(y,k){return this.x=Math.max(y.x,Math.min(k.x,this.x)),this.y=Math.max(y.y,Math.min(k.y,this.y)),this.z=Math.max(y.z,Math.min(k.z,this.z)),this.w=Math.max(y.w,Math.min(k.w,this.w)),this},clampScalar:function(){var F,J;return function(G,n){return F===l&&(F=new op,J=new op),F.set(G,G,G,G),J.set(n,n,n,n),this.clamp(F,J)}}(),clampLength:function(H,v){var N=this.length();return this.divideScalar(N||1).multiplyScalar(Math.max(H,Math.min(v,N)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(X){return this.x*X.x+this.y*X.y+this.z*X.z+this.w*X.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(y){return this.normalize().multiplyScalar(y)},lerp:function(o,E){return this.x+=(o.x-this.x)*E,this.y+=(o.y-this.y)*E,this.z+=(o.z-this.z)*E,this.w+=(o.w-this.w)*E,this},lerpVectors:function(T,k,A){return this.subVectors(k,T).multiplyScalar(A).add(T)},equals:function(p){return p.x===this.x&&p.y===this.y&&p.z===this.z&&p.w===this.w},fromArray:function(U,H){return H===l&&(H=0),this.x=U[H],this.y=U[H+1],this.z=U[H+2],this.w=U[H+3],this},toArray:function(T,_){return T===l&&(T=[]),_===l&&(_=0),T[_]=this.x,T[_+1]=this.y,T[_+2]=this.z,T[_+3]=this.w,T},fromBufferAttribute:function(R,b){return this.x=R.getX(b),this.y=R.getY(b),this.z=R.getZ(b),this.w=R.getW(b),this}});var um=a.Math.Vector3=function(k,G,S){k===l?(this.x=0,this.y=0,this.z=0):"object"==typeof k?this.copy(k):this.set(k,G==l?k:G,S==l?k:S)};Y.assign(um.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(w,Z,m){return this.x=w,this.y=Z,this.z=m,this},equals:function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z},setScalar:function(u){return this.x=u,this.y=u,this.z=u,this},setX:function(Y){return this.x=Y,this},setY:function(p){return this.y=p,this},setZ:function(S){return this.z=S,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(Y){return Y.x===l?(this.x=Y[0],this.y=Y[1],this.z=Y[2]):(this.x=Y.x,this.y=Y.y,this.z=Y.z||0),this},add:function(z){return this.x+=z.x,this.y+=z.y,this.z+=z.z,this},addScalar:function(p){return this.x+=p,this.y+=p,this.z+=p,this},addVectors:function(M,W){return this.x=M.x+W.x,this.y=M.y+W.y,this.z=M.z+W.z,this},addScaledVector:function(V,K){return this.x+=V.x*K,this.y+=V.y*K,this.z+=V.z*K,this},sub:function(p){return this.x-=p.x,this.y-=p.y,this.z-=p.z,this},subScalar:function(h){return this.x-=h,this.y-=h,this.z-=h,this},subVectors:function(p,l){return this.x=p.x-l.x,this.y=p.y-l.y,this.z=p.z-l.z,this},divide:function(m){return this.x/=m.x,this.y/=m.y,this.z/=m.z,this},multiply:function(o){return this.x*=o.x,this.y*=o.y,this.z*=o.z,this},multiplyScalar:function(W){return this.x*=W,this.y*=W,this.z*=W,this},distanceTo:function(N){return Math.sqrt(this.distanceToSquared(N))},distanceToSquared:function(P){var H=this.x-P.x,p=this.y-P.y,y=this.z-P.z;return H*H+p*p+y*y},distanceToSquared2:function(P){var f=this.x-P[0],X=this.y-P[1],I=this.z-P[2];return f*f+X*X+I*I},divideVectors:function(B,p){return this.x=B.x/p.x,this.y=B.y/p.y,this.z=B.z/p.z,this},multiplyVectors:function(b,X){return this.x=b.x*X.x,this.y=b.y*X.y,this.z=b.z*X.z,this},transformDirection:function(A){var U=this.x,s=this.y,B=this.z,l=A.el;return this.x=l[0]*U+l[4]*s+l[8]*B,this.y=l[1]*U+l[5]*s+l[9]*B,this.z=l[2]*U+l[6]*s+l[10]*B,this.normalize()},applyAxisAngle:function(){var Q=new Rl;return function(W,X){return this.applyQuaternion(Q.setFromAxisAngle(W,X))}}(),applyEuler:function(){var i=new Rl;return function(M){return this.applyQuaternion(i.setFromEuler(M))}}(),applyQuaternion:function(T){var w=this.x,F=this.y,y=this.z,v=T._x,P=T._y,G=T._z,x=T._w,e=x*w+P*y-G*F,A=x*F+G*w-v*y,z=x*y+v*F-P*w,H=-v*w-P*F-G*y;return this.x=e*x+H*-v+A*-G-z*-P,this.y=A*x+H*-P+z*-v-e*-G,this.z=z*x+H*-G+e*-P-A*-v,this},applyMatrix4:function(H){var C=this.x,U=this.y,Q=this.z,u=H.el,B=1/(u[3]*C+u[7]*U+u[11]*Q+u[15]);return this.x=(u[0]*C+u[4]*U+u[8]*Q+u[12])*B,this.y=(u[1]*C+u[5]*U+u[9]*Q+u[13])*B,this.z=(u[2]*C+u[6]*U+u[10]*Q+u[14])*B,this},applyMatrix3:function(n){var d=this.x,O=this.y,b=this.z,w=n.el;return this.x=w[0]*d+w[3]*O+w[6]*b,this.y=w[1]*d+w[4]*O+w[7]*b,this.z=w[2]*d+w[5]*O+w[8]*b,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var _=new um;return function(X){return this.sub(_.copy(X).multiplyScalar(2*this.dot(X)))}}(),dot:function(f){return this.x*f.x+this.y*f.y+this.z*f.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)
    },manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var A=this.length();return A?this.multiplyScalar(1/A):this},setLength:function(S){return this.normalize().multiplyScalar(S)},fromArray:function(W,y){return y===l&&(y=0),this.x=W[y],this.y=W[y+1],this.z=W[y+2],this},toArray:function(w,s){return w===l&&(w=[0,0,0]),s===l&&(s=0),w[s]=this.x,w[s+1]=this.y,w[s+2]=this.z,w},cross:function(Q){return this.crossVectors(this,Q)},angleTo:function(W){var S=this.dot(W)/Math.sqrt(this.lengthSq()*W.lengthSq());return S>1||-1>S?0:Math.acos(S)},lerp:function(J,Q){return this.x+=(J.x-this.x)*Q,this.y+=(J.y-this.y)*Q,this.z+=(J.z-this.z)*Q,this},lerpVectors:function(K,a,v){return this.subVectors(a,K).multiplyScalar(v).add(K)},crossVectors:function(p,t){var R=p.x,o=p.y,H=p.z,l=t.x,P=t.y,h=t.z;return this.x=o*h-H*P,this.y=H*l-R*h,this.z=R*P-o*l,this},min:function(y){return this.x=Math.min(this.x,y.x),this.y=Math.min(this.y,y.y),this.z=Math.min(this.z,y.z),this},max:function(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this.z=Math.max(this.z,s.z),this},setFromMatrixPosition:function(X){return this.setFromMatrixColumn(X,3)},setFromMatrixScale:function(X){var S=this.setFromMatrixColumn(X,0).length(),Y=this.setFromMatrixColumn(X,1).length(),n=this.setFromMatrixColumn(X,2).length();return this.x=S,this.y=Y,this.z=n,this},setFromMatrixColumn:function(u,e){return this.fromArray(u.el,4*e)}});var Sf=a.Math.Vector2=function(v,S,m){"object"==typeof v&&(v.x!=l?(S=v.y,v=v.x,m=v.e):(m=v[2],S=v[1],v=v[0])),this.set(v||0,S||0,m)};Sf.prototype={},Sf.prototype.constructor=Sf,Y.defineProperties(Sf.prototype,{width:{get:function(){return this.x},set:function(u){this.x=u}},height:{get:function(){return this.y},set:function(l){this.y=l}}}),Sf.prototype.clone=function(){return new Sf(this.x,this.y,this.e)},Sf.prototype.copy=function(y){return this.set(y.x,y.y,y.e),this},Sf.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},Sf.prototype.set=function(R,i,h){return this.x=R||0,this.y=i||(0!==i?this.x:0),h!=l&&(this.e=h),this},Sf.prototype.setScalar=function(L){return this.x=L,this.y=L,this},Sf.prototype.setX=function(Q){return this.x=Q||0,this},Sf.prototype.setY=function(h){return this.y=h||0,this},Sf.prototype.add=function(T){return this.x+=T.x,this.y+=T.y,this},Sf.prototype.addVectors=function(n,s){return this.x=n.x+s.x,this.y=n.y+s.y,this},Sf.prototype.addScalar=function(e){return this.x+=e,this.y+=e,this},Sf.prototype.addScaledVector=function(s,C){return this.x+=s.x*C,this.y+=s.y*C,this},Sf.prototype.sub=function(u){return this.x-=u.x,this.y-=u.y,this},Sf.prototype.subScalar=function(H){return this.x-=H,this.y-=H,this},Sf.prototype.subVectors=function(L,P){return this.x=L.x-P.x,this.y=L.y-P.y,this},Sf.prototype.multiply=function(r){return this.x*=r.x,this.y*=r.y,this},Sf.prototype.multiplyScalar=function(b){return this.x*=b,this.y*=b,this},Sf.prototype.divide=function(R){return this.x/=R.x,this.y/=R.y,this},Sf.prototype.divideScalar=function(f){return this.multiplyScalar(1/f)},Sf.prototype.min=function(T){return this.x=Math.min(this.x,T.x),this.y=Math.min(this.y,T.y),this},Sf.prototype.max=function(g){return this.x=Math.max(this.x,g.x),this.y=Math.max(this.y,g.y),this},Sf.prototype.fromArray=function(D,F){return F===l&&(F=0),this.x=D[F],this.y=D[F+1],this},Sf.prototype.clamp=function(w,G){return this.x=Math.max(w.x,Math.min(G.x,this.x)),this.y=Math.max(w.y,Math.min(G.y,this.y)),this},Sf.prototype.clampScalar=function(){var a,Z;return function(w,U){return a===l&&(a=new Sf,Z=new Sf),a.set(w,w),Z.set(U,U),this.clamp(a,Z)}}(),Sf.prototype.clampLength=function(u,G){var n=this.length();return this.multiplyScalar(Math.max(u,Math.min(G,n))/n)},Sf.prototype.dot=function(z){return this.x*z.x+this.y*z.y},Sf.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Sf.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Sf.prototype.normalize=function(){return this.divideScalar(this.length())},Sf.prototype.angle=function(){var g=Math.atan2(this.y,this.x);return 0>g&&(g+=2*Math.PI),g},Sf.prototype.distanceTo=function(M){return Math.sqrt(this.distanceToSquared(M))},Sf.prototype.distanceToSquared=function(X){var M=this.x-X.x,E=this.y-X.y;return M*M+E*E},Sf.prototype.isNearEnough=function(T){return this.distanceToSquared(T)<1e-8},Sf.prototype.setLength=function($){var L=this.length();return L?this.multiplyScalar($/L):this},Sf.prototype.lerp=function($,e){return this.x+=($.x-this.x)*e,this.y+=($.y-this.y)*e,this},Sf.prototype.lerpVectors=function(j,m,M){return this.subVectors(m,j).multiplyScalar(M).add(j)},Sf.prototype.rotateAround=function(b,r){var o=b?b.x:0,$=b?b.y:0,V=Math.cos(r),U=Math.sin(r),l=this.x-o,h=this.y-$;return this.x=l*V-h*U+o,this.y=l*U+h*V+$,this},Y.assign(z.prototype,{isMatrix3:!0,set:function(C,l,d,s,j,U,A,k,o){var F=this.el;return F[0]=C,F[1]=s,F[2]=A,F[3]=l,F[4]=j,F[5]=k,F[6]=d,F[7]=U,F[8]=o,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(p){var N=this.el,C=p.el;return N[0]=C[0],N[1]=C[1],N[2]=C[2],N[3]=C[3],N[4]=C[4],N[5]=C[5],N[6]=C[6],N[7]=C[7],N[8]=C[8],this},setFromMatrix4:function(K){var C=K.el;return this.set(C[0],C[4],C[8],C[1],C[5],C[9],C[2],C[6],C[10]),this},applyToBufferAttribute:function(){var r=new um;return function(n){for(var M=0,w=n.count;w>M;M++)r.x=n.getX(M),r.y=n.getY(M),r.z=n.getZ(M),r.applyMatrix3(this),n.setXYZ(M,r.x,r.y,r.z);return n}}(),multiply:function(y){return this.multiplyMatrices(this,y)},premultiply:function(E){return this.multiplyMatrices(E,this)},multiplyMatrices:function(Q,v){var y=Q.el,E=v.el,b=this.el,r=y[0],h=y[3],$=y[6],f=y[1],o=y[4],e=y[7],N=y[2],X=y[5],i=y[8],I=E[0],k=E[3],d=E[6],l=E[1],u=E[4],s=E[7],m=E[2],q=E[5],K=E[8];return b[0]=r*I+h*l+$*m,b[3]=r*k+h*u+$*q,b[6]=r*d+h*s+$*K,b[1]=f*I+o*l+e*m,b[4]=f*k+o*u+e*q,b[7]=f*d+o*s+e*K,b[2]=N*I+X*l+i*m,b[5]=N*k+X*u+i*q,b[8]=N*d+X*s+i*K,this},multiplyScalar:function(D){var t=this.el;return t[0]*=D,t[3]*=D,t[6]*=D,t[1]*=D,t[4]*=D,t[7]*=D,t[2]*=D,t[5]*=D,t[8]*=D,this},determinant:function(){var E=this.el,_=E[0],V=E[1],W=E[2],s=E[3],R=E[4],A=E[5],L=E[6],y=E[7],z=E[8];return _*R*z-_*A*y-V*s*z+V*A*L+W*s*y-W*R*L},getInverse:function(Z){var L=Z.el,p=this.el,K=L[0],E=L[1],t=L[2],A=L[3],n=L[4],r=L[5],G=L[6],V=L[7],d=L[8],c=d*n-r*V,g=r*G-d*A,a=V*A-n*G,P=K*c+E*g+t*a;if(0===P)return this.identity();var h=1/P;return p[0]=c*h,p[1]=(t*V-d*E)*h,p[2]=(r*E-t*n)*h,p[3]=g*h,p[4]=(d*K-t*G)*h,p[5]=(t*A-r*K)*h,p[6]=a*h,p[7]=(E*G-V*K)*h,p[8]=(n*K-E*A)*h,this},transpose:function(){var D,g=this.el;return D=g[1],g[1]=g[3],g[3]=D,D=g[2],g[2]=g[6],g[6]=D,D=g[5],g[5]=g[7],g[7]=D,this},getNormalMatrix:function(p){return this.setFromMatrix4(p).getInverse(this).transpose()},transposeIntoArray:function(O){var D=this.el;return O[0]=D[0],O[1]=D[3],O[2]=D[6],O[3]=D[1],O[4]=D[4],O[5]=D[7],O[6]=D[2],O[7]=D[5],O[8]=D[8],this},setUvTransform:function(S,T,A,o,n,c,p){var v=Math.cos(n),h=Math.sin(n);this.set(A*v,A*h,-A*(v*c+h*p)+c+S,-o*h,o*v,-o*(-h*c+v*p)+p+T,0,0,1)},scale:function(Q,L){var f=this.el;return f[0]*=Q,f[3]*=Q,f[6]*=Q,f[1]*=L,f[4]*=L,f[7]*=L,this},rotate:function(n){var r=Math.cos(n),A=Math.sin(n),l=this.el,J=l[0],d=l[3],Q=l[6],a=l[1],R=l[4],s=l[7];return l[0]=r*J+A*a,l[3]=r*d+A*R,l[6]=r*Q+A*s,l[1]=-A*J+r*a,l[4]=-A*d+r*R,l[7]=-A*Q+r*s,this},translate:function(B,g){var W=this.el;return W[0]+=B*W[2],W[3]+=B*W[5],W[6]+=B*W[8],W[1]+=g*W[2],W[4]+=g*W[5],W[7]+=g*W[8],this},equals:function(g){for(var Z=this.el,t=g.el,n=0;9>n;n++)if(Z[n]!==t[n])return!1;return!0},fromArray:function(v,f){f===l&&(f=0);for(var O=0;9>O;O++)this.el[O]=v[O+f];return this},toArray:function(T,X){T===l&&(T=[]),X===l&&(X=0);var M=this.el;return T[X]=M[0],T[X+1]=M[1],T[X+2]=M[2],T[X+3]=M[3],T[X+4]=M[4],T[X+5]=M[5],T[X+6]=M[6],T[X+7]=M[7],T[X+8]=M[8],T}});var ho=a.Math.Plane=function($,N){this.normal=$!==l?$:new um(1,0,0),this.constant=N!==l?N:0};Y.assign(ho.prototype,{set:function(U,o){return this.normal.copy(U),this.constant=o,this},setComponents:function($,X,s,p){return this.normal.set($,X,s),this.constant=p,this},setFromNormalAndCoplanarPoint:function(B,z){return this.normal.copy(B),this.constant=-z.dot(this.normal),this},setFromCoplanarPoints:function(){var V=new um,q=new um;return function(D,_,i){var U=V.subVectors(i,_).cross(q.subVectors(D,_)).normalize();return this.setFromNormalAndCoplanarPoint(U,D),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(z){return this.normal.copy(z.normal),this.constant=z.constant,this},normalize:function(){var W=1/this.normal.length();return this.normal.multiplyScalar(W),this.constant*=W,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(z){return this.normal.dot(z)+this.constant},distanceToSphere:function(P){return this.distanceToPoint(P.center)-P.radius},projectPoint:function(y,B){return B===l&&(B=new um),B.copy(this.normal).multiplyScalar(-this.distanceToPoint(y)).add(y)},intersectLine:function(){var w=new um;return function(K,$){$===l&&($=new um);var F=K.delta(w),f=this.normal.dot(F);if(0===f)return 0===this.distanceToPoint(K.start)?$.copy(K.start):l;var E=-(K.start.dot(this.normal)+this.constant)/f;return 0>E||E>1?l:$.copy(F).multiplyScalar(E).add(K.start)}}(),intersectsLine:function(T){var N=this.distanceToPoint(T.start),U=this.distanceToPoint(T.end);return 0>N&&U>0||0>U&&N>0},intersectsBox:function(P){return P.intersectsPlane(this)},intersectsSphere:function(G){return G.intersectsPlane(this)},coplanarPoint:function(d){return d===l&&(d=new um),d.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var K=new um,M=new z;return function(m,B){var J=B||M.getNormalMatrix(m),R=this.coplanarPoint(K).applyMatrix4(m),x=this.normal.applyMatrix3(J).normalize();return this.constant=-R.dot(x),this}}(),translate:function(_){return this.constant-=_.dot(this.normal),this},equals:function(F){return F.normal.equals(this.normal)&&F.constant===this.constant}});var Jl=a.Math.Ray=function(Y,T){this.origin=Y!==l?Y.clone():new um,this.direction=T!==l?T.clone():new um};Y.assign(Jl.prototype,{set:function(z,r){return this.origin.copy(z),this.direction.copy(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(i){return this.origin.copy(i.origin),this.direction.copy(i.direction),this.maxHitLen=i.maxHitLen,this},at:function(z,B){var P=B||new um;return P.copy(this.direction).multiplyScalar(z).add(this.origin)},setMaxHitLength:function(g){this.maxHitLen=g},lookAt:function(Q){return this.direction.copy(Q).sub(this.origin).normalize(),this},applyMatrix4:function(V){var k=this.maxHitLen;if(k){var w=this.direction.clone().multiplyScalar(k).add(this.origin);w.applyMatrix4(V)}return this.origin.applyMatrix4(V),this.direction.transformDirection(V),k&&(this.maxHitLen=this.origin.distanceTo(w)),this},intersectSphere:function(){var Q=new um;return function(O,U){Q.subVectors(O.center,this.origin);var K=Q.dot(this.direction),T=Q.dot(Q)-K*K,E=O.radius*O.radius;if(T>E)return null;var G=Math.sqrt(E-T),A=K-G,Z=K+G;return 0>A&&0>Z?null:0>A?this.at(Z,U):this.at(A,U)}}(),intersectEllipsoid:function(){var X=new um,h=new um;return function(f,J){X.subVectors(f.center,this.origin),X.divide(f.radius),h.divideVectors(this.direction,f.radius);var V=h.lengthSq(),j=X.dot(h),w=X.dot(X)*V-j*j;if(w>V)return null;var z=Math.sqrt(V-w),d=(j-z)/V,l=(j+z)/V;return 0>d&&0>l?null:0>d?this.at(l,J):this.at(d,J)}}(),intersectBox:function(l,T){var K,z,k,s,t,q,x=1/this.direction.x,X=1/this.direction.y,O=1/this.direction.z,L=this.origin;if(x>=0?(K=(l.min.x-L.x)*x,z=(l.max.x-L.x)*x):(K=(l.max.x-L.x)*x,z=(l.min.x-L.x)*x),X>=0?(k=(l.min.y-L.y)*X,s=(l.max.y-L.y)*X):(k=(l.max.y-L.y)*X,s=(l.min.y-L.y)*X),K>s||k>z)return null;if((k>K||K!==K)&&(K=k),(z>s||z!==z)&&(z=s),O>=0?(t=(l.min.z-L.z)*O,q=(l.max.z-L.z)*O):(t=(l.max.z-L.z)*O,q=(l.min.z-L.z)*O),K>q||t>z)return null;if((t>K||K!==K)&&(K=t),(z>q||z!==z)&&(z=q),0>z)return null;var B=K>=0?K:z,V=this.maxHitLen;return V&&B>V?null:this.at(B,T)},intersectTriangle:function(){var b=new um,Z=new um,q=new um,p=new um;return function(N,W,E,y,j){Z.subVectors(W,N),q.subVectors(E,N),p.crossVectors(Z,q);var e,u=this.direction.dot(p);if(u>0){if(y)return null;e=1}else{if(!(0>u))return null;e=-1,u=-u}b.subVectors(this.origin,N);var v=e*this.direction.dot(q.crossVectors(b,q));if(0>v)return null;var n=e*this.direction.dot(Z.cross(b));if(0>n||v+n>u)return null;var $=-e*b.dot(p);if(0>$)return null;var X=$/u,M=this.maxHitLen;return M&&X>M?null:this.at(X,j)}}()});var Ik=a.Math.Box3=function(Y,n){this.min=Y!==l?Y:new um(1/0,1/0,1/0),this.max=n!==l?n:new um(-1/0,-1/0,-1/0)};Y.assign(Ik.prototype,{set:function(K,Z){return this.min.copy(K),this.max.copy(Z),this},setFromArray:function(t){for(var x=1/0,O=1/0,F=1/0,H=-1/0,S=-1/0,p=-1/0,I=0,C=t.length;C>I;I+=3){var E=t[I],l=t[I+1],B=t[I+2];x>E&&(x=E),O>l&&(O=l),F>B&&(F=B),E>H&&(H=E),l>S&&(S=l),B>p&&(p=B)}return this.min.set(x,O,F),this.max.set(H,S,p),this},setFromPoints:function(c){this.makeEmpty();for(var F=0,K=c.length;K>F;F++)this.expandByPoint(c[F]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(K){return K.max.x<this.min.x||K.min.x>this.max.x||K.max.y<this.min.y||K.min.y>this.max.y||K.max.z<this.min.z||K.min.z>this.max.z?!1:!0},copy:function(f){return this.min.copy(f.min),this.max.copy(f.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(u){return this.min.min(u),this.max.max(u),this},expandByBox:function(J){return this.min.min(J.min),this.max.max(J.max),this},applyMatrix4:function(){var y=[new um,new um,new um,new um,new um,new um,new um,new um];return function(q){return this.isEmpty()?this:(y[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(q),y[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(q),y[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(q),y[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(q),y[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(q),y[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(q),y[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(q),y[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(q),this.setFromPoints(y),this)}}()});var Ee=a.Math.Sphere=function(v,Z){this.center=v!==l?v:new um,this.radius=Z!==l?Z:0};Y.assign(Ee.prototype,{set:function(b,t){return this.center.copy(b),this.radius=t,this},setFromPoints:function(){var t=new Ik;return function(T,P){var J=this.center;P!==l?J.copy(P):t.setFromPoints(T).getCenter(J);for(var X=0,G=0,M=T.length;M>G;G++)X=Math.max(X,J.distanceToSquared(T[G]));return this.radius=Math.sqrt(X),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(l){return l.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(L){return L.distanceTo(this.center)-this.radius},intersectsSphere:function(q){var x=this.radius+q.radius;return q.center.distanceToSquared(this.center)<=x*x},intersectsBox:function(J){return J.intersectsSphere(this)},intersectsPlane:function(O){return Math.abs(O.distanceToPoint(this.center))<=this.radius},clampPoint:function(i,O){var t=this.center.distanceToSquared(i);return O===l&&(O=new um),O.copy(i),t>this.radius*this.radius&&(O.sub(this.center).normalize(),O.multiplyScalar(this.radius).add(this.center)),O},getBoundingBox:function(J){return J===l&&(J=new Ik),J.set(this.center,this.center),J.expandByScalar(this.radius),J},applyMatrix4:function(Q){return this.center.applyMatrix4(Q),this.radius=this.radius*Q.getMaxScaleOnAxis(),this},translate:function(q){return this.center.add(q),this},equals:function(p){return p.center.equals(this.center)&&p.radius===this.radius}});var Fq=a.Math.Frustum=function($,i,O,H,v,u){this.planes=[$!==l?$:new ho,i!==l?i:new ho,O!==l?O:new ho,H!==l?H:new ho,v!==l?v:new ho,u!==l?u:new ho]};Y.assign(Fq.prototype,{set:function(B,d,K,k,W,Y){var M=this.planes;return M[0].copy(B),M[1].copy(d),M[2].copy(K),M[3].copy(k),M[4].copy(W),M[5].copy(Y),this},clone:function(){return(new this.constructor).copy(this)},copy:function(O){for(var M=this.planes,E=0;6>E;E++)M[E].copy(O.planes[E]);return this},setFromMatrix:function(w){var z=this.planes,O=w.el,E=O[0],o=O[1],j=O[2],U=O[3],r=O[4],t=O[5],s=O[6],p=O[7],h=O[8],d=O[9],k=O[10],J=O[11],Z=O[12],b=O[13],D=O[14],n=O[15];return z[0].setComponents(U-E,p-r,J-h,n-Z).normalize(),z[1].setComponents(U+E,p+r,J+h,n+Z).normalize(),z[2].setComponents(U+o,p+t,J+d,n+b).normalize(),z[3].setComponents(U-o,p-t,J-d,n-b).normalize(),z[4].setComponents(U-j,p-s,J-k,n-D).normalize(),z[5].setComponents(U+j,p+s,J+k,n+D).normalize(),this},intersectsObject:function(){var d=new Ee;return function(i){var l=i.geometry;return null===l.boundingSphere&&l.computeBoundingSphere(),d.copy(l.boundingSphere).applyMatrix4(i.matrixWorld),this.intersectsSphere(d)}}(),intersectsSprite:function(){var a=new Ee;return function(e){return a.center.set(0,0,0),a.radius=.7071067811865476,a.applyMatrix4(e.matrixWorld),this.intersectsSphere(a)}}(),intersectsSphere:function(D){for(var O=this.planes,k=D.center,T=-D.radius,m=0;6>m;m++){var y=O[m].distanceToPoint(k);if(T>y)return!1}return!0},intersectsBox:function(){var s=new um;return function(Y){for(var P=this.planes,O=0;6>O;O++){var J=P[O];if(s.x=J.normal.x>0?Y.max.x:Y.min.x,s.y=J.normal.y>0?Y.max.y:Y.min.y,s.z=J.normal.z>0?Y.max.z:Y.min.z,J.distanceToPoint(s)<0)return!1}return!0}}(),containsPoint:function(O){for(var o=this.planes,u=0;6>u;u++)if(o[u].distanceToPoint(O)<0)return!1;return!0}});var ke=a.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};Y.assign(ke.prototype,{set:function(P,f,O,U,d,j,F,h,m,A,w,T,s,R,S,v){var X=this.el;return X[0]=P,X[4]=f,X[8]=O,X[12]=U,X[1]=d,X[5]=j,X[9]=F,X[13]=h,X[2]=m,X[6]=A,X[10]=w,X[14]=T,X[3]=s,X[7]=R,X[11]=S,X[15]=v,this},clone:function(){return(new ke).fromArray(this.el)},fromArray:function(z,U){U===l&&(U=0);for(var N=this.el,F=0;16>F;F++)N[F]=z[F+U];return this},getElements:function(){return this.el},scale:function(c){var n=this.el,T=c.x,U=c.y,k=c.z;return n[0]*=T,n[4]*=U,n[8]*=k,n[1]*=T,n[5]*=U,n[9]*=k,n[2]*=T,n[6]*=U,n[10]*=k,n[3]*=T,n[7]*=U,n[11]*=k,this},makeRotationFromEuler:function(q){var F=this.el,p=q._x,V=q._y,R=q._z,j=q._order,E=Math.cos(p),N=Math.sin(p),e=Math.cos(V),W=Math.sin(V),H=Math.cos(R),C=Math.sin(R);if("XYZ"===j){var t=E*H,w=E*C,g=N*H,L=N*C;F[0]=e*H,F[4]=-e*C,F[8]=W,F[1]=w+g*W,F[5]=t-L*W,F[9]=-N*e,F[2]=L-t*W,F[6]=g+w*W,F[10]=E*e}else if("YXZ"===j){var l=e*H,o=e*C,m=W*H,v=W*C;F[0]=l+v*N,F[4]=m*N-o,F[8]=E*W,F[1]=E*C,F[5]=E*H,F[9]=-N,F[2]=o*N-m,F[6]=v+l*N,F[10]=E*e}else if("ZXY"===j){var l=e*H,o=e*C,m=W*H,v=W*C;F[0]=l-v*N,F[4]=-E*C,F[8]=m+o*N,F[1]=o+m*N,F[5]=E*H,F[9]=v-l*N,F[2]=-E*W,F[6]=N,F[10]=E*e}else if("ZYX"===j){var t=E*H,w=E*C,g=N*H,L=N*C;F[0]=e*H,F[4]=g*W-w,F[8]=t*W+L,F[1]=e*C,F[5]=L*W+t,F[9]=w*W-g,F[2]=-W,F[6]=N*e,F[10]=E*e}else if("YZX"===j){var c=E*e,d=E*W,P=N*e,h=N*W;F[0]=e*H,F[4]=h-c*C,F[8]=P*C+d,F[1]=C,F[5]=E*H,F[9]=-N*H,F[2]=-W*H,F[6]=d*C+P,F[10]=c-h*C}else if("XZY"===j){var c=E*e,d=E*W,P=N*e,h=N*W;F[0]=e*H,F[4]=-C,F[8]=W*H,F[1]=c*C+h,F[5]=E*H,F[9]=d*C-P,F[2]=P*C-d,F[6]=N*H,F[10]=h*C+c}return F[3]=0,F[7]=0,F[11]=0,F[12]=0,F[13]=0,F[14]=0,F[15]=1,this},makeRotationFromQuaternion:function(_){var e=this.el,q=_._x,t=_._y,S=_._z,K=_._w,B=q+q,I=t+t,c=S+S,R=q*B,$=q*I,J=q*c,u=t*I,G=t*c,b=S*c,V=K*B,Z=K*I,y=K*c;return e[0]=1-(u+b),e[4]=$-y,e[8]=J+Z,e[1]=$+y,e[5]=1-(R+b),e[9]=G-V,e[2]=J-Z,e[6]=G+V,e[10]=1-(R+u),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(x){var d=this.el,S=x.el,J=S[0],p=S[1],a=S[2],t=S[3],T=S[4],L=S[5],E=S[6],$=S[7],q=S[8],e=S[9],I=S[10],s=S[11],k=S[12],h=S[13],W=S[14],i=S[15],y=e*W*$-h*I*$+h*E*s-L*W*s-e*E*i+L*I*i,M=k*I*$-q*W*$-k*E*s+T*W*s+q*E*i-T*I*i,o=q*h*$-k*e*$+k*L*s-T*h*s-q*L*i+T*e*i,X=k*e*E-q*h*E-k*L*I+T*h*I+q*L*W-T*e*W,A=J*y+p*M+a*o+t*X;if(0===A)return this.identity();var V=1/A;return d[0]=y*V,d[1]=(h*I*t-e*W*t-h*a*s+p*W*s+e*a*i-p*I*i)*V,d[2]=(L*W*t-h*E*t+h*a*$-p*W*$-L*a*i+p*E*i)*V,d[3]=(e*E*t-L*I*t-e*a*$+p*I*$+L*a*s-p*E*s)*V,d[4]=M*V,d[5]=(q*W*t-k*I*t+k*a*s-J*W*s-q*a*i+J*I*i)*V,d[6]=(k*E*t-T*W*t-k*a*$+J*W*$+T*a*i-J*E*i)*V,d[7]=(T*I*t-q*E*t+q*a*$-J*I*$-T*a*s+J*E*s)*V,d[8]=o*V,d[9]=(k*e*t-q*h*t-k*p*s+J*h*s+q*p*i-J*e*i)*V,d[10]=(T*h*t-k*L*t+k*p*$-J*h*$-T*p*i+J*L*i)*V,d[11]=(q*L*t-T*e*t-q*p*$+J*e*$+T*p*s-J*L*s)*V,d[12]=X*V,d[13]=(q*h*a-k*e*a+k*p*I-J*h*I-q*p*W+J*e*W)*V,d[14]=(k*L*a-T*h*a-k*p*E+J*h*E+T*p*W-J*L*W)*V,d[15]=(T*e*a-q*L*a+q*p*E-J*e*E-T*p*I+J*L*I)*V,this},makeRotationAxis:function(o,a){var $=Math.cos(a),W=Math.sin(a),J=1-$,D=o.x,C=o.y,R=o.z,z=J*D,U=J*C;return this.set(z*D+$,z*C-W*R,z*R+W*C,0,z*C+W*R,U*C+$,U*R-W*D,0,z*R-W*C,U*R+W*D,J*R*R+$,0,0,0,0,1),this},multiply:function(Y){return this.multiplyMatrices(this,Y)},premultiply:function(T){return this.multiplyMatrices(T,this)},multiplyMatrices:function(p,w){var o=p.el,u=w.el,z=this.el,Y=o[0],c=o[4],t=o[8],T=o[12],a=o[1],N=o[5],C=o[9],F=o[13],Z=o[2],q=o[6],S=o[10],b=o[14],j=o[3],M=o[7],E=o[11],D=o[15],I=u[0],X=u[4],R=u[8],f=u[12],G=u[1],m=u[5],P=u[9],W=u[13],$=u[2],r=u[6],K=u[10],l=u[14],O=u[3],J=u[7],A=u[11],y=u[15];return z[0]=Y*I+c*G+t*$+T*O,z[4]=Y*X+c*m+t*r+T*J,z[8]=Y*R+c*P+t*K+T*A,z[12]=Y*f+c*W+t*l+T*y,z[1]=a*I+N*G+C*$+F*O,z[5]=a*X+N*m+C*r+F*J,z[9]=a*R+N*P+C*K+F*A,z[13]=a*f+N*W+C*l+F*y,z[2]=Z*I+q*G+S*$+b*O,z[6]=Z*X+q*m+S*r+b*J,z[10]=Z*R+q*P+S*K+b*A,z[14]=Z*f+q*W+S*l+b*y,z[3]=j*I+M*G+E*$+D*O,z[7]=j*X+M*m+E*r+D*J,z[11]=j*R+M*P+E*K+D*A,z[15]=j*f+M*W+E*l+D*y,this},lookAt:function(){var y=new um,T=new um,U=new um;return function(_,X,f){var V=this.el;return U.subVectors(_,X),0===U.lengthSq()&&(U.z=1),U.normalize(),y.crossVectors(f,U),0===y.lengthSq()&&(1===Math.abs(f.z)?U.x+=1e-4:U.z+=1e-4,U.normalize(),y.crossVectors(f,U)),y.normalize(),T.crossVectors(U,y),V[0]=y.x,V[4]=T.x,V[8]=U.x,V[1]=y.y,V[5]=T.y,V[9]=U.y,V[2]=y.z,V[6]=T.z,V[10]=U.z,this}}(),extractScale:function(){var s;return function(K){s===l&&(s=new um),K===l&&(K=new um);var j=s.setFromMatrixColumn(this,0).length(),U=s.setFromMatrixColumn(this,1).length(),z=s.setFromMatrixColumn(this,2).length();return K.set(j,U,z),K}}(),extractRotation:function(){var g;return function(s){g===l&&(g=new um),s===l&&(s=new ke);var x=this.el,R=s.el,e=1/g.setFromMatrixColumn(s,0).length(),p=1/g.setFromMatrixColumn(s,1).length(),V=1/g.setFromMatrixColumn(s,2).length();return x[0]=R[0]*e,x[1]=R[1]*e,x[2]=R[2]*e,x[4]=R[4]*p,x[5]=R[5]*p,x[6]=R[6]*p,x[8]=R[8]*V,x[9]=R[9]*V,x[10]=R[10]*V,this}}(),multiplyScalar:function(H){var N=this.el;return N[0]*=H,N[4]*=H,N[8]*=H,N[12]*=H,N[1]*=H,N[5]*=H,N[9]*=H,N[13]*=H,N[2]*=H,N[6]*=H,N[10]*=H,N[14]*=H,N[3]*=H,N[7]*=H,N[11]*=H,N[15]*=H,this},getPosition:function(X){return X===l&&(X=new um),X.setFromMatrixColumn(this,3)},setPosition:function(Y){var A=this.el;return A[12]=Y.x,A[13]=Y.y,A[14]=Y.z,this},toArray:function(W,n){W===l&&(W=[]),n===l&&(n=0);var k=this.el;return W[n]=k[0],W[n+1]=k[1],W[n+2]=k[2],W[n+3]=k[3],W[n+4]=k[4],W[n+5]=k[5],W[n+6]=k[6],W[n+7]=k[7],W[n+8]=k[8],W[n+9]=k[9],W[n+10]=k[10],W[n+11]=k[11],W[n+12]=k[12],W[n+13]=k[13],W[n+14]=k[14],W[n+15]=k[15],W},determinant:function(){var D=this.el,V=D[0],B=D[4],r=D[8],E=D[12],t=D[1],u=D[5],y=D[9],O=D[13],P=D[2],H=D[6],a=D[10],G=D[14],K=D[3],i=D[7],s=D[11],L=D[15];return K*(+E*y*H-r*O*H-E*u*a+B*O*a+r*u*G-B*y*G)+i*(+V*y*G-V*O*a+E*t*a-r*t*G+r*O*P-E*y*P)+s*(+V*O*H-V*u*G-E*t*H+B*t*G+E*u*P-B*O*P)+L*(-r*u*P-V*y*H+V*u*a+r*t*H-B*t*a+B*y*P)},copy:function(D){var I=this.el,l=D.el;return I[0]=l[0],I[1]=l[1],I[2]=l[2],I[3]=l[3],I[4]=l[4],I[5]=l[5],I[6]=l[6],I[7]=l[7],I[8]=l[8],I[9]=l[9],I[10]=l[10],I[11]=l[11],I[12]=l[12],I[13]=l[13],I[14]=l[14],I[15]=l[15],this},compose:function(B,x,t){var s=this.el,_=x._x,U=x._y,y=x._z,c=x._w,w=_+_,j=U+U,q=y+y,N=_*w,h=_*j,T=_*q,e=U*j,l=U*q,f=y*q,Z=c*w,m=c*j,Q=c*q,X=t.x,o=t.y,k=t.z;return s[0]=(1-(e+f))*X,s[1]=(h+Q)*X,s[2]=(T-m)*X,s[3]=0,s[4]=(h-Q)*o,s[5]=(1-(N+f))*o,s[6]=(l+Z)*o,s[7]=0,s[8]=(T+m)*k,s[9]=(l-Z)*k,s[10]=(1-(N+e))*k,s[11]=0,s[12]=B.x,s[13]=B.y,s[14]=B.z,s[15]=1,this},decompose:function(){var i=new um,o=new ke;return function(b,N,e){var U=this.el,w=i.set(U[0],U[1],U[2]).length(),t=i.set(U[4],U[5],U[6]).length(),E=i.set(U[8],U[9],U[10]).length(),m=this.determinant();0>m&&(w=-w),b.x=U[12],b.y=U[13],b.z=U[14],o.copy(this);var J=1/w,X=1/t,S=1/E;return o.el[0]*=J,o.el[1]*=J,o.el[2]*=J,o.el[4]*=X,o.el[5]*=X,o.el[6]*=X,o.el[8]*=S,o.el[9]*=S,o.el[10]*=S,N.setFromRotationMatrix(o),e.x=w,e.y=t,e.z=E,this}}()});var Tm=a.Math.Triangle=function(k,A,x){this.a=k!==l?k:new um,this.b=A!==l?A:new um,this.c=x!==l?x:new um};Y.assign(Tm,{barycoordFromPoint:function(){var z=new um,W=new um,B=new um;return function(K,H,M,J,D){z.subVectors(J,H),W.subVectors(M,H),B.subVectors(K,H);var m=z.dot(z),T=z.dot(W),d=z.dot(B),R=W.dot(W),r=W.dot(B),Q=m*R-T*T,S=D||new um;if(0===Q)return S.set(-2,-1,-1);var x=1/Q,C=(R*d-T*r)*x,A=(m*r-T*d)*x;return S.set(1-C-A,A,C)}}()});var kd=a.Math.Euler=function(f,W,A,m,o){this.set(f,W,A,m,o)};kd.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],kd.DefaultOrder="XYZ",kd.ReverseOrder=function(D){return D=D[2]+D[1]+D[0],D.toUpperCase()},Y.defineProperties(kd.prototype,{x:{get:function(){return this._x},set:function(K){this._x=K,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(F){this._y=F,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(l){this._z=l,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(m){this._order=m,this.onChangeCallback()}}}),Y.assign(kd.prototype,{set:function(S,Y,K,l,T){return sp(S)&&(T=K,l=Y,K=S[2],Y=S[1],S=S[0]),l?T&&(l=kd.ReverseOrder(l)):l="ZYX",this._x=S||0,this._y=Y||0,this._z=K||0,this._order=l||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(C){return this._x=C._x,this._y=C._y,this._z=C._z,this._order=C._order,this.onChangeCallback(),this},setFromRotationMatrix:function(O,y,r){var k=a.Math.clamp,v=O.el||O,n=v[0],x=v[4],p=v[8],l=v[1],Z=v[5],j=v[9],Y=v[2],N=v[6],H=v[10];return y=y||this._order,"XYZ"===y?(this._y=Math.asin(k(p,-1,1)),Math.abs(p)<.99999?(this._x=Math.atan2(-j,H),this._z=Math.atan2(-x,n)):(this._x=Math.atan2(N,Z),this._z=0)):"YXZ"===y?(this._x=Math.asin(-k(j,-1,1)),Math.abs(j)<.99999?(this._y=Math.atan2(p,H),this._z=Math.atan2(l,Z)):(this._y=Math.atan2(-Y,n),this._z=0)):"ZXY"===y?(this._x=Math.asin(k(N,-1,1)),Math.abs(N)<.99999?(this._y=Math.atan2(-Y,H),this._z=Math.atan2(-x,Z)):(this._y=0,this._z=Math.atan2(l,n))):"ZYX"===y?(this._y=Math.asin(-k(Y,-1,1)),Math.abs(Y)<.99999?(this._x=Math.atan2(N,H),this._z=Math.atan2(l,n)):(this._x=0,this._z=Math.atan2(-x,Z))):"YZX"===y?(this._z=Math.asin(k(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-j,Z),this._y=Math.atan2(-Y,n)):(this._x=0,this._y=Math.atan2(p,H))):"XZY"===y?(this._z=Math.asin(-k(x,-1,1)),Math.abs(x)<.99999?(this._x=Math.atan2(N,Z),this._y=Math.atan2(p,n)):(this._x=Math.atan2(-j,H),this._y=0)):console.warn("unsupported order: "+y),this._order=y,r!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var y=new ke;return function(k,B,N){return y.makeRotationFromQuaternion(k),this.setFromRotationMatrix(y,B,N)}}(),setFromVector3:function(P,d){return this.set(P.x,P.y,P.z,d||this._order)},reorder:function(){var V=new Rl;return function(E){return V.setFromEuler(this),this.setFromQuaternion(V,E)}}(),equals:function(z){return z._x===this._x&&z._y===this._y&&z._z===this._z&&z._order===this._order},fromArray:function(W){return this._x=W[0],this._y=W[1],this._z=W[2],W[3]!==l&&(this._order=W[3]),this.onChangeCallback(),this},toArray:function(v,V){return v===l&&(v=[]),V===l&&(V=0),v[V]=this._x,v[V+1]=this._y,v[V+2]=this._z,v[V+3]=this._order,v},toVector3:function(K){return K?K.set(this._x,this._y,this._z):new um(this._x,this._y,this._z)},onChange:function(I){return this.onChangeCallback=I,this},onChangeCallback:function(){}});var Lc={ms_ac:function(O,y){for(var x=y.ms_ac,K=0;K<x.length;K++)xf(O,x[K])},ms_listener:function(G){G.addListeners=function(){var H=this,w=0,Z=Pk;for(A.mockTouch&&(Z=ue.concat(hs).concat(Ff));w<Z.length;w++){var o=Z[w];"wheel"===o&&!H.handle_wheel&&H.handle_mousewheel&&(H.handle_wheel=function(l){qf(H,l)}),H["handle_"+o]&&Qd(o,H.getView(),H)}},G.removeListeners=function(){for(var b=this,I=0;I<Pk.length;I++)b["handle_"+Pk[I]]&&Md(Pk[I],b.getView(),b)}},ms_fire:function(n){n.mp=function(h,L,z){this.addPropertyChangeListener(h,L,z)},n.ump=function(C,t){this.removePropertyChangeListener(C,t)},n.fp=function(k,M,j,g,$){return this.firePropertyChange(k,M,j,g,$)},n.addPropertyChangeListener=function(s,Y,X){var H=this;H._62I||(H._62I=new Kd),H._62I.add(s,Y,X)},n.removePropertyChangeListener=function(s,L){this._62I&&this._62I.remove(s,L)},n.firePropertyChange=function(G,$,b,e,i){if(e){if(e($,b))return!1}else if($===b)return!1;var Y=this,O=i||{};return O.property=G,O.oldValue=$,O.newValue=b,O.source=Y,O.data=Y,Y._62I&&Y._62I.fire(O),Y.onPropertyChanged&&Y.onPropertyChanged(O),!0}},ms_attr:function(s){s.a=function(o,Z){var i=this;if(2===arguments.length)i.setAttr(o,Z);else{if(!Bn(o))return i.getAttr(o);for(var M in o)i.setAttr(M,o[M])}return i},s.getAttr=function(D,c){if(c===l&&(c=1),this._attrObject&&D in this._attrObject)return this._attrObject[D];if(this.getImage){var F=this.getImage();if(tk(F)&&(F=Di[F]),Bn(F)&&"dataBindings"in F)for(var N=F.dataBindings,d=N.length-1;d>=0;d--){var s=N[d];if(s.attr===D){if("defaultValue"in s)return s.defaultValue;break}}}return c?P[D]:l},s.setAttr=function(R,y){var K=this;K._attrObject||(K._attrObject={});var Z=K._attrObject[R];y===l?delete K._attrObject[R]:K._attrObject[R]=y,K.fp&&K.fp("a:"+R,Z,y)&&K.onAttrChanged&&K.onAttrChanged(R,Z,y)},s.getSerializableAttrs=function(){var i,D={};for(i in this._attrObject)D[i]=1;return D}},ms_bnb:function(i){i.getBodyColor=function(z){return z.s("body.color")},i.getBorderColor=function(u){return u.s("border.color")}},_51o:function(u){u.mi=function(s,E,t){this.addInteractorListener(s,E,t)},u.umi=function(Q,m){this.removeInteractorListener(Q,m)},u.fi=function(p){this.fireInteractorEvent(p)},u.addInteractorListener=function(S,O,a){var $=this;$._63I||($._63I=new Kd),$._63I.add(S,O,a)},u.removeInteractorListener=function(b,c){this._63I&&this._63I.remove(b,c)},u.fireInteractorEvent=function(S){this._63I&&this._63I.fire(S)},u.setInteractors=function(o){var e=this,d=e._interactors;d&&d.each(function(A){A.tearDown()}),sp(o)&&(o=new Nj(o)),e._interactors=o,o&&o.each(function(c){c.setUp()}),e.fp("interactors",d,o),e.invalidateSelection()},u.getInteractors=function(){return this._interactors}},_49o:function(r){r._44O=Z,r._45O=Z,r.getTopPainters=function(){return this._44O},r.getBottomPainters=function(){return this._45O},r.addTopPainter=function(d){var o=this;o._44O||(o._44O=new Nj),o._44O.contains(d)||(o._44O.add(d),o.redraw&&o.redraw())},r.removeTopPainter=function(J){var r=this;r._44O&&(r._44O.remove(J),r.redraw&&r.redraw())},r.addBottomPainter=function(P){var U=this;U._45O||(U._45O=new Nj),U._45O.contains(P)||(U._45O.add(P),U.redraw&&U.redraw())},r.removeBottomPainter=function(E){var Z=this;Z._45O&&(Z._45O.remove(E),Z.redraw&&Z.redraw())},r._93db=function(y,E){var V=this;V._45O&&V._45O.each(function(A){A.draw?A.draw(y,E):A.call(V,y,E)})},r._92db=function(d,y){var l=this;l._44O&&l._44O.each(function(t){t.draw?t.draw(d,y):t.call(l,d,y)})}},ms_sm:function(n){n.sm=function(){return this.getSelectionModel()},n.setSelectableFunc=function(D){this.sm().setFilterFunc(D)},n.getSelectableFunc=function(){return this.sm().getFilterFunc()},n.getSelectionModel=function(){var _=this;return _._selectionModel?_._selectionModel:_.dm().sm()
    },n.isSelectionModelShared=function(){return!this._selectionModel},n.setSelectionModelShared=function(C){var F=this,O=!F._selectionModel,R=F.handleSelectionChange,Q=F.dm();O!==C&&(F.invalidateSelection&&F.invalidateSelection(),C?(Q.sm().ms(R,F),F._selectionModel.ums(R,F),F._selectionModel.dispose(),F._selectionModel=Z):(Q.sm().ums(R,F),F._selectionModel=new Dm(Q),F._selectionModel.ms(R,F)),F.onSelectionModelSharedChanged(),F.fp("selectionModelShared",O,C))},n.onSelectionModelSharedChanged=function(){var l=this;l.redraw(),l.invalidateSelection&&l.invalidateSelection()},n.removeSelection=function(){var N=this.dm();N.beginTransaction(),this.sm().toSelection().each(N.remove,N),N.endTransaction()},n.selectAll=function(){var t=this;t.sm().ss(t.dm().toDatas(function(B){return t.isVisible(B)&&t.isSelectable(B)}))},n.isSelected=function(S){return this.sm().co(S)},n.isSelectedById=function(M){var S=this.dm().getDataById(M);return S?this.isSelected(S):!1},n.isSelectable=function(W){return this.sm().isSelectable(W)}},ms_tx:function(u){u._64I=0,u._65O=0,u.isScrollable=function(){return this.getWidth()<this._64I},u._40o=function(){return this.isScrollable()},u.getLogicalPoint=function(C){return kk(C,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},u.tx=function(O){return O===l?this.getTranslateX():(this.setTranslateX(O),void 0)},u.getTranslateX=function(){return this._65O},u.setTranslateX=function(U){var J=this,B=J.getWidth()-J._64I;B>U&&(U=B),U>0&&(U=0),U=h(U);var S=J._65O;J._65O=U,J.fp(Ok,S,U)}},ms_ty:function(z){z._23Q=0,z._66O=0,z._41o=function(){return this.getHeight()<this._23Q},z.getLogicalPoint=function(e){return kk(e,this._canvas||this._view,this.tx?this.tx():0,this.ty())},z.ty=function(k){return k===l?this.getTranslateY():(this.setTranslateY(k),void 0)},z.getTranslateY=function(){return this._66O},z.setTranslateY=function(j){var v=this,d=v.getHeight()-v._23Q;d>j&&(j=d),j>0&&(j=0),j=h(j);var K=v._66O;v._66O=j,v.fp(Sl,K,j)}},ms_txy:function(n){n._65O=0,n._66O=0,n.tx=function(m){return m===l?this.getTranslateX():(this.setTranslateX(m),void 0)},n.ty=function(m){return m===l?this.getTranslateY():(this.setTranslateY(m),void 0)},n.onTranslateEnded=function(){},n.setTranslate=function(T,I,u){var G=this;if(u=Zc(u)){G._65I&&G._65I.stop(!0);var p=G.tx(),Y=G.ty();u.action=function(L){G.setTranslate(p+(T-p)*L,Y+(I-Y)*L)},u._37o=function(){delete G._66I,delete G._65I,G.onTranslateEnded()},G._66I=1,G._65I=we(u)}else G.tx(T),G.ty(I)},n.getTranslateX=function(){return this._65O},n.setTranslateX=function(R){var k=this;R=k.adjustTranslateX(R);var r=k._65O;k._65O=R,k.fp(Ok,r,R)},n.getTranslateY=function(){return this._66O},n.setTranslateY=function(_){var d=this;_=d.adjustTranslateY(_);var s=d._66O;d._66O=_,d.fp(Sl,s,_)},n.adjustTranslateX=function(t){return h(t)},n.adjustTranslateY=function(m){return h(m)},n.translate=function(N,x,Q){this.setTranslate(this.tx()+N,this.ty()+x,Q)},n.getLogicalPoint=function(V){var J=this;return kk(V,this._canvas||J._view,J.tx(),J.ty())}},ms_dm:function(m){m.dm=function(f){return f?(this.setDataModel(f),void 0):this.getDataModel()},m.getDataModel=function(){return this._dataModel}},ms_lp:function(P){P.lp=function(G){return this.getLogicalPoint(G)}},ms_v:function(K){K._disabled=!1,K.setDisabled=function(A,P){var r=this,i=r._disabled;i!==A&&(i&&(pf(r._63O),delete r._63O),A&&(Jp(r._view,r._63O=Zm(P)),r.iv()),r._disabled=A,r.fp("disabled",i,A))},K.isDisabled=function(){return this._disabled},K.getDisabledDiv=function(){return this._63O},K.getView=function(){return this._view},K.addToDOM=function(i){var c=this,$=c.getView(),I=$.style;i=i||D.body,i.appendChild($),I.left="0",I.right="0",I.top="0",I.bottom="0",T(M,"resize",function(){c.iv()}),c.iv()},K.getWidth=function(){return this._view.clientWidth},K.getHeight=function(){return this._view.clientHeight},K.setWidth=function(D){var O=this;O._view.style.width=D+Bd,O.iv(),O.fp&&O.fp(fk,Z,D)},K.setHeight=function(v){var X=this;X._view.style.height=v+Bd,X.iv(),X.fp&&X.fp(Ec,Z,v)},K.setFocus=function(I){var w=this,B=w._currentEditor;return I&&B&&(B.getView&&(B=B.getView()),B.contains(I.target))?!1:(Fp(w._view),w.endEditing&&w.endEditing(),w.fireViewEvent("focus"),!0)},K.iv=function(U){this.invalidate(U)},K.invalidate=function(C){var D=this;D._68I||(D._68I=1,ys(D.validate,D,Z,C),D.onInvalidated&&D.onInvalidated(),D.fireViewEvent("invalidate"))},K.validate=function(){var j=this,m=j._view;if(j._68I&&(delete j._68I,m.parentNode))if(0===m.offsetWidth&&0===m.offsetHeight&&j._67I!==Z)j._67I===l&&(j._67I=A.reinvalidateCount),j._67I>0?j._67I--:j._67I=Z,j.iv();else{j.fireViewEvent("beginValidate"),j.validateImpl(),j.onValidated&&j.onValidated(),j.fireViewEvent("validate");var i=j._63O;i&&(m.lastChild!==i&&(pf(i),Jp(m,i)),Vn(i,0,0,j.getWidth(),j.getHeight())),zh(j),Il(j),gj(j)}},K.layout=function(p,g,W,j){1===arguments.length?Vn(this,p):Vn(this,p,g,W,j)},K.addViewListener=function(M,I,U){var s=this;s._67O||(s._67O=new Kd),s._67O.add(M,I,U)},K.removeViewListener=function(B,k){this._67O.remove(B,k)},K.fireViewEvent=function(R){var V=this;V._67O&&(tk(R)&&(R={kind:R}),V._67O.fire(R)),A.viewListener&&A.viewListener(V,R)}},ms_tip:function(u){u.setToolTipEnabled=function(o){var H=this;o?ng||H._13o||(H.enableToolTip(),H.fp("toolTipEnabled",!1,!0)):H._13o&&(H.disableToolTip(),H.fp("toolTipEnabled",!0,!1))},u.isToolTipEnabled=function(){return!!this._13o},u.enableToolTip=function(){var X=this;if(!ng&&!X._13o){X._13o=function(r){var y=X.getToolTip(r);y!=Z?A.toolTipContinual&&A.isToolTipShowing()?Vr(r,y):(Kp(),Fn={timeout:U(jo,nj),e:r,info:y}):Kp()};var m=X.getView();T(m,ig,X._13o),T(m,"mouseleave",A.hideToolTip)}},u.disableToolTip=function(){var k=this;if(k._13o){var v=k.getView();K(v,ig,k._13o),K(v,"mouseleave",A.hideToolTip),delete k._13o}},u.getToolTip=function(N){var t=this;if(t.getDataAt){var X=t.getDataAt(N);return X?X.getToolTip():Z}return t.getValue?t.getValue():void 0}},_52o:function(H){H._zoom=1,H._29I=oo,H.zoomIn=function(Z,n){this.setZoom(this._zoom*ag,Z,n)},H.zoomOut=function(d,W){this.setZoom(this._zoom/ag,d,W)},H.zoomReset=function(j,U){this.setZoom(1,j,U)},H.scrollZoomIn=function(R){this.setZoom(this._zoom*Br,Z,R)},H.scrollZoomOut=function(Q){this.setZoom(this._zoom/Br,Z,Q)},H.pinchZoomIn=function(C){this.setZoom(this._zoom*rf,Z,C)},H.pinchZoomOut=function(E){this.setZoom(this._zoom/rf,Z,E)},H.adjustZoom=function(J){return Ei>J?Ei:J>kj?kj:J},H.getZoom=function(){return this._zoom},H.setZoom=function(x,I,b){var D=this;if(I=Zc(I)){D._14o&&D._14o.stop(!0);var l=D._zoom;I.action=function(B){D._96O(l+(x-l)*B,b)},I._37o=function(){delete D._zooming,delete D._14o,D.onZoomEnded()},D._zooming=1,D._14o=we(I)}else D._96O(x,b)},H._96O=function(x,d){var _=this;if(x=_.adjustZoom(x),x!==_._zoom){_.validate();var V=_._29I,E=_._zoom;0!==V.width&&0!==V.height&&(d=d?d:{x:V.x+V.width/2,y:V.y+V.height/2},_.tx((d.x-V.x)*E-d.x*x),_.ty((d.y-V.y)*E-d.y*x)),_._zoom=x,_.fp("zoom",E,x)}}},ms_edge:function(O){O._2I=function(e){var F=this;F._44I||(F._44I=new Nj),F._42I||(F._42I=new Nj),F._44I.add(e),F._42I.add(e),F._20I()},O._4I=function(N){var d=this;d._44I||(d._44I=new Nj),d._43I||(d._43I=new Nj),d._44I.add(N),d._43I.add(N),d._20I()},O._16I=function(S){var O=this;O._44I.remove(S),O._42I.remove(S),O._44I.isEmpty()&&delete O._44I,O._42I.isEmpty()&&delete O._42I,O._20I()},O._18I=function(s){var Z=this;Z._44I.remove(s),Z._43I.remove(s),Z._44I.isEmpty()&&delete Z._44I,Z._43I.isEmpty()&&delete Z._43I,Z._20I()},O._20I=function(){var L=this;if(delete L._45I,!L._44I||L._44I.isEmpty())return delete L._70O,void 0;var y;L._44I.each(function(N){N.isLooped()&&(y||(y={}),y[N._id]||(L._45I||(L._45I=new Nj),L._45I.add(N),y[N._id]=N))}),y?(L._70O=new Nj,L._44I.each(function(i){y[i._id]?"A"===y[i._id]||(y[i._id]="A",L._70O.add(i)):L._70O.add(i)})):L._70O=L._44I},O.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},O.getSourceAgentEdges=function(){return this._46I},O.getTargetAgentEdges=function(){return this._47I},O._1I=function(Q){var s=this;s._46I||(s._46I=new Nj),s._48I||(s._48I=new Nj),s._46I.add(Q),s._48I.add(Q),s._19I()},O._3I=function(w){var j=this;j._47I||(j._47I=new Nj),j._48I||(j._48I=new Nj),j._47I.add(w),j._48I.add(w),j._19I()},O._15I=function(O){var C=this;C._46I.remove(O),C._48I.remove(O),C._46I.isEmpty()&&delete C._46I,C._48I.isEmpty()&&delete C._48I,C._19I()},O._17I=function(g){var l=this;l._47I.remove(g),l._48I.remove(g),l._47I.isEmpty()&&delete l._47I,l._48I.isEmpty()&&delete l._48I,l._19I()},O._19I=function(){var m=this;delete m._49I;var I=m._48I;if(I&&!I.isEmpty()){var r={};I.each(function(o){r[o._id]?m._49I||(m._49I=new Nj):r[o._id]=o}),m._49I?I.each(function(c){r[c._id]&&(m._49I.add(c),delete r[c._id])}):m._49I=I}},O.getLoopedEdges=function(){return this._45I},O.getEdges=function(){return this._70O},O.getAgentEdges=function(){return this._49I},O.getSourceEdges=function(){return this._42I},O.getTargetEdges=function(){return this._43I},O._8I=function(){this._70O&&this._70O.each(function(q){q._7I()})}}};Nh(A,{getVersion:function(){return"7.0.8-dev5"}},!0),Nh(A,{numberDigits:5,crossOrigin:"",baseZIndex:l,isTouchable:ng,devicePixelRatio:M.devicePixelRatio?M.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:v.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Xm},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(o){return o*o},labelColor:vl,labelSelectColor:Af,labelFont:"12px arial, sans-serif",widgetIndent:ng?30:20,widgetRowHeight:ng?30:20,widgetHeaderHeight:ng?32:22,widgetTitleHeight:ng?34:24,scrollBarColor:on,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:ng?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Gl,intersectionLineLine:ff,isEnter:bd,isEsc:Nb,isDelete:Go,isSpace:nb,isLeft:Bg,isUp:yb,isRight:Pn,isDown:Vl,isTouchEvent:Fe,getTarget:$r,isString:tk,isNumber:gh,isBoolean:ej,isArray:sp,isSelectAll:Dn,isFunction:vi,isObject:Bn,getPropertyValue:Xg,setPropertyValue:On,addMethod:Nh,isMobile:function(){var I;return function(){return I!==l?I:(I=!1,function(J){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(J)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(J.substr(0,4)))&&(I=!0)}(navigator.userAgent||navigator.vendor||M.opera),I)}}(),createGradient:function(h,G,q,p,I,U,m,t){var x=$p[G];return x(h,q,p,I,U,m,t)},appendToScreen:function(I){I=I.getView?I.getView():I,(D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement||D.body).appendChild(I)},encodeString:function(G){return a.Math.encodeBase64(G,A.encodeStringKey)},decodeString:function(y){return a.Math.decodeBase64(y,A.encodeStringKey)},findView:function(r){var O=function(C,m){var Z=m._ht;Z&&C.push(Z);var D=m.children,R=D.length;if(R)for(var Y=0;R>Y;Y++)O(C,D[Y])},f=[];O(f,D.body);var V=function(X,E){for(var b="2d"===E?Jk.GraphView:Hp.Graph3dView,I=0,G=X.length;G>I;I++)if(X[I]instanceof b)return f[I];return null};return"all"===r?f:"2d"===r?V(f,"2d"):"3d"===r?V(f,"3d"):V(f,"3d")||V(f,"2d")},toggleFullscreen:function(P){var n=P.getView();if(D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement)D.exitFullscreen?D.exitFullscreen():D.msExitFullscreen?D.msExitFullscreen():D.mozCancelFullScreen?D.mozCancelFullScreen():D.webkitExitFullscreen&&D.webkitExitFullscreen();else{var o=!0;if(P.isSelfViewEvent){var d=P.getX(),f=P.getY(),Z=P.getWidth(),l=P.getHeight(),e=n.style.background,T=n.style.backgroundColor;e||T||(n.style.backgroundColor="white"),n.requestFullscreen?n.requestFullscreen():n.msRequestFullscreen?n.msRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen();var W=setInterval(function(){if(n!==(D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement))clearInterval(W),P.setX(d),P.setY(f),P.setWidth(Z),P.setHeight(l),P._fullscreen=!1,n.style.oldBackgroundColor=T,P.iv();else{var e=a.Default.getWindowInfo();(o||e.width!==P.getWidth()||e.height!==P.getHeight())&&(P.setX(e.left),P.setY(e.top),P.setWidth(e.width),P.setHeight(e.height),P._fullscreen=!0,P.iv(),o=!1)}},500)}else{var R=n.style.left,Y=n.style.top,Z=n.style.width,l=n.style.height,e=n.style.background,T=n.style.backgroundColor;e||T||(n.style.backgroundColor="white"),n.requestFullscreen?n.requestFullscreen():n.msRequestFullscreen?n.msRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen();var W=setInterval(function(){if(n!==(D.fullscreenElement||D.mozFullScreenElement||D.webkitFullscreenElement||D.msFullscreenElement))clearInterval(W),n.style.left=R,n.style.top=Y,n.style.width=Z,n.style.height=l,n.style.oldBackgroundColor=T,P.iv();else{var h=a.Default.getWindowInfo();(o||h.width!==P.getWidth()||h.height!==P.getHeight())&&(Vn(P),o=!1)}},500)}}},appendTimeStamp:function(r){return r},setCompType:function(u,j){vi(j)||Bn(j)?en[u]=j:Ln(u)},getCompType:function(o){var J=en[o];return J===l&&Rj.test(o)&&Ln(o),J},getCompTypeMap:function(){return en},drawCompType:function(k,r,c,S,v,i){k(r,c,S,v,i)},numberListener:function(){var X={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(J){var v=J.keyCode;X[v]||65===v&&A.isCtrlDown(J)||86===v&&A.isCtrlDown(J)||67===v&&A.isCtrlDown(J)||88===v&&A.isCtrlDown(J)||v>=35&&40>=v||(J.shiftKey||48>v||v>57)&&(96>v||v>105)&&J.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(Y){var G=Y.target.tagName;("DIV"===G||"CANVAS"===G)&&!(A.ignoreKeyCodes.indexOf(Y.keyCode)>=0)&&("keydown"!==Y.type||Bg(Y)||Pn(Y)||yb(Y)||Vl(Y)||Go(Y)||65===Y.keyCode&&(Y.metaKey||Y.ctrlKey))&&(Y.preventDefault(),Y.preventManipulation&&Y.preventManipulation())},getWindowInfo:function(){var g=D.documentElement,W=g&&(g.scrollLeft||g.scrollTop)?g:D.body;return{target:W,left:W.scrollLeft,top:W.scrollTop,width:M.innerWidth||W.clientWidth,height:M.innerHeight||W.clientHeight}},isDragging:function(){return!!Xm},isLeftButton:function(B){return Fe(B)?!0:0===B.button},isMiddleButton:function(d){return Fe(d)?!1:d&&(1===d.button||4&(d.buttons||0))},isRightButton:function(J){return Fe(J)?!1:J&&(2===J.button||2&(J.buttons||0))},isInput:function(a){if(!a)return!1;var U=a.tagName;return"INPUT"===U||"TEXTAREA"===U||"SELECT"===U},getTouchCount:function(C){return Fe(C)?C.touches.length:1},isDoubleClick:function(){function V(x){x.details=0,x.timeout=null,x.lastPoint=null}var j={};return ti=new $,Wk=ti.getTime(),function(y){if(bp(y)>1)return!1;var a=y.button==Z?"":y.button,W=y.type+a,d=W+"_isDoubleClick",C=j[W];if(C||(C=j[W]={details:0,timeout:null,lastPoint:null}),y[d]===l){y[d]=!0;var o=zn(y);C.timeout&&(_(C.timeout),C.timeout=null);var D=Fe(y)?A.doubleTouchRange:A.doubleClickRange;C.lastPoint&&fm(C.lastPoint,o)>D&&V(C),C.lastPoint=o,C.details++,C.timeout=U(function(){V(this)}.bind(C),500)}return 2===C.details}}(),isShiftDown:function(s){return s?s.shiftKey:_n["16"]},isCtrlDown:function(z){return z?ep?z.metaKey:z.ctrlKey:ep?_n["91"]:_n["17"]},getClientPoint:function(I){return Fe(I)&&(I=eq(I)),{x:I.clientX,y:I.clientY}},isMouseEvent:function(B){return B instanceof MouseEvent||0===B.type.indexOf("mouse")},getTargetElement:function(B){if(A.isMouseEvent(B)||!D.elementFromPoint)return B.target;var t=Jf(B);return D.elementFromPoint(t.x,t.y)},getPagePoint:function(W){return Fe(W)&&(W=eq(W)),{x:W.pageX,y:W.pageY}},createObject:function(C,S){var j=new C;for(var r in S){var z=S[r];if(vi(z))j[r]=z;else if(0===r.indexOf("s:"))j.s(r.substr(2),S[r]);else if(0===r.indexOf("a:"))j.a(r.substr(2),S[r]);else{var n=zp(r),z=S[r];j[n]?(j[n](z),"setToolTip"===n&&j.enableToolTip&&j.enableToolTip()):j[r]=z}}return j},setImage:function(T,M,s,H){var R=arguments.length;4===R?tf(T,H,M,s):2===R?tk(M)?tf(T,M):Cg(T,M):1===R&&tf(T,T)},getImage:function(W,o,c){var V;if(W==Z)return Z;if(Bn(W)?V=W:(V=Di[W],W&&V===l&&(cc&&cc[W]||tf(W,W))),o&&V&&V.tagName){var f;f="override"===c?"colors_override":"override_rgb"===c?"colors_override_rgb":"override_a"===c?"colors_override_a":"colors",V[f]||(V[f]={__count__:0});var k=V[f][o];return k||(V[f].__count__>A.imageCacheThreshold&&(V[f]={__count__:0}),k=xl(V,nk(o),V.width,V.height,c),V[f][o]=k,V[f].__count__++),k}return V},isImageComplete:function(y,o,U){var I=Uj(y);if(!I)return!1;if(I.tagName)return I.complete;for(var p,y,P,S=I.comps,v=!0,q=0,d=S.length;d>q;q++)if(p=S[q],P=p.type,"image"===p.type){y=p.name,y&&y.func&&(y=Xo(y,o));var W=Gk(y,o,U);if(!W){v=!1;break}}else if(Rj.test(P)&&A.getCompType(P)===l){v=!1,Ln(P);break}return v},getId:function(){var S=1;return function(){return++S}}(),callLater:function(Q,T,i,X){var $=function(){Q.apply(T,i)};return X?U($,X):M.requestAnimationFrame($)},cancelLater:function(S,b){b?_(S):M.cancelAnimationFrame(S)},clone:function(u){if(null==u||"object"!=typeof u)return u;if(u instanceof Date){var d=new Date;return d.setTime(u.getTime()),d}if(u instanceof Array){for(var d=[],v=0,i=u.length;i>v;v++)d[v]=Em(u[v]);return d}if(u instanceof Nj){for(var d=new Nj,v=0,i=u.length;i>v;v++)d.set(v,Em(u.get(v)));return d}if(u instanceof ob)return u;if(u instanceof Y){var d={};for(var F in u)u.hasOwnProperty(F)&&(d[F]=Em(u[F]));return d}return u},callWhenLoaded:function(L,J){J=J||100;var W=zk(L,J);Vo||(Vo={}),Vo[W]={tick:W,cb:L,delay:J}},beforeLoadURL:function(v,C){if(Vo){var u={};for(var C in Vo){var Q=Vo[C];_(Q.tick);var N=zk(Q.cb,Q.delay);u[N]={tick:N,delay:Q.delay,cb:Q.cb}}Vo=u}return A.convertURL?A.convertURL(v,C):v},convertURL:function(E){return E},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return A.getImage("default_blank")},resizeImagePOT:function(f,R){if(!f||!f.tagName)return f;var o=f.width,q=f.height;if(!o||!q)return f;if(rk.isPOT(o)&&rk.isPOT(q)&&(!R||o===q))return f;var P,I;R?I=P=rk.nearestPOT(Math.min(o,q)):(P=rk.nearestPOT(o),I=rk.nearestPOT(q));var d=uh(),L=d.getContext("2d");return wg(d,P,I,1),L.drawImage(f,0,0,o,q,0,0,P,I),d},sortFunc:function(w,o){if(w===o)return 0;if(w==Z&&o!=Z)return 1;if(w!=Z&&o==Z)return-1;if(w==Z&&o==Z)return 0;var j,P=typeof w,C=typeof o;return P===Xp&&C===Xp?j=w.localeCompare(o):P===Tn&&C===Tn&&(j=w-o),j===l&&(j=(""+w).localeCompare(""+o)),j>0?1:0>j?-1:0},getClassMap:function(){return Zh},getClass:function(G){if(tk(G)){var l,s=Zh[G];if(!s){l=G.split("."),s=M;for(var V=0;V<l.length;V++)s=s[l[V]];Zh[G]=s}return s}return G},def:function(Q,l,Y){var P,v,X,b=function(){};if(b.prototype=l.prototype,P=new b,tk(Q)){if(Zh[Q])throw"'"+Q+"' already defined";X=go(Q),P.getClassName=function(){return Q}}else X=Q;if(P.constructor=X,P.getClass=function(){return X},P.getSuperClass=function(){return l},Y)for(v in Y)Lc[v]&&Lc.hasOwnProperty(v)?Lc[v](P,Y):Sc(P,Y,v);X.prototype=P,X.superClass=l.prototype},startAnim:function(){var j=function(Q){Q.duration&&(Q.startTime=xk()),Q.timeId=ys(Q.tick,Z,Z,Q.interval)};return function(p){return p=Em(p),p.easing=p.easing||A.animEasing,p.duration||p.frames||(p.duration=A.animDuration),p.t=0,p.duration?p.interval=0:(p.frame=0,p.interval=p.interval||10),p.tick=function(){if(p.duration){var c=(xk()-p.startTime)/p.duration;if(c>1&&(c=1),p.t=c,p.action(p.easing(c),c),!p.isRunning())return;1===c?p.stop():p._isPaused||(p.timeId=ys(p.tick))}else{if(p.frame++,c=p.t=p.frame/p.frames,p.action(p.easing(c),c),!p.isRunning())return;p.frame<p.frames?p._isPaused||(p.timeId=ys(p.tick,Z,Z,p.interval)):p.stop()}},p.resume=function(){p._isPaused&&(delete p._isPaused,p.duration?p.t<1&&(p.startTime=xk()-p.duration*p.t,p.timeId=ys(p.tick)):p.frame<p.frames&&(p.timeId=ys(p.tick,Z,Z,p.interval)))},p.pause=function(){wr(p.timeId,!p.duration),p._isPaused=!0},p.isPaused=function(){return this._isPaused},p.stop=function(V){p.isRunning()&&(wr(p.timeId,!p.duration),delete p.timeId,p.duration?p.t<1&&V&&(p.t=1,p.action(p.easing(1),1)):p.frame<p.frames&&V&&(p.frame=p.frames,p.action(p.easing(1),1)),p._37o&&p._37o(),p.finishFunc&&p.finishFunc())},p.isRunning=function(){return p.timeId!=Z},p.delay?ys(j,Z,[p],p.delay):j(p),p}}(),getTextSize:function(){var r={},f=D?uh().getContext("2d"):Z;return function(Q,z){f.font=Q?Q:yc;var w=r[f.font];return w||(w=2*f.measureText("e").width+4,r[f.font]=w),{width:f.measureText(z).width+4,height:w}}}(),drawText:function(X,r,J,B,t,c,D,P,f,z){if(r!=Z){var H=hh(J,r),C={};C.y=z&&z!==_e?z===Uh?c+H.height/2:c+P-H.height/2:c+P/2,C.x=f&&f!==Bc?f===qe?t+D-H.width/2:t+D/2:t+H.width/2,Gq(X,r,C,J,B)}},getDistance:function(L,D){var y=L.length;return D?3===y?w(g(L[0]-D[0])+g(L[1]-D[1])+g(L[2]-D[2])):2===y?w(g(L[0]-D[0])+g(L[1]-D[1])):L.z===l?w(g(D.x-L.x)+g(D.y-L.y)):w(g(D.x-L.x)+g(D.y-L.y)+g(D.z-L.z)):3===y?w(g(L[0])+g(L[1])+g(L[2])):2===y?w(g(L[0])+g(L[1])):void 0},brighter:function(o,n){return 0>n&&(n=-n),Uf(o,n?n:40)},darker:function(a,c){return c>0&&(c=-c),Uf(a,c?c:-40)},unionPoint:function(x,Y){if(!x)return Z;if(2===arguments.length)return x&&Y?{x:C(x.x,Y.x),y:C(x.y,Y.y),width:t(x.x-Y.x),height:t(x.y-Y.y)}:Z;var s=x;if(s._as&&(s=s._as),s.length===l)return Z;var K=s.length;if(0>=K)return Z;for(var L=1,u=s[0],q={x:u.x,y:u.y,width:0,height:0};K>L;L++){u=s[L];var _=C(q.x,u.x),F=j(q.x+q.width,u.x),X=C(q.y,u.y),B=j(q.y+q.height,u.y);q.x=_,q.y=X,q.width=F-_,q.height=B-X}return q},unionRect:function(M,w){if(M&&!w)return Em(M);if(!M&&w)return Em(w);if(M&&w){var s={x:C(M.x,w.x),y:C(M.y,w.y)};return s.width=j(M.x+M.width,w.x+w.width)-s.x,s.height=j(M.y+M.height,w.y+w.height)-s.y,s}return Z},containsPoint:function(i,H,S,N){if(N!=Z&&1!==N){var Y=i.x+i.width/2,K=i.y+i.height/2;i={x:Y-i.width/2*N,y:K-i.height/2*N,width:i.width*N,height:i.height*N}}if(S){var h=i.width/2,Q=i.height/2,X=E(-S),F=m(-S),$=H.x-i.x-h,e=H.y-i.y-Q;return H={x:F*$-X*e,y:X*$+F*e},or({x:-h,y:-Q,width:i.width,height:i.height},H)}return!(!i||H.x<i.x||H.y<i.y||H.x>i.x+i.width||H.y>i.y+i.height)},containsRect:function(K,P){if(!K||!P)return!1;var m=P.x,z=P.y,M=P.width,W=P.height,y=K.width,_=K.height;if(0>(y|_|M|W))return!1;var o=K.x,i=K.y;if(o>m||i>z)return!1;if(y+=o,M+=m,m>=M){if(y>=o||M>y)return!1}else if(y>=o&&M>y)return!1;if(_+=i,W+=z,z>=W){if(_>=i||W>_)return!1}else if(_>=i&&W>_)return!1;return!0},intersectsRect:function(h,N){if(!h||!N)return!1;var Y=N.width,c=N.height,O=h.width,g=h.height;if(0>=O||0>=g||0>=Y||0>=c)return!1;var y=N.x,l=N.y,a=h.x,_=h.y;return O+=a,g+=_,Y+=y,c+=l,O>y&&g>l&&Y>a&&c>_},intersection:function(R,n){if(!R||!n)return Z;var A=n.x,O=n.y,U=R.x,T=R.y,y=A,L=O,K=U,z=T;return y+=n.width,L+=n.height,K+=R.width,z+=R.height,U>A&&(A=U),T>O&&(O=T),y>K&&(y=K),L>z&&(L=z),y-=A,L-=O,0>=y||0>=L?Z:{x:A,y:O,width:y,height:L}},grow:function(N,t,g){g===l&&(g=t),N.x-=t,N.y-=g,N.width=N.width+2*t,N.height=N.height+2*g},getScreenPoint:function(M,O,x,j,F,p,m){var Y=x.getBoundingClientRect(),y=M*(p||1)-x.scrollLeft+(j||0),N=O*(m||1)-x.scrollTop+(F||0),I=rh(x,!1);if(I){var U=new um(y,N,0);return U.applyMatrix4(I),console.log(U),{x:U.x,y:U.y}}return{x:y+Y.left,y:N+Y.top}},getLogicalPoint:function(j,M,P,_,A,I){var W,z,m=M.getBoundingClientRect();j.target?(oe(j)?ep?_n["91"]=!0:_n["17"]=!0:ep?_n["91"]=!1:_n["17"]=!1,_n["16"]=_d(j)?!0:!1,j=Fe(j)?eq(j):j,W=j.clientX,z=j.clientY):(W=j.x,z=j.y);var d=rh(M,!0);if(d){var f=new um(W,z,0);f.applyMatrix4(d);do{if(Math.abs(f.z)<=1e-6)break;var X=new um(W,z,1);if(X.applyMatrix4(matrix),Math.abs(X.z)<=1e-6){f=X;break}if(X.sub(f),Math.abs(X.z)<=1e-6)break;f.addScaledVector(X,-f.z/X.z)}while(!1);return{x:(f.x+M.scrollLeft-(P||0))/(A||1),y:(f.y+M.scrollTop-(_||0))/(I||1)}}return{x:(W-m.left+M.scrollLeft-(P||0))/(A||1),y:(z-m.top+M.scrollTop-(_||0))/(I||1)}},removeHTML:function(){var t;return function(H){return H&&H.getView&&(H=H.getView()),H&&H.parentNode?t===H?!0:(t=H,H.parentNode.removeChild(H),t=Z,!0):!1}}(),getToolTipDiv:function(){if(!Zj){Zj=Sr(),Ui=Sr();var _=Zj.style;A.baseZIndex!=Z&&(_.zIndex=N(A.baseZIndex)+3+""),_.whiteSpace="nowrap",_.color=A.toolTipLabelColor,_.background=A.toolTipBackground,_.font=A.toolTipLabelFont,_.padding="5px",_.boxShadow="0px 0px 3px "+A.toolTipShadowColor}return Zj},isToolTipShowing:function(){return Zj&&Zj.parentNode?!0:Ui&&Ui.parentNode?!0:!1},hideToolTip:function(){pf(Zj),pf(Ui),Ak()},showToolTip:function(v,S){if(!v||S==Z)return Kp(),void 0;A.getToolTipDiv();var M,l;if(S.html?(S=S.html,M=Ui,pf(Zj)):(M=Zj,pf(Ui)),l=M.style,M.innerHTML=S,M.parentNode||a.Default.appendToScreen(M),v.target){v=Jf(v);var O=kg(),C=v.x,G=v.y,r=ng?60:12;if(ng){var k=M.getBoundingClientRect();l.left=C-k.width/2+Bd,l.top=G-k.height-r<O.top?G+r+Bd:G-k.height-r+Bd}else{l.left=C+r+Bd,l.top=G+r+Bd;var k=M.getBoundingClientRect();k.left+k.width>O.width&&(l.left=C-r-k.width+Bd),k.top+k.height>O.height&&(l.top=G-r-k.height+Bd),k.left<0&&(l.left=C+r+Bd),k.top<0&&(l.top=G+r+Bd)}}else l.left=v.x+Bd,l.top=v.y+Bd;Ak()},startDragging:function(g,X,W){W==l&&(W=!0),g!==Xm&&(Xm?W&&(Fe(X)?Xm.handleWindowTouchEnd(X):Xm.handleWindowMouseUp(X)):Fe(X)?(T(M,mm,gr),T(M,Xk,Co)):(T(M,ig,wi),T(M,qr,ki)),Xm=g)},getImageMap:function(){return Di},toBoundaries:function(v,D,x,E){var i=[];return Ai(v,D,x,E).forEach(function(y){var P=[];y.forEach(function(x){P.push(x.x,x.y)}),i.push(P)}),i},getCurrentKeyCodeMap:function(){return _n},drawCenterImage:function(d,Q,V,v,w,u,R,s){!w&&u&&u.isSelfViewEvent&&(w=u);var x=ab(Q,w,u),z=kn(Q,w,u);nn(d,Q,h(V-x/2),h(v-z/2),x,z,w,u,R,s)},drawStretchImage:function(y,O,d,S,U,A,G,g,z,p,L,_){!g&&z&&z.isSelfViewEvent&&(g=z);var m,B=ab(O,g,z,A),l=kn(O,g,z,G);"uniform"===d?(m=C(A/B,G/l),B*=m,l*=m,S+=h((A-B)/2),U+=h((G-l)/2),A=B,G=l):"centerUniform"===d&&((B>A||l>G)&&(m=C(A/B,G/l),B*=m,l*=m),S+=h((A-B)/2),U+=h((G-l)/2),A=B,G=l);var w=y.interactiveInfo;if(w){var Z;if(Z="center"===d?{x:S+A/2-B/2,y:U+G/2-l/2,width:B,height:l}:{x:S,y:U,width:A,height:G},w.rect){var j=w.compInfos,X=j.length;X&&(j[X-1].rect.image=O)}else w.rect=Z}if("center"===d){var r=L!==!1&&(B>A||l>G);r&&(y.save(),y.beginPath(),y.rect(S,U,A,G),y.clip()),nn(y,O,S+A/2-B/2,U+G/2-l/2,B,l,g,z,p,_),r&&y.restore()}else nn(y,O,S,U,A,G,g,z,p,_)},toCanvas:function(i,p,J,K,l,m,Q,g,t){i=Uj(i,Q),p=p||ab(i,l),J=J||kn(i,l);var U=uh(),d=qq(U);return g?(wg(U,p,J,g),d.scale(g,g)):wg(U,p,J,1),cj(d,i,K,0,0,p,J,l,m,Q,t),i&&i.clampToEdge&&(U.clampToEdge=i.clampToEdge),d.restore(),U},toGrayColor:function(X){if(!X)return X;var F=jn(X),N=h(.299*F[0]+.587*F[1]+.114*F[2]);return"rgba("+N+","+N+","+N+","+F[3]/255+")"},createGradientImage:function(w,B,Z,U){for(var u=["L",0,0,w,0,1,0,0,1,0,0],K=0,C=Math.min(B.length,Z.length);C>K;K++)u.push(Z[K],B[K]);var b=a.Default.toCanvas({width:w,height:w,clampToEdge:!0,comps:[{type:"shape",rotation:U||0,points:[0,0,w,0,w,w,0,w],background:"#ffffff",gradientPack:u}]});return b},createElement:function(R,l,x,L){var u=D.createElement(R);return Gi(u,l||v.widgetBorder,2),u.style.font=x?x:yc,L!=Z&&(u.value=L),A.onElementCreated&&A.onElementCreated(u),u},containedInView:function(p,T){var M=Kl(T).getBoundingClientRect();return or({x:M.left,y:M.top,width:M.width,height:M.height},zn(p))},isIsolating:function(){return ar>0},setIsolating:function(G){G?ar++:ar--},getMSMap:function(){return Lc},stringify:function(u,N,K){var G=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var w=JSON.stringify(u,function(U,p){return"function"==typeof p?"__ht__"+(p.__ht__||p.toString()):gh(p)?wd(p):p instanceof a.List?"__ht__list"+(p.__ht__list||A.stringify(p._as)):p},N==Z?2:N);return Date.prototype.toJSON=G,K&&(w="__ht__encode"+A.encodeString(w)),w},parse:function(R){return tk(R)?"__ht__encode"!=R.substr(0,12)||(R=A.decodeString(R.substr(12)),tk(R))?JSON.parse(R,function(h,F){if(tk(F))if("__ht__function"==F.substr(0,14)){var l=F.indexOf("{")+1,c=F.lastIndexOf("}"),P=F.indexOf("(")+1,t=F.indexOf(")");if(l&&c&&P&&t){var V=new Function(F.substring(P,t),F.substring(l,c));return V.__ht__=F.substr(6),V}}else{if("__ht__date"==F.substr(0,10))return new Date(N(F.substr(10)));if("__ht__list"===F.substr(0,10))return new Nj(A.parse(F.substr(10)))}return F}):R:R},loadJS:function(d,e){e&&d.push(e);var Z=d.shift();if(sp(Z))d=Z.contact(d),A.loadJS(d);else if(vi(Z))Z(),A.loadJS(d);else if(tk(Z)){var B=D.createElement("script");B.onload=function(){A.loadJS(d)},B.setAttribute("src",Z),D.getElementsByTagName("head")[0].appendChild(B)}else d.length&&A.loadJS(d)},extendClass:function(Q,O){var W=Q.prototype;for(var F in O)Lc[F]&&Lc.hasOwnProperty(F)?Lc[F](W,O):W[F]=O[F]},toRoundedCorner:function(){function g(J,s,Q){J.x=s.x,J.y=s.e||Q,J.z=s.y}var S=new um,E=new um,q=new um,A=new um;return function(D,y){var M,Z=0;D.getPoints&&(Z=D.getElevation(),D=D.getPoints()),M=D instanceof Nj?D:new Nj(D);var $=M.size();if(0>=y)return{points:M};var j=new Nj,H=new Nj,r=M.get(0);g(S,r,Z),j.add(r),H.add(1);for(var t=1;$>t;t++)if($>t+1){var _=M.get(t),k=M.get(t+1);g(E,_,Z),g(q,k,Z),A.subVectors(S,E).setLength(Math.min(.99*A.length(),y)).add(E),_.e!==l||r.e!==l?j.add({x:A.x,y:A.z,e:A.y}):j.add({x:A.x,y:A.z}),j.add(_),A.subVectors(q,E).setLength(Math.min(.99*A.length(),y)).add(E),_.e!==l||k.e!==l?j.add(r={x:A.x,y:A.z,e:A.y}):j.add(r={x:A.x,y:A.z}),S.copy(A),H.addAll([2,3])}else j.add(M.get(t)),H.add(2);return{points:j,segments:H}}}(),toColorData:jn,setCanvas:wg,createDiv:Sr,createDisabledDiv:Zm,createView:Wm,createCanvas:uh,appendChild:Jp,initContext:qq,checkLoadingImage:zh,translateAndScale:hb,layout:Vn,getPosition:od,drawPoints:wb,drawRoundRect:Ce,drawBorder:lk,setFocus:Fp,getter:kr,setter:zp,isEmptyObject:rr,cameraPriority:function(){var C={skybox:0,main:1e4,top:1e7};return Y.seal(Y.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return C.skybox},set:function(V){if(V>=C.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");C.skybox=Number(V)}},main:{configurable:!1,enumerable:!1,get:function(){return C.main},set:function($){if($<=C.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");
                if($>=C.top)throw new RangeError("Main camera must have lower priority than the top camera.");C.main=Number($)}},top:{configurable:!1,enumerable:!1,get:function(){return C.top},set:function(W){if(W<=C.main)throw new RangeError("Top camera must have higher priority than the main camera.");C.top=Number(W)}}}))}()},!0),Nh(O,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Ph=A.disabledOpacity,nj=A.toolTipDelay,vj=A.devicePixelRatio,vc=A.autoMakeVisible,vg=A.autoHideScrollBar,cs=A.imageGradient,Vr=A.showToolTip,Kp=A.hideToolTip,Hi=A.dashPattern,wc=A.lineCap,xp=A.lineJoin,md=A.labelColor,Zr=A.labelSelectColor,yc=A.labelFont,tg=A.widgetIndent,ve=A.widgetRowHeight,Gg=A.widgetHeaderHeight,Hj=A.widgetTitleHeight,Tc=A.scrollBarColor,Tl=A.scrollBarSize,Qn=A.scrollBarTimeout,Kc=A.scrollBarMinLength,Vp=A.scrollBarInteractiveSize,ag=A.zoomIncrement,Br=A.scrollZoomIncrement,rf=A.pinchZoomIncrement,kj=A.zoomMax,Ei=A.zoomMin,qs=A.createObject,td=A.preventDefault,nq=A.setImage,Uj=A.getImage,Gk=A.isImageComplete,Pe=A.drawCenterImage,cj=A.drawStretchImage,Vc=A.getId,ys=A.callLater,wr=A.cancelLater,dn=A.sortFunc,Em=A.clone,go=A.getClass,we=A.startAnim,Bo=A.brighter,Kr=A.darker,xc=A.drawText,hh=A.getTextSize,Vi=A.isLeftButton,ge=A.isMiddleButton,Pi=A.isRightButton,bp=A.getTouchCount,Ko=A.isDoubleClick,_d=A.isShiftDown,oe=A.isCtrlDown,zn=A.getClientPoint,Jf=A.getPagePoint,fm=A.getDistance,rl=A.unionPoint,Xj=A.unionRect,or=A.containsPoint,Ob=A.containsRect,Yb=A.intersectsRect,$l=A.intersection,kg=A.getWindowInfo,Er=A.grow,kk=A.getLogicalPoint,sn=A.getScreenPoint,Oi=A.startDragging,pf=A.removeHTML,es=A.createElement,bf=A.segmentResolution,ml=A.shapeResolution,Aj=A.shapeSide,Im=A.def,En=function(w,X,_){Im(W+"."+w,X,_)},Rg=function(s,d){s.childNodes.forEach(function(t){d(t),Rg(t,d)})};Nh(A,{toolTipLabelColor:md,toolTipLabelFont:yc,toolTipBackground:v.toolTipBackground,toolTipShadowColor:on,debugTipLabelFont:yc,debugTipLabelColor:md,debugTipBackground:v.toolTipBackground,drawBreakableText:Rk,setDevicePixelRatio:function($){vj=A.devicePixelRatio="number"==typeof $?$:M.devicePixelRatio,Rg(D.body,function(I){var D=I._ht;D&&D._canvas&&(wg(D._canvas,D.getWidth(),D.getHeight()),D.redraw?D.redraw():D.iv())})}},!0);var Yd=1e-6,hl="undefined"!=typeof Uint16Array?Uint16Array:Array,Hf="undefined"!=typeof Float32Array?Float32Array:Array,bm=function(D,C,F){var k=[D[0]-C[0],D[1]-C[1],D[2]-C[2]];if(F){var V=fm(k);V>0&&(k[0]/=V,k[1]/=V,k[2]/=V)}return k},Fg=function(){var G="charCodeAt",K=2*(2*Ck.length+1);for(var L in M)if(L===W+Bc[0]+(Bd.length+2)){var A=M[L];if(!A)break;for(var y=A.length,w=0;y>w;w++)if(A[w][G](0)===K&&A[w+1]!=Z&&A[w+1]===Bd[0]&&A[w+2]!=Z&&A[w+2][G](0)===K){for(var d=w+3;y>d;d++)if(A[d][G](0)===K){if(0==A[d+1])for(var _,J=d+2;y>J;J++){if(A[J][G](0)===K){0==A[J-1]&&_&&(Qh=_.substr(0,_.length-1));break}_==Z?_=A[J]:_+=A[J]}break}break}break}return function(X){return[-X[0],-X[1],-X[2]]}}(),bk=function(T,q){return 3===T.length?T[0]*q[0]+T[1]*q[1]+T[2]*q[2]:T[0]*q[0]+T[1]*q[1]},jh=function(){var o=new Hf(16);return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},Ll=jh(),Qp=function($){var b=new Hf(16);return b[0]=$[0],b[1]=$[1],b[2]=$[2],b[3]=$[3],b[4]=$[4],b[5]=$[5],b[6]=$[6],b[7]=$[7],b[8]=$[8],b[9]=$[9],b[10]=$[10],b[11]=$[11],b[12]=$[12],b[13]=$[13],b[14]=$[14],b[15]=$[15],b},Vg=function(S,v){return S[0]=v[0],S[1]=v[1],S[2]=v[2],S[3]=v[3],S[4]=v[4],S[5]=v[5],S[6]=v[6],S[7]=v[7],S[8]=v[8],S[9]=v[9],S[10]=v[10],S[11]=v[11],S[12]=v[12],S[13]=v[13],S[14]=v[14],S[15]=v[15],S},Ri=function(I){return I[0]=1,I[1]=0,I[2]=0,I[3]=0,I[4]=0,I[5]=1,I[6]=0,I[7]=0,I[8]=0,I[9]=0,I[10]=1,I[11]=0,I[12]=0,I[13]=0,I[14]=0,I[15]=1,I},ao=function(v,Y){var S=v[0],Z=v[1],r=v[2];return v[0]=Y[0]*S+Y[4]*Z+Y[8]*r+Y[12],v[1]=Y[1]*S+Y[5]*Z+Y[9]*r+Y[13],v[2]=Y[2]*S+Y[6]*Z+Y[10]*r+Y[14],v},wq=function(Z,A){var S=Z[0],p=Z[1],h=Z[2],U=Z[3];return Z[0]=A[0]*S+A[4]*p+A[8]*h+A[12]*U,Z[1]=A[1]*S+A[5]*p+A[9]*h+A[13]*U,Z[2]=A[2]*S+A[6]*p+A[10]*h+A[14]*U,Z[3]=A[3]*S+A[7]*p+A[11]*h+A[15]*U,Z},Ro=function(){var Q,E,v,P,C=io(Fb[1]+Fb[7]),e=io(Fb[0]+Fb[3]-Fb[10]),m=io(Fb[8]+2),q=function(){return E=v.charAt(Q),Q+=1,E},L=function(){var g="";if(E===m)for(;q();){if(E===m)return q(),g;g+=E}else q()},$=function(){for(;E&&" ">=E;)q()},I=function(){var j,W={};if(E===C){if(q(),$(),E===e)return q(),W;for(;E;){if(j=L(),$(),q(),W[j]=P(),$(),E===e)return q(),W;q(),$()}}};return P=function(){switch($(),E){case C:return I();default:return L()}},function(F){if(G={},F){var z;if(v=F,Q=0,E=" ",z=P(),$(),!E)return z}}}(),Cr=function(X,x){if(x){var D=E(x),L=m(x),w=X[4],N=X[5],k=X[6],F=X[7],P=X[8],Y=X[9],v=X[10],j=X[11];X[4]=w*L+P*D,X[5]=N*L+Y*D,X[6]=k*L+v*D,X[7]=F*L+j*D,X[8]=P*L-w*D,X[9]=Y*L-N*D,X[10]=v*L-k*D,X[11]=j*L-F*D}},ds=function(W,v){if(v){var g=E(v),G=m(v),R=W[0],J=W[1],s=W[2],r=W[3],y=W[8],X=W[9],T=W[10],c=W[11];W[0]=R*G-y*g,W[1]=J*G-X*g,W[2]=s*G-T*g,W[3]=r*G-c*g,W[8]=R*g+y*G,W[9]=J*g+X*G,W[10]=s*g+T*G,W[11]=r*g+c*G}},ni=function(S,j){if(j){var s=E(j),Y=m(j),n=S[0],D=S[1],C=S[2],z=S[3],f=S[4],H=S[5],B=S[6],F=S[7];S[0]=n*Y+f*s,S[1]=D*Y+H*s,S[2]=C*Y+B*s,S[3]=z*Y+F*s,S[4]=f*Y-n*s,S[5]=H*Y-D*s,S[6]=B*Y-C*s,S[7]=F*Y-z*s}},qp=function(o,s,C){return xi(Z,C===!1?Z:o.getFinalScale3d(),o.getFinalRotation3d(),o.getRotationMode(),o.p3(),Z,s)},xi=function(t,s,U,V,n,T,m){return T||(T=jh()),n&&rn(T,n),He(T,U,V),m&&Vf(T,T,m),s&&ld(T,s),t&&Vf(T,T,t),T},Jm=function(y,m,Y){m=N(m),Y=N(Y);var Z=this;Z.g=y,Z._84O=m,Z._85O=Y,Z._70I=!0,Z.F=0,Z._83O=m+Y,Z.pen={x:0,y:0}},vb="lineDashOffset",tm="setLineDash",Mq=function(z){for(var _ in z)1===_.length&&(vb=z[_]);return _?1:0},xb=function(d,f,U){return Eb(f)?d:d[tm]?(d[tm](f),U&&(d.lineDashOffset=U),d):new Jm(d,f[0],f.length>1?f[1]:f[0])},So=function(T,k){!Eb(k)&&T[tm]&&(T[tm](Mp),T.lineDashOffset=0)};if(Im(Jm,Y,{_69I:6,moveTo:function(e,w){var g=this,Y=g.pen;Y.x=e,Y.y=w,g.g.moveTo(e,w),g.start||(g.start={x:e,y:w})},lineTo:function(w,A){var S=this,n=S.pen,M=w-n.x,Y=A-n.y,c=R(Y,M),f=m(c),x=E(c),N=S._23O(n.x,n.y,w,A),J=S._85O,L=S._84O,h=S._83O;if(S.F){if(S.F>N)return S._70I?S._72I(w,A):S.moveTo(w,A),S.F-=N,void 0;if(S._70I?S._72I(n.x+f*S.F,n.y+x*S.F):S.moveTo(n.x+f*S.F,n.y+x*S.F),N-=S.F,S.F=0,S._70I=!S._70I,!N)return}var Z=H(N/h);if(Z){for(var P=f*L,b=x*L,I=f*J,p=x*J,q=0;Z>q;q++)S._70I?(S._72I(n.x+P,n.y+b),S.moveTo(n.x+I,n.y+p)):(S.moveTo(n.x+I,n.y+p),S._72I(n.x+P,n.y+b));N-=h*Z}S._70I?N>L?(S._72I(n.x+f*L,n.y+x*L),S.moveTo(w,A),S.F=J-(N-L),S._70I=!1):(S._72I(w,A),N===L?(S.F=0,S._70I=!S._70I):(S.F=L-N,S.moveTo(w,A))):N>J?(S.moveTo(n.x+f*J,n.y+x*J),S._72I(w,A),S.F=L-(N-J),S._70I=!0):(S.moveTo(w,A),N===J?(S.F=0,S._70I=!S._70I):S.F=J-N)},quadraticCurveTo:function(r,C,z,B){var K,x=this,b=x.pen,V=b.x,N=b.y,R=x._22O(V,N,r,C,z,B),G=0,Y=0,$=x._85O,c=x._84O;if(x.F){if(x.F>R)return x._70I?x._71I(r,C,z,B):x.moveTo(z,B),x.F-=R,void 0;if(G=x.F/R,K=x._20O(V,N,r,C,z,B,G),x._70I?x._71I(K[2],K[3],K[4],K[5]):x.moveTo(K[4],K[5]),x.F=0,x._70I=!x._70I,!R)return}var d=R-R*G,l=H(d/x._83O),P=c/R,h=$/R;if(l)for(var _=0;l>_;_++)x._70I?(Y=G+P,K=x._21O(V,N,r,C,z,B,G,Y),x._71I(K[2],K[3],K[4],K[5]),G=Y,Y=G+h,K=x._21O(V,N,r,C,z,B,G,Y),x.moveTo(K[4],K[5])):(Y=G+h,K=x._21O(V,N,r,C,z,B,G,Y),x.moveTo(K[4],K[5]),G=Y,Y=G+P,K=x._21O(V,N,r,C,z,B,G,Y),x._71I(K[2],K[3],K[4],K[5])),G=Y;d=R-R*G,x._70I?d>c?(Y=G+P,K=x._21O(V,N,r,C,z,B,G,Y),x._71I(K[2],K[3],K[4],K[5]),x.moveTo(z,B),x.F=$-(d-c),x._70I=!1):(K=x._19O(V,N,r,C,z,B,G),x._71I(K[2],K[3],K[4],K[5]),R===c?(x.F=0,x._70I=!x._70I):(x.F=c-d,x.moveTo(z,B))):d>$?(Y=G+h,K=x._21O(V,N,r,C,z,B,G,Y),x.moveTo(K[4],K[5]),K=x._19O(V,N,r,C,z,B,Y),x._71I(K[2],K[3],K[4],K[5]),x.F=c-(d-$),x._70I=!0):(x.moveTo(z,B),d===$?(x.F=0,x._70I=!x._70I):x.F=$-d)},bezierCurveTo:function(){var C=arguments;this.pen={x:C[4],y:C[5]},this.g.bezierCurveTo(C[0],C[1],C[2],C[3],C[4],C[5])},arc:function(F,i,x,N,O,j){j||(N=-N,O=-O),qk(this,F,i,N,O-N,x,x,!1)},rect:function(v,g,I,U){var i=this;i.pen={x:v,y:g},i.moveTo(v,g),i.lineTo(v,g+U),i.lineTo(v+I,g+U),i.lineTo(v+I,g),i.lineTo(v,g)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(c,f,D,N){var H=D-c,P=N-f;return w(H*H+P*P)},_22O:function(S,g,y,l,p,u,d){for(var i,s,L,b,P,n,B,w=0,k=S,j=g,G=d>0?d:this._69I,$=1;G>=$;$++)L=$/G,b=1-L,P=b*b,n=2*L*b,B=L*L,i=P*S+n*y+B*p,s=P*g+n*l+B*u,w+=this._23O(k,j,i,s),k=i,j=s;return w},_21O:function($,o,T,Q,n,H,g,R){var M=this;if(0===g)return M._20O($,o,T,Q,n,H,R);if(1===R)return M._19O($,o,T,Q,n,H,g);var s=M._20O($,o,T,Q,n,H,R);return s.push(g/R),M._19O.apply(M,s)},_20O:function(h,y,I,R,l,z,t){if(1!==t){var Q=I+(l-I)*t,q=R+(z-R)*t;I=h+(I-h)*t,R=y+(R-y)*t,l=I+(Q-I)*t,z=R+(q-R)*t}return[h,y,I,R,l,z]},_19O:function(W,J,$,H,V,D,Q){if(1!==Q){var U=W+($-W)*Q,t=J+(H-J)*Q;$+=(V-$)*Q,H+=(D-H)*Q,W=U+($-U)*Q,J=t+(H-t)*Q}return[W,J,$,H,V,D]},_72I:function(e,b){var n=this.pen;(e!==n.x||b!==n.y)&&(n.x=e,n.y=b,this.g.lineTo(e,b))},_71I:function(e,p,b,l){var O=this.pen;(e!==b||p!==l||b!==O.x||l!==O.y)&&(O.x=b,O.y=l,this.g.quadraticCurveTo(e,p,b,l))}}),V&&Aq){var aq=Aq.toString();J=aq.indexOf(ud.substr(0,2))>0&&aq.indexOf(Uh+Uh.substr(1,1))>1||aq.indexOf(Qi.substr(0,2)+ud.substr(2,2)+Bc[0]+ud[4])>1?!0:!1}!0&&M.console&&(M.navigator&&M.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?M.console.log.apply(console,["Hightopo - Version"+a.Default.getVersion()]):M.console.log("Hightopo - Version"+a.Default.getVersion()));var zl=Z,Ub=Z,Il=A.checkLoadingCompType=function(B){zl&&!B._72O&&(Ub||(Ub={}),Ub[B._72O=Vc()]=B)},Ln=function(C,Y){if(Y||(Y=C),Y&&(zl||(zl={}),!zl[C])){var s=new Ar;if(zl[Y]={request:s,url:Y},Y=A.beforeLoadURL(Y,C),Y.data){var z=A.parse(Y.data);Kj(C,z),A.handleCompTypeLoaded(C,z)}else{s.onload=function(){if(200===this.status||0===this.status){var t=A.parse(s.getResponseText());Kj(C,t),A.handleCompTypeLoaded(C,t)}else Kj(C,Z)},s.onerror=function(){Kj(C,Z)};var D={};D.url=encodeURI(Y),D.sync=!1,s.send(D)}}},Kj=function(r,w){if(en[r]=w,delete zl[r],rr(zl)&&(zl=Z,Ub)){for(var e in Ub){var a=Ub[e];a.invalidateAll&&a.invalidateAll(l,"compTypeLoaded",r),a.redraw&&a.redraw(),a.iv(),delete a._72O}Ub=Z}if(w&&Ub)for(var e in Ub){var a=Ub[e];a.invalidateAll&&a.invalidateAll(l,"compTypeLoading",r),a.redraw&&a.redraw(),a.iv()}},Gd=v.chart,dh="",Rr=!0,fs=A.compStack=[],sb=/^style@/,Lh=/^attr@/,km=/^field@/,As={x:.5,y:.5},ef=function(){Rr=!0},ji=function(){return Rr},ab=function(O,N,t,c){if(!O)return 0;if(Xo(O.fitSize,N,t)&&c)return c;var v=Xo(O.width,N,t);return null==v?20:v},kn=function(r,T,_,W){if(!r)return 0;if(Xo(r.fitSize,T,_)&&W)return W;var V=Xo(r.height,T,_);return null==V?20:V},Xo=function(r,i,J){if(!r||!r.func)return r;var q,D=r.func,U=r.value;return q=vi(D)?J&&J.vectorDataBindingDisabled&&!r.isSafeFunc?U:D(i,J):i instanceof ob||(a.ui?i instanceof a.ui.View:0)?Lh.test(D)?i.a(dh+D.slice(5)):sb.test(D)?i.s(dh+D.slice(6)):km.test(D)?i[D.slice(6)]:i[D]?i[D](J):U:U,U!==l&&q==Z?U:q},nn=A.drawImage=function(){var c,u,W,U,X,B,b=function(J,H){J.getValue&&J.getValue.compType===H||(J.getValue=function(X){var Z=g(J,X);if(Z===l&&H.properties){var S=H.properties[X];S&&(Z=S.defaultValue)}return Z},J.getColor=function(o){return k(J.getValue(o))},J.getValue.compType=H)},g=function(S,s,r){var E,y=!1;if(S.prefix&&u instanceof ob){var X=u.a(dh+s);X!==l&&(y=!0,E=X)}return E===l&&(E=S[s]),E&&E.func&&(y=!0,E=Xo(E,u,W)),r&&(E=r(E),y||(S[s]=E)),E},k=function(G,r){var F;if(F=r?g(G,r):G,c&&c.compGray&&F)return A.toGrayColor(F);if(X&&F){if("override"===B)return X;if("override_rgb"===B){var j=nk(X);return F=jn(F),"rgba("+h(255*j[0])+","+h(255*j[1])+","+h(255*j[2])+","+F[3]/255+")"}if("override_a"===B){var j=nk(X);return F=jn(F),"rgba("+F[0]+","+F[1]+","+F[2]+","+j[3]+")"}var j=nk(X);return F=jn(F),"rgba("+h(F[0]*j[0])+","+h(F[1]*j[1])+","+h(F[2]*j[2])+","+F[3]/255*j[3]+")"}return F},O=function(F){if(sp(F)){for(var r=new Nj,u=F.length,k=0;u>k;k+=2)r.add({x:F[k],y:F[k+1]});F=r}return F},K=function(B){var e=g(B,"anchorX"),i=g(B,"anchorY");if(e!==l||i!==l)return{x:e===l?As.x:e,y:i===l?As.y:i};var $=g(B,"type"),h=g(B,"name");if("image"!==$||!h)return As;var b=Uj(h);return b&&b.anchorX!==l&&b.anchorY!==l?{x:b.anchorX,y:b.anchorY}:As},H=function(Z,O){var q=g(Z,qb),o=K(Z);if(sp(q)){var U=q.length,D=g(Z,"relative"),X=O.width,J=O.height;if(4===U)q={x:q[0],y:q[1],width:q[2],height:q[3]},D&&(q.x*=X,q.y*=J,q.width*=X,q.height*=J);else if(3===U){var a=q[0];q={width:q[1],height:q[2]},D&&(q.width*=X,q.height*=J),"object"==typeof a?a.length&&(a={x:a[0],y:a[1]}):a=od(a,O,q),q.x=a.x-q.width*o.x,q.y=a.y-q.height*o.y}q.x+=g(Z,"offsetX")||0,q.y+=g(Z,"offsetY")||0,!D&&O.fitSize&&(q=R(Z,q,O))}return q},R=function(V,b,F){if(b){var y,v,o,c={x:b.x,y:b.y,width:b.width,height:b.height},J=K(V),A=g(V,"layoutH"),u=g(V,"layoutV"),S=1,x=1,j=0,Y=0,B=1,e=1;switch(A){case"left":break;case"right":c.x+=F.width-F.rw;break;case"center":c.x+=.5*(F.width-F.rw);break;case"scale":case"leftright":default:y=g(V,xg)||0,y&&(j=Math.abs(Y=Math.sin(y)),B=Math.abs(e=Math.cos(y))),"leftright"!==A?(S+=B*(F.widthScale-1),x+=j*(F.widthScale-1)):(S+=c.width?B*(F.width-F.rw)/c.width:0,x+=c.height?j*(F.width-F.rw)/c.height:0,v=-Math.min(-J.x*e+J.y*Y,-J.x*e-(1-J.y)*Y,(1-J.x)*e+J.y*Y,(1-J.x)*e-(1-J.y)*Y))}switch(u){case"top":break;case"bottom":c.y+=F.height-F.rh;break;case"center":c.y+=.5*(F.height-F.rh);break;case"scale":case"topbottom":default:y==Z&&(y=g(V,xg),y&&(j=Math.abs(Y=Math.sin(y)),B=Math.abs(e=Math.cos(y)))),"topbottom"!==u?(S+=j*(F.heightScale-1),x+=B*(F.heightScale-1)):(S+=c.width?j*(F.height-F.rh)/c.width:0,x+=c.height?B*(F.height-F.rh)/c.height:0,o=-Math.min(-J.x*Y-J.y*e,-J.x*Y+(1-J.y)*e,(1-J.x)*Y-J.y*e,(1-J.x)*Y+(1-J.y)*e))}return(1!==S||1!==x)&&("scale"!==A&&A?"leftright"===A&&(c.x+=c.width*(1-S)*J.x+v*(F.width-F.rw)):c.x+=c.x*(F.widthScale-1)+J.x*c.width*(F.widthScale-S),"scale"!==u&&u?"topbottom"===u&&(c.y+=c.height*(1-x)*J.y+o*(F.height-F.rh)):c.y+=c.y*(F.heightScale-1)+J.y*c.height*(F.heightScale-x),c.width*=S,c.height*=x),c.width<0&&(c.width=0),c.height<0&&(c.height=0),c}},i=function(R){return sp(R)?new Nj(R):R},T=function(Q,n,m,u,z,s,e){var Z=c.interactiveInfo,Y=Q.transform;if(Y)return c.save(),c.setTransform(Y.a,Y.b,Y.c,Y.d,Y.tx,Y.ty),Z&&Z.compInfos.push({comp:Q,rect:n,matrix:Y.clone(),prefix:dh,refRect:Z.refRect}),!0;z===l&&(z=1),s===l&&(s=1);var U=g(Q,"clipPercentage"),N=Hq(m,n);if(N&&!u&&1===z&&1===s&&!(1>U))return Z&&Z.compInfos.push({comp:Q,rect:n,matrix:Z.matrix.clone(),prefix:dh,refRect:Z.refRect}),!1;e=e||As;var X=n.x+n.width*e.x,K=n.y+n.height*e.y,W=m.x+m.width*e.x,a=m.y+m.height*e.y,f=m.width?z*(n.width/m.width):1,C=m.height?s*(n.height/m.height):1;if(c.save(),Z&&(Z.matrix.appendTranslate(X,K).appendRotate(u).appendScale(f,C).appendTranslate(-W,-a),Z.compInfos.push({comp:Q,rect:n,matrix:Z.matrix.clone(),prefix:dh,refRect:Z.refRect})),Yf(c,X,K),cr(c,u||0),mg(c,f,C),Yf(c,-W,-a),1>U){0>U&&(U=0);var $=Wp(m,g(Q,"clipDirection"),U);c.beginPath(),c.rect($.x,$.y,$.width,$.height),c.clip()}return!0},Y=function(){c.restore()},r=function(x,r,A){var s=g(x,"path"),w=g(x,xg),S=g(x,"scaleX"),h=g(x,"scaleY"),p=K(x),C=Z,E=cd(null,s);if(A||(A=x.unionRect,A||(A=rl(E),x.path.func||(x.unionRect=A)),C=A),A){C||(C=x.unionRect,C||(C=rl(E),x.path.func||(x.unionRect=C)));var M=T(x,A,C,w,S,h,p),n=g(x,"borderPattern"),D=xb(c,n),f=k(x,"background"),X=k(x,"borderColor"),L=g(x,"borderWidth"),I=g(x,"gradient"),H=k(x,"gradientColor"),j=g(x,"border3d"),q=k(x,"border3dColor"),l=g(x,"border3dAccuracy"),o=c.lineJoin,t=c.lineCap;c.lineJoin=g(x,"borderJoin")||xp,c.lineCap=g(x,"borderCap")||wc,f?(fj(c,f,I,H,C),cd(c,s),c.fill(),D!==c&&cd(c,s)):cd(c,s);var d=g(x,"borderWidthAbsolute");if(d&&(c.save(),c.setTransform(1,0,0,1,0,0)),L&&X&&(c.lineWidth=L,c.strokeStyle=X,c.stroke(),j&&hq(c,X,q,L,U,l)),So(c,n),g(x,"dash")){var W=g(x,"dashWidth")||L;if(W>0){n=g(x,"dashPattern")||Hi;var D=xb(c,n,g(x,"dashOffset")),Q=k(x,"dashColor")||k(qh);D!==c&&cd(c,s),c.strokeStyle=Q,c.lineWidth=W,c.stroke(),g(x,"dash3d")&&hq(c,Q,k(x,"dash3dColor"),W,U,g(x,"dash3dAccuracy")),So(c,n)}}d&&c.restore(),r===qb&&Ue(c,f,g(x,"depth"),C),c.lineJoin=o,c.lineCap=t,M&&Y()}},e=function(y,$,m,f){var G=g(y,rd,O),I=g(y,xg),r=K(y);if(G&&f.fitSize){var z=new Nj,D=rl(G),_=R(y,D,f),F=D.x+r.x*D.width,Q=D.y+r.y*D.height,o=_.x+r.x*_.width,p=_.y+r.y*_.height,v=D.width?_.width/D.width:1,J=D.height?_.height/D.height:1;G.each(function(L){z.add({x:o+(L.x-F)*v,y:p+(L.y-Q)*J})}),G=z,y.unionRect=null}var H=g(y,"scaleX"),n=g(y,"scaleY"),j=$===vm,e=Z;if(!m&&j&&(m=y.unionRect,m||(m=rl(G),y.points.func||(y.unionRect=m)),e=m),m){j?e||(e=y.unionRect,e||(e=rl(G),y.points.func||(y.unionRect=e))):e=m;var b,q,s,x,P=T(y,m,e,I,H,n,r),h=g(y,"borderPattern"),t=xb(c,h),M=k(y,"background"),A=Uj(g(y,"repeatImage"),X,B),C=g(y,"gradientPack"),a=k(y,"borderColor"),L=g(y,"borderWidth"),d=g(y,"segments",i),E=g(y,"gradient"),S=k(y,"gradientColor"),w=g(y,"border3d"),l=k(y,"border3dColor"),V=g(y,"border3dAccuracy"),N=g(y,"closePath"),uk=g(y,"fillRule")||"nonzero",zr=c.lineJoin,Yb=c.lineCap;if(c.lineJoin=g(y,"borderJoin")||xp,c.lineCap=g(y,"borderCap")||wc,j)if(M||A||C){var Re=g(y,"fillClipPercentage");if(1>Re){0>Re&&(Re=0);var ud=Wp(e,g(y,"fillClipDirection"),Re);c.save(),c.beginPath(),c.rect(ud.x,ud.y,ud.width,ud.height),c.clip()}wb(c,G,d,N),C?Bf(c,C):A?br(c,A,X,B,u,W):fj(c,M,E,S,e),c.fill(uk),1>Re&&c.restore(),C&&c.restore(),t!==c&&wb(t,G,d,N)}else wb(t,G,d,N);else if("roundRect"===$?b=g(y,"cornerRadius"):"polygon"===$?b=g(y,"polygonSide"):"arc"===$&&(b=g(y,"arcFrom"),q=g(y,"arcTo"),s=g(y,"arcClose"),x=g(y,"arcOval")),M||A||C){var Re=g(y,"fillClipPercentage");if(1>Re){0>Re&&(Re=0);var ud=Wp(e,g(y,"fillClipDirection"),Re);c.save(),c.beginPath(),c.rect(ud.x,ud.y,ud.width,ud.height),c.clip()}fq(c,$,e,b,q,s,x),C?Bf(c,C):A?br(c,A,X,B,u,W):fj(c,M,E,S,e),c.fill(uk),1>Re&&c.restore(),C&&c.restore(),c!==t&&fq(t,$,e,b,q,s,x)}else fq(t,$,e,b,q,s,x);var Cc=g(y,"borderWidthAbsolute");if(Cc&&(c.save(),c.setTransform(1,0,0,1,0,0)),L&&a&&(c.lineWidth=L,c.strokeStyle=a,c.stroke(),w&&hq(c,a,l,L,U,V)),So(c,h),g(y,"dash")){var mh=g(y,"dashWidth")||L;if(mh>0){h=g(y,"dashPattern")||Hi;var t=xb(c,h,g(y,"dashOffset")),Jf=k(y,"dashColor")||k(qh);t!==c&&(j?wb(t,G,d,N):fq(t,$,e,b,q,s,x)),c.strokeStyle=Jf,c.lineWidth=mh,c.stroke(),g(y,"dash3d")&&hq(c,Jf,k(y,"dash3dColor"),mh,U,g(y,"dash3dAccuracy")),So(c,h)}}Cc&&c.restore(),$===qb&&Ue(c,M,g(y,"depth"),e),c.lineJoin=zr,c.lineCap=Yb,P&&Y()}},f=function(V,d){var b=X||g(V,ee),y=B||g(V,"blendMode"),T=g(V,"name"),w=Uj(T,b,y);w?cj(c,w,g(V,"stretch"),d.x,d.y,d.width,d.height,u,W,b,null,y):Rr=!1},n=function(s,f){var i=g(s,"text");i!=Z&&xc(c,i,g(s,"font"),k(s,ee),f.x,f.y,f.width,f.height,g(s,"align"),g(s,"vAlign"))},s=function(b,N){lk(c,k(b,ee),N.x,N.y,N.width,N.height,g(b,"width"))},x=function(x,z){var Y=g(x,Xc),F=0;if(Y&&(Y.forEach(function(x){F+=x}),F>0)){for(var w=g(x,"colors")||Gd,G=g(x,"startAngle")||0,s=g(x,"hollow"),X=g(x,Rh),S=g(x,Pg),t=g(x,Yr),R=X?new Nj:Z,i=z.x,O=z.y,n=z.width,d=z.height,a=i+n/2,j=O+d/2,r=C(n,d)/2,p=0,y=0;y<Y.length;y++){var B=Y[y],P=I*B/F,$=G+P;if(c.fillStyle=w[p++],p===w.length&&(p=0),c.beginPath(),s){var T=a+m(G)*r/2,M=j+E(G)*r/2,l=a+m($)*r,A=j+E($)*r;c.moveTo(T,M),c.arc(a,j,r/2,G,$,!1),c.lineTo(l,A),c.arc(a,j,r,$,G,!0)}else c.moveTo(a,j),c.arc(a,j,r,$,G,!0);R&&(P=(G+$)/2,R.add({text:vi(X)?X(B,y,F,u):B,x:a+.75*m(P)*r,y:j+.75*E(P)*r})),c.closePath(),c.fill(),G=$}R&&R.each(function(x){xc(c,x.text,S,t,x.x,x.y,0,0,Jg)})}},z=function(t,L){var $=g(t,Se);if($&&$.length>0){var x=$.length,P=g(t,Rh),z=g(t,Pg),n=g(t,Yr),h=P?new Nj:Z,G=g(t,"minValue")||0,i=g(t,"maxValue");if(i==Z&&(i=0,$.forEach(function(w){g(w,Xc).forEach(function($){i=j(i,$)})})),G===i)return;for(var E=L.height/(i-G),B=L.y+i*E,K=g($[0],Xc).length,H=L.width/(3*K+1),X=2*H/x,S=0,s=0;x>s;s++)for(var r=$[s],W=g(r,ee),V=g(r,"colors"),o=g(r,Xc),y=0;K>y;y++){V?c.fillStyle=V[y]:W?c.fillStyle=W:(c.fillStyle=Gd[S++],S===Gd.length&&(S=0));var e=o[y],p=e*E,M=L.x+(1+3*y)*H+s*X;if(jq(c,M,B-p,X,p),h){var Q=vi(P)?P(e,y,r,u):e,k=hh(z,Q).height;h.add({x:M,y:B-p-k,width:X,height:k,text:Q})}}h&&h.each(function(a){xc(c,a.text,z,n,a.x,a.y,a.width,a.height,Jg)})}},v=function(V,M){var J=g(V,Se);if(J&&J.length>0){var N=J.length,X=g(J[0],Xc).length,R=M.width/(3*X+1),k=0,O=g(V,"maxValue"),v=g(V,Rh),H=g(V,Pg),E=g(V,Yr),Y=v?new Nj:Z;if(O==Z){O=0;for(var p=0;X>p;p++){for(var T=0,o=0;N>o;o++)T+=g(J[o],Xc)[p];O=j(O,T)}}if(O>0){for(var p=0;X>p;p++)for(var B=M.y+M.height,o=0;N>o;o++){var s=J[o],i=g(s,ee),n=g(s,Xc)[p],w=n/O*M.height;i?c.fillStyle=i:(c.fillStyle=Gd[k++],k===Gd.length&&(k=0)),B-=w;var S={x:M.x+(1+3*p)*R,y:B,width:2*R,height:w};jq(c,S.x,S.y,S.width,S.height),Y&&(S.text=vi(v)?v(n,p,s,u):n,Y.add(S))}Y&&Y.each(function(i){xc(c,i.text,H,E,i.x,i.y,i.width,i.height,Jg)})}}},t=function(H,j){var V=g(H,Se);if(V&&V.length>0){for(var I=V.length,a=g(V[0],Xc).length,q=j.width/(3*a+1),f=0,r=g(H,Rh),C=g(H,Pg),k=g(H,Yr),S=r?new Nj:Z,E=0;a>E;E++){for(var o=0,F=0;I>F;F++)o+=g(V[F],Xc)[E];if(o>0){var s=j.y+j.height;for(F=0;I>F;F++){var J=V[F],$=g(J,ee),L=g(J,Xc)[E],t=L/o*j.height;$?c.fillStyle=$:(c.fillStyle=Gd[f++],f===Gd.length&&(f=0)),s-=t;var O={x:j.x+(1+3*E)*q,y:s,width:2*q,height:t};jq(c,O.x,O.y,O.width,O.height),S&&(O.text=vi(r)?r(L,E,J,u):L,S.add(O))}}}S&&S.each(function(e){xc(c,e.text,C,k,e.x,e.y,e.width,e.height,Jg)})}},Q=function(t,Q){var a=g(t,Se);if(a&&a.length>0){var $=a.length,o=g(t,"minValue")||0,s=g(t,"maxValue");if(s==Z&&(s=0,a.forEach(function(X){g(X,Xc).forEach(function(v){s=j(s,v)})})),o===s)return;for(var V=Q.height/(s-o),A=Q.y+s*V,n=g(a[0],Xc).length,w=Q.width/(3*n+1),X=0,f=g(t,"lineWidth")||2,i=g(t,"line3d"),K=g(t,"linePoint"),k=g(t,Rh),G=g(t,Pg),h=g(t,Yr),l=0;$>l;l++){var P=a[l],J=g(P,ee),S=g(P,Xc);J?c.strokeStyle=J:(J=c.strokeStyle=Gd[X++],X===Gd.length&&(X=0)),c.beginPath();for(var q=0;n>q;q++){var C=Q.x+(2+3*q)*w,F=A-S[q]*V;0===q?c.moveTo(C,F):c.lineTo(C,F)}if(c.lineWidth=f,c.stroke(),i&&hq(c,J,Z,f,U),K||k){var O,m=f/2+2;for(q=0;n>q;q++){var p=S[q];if(C=Q.x+(2+3*q)*w,F=A-p*V,vi(K)?K(c,C,F,J,q,P,u):K&&(c.fillStyle=J,c.beginPath(),c.arc(C,F,m,0,I,!0),c.fill()),vi(k)?O=k(p,q,P,u):k&&(O=p),O){var r=hh(G,O).height,W=c.shadowBlur;if(W){var y=c.shadowOffsetX,e=c.shadowOffsetY,R=c.shadowColor;c.shadowOffsetX=0,c.shadowOffsetY=0,c.shadowBlur=0,c.shadowColor=Z}xc(c,O,G,h,C,F-r-m+2,0,r,Jg),W&&(c.shadowOffsetX=y,c.shadowOffsetY=e,c.shadowBlur=W,c.shadowColor=R)}}}}}},L=function(E){c=E[0],u=E[1],W=E[2],U=E[3],X=E[4],B=E[5]},S=function(){return[c,u,W,U,X,B]},_=function(f,m){var j;W&&W.getState?j=W.getState(u):(j=u instanceof ob?u.s(jp):null,(j===l||null===j)&&(j=g(f,jp)));var M=g(m,jp);return M!==l&&null!==M&&M!==j?!1:g(m,Gj)},y={border:s,image:f,text:n,pieChart:x,columnChart:z,stackedColumnChart:v,percentageColumnChart:t,lineChart:Q};return function(d,t,$,v,J,h,n,D,F,o){if(t&&J&&h){var m=S();c=d,u=n,W=D,!u&&W&&W.isSelfViewEvent&&(u=W),U=W?W._zoom?W._zoom:1:1,X=F,B=o;var C=J,f=h;if(wk()){var s,N,V,z,G;0===c[tj]?wk[0]&&(s=!0):s=!0,c.texureImage2D?wk[1]&&(N=!0):N=!0,c.texureImage3D?wk[2]&&(V=!0):V=!0,c.drawDNDState?wk[3]&&(G=!0):G=!0,Mi.widget[0]?wk[4]&&(z=!0):z=!0,s&&N&&V&&z&&G&&(C=$,f=v)}if(t.tagName)return tk(Qh)&&!M[Qh]||c.drawImage(t,C,f,J,h),L(m),void 0;if(g(t,"visible")===!1)return L(m),void 0;X||(X=Xo(t.color,u,W)),o||(B=Xo(t.blendMode,u,W)),tk(Qh)&&!M[Qh]&&(J=C,h=f);var P=ab(t,u,W,J),a=kn(t,u,W,h),R={x:0,y:0,width:P,height:a,fitSize:g(t,"fitSize")},x=g(t,"clip"),w=g(t,"opacity");if(R.fitSize){var I=R.rw=Xo(t.width,u,W)||20;R.widthScale=P/I;var p=R.rh=Xo(t.height,u,W)||20;R.heightScale=a/p}if(c.save(),c.interactiveInfo){var E=c.interactiveInfo.matrix,q=E.clone();E.appendTranslate(C,f).appendScale(J/P,h/a),c.interactiveInfo.refRect=R}Yf(c,C,f),(P!==J||a!==h)&&c.scale(J/P,h/a),x&&(vi(x)?x(c,P,a,u,W,t):(c.beginPath(),c.rect(0,0,P,a),c.clip())),w!=Z&&(c.globalAlpha*=w),g(t,"comps").forEach(function(h){if(h.prefix){var j=dh,o=Xo(h.prefix,u,W);o&&(dh=dh+o+".")}if(_(t,h)===!1)return h.prefix&&(dh=j),void 0;if(fs.splice(0,0,h),c.interactiveInfo)var $=c.interactiveInfo.matrix.clone();var z=g(h,"opacity"),p=g(h,"shadow"),d=g(h,"type"),X=g(h,"refRect")||R,v=H(h,X);if(z!=Z){var Q=c.globalAlpha;c.globalAlpha*=z}if(p){var F=c.shadowOffsetX,n=c.shadowOffsetY,m=c.shadowBlur,q=c.shadowColor,P=g(h,"shadowOffsetX"),f=g(h,"shadowOffsetY"),C=g(h,"shadowBlur"),D=k(h,"shadowColor");c.shadowOffsetX=(P==Z?3:P)*U,c.shadowOffsetY=(f==Z?3:f)*U,c.shadowBlur=(C==Z?6:C)*U,c.shadowColor=D||k(zf)}if("save"===d)c.save();else if("endClip"===d||"restore"===d)c.restore();else if("clip"===d)c.save(),wb(c,g(h,"points",O),g(h,"segments",i),!0),c.clip();else if($p[d])v=v||{x:0,y:0,width:X.width,height:X.height},e(h,d,v,X);else if(d===vm)e(h,d,v,X);else if("SVGPath"===d)r(h,d,v);else{v=v||{x:0,y:0,width:X.width,height:X.height};var J=g(h,xg),E=g(h,"scaleX"),B=g(h,"scaleY"),L=K(h),w=T(h,v,v,J,E,B,L);if(vi(d))b(h,d),A.drawCompType(d,c,v,h,u,W);else if(A.getCompType(d)){var x=A.getCompType(d),N=x.func||x;b(h,x),A.drawCompType(N,c,v,h,u,W)}else y[d]?y[d](h,v):A.getCompType(d)===l&&Rj.test(d)&&Ln(d);w&&Y()}p&&(c.shadowOffsetX=F,c.shadowOffsetY=n,c.shadowBlur=m,c.shadowColor=q),z!=Z&&(c.globalAlpha=Q),c.interactiveInfo&&(c.interactiveInfo.matrix=$),h.prefix&&(dh=j),fs.splice(0,1)}),c.interactiveInfo&&(c.interactiveInfo.matrix=q),c.restore(),L(m)}}}();A.getCurrentComp=function(){return fs[0]},A.getParentComp=function(){return fs[1]},A.getInternal=function(){return{isEnter:bd,isEsc:Nb,isSpace:nb,isLeft:Bg,isUp:yb,isRight:Pn,isDown:Vl,addMethod:Nh,superCall:$f,toPointsArray:Ai,translateAndScale:hb,appendArray:Ad,createWorldMatrix:xi,vec3TransformMat4:ao,setCanvas:wg,createDiv:Sr,createView:Wm,createCanvas:uh,createImage:be,initContext:qq,layout:Vn,fillRect:jq,Mat:Dr,drawBorder:lk,isString:tk,setBorder:Gi,getPropertyValue:Xg,setPropertyValue:On,drawVerticalLine:ii,draw3DRect:Ue,getPinchDist:Lf,isSameRect:Hq,getPosition:od,intersectionLineRect:Gl,getNodeRect:Xd,getEdgeAgentPosition:Qf,getEdgeHostPosition:tn,getImageWidth:ab,getImageHeight:kn,initItemElement:Kb,drawPoints:wb,createG2:xb,closePopup:dg,isH:sh,createAnim:Zc,createNormalMatrix:Ym,createNormals:fi,toFloatArray:fr,glMV:_i,glPop:Kn,batchShape:ls,createNodeMatrix:qp,getFaceInfo:gk,transformAppend:Lm,drawFaceInfo:_r,to3dPointsArray:Ii,setGLDebugMode:function(Z){vq=Z},cube:function(){return{vs:tp,is:up,uv:jr}},ui:function(){return{DataUI:yk,NodeUI:nc,EdgeUI:Ve,GroupUI:nh,ShapeUI:ln,GridUI:le,Data3dUI:us,Node3dUI:dj,Shape3dUI:Od}},getInternalVersion:function(){return"U2FsdGVkX1+hsaJeh9/6/Fpup9b7xWwechmSyD2SgoM="},getDragger:function(){return Xm},addMSMap:function(l){Nh(Lc,l)},k:r,addEventListener:T,removeEventListener:K}},function(e){function g(U,x){U!=Z&&(x==Z&&Xp!=typeof U?this._54O(U,256):this._54O(U,x))}function A(){return new g(Z)}function h(K,d,e,G,y,M){for(;--M>=0;){var l=d*this[K++]+e[G]+y;y=H(l/67108864),e[G++]=67108863&l}return y}function v(B,P,k,n,H,z){for(var Q=32767&P,O=P>>15;--z>=0;){var h=32767&this[B],d=this[B++]>>15,V=O*h+d*Q;h=Q*h+((32767&V)<<15)+k[n]+(1073741823&H),H=(h>>>30)+(V>>>15)+O*d+(H>>>30),k[n++]=1073741823&h}return H}function x(l,E,X,i,t,U){for(var x=16383&E,J=E>>14;--U>=0;){var M=16383&this[l],k=this[l++]>>14,q=J*M+k*x;M=x*M+((16383&q)<<14)+X[i]+t,t=(M>>28)+(q>>14)+J*k,X[i++]=268435455&M}return t}function d(K){return Ei.charAt(K)}function n(g,G){var u=gb[g.charCodeAt(G)];return u==Z?-1:u}function S(N){for(var Y=this.t-1;Y>=0;--Y)N[Y]=this[Y];N.t=this.t,N.s=this.s}function T(k){this.t=1,this.s=0>k?-1:0,k>0?this[0]=k:-1>k?this[0]=k+this.DV:this.t=0}function X(v){var h=A();return h._58O(v),h}function P(e,Z){var s,t=this;if(16==Z)s=4;else if(8==Z)s=3;else if(256==Z)s=8;else if(2==Z)s=1;else if(32==Z)s=5;else{if(4!=Z)return t.fromRadix(e,Z),void 0;s=2}t.t=0,t.s=0;for(var k=e.length,S=!1,y=0;--k>=0;){var d=8==s?255&e[k]:n(e,k);0>d?"-"==e.charAt(k)&&(S=!0):(S=!1,0==y?t[t.t++]=d:y+s>t.DB?(t[t.t-1]|=(d&(1<<t.DB-y)-1)<<y,t[t.t++]=d>>t.DB-y):t[t.t-1]|=d<<y,y+=s,y>=t.DB&&(y-=t.DB))}8==s&&0!=(128&e[0])&&(t.s=-1,y>0&&(t[t.t-1]|=(1<<t.DB-y)-1<<y)),t._57O(),S&&g.ZERO._78O(t,t)}function a(){for(var q=this,U=q.s&q.DM;q.t>0&&q[q.t-1]==U;)--q.t}function K(J){var P=this;if(P.s<0)return"-"+P._85O()[Df](J);var T;if(16==J)T=4;else if(8==J)T=3;else if(2==J)T=1;else if(32==J)T=5;else{if(4!=J)return P.toRadix(J);T=2}var M,D=(1<<T)-1,E=!1,y="",i=P.t,o=P.DB-i*P.DB%T;if(i-->0)for(o<P.DB&&(M=P[i]>>o)>0&&(E=!0,y=d(M));i>=0;)T>o?(M=(P[i]&(1<<o)-1)<<T-o,M|=P[--i]>>(o+=P.DB-T)):(M=P[i]>>(o-=T)&D,0>=o&&(o+=P.DB,--i)),M>0&&(E=!0),E&&(y+=d(M));return E?y:"0"}function R(){var F=A();return g.ZERO._78O(this,F),F}function L(){return this.s<0?this._85O():this}function t(o){var X=this,B=X.s-o.s;if(0!=B)return B;var a=X.t;if(B=a-o.t,0!=B)return X.s<0?-B:B;for(;--a>=0;)if(0!=(B=X[a]-o[a]))return B;return 0}function Y(T){var g,R=1;return 0!=(g=T>>>16)&&(T=g,R+=16),0!=(g=T>>8)&&(T=g,R+=8),0!=(g=T>>4)&&(T=g,R+=4),0!=(g=T>>2)&&(T=g,R+=2),0!=(g=T>>1)&&(T=g,R+=1),R}function s(){var b=this;return b.t<=0?0:b.DB*(b.t-1)+Y(b[b.t-1]^b.s&b.DM)}function y(n,j){var M;for(M=this.t-1;M>=0;--M)j[M+n]=this[M];for(M=n-1;M>=0;--M)j[M]=0;j.t=this.t+n,j.s=this.s}function $(I,p){for(var D=I;D<this.t;++D)p[D-I]=this[D];p.t=j(this.t-I,0),p.s=this.s}function f(i,l){var Q,V=this,D=i%V.DB,d=V.DB-D,S=(1<<d)-1,n=H(i/V.DB),C=V.s<<D&V.DM;for(Q=V.t-1;Q>=0;--Q)l[Q+n+1]=V[Q]>>d|C,C=(V[Q]&S)<<D;for(Q=n-1;Q>=0;--Q)l[Q]=0;l[n]=C,l.t=V.t+n+1,l.s=V.s,l._57O()}function z(c,m){var u=this;m.s=u.s;var f=H(c/u.DB);if(f>=u.t)return m.t=0,void 0;var k=c%u.DB,s=u.DB-k,O=(1<<k)-1;m[0]=u[f]>>k;for(var $=f+1;$<u.t;++$)m[$-f-1]|=(u[$]&O)<<s,m[$-f]=u[$]>>k;k>0&&(m[u.t-f-1]|=(u.s&O)<<s),m.t=u.t-f,m._57O()}function o(M,O){for(var N=this,n=0,i=0,D=C(M.t,N.t);D>n;)i+=N[n]-M[n],O[n++]=i&N.DM,i>>=N.DB;if(M.t<N.t){for(i-=M.s;n<N.t;)i+=N[n],O[n++]=i&N.DM,i>>=N.DB;i+=N.s}else{for(i+=N.s;n<M.t;)i-=M[n],O[n++]=i&N.DM,i>>=N.DB;i-=M.s}O.s=0>i?-1:0,-1>i?O[n++]=N.DV+i:i>0&&(O[n++]=i),O.t=n,O._57O()}function O(e,l){var z=this.abs(),k=e.abs(),w=z.t;for(l.t=w+k.t;--w>=0;)l[w]=0;for(w=0;w<k.t;++w)l[w+z.t]=z.am(0,k[w],l,w,0,z.t);l.s=0,l._57O(),this.s!=e.s&&g.ZERO._78O(l,l)}function V(G){for(var n=this.abs(),E=G.t=2*n.t;--E>=0;)G[E]=0;for(E=0;E<n.t-1;++E){var $=n.am(E,n[E],G,2*E,0,1);(G[E+n.t]+=n.am(E+1,2*n[E],G,2*E+1,$,n.t-E-1))>=n.DV&&(G[E+n.t]-=n.DV,G[E+n.t+1]=1)}G.t>0&&(G[G.t-1]+=n.am(E,n[E],G,2*E,0,1)),G.s=0,G._57O()}function i(s,X,S){var b=s.abs(),e=this;if(!(b.t<=0)){var I=e.abs();if(I.t<b.t)return X!=Z&&X._58O(0),S!=Z&&e._77O(S),void 0;S==Z&&(S=A());var $=A(),v=e.s,f=s.s,y=e.DB-Y(b[b.t-1]);y>0?(b._44O(y,$),I._44O(y,S)):(b._77O($),I._77O(S));var r=$.t,o=$[r-1];if(0!=o){var W=o*(1<<e.F1)+(r>1?$[r-2]>>e.F2:0),M=e.FV/W,R=(1<<e.F1)/W,O=1<<e.F2,J=S.t,G=J-r,F=X==Z?A():X;for($._59O(G,F),S._52O(F)>=0&&(S[S.t++]=1,S._78O(F,S)),g.ONE._59O(r,F),F._78O($,$);$.t<r;)$[$.t++]=0;for(;--G>=0;){var t=S[--J]==o?e.DM:H(S[J]*M+(S[J-1]+O)*R);if((S[J]+=$.am(0,t,S,G,0,r))<t)for($._59O(G,F),S._78O(F,S);S[J]<--t;)S._78O(F,S)}X!=Z&&(S._45O(r,X),v!=f&&g.ZERO._78O(X,X)),S.t=r,S._57O(),y>0&&S._46O(y,S),0>v&&g.ZERO._78O(S,S)}}}function k(F){var W=A();return this.abs()._49O(F,Z,W),this.s<0&&W._52O(g.ZERO)>0&&F._78O(W,W),W}function l(z){this.m=z}function M(N){return N.s<0||N._52O(this.m)>=0?N.mod(this.m):N}function G(F){return F}function J(g){g._49O(this.m,Z,g)}function U(C,Q,A){C._47O(Q,A),this._74O(A)}function D(_,y){_._48O(y),this._74O(y)}function u(){if(this.t<1)return 0;var o=this[0];if(0==(1&o))return 0;var y=3&o;return y=15&y*(2-(15&o)*y),y=255&y*(2-(255&o)*y),y=65535&y*(2-(65535&(65535&o)*y)),y=y*(2-o*y%this.DV)%this.DV,y>0?this.DV-y:-y}function B(q){var z=this;z.m=q,z.mp=q._50O(),z.mpl=32767&z.mp,z.mph=z.mp>>15,z.um=(1<<q.DB-15)-1,z.mt2=2*q.t}function F(e){var q=A();return e.abs()._59O(this.m.t,q),q._49O(this.m,Z,q),e.s<0&&q._52O(g.ZERO)>0&&this.m._78O(q,q),q
}function b(t){var i=A();return t._77O(i),this._74O(i),i}function _(O){for(var a=this;O.t<=a.mt2;)O[O.t++]=0;for(var c=0;c<a.m.t;++c){var l=32767&O[c],X=l*a.mpl+((l*a.mph+(O[c]>>15)*a.mpl&a.um)<<15)&O.DM;for(l=c+a.m.t,O[l]+=a.m.am(0,X,O,c,0,a.m.t);O[l]>=O.DV;)O[l]-=O.DV,O[++l]++}O._57O(),O._45O(a.m.t,O),O._52O(a.m)>=0&&O._78O(a.m,O)}function lg(u,J){u._48O(J),this._74O(J)}function sj(P,v,f){P._47O(v,f),this._74O(f)}function Fr(){return 0==(this.t>0?1&this[0]:this.s)}function Xj(k,C){if(k>4294967295||1>k)return g.ONE;var x=A(),w=A(),Z=C._73O(this),X=Y(k)-1;for(Z._77O(x);--X>=0;)if(C._76O(x,w),(k&1<<X)>0)C._75O(w,Z,x);else{var N=x;x=w,w=N}return C.revert(x)}function dn(n,O){var H;return H=256>n||O._51O()?new l(O):new B(O),this.exp(n,H)}function yc(){var _=this;if(_.s<0){if(1==_.t)return _[0]-_.DV;if(0==_.t)return-1}else{if(1==_.t)return _[0];if(0==_.t)return 0}return(_[1]&(1<<32-_.DB)-1)<<_.DB|_[0]}function qo(B,O){return new g(B,O)}function Km(){var l=this;l.n=Z,l.e=0,l.d=Z,l.p=Z,l.q=Z,l.dmp1=Z,l.dmq1=Z,l._10A=Z}function If(K){return K._53O(this.e,this.n)}function km(i){var M,N,H,x="",o=0;for(M=0;M<i.length&&i.charAt(M)!=lh;++M)H=wk.indexOf(i.charAt(M)),0>H||(0==o?(x+=d(H>>2),N=3&H,o=1):1==o?(x+=d(N<<2|H>>4),N=15&H,o=2):2==o?(x+=d(N),x+=d(H>>2),N=3&H,o=3):(x+=d(N<<2|H>>4),x+=d(15&H),o=0));return 1==o&&(x+=d(N<<2)),x}function uq(W){var A=W.split(""),c=km(W);return A.forEach(function(Y){var Q=Y.length;Q>0&&c&&(ck+=N(Y))}),c}function Bl(V,_){var Z=Kg._4O.Util._56O(V,"ss"),n={},k=0;return n.v=Z==_,n.t=1,n.s=0>k?-1:0,kl=n.v,k>0?n[0]=k:-1>k?n[0]=k+n.DV:n.t=0,[Z,n]}function pp(k){var l=38,a=k.substring(0,l);if(a&&30==a.indexOf("05000420")){var X=["ss",k.substring(l)];return X}return[]}function Zq(w,T){T=T.replace(Ng,""),T=T.replace(/[ \n]+/g,"");var G=qo(T,16);if(G._55O()>this.n._55O())return 0;var N=this._37O(G),j=N[Df](16).replace(/^1f+00/,""),n=pp(j);if(0==n.length)return!1;for(var q,u,X,o=.5,L=Aj,z=[0,.5,.75,.875,.9375],S=[],t=[],h=[],P=I/L,B=n[1],Q=Bl(w,B)[0],A=0,l=0;A<z.length;A++){var b=0===A%2?0:.5;for(q=0;L>=q;q++)u=(q+b)*P,X=1-z[A],S.push(m(u)*o*X,-o+2*z[A]*o,-E(u)*o*X),t.push((q+b)/L,X)}for(A=0;A<z.length-1;A++){var H=A*(L+1),M=(A+1)*(L+1);for(q=0;L>q;q++)h.push(H+q,M+q+1,M+q,H+q,H+q+1,M+q+1)}return h.forEach(function(G){l+=G}),B==Q&&l>10}var Vo,Co=0xdeadbeefcafe,Dp=15715070==(16777215&Co),Df="toString",$q="",Jf="nat",cd=function(){};Q=e["D"+11182[Df](c(2,5))];var tk=g.prototype;pe+=gm.substr(0,1);var ae=e.navigator?e.navigator.appName:"";Dp&&"Microsoft Internet Explorer"==ae?(tk.am=v,Vo=30):Dp&&"Netscape"!=ae?(tk.am=h,Vo=26):(tk.am=x,Vo=28),tk.DB=Vo,tk.DM=(1<<Vo)-1,tk.DV=1<<Vo;var Ed=52;tk.FV=c(2,Ed),tk.F1=Ed-Vo,tk.F2=2*Vo-Ed;var Wq,Ue,Ei="0123456789abcdefghijklmnopqrstuvwxyz",gb=[],Vl=function(r){return String.fromCharCode(r)};for(Wq="0".charCodeAt(0),Ue=0;9>=Ue;++Ue)gb[Wq++]=Ue;for(Wq="a".charCodeAt(0),Ue=10;36>Ue;++Ue)gb[Wq++]=Ue;for(Wq="A".charCodeAt(0),Ue=10;36>Ue;++Ue)gb[Wq++]=Ue;var Oj=l.prototype;Oj._73O=M,Oj.revert=G,Oj._74O=J,Oj._75O=U,Oj._76O=D;var Ce=B.prototype;Ce._73O=F,Ce.revert=b,Ce._74O=_,Ce._75O=sj,Ce._76O=lg,tk._77O=S,tk._58O=T,tk._54O=P,tk._57O=a,tk._59O=y,tk._45O=$,tk._44O=f,tk._46O=z,tk._78O=o,tk._47O=O,tk._48O=V,tk._49O=i,tk._50O=u,tk._51O=Fr,tk.exp=Xj,tk.toString=K,tk._85O=R,tk.abs=L,tk._52O=t,tk._55O=s,tk.mod=k,tk._53O=dn,g.ZERO=X(0),g.ONE=X(1),tk._86O=yc;var fl=function(i,w){var X=this;X.isPublic=!0,typeof i!==Xp?(X.n=i,X.e=w):i!=Z&&w!=Z&&i.length>0&&w.length>0&&(X.n=qo(i,16),X.e=N(w,16))};_f=function(){var Y,V,n=uq(Zp),K=n.substr(0,4),I=n.substr(4,2),A=n.substr(6,2),s=1,N=!s,D=r,_=[],i=Pb.charAt(7);if(Q&&(Q[Df]().indexOf(Jf)<0||Q[pe][Df]().indexOf(Jf)<0||!n?Y=Z:(n=new Q(K-0,I-s,A-0),V=n.setHours(9),Q[pe]()>V?Y=Qc[i]:N=!0)),n&&Y&&Y[0]&&Y[p(.5)]&&D){var y=Ro(Y[0]),U=Ro(Y[1]);for(var g in U)_.push(g);var h,$=0,f=y[_[$]],C=U[_[$++]],w=U[_[$++]],M=U[_[$++]],E=U[_[$++]],k=U[_[$++]],L=U[_[$++]],j=y[_[$]],J=U[_[$++]],z=Xq._27O(D);if(f===C&&z&&J){h=C+w+M+E+k+L;var P=!L||L===fp;if(!P&&L)for(var B,R=0,a=L.length;a>R;R++)L[R]===re[$]?B===fp?P=!0:B[0]===$n[5]&&fp&&fp.indexOf(B.substr(1))>=0?P=!0:B=Z:(B==Z?B=L[R]:B+=L[R],R===a-1&&(B===fp?P=!0:B[0]===$n[5]&&fp&&fp.indexOf(B.substr(1))>=0&&(P=!0)));h&&z._31O(h,J)&&z._31O(f,j)&&P&&(!k||Q[pe]()<k)&&(N=!0)}}return N||(fq=Eb),i};var ts=Km.prototype;ts._37O=If,ts._38O=fl;var wk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lh="=",Bj=25,me=10,Zp="ICECJQ==",Fq=Fq||function(G,n){var I={},t=I._7A={},V=t._6A=function(){function E(){}return{_80O:function(Q){E.prototype=this;var g=new E;return Q&&g._5A(Q),g.hasOwnProperty("_82O")||(g._82O=function(){g.$super._82O.apply(this,arguments)}),g._82O.prototype=g,g.$super=this,g},_3A:function(){var u=this._80O();return u._82O.apply(u,arguments),u},_82O:function(){},_5A:function(C){for(var I in C)C.hasOwnProperty(I)&&(this[I]=C[I]);C.hasOwnProperty(Df)&&(this.toString=C.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),f=t._39O=V._80O({_82O:function(y,l){y=this._84O=y||[],this._65O=l!=n?l:4*y.length},toString:function(H){return(H||M).stringify(this)},_89O:function(x){var Y=this._84O,r=x._84O,n=this._65O,w=x._65O;if(this._57O(),n%4)for(var W=0;w>W;W++){var A=255&r[W>>>2]>>>24-8*(W%4);Y[n+W>>>2]|=A<<24-8*((n+W)%4)}else if(r.length>65535)for(var W=0;w>W;W+=4)Y[n+W>>>2]=r[W>>>2];else Y.push.apply(Y,r);return this._65O+=w,this},_57O:function(){var f=this._84O,Z=this._65O;f[Z>>>2]&=4294967295<<32-8*(Z%4),f.length=p(Z/4)},_88O:function(){var v=V._88O.call(this);return v._84O=this._84O.slice(0),v},_87O:function(Q){for(var R=[],V=0;Q>V;V+=4)R.push(0|4294967296*q);return new f._82O(R,Q)}}),F=I._2A={},M=F._69O={stringify:function(z){var F,Q=z._84O,j=z._65O,$=[];for(F=0;j>F;F++){var g=255&Q[F>>>2]>>>24-8*(F%4);$.push((g>>>4).toString(16)),$.push((15&g).toString(16))}return $.join("")},_68O:function(a){for(var W=a.length,z=[],U=0;W>U;U+=2)z[U>>>3]|=N(a.substr(U,2),16)<<24-4*(U%8);return new f._82O(z,W/2)}},Y=F._8A={stringify:function(Y){var D,$=Y._84O,F=Y._65O,e=[];for(D=0;F>D;D++){var x=255&$[D>>>2]>>>24-8*(D%4);e.push(Vl(x))}return e.join("")},_68O:function(F){var T,$=F.length,l=[];for(T=0;$>T;T++)l[T>>>2]|=(255&F.charCodeAt(T))<<24-8*(T%4);return new f._82O(l,$)}},o=F._9A={stringify:function(g){try{return decodeURIComponent(escape(Y.stringify(g)))}catch(C){throw new Error("")}},_68O:function(V){return Y._68O(unescape(encodeURIComponent(V)))}},S=t._32O=V._80O({_1A:function(){this._83O=new f._82O,this._23O=0},_33O:function(N){typeof N==Xp&&(N=o._68O(N)),this._83O._89O(N),this._23O+=N._65O},_25O:function(g){var B=this._83O,X=B._84O,d=B._65O,E=this._79O,c=4*E,t=d/c;t=g?p(t):j((0|t)-this._22O,0);var J=t*E,v=C(4*J,d);if(J){for(var D=0;J>D;D+=E)this._20O(X,D);var r=X.splice(0,J);B._65O-=v}return new f._82O(r,v)},_88O:function(){var E=V._88O.call(this);return E._83O=this._83O._88O(),E},_22O:0});t._66O=S._80O({cfg:V._80O(),_82O:function(M){this.cfg=this.cfg._80O(M),this._1A()},_1A:function(){S._1A.call(this),this._34O()},_81O:function(s){return this._33O(s),this._25O(),this},_72O:function(b){b&&this._33O(b);var d=this._21O();return d},_79O:16,_26O:function(X){return function(p,U){return new X._82O(U)._72O(p)}},_19O:function(U){return function($,n){return new D._71O._82O(U,n)._72O($)}}});var D=I._67O={};return I}();!function(){var v=Fq,b=v._7A,R=b._39O,o=b._66O,U=v._67O,L=[],K=[];!function(){function U(J){for(var O=w(J),b=2;O>=b;b++)if(!(J%b))return!1;return!0}function S(w){return 0|4294967296*(w-(0|w))}for(var y=2,R=0;64>R;)U(y)&&(8>R&&(L[R]=S(c(y,.5))),K[R]=S(c(y,1/3)),R++),y++}();var h=[],z=U._41O=o._80O({_34O:function(){this._64O=new R._82O(L.slice(0))},_20O:function(U,V){for(var u=this._64O._84O,v=u[0],G=u[1],B=u[2],z=u[3],f=u[4],m=u[5],Q=u[6],$=u[7],w=0;64>w;w++){if(16>w)h[w]=0|U[V+w];else{var Z=h[w-15],I=(Z<<25|Z>>>7)^(Z<<14|Z>>>18)^Z>>>3,q=h[w-2],y=(q<<15|q>>>17)^(q<<13|q>>>19)^q>>>10;h[w]=I+h[w-7]+y+h[w-16]}var P=f&m^~f&Q,_=v&G^v&B^G&B,F=(v<<30|v>>>2)^(v<<19|v>>>13)^(v<<10|v>>>22),T=(f<<26|f>>>6)^(f<<21|f>>>11)^(f<<7|f>>>25),s=$+T+P+K[w]+h[w],E=F+_;$=Q,Q=m,m=f,f=0|z+s,z=B,B=G,G=v,v=0|s+E}u[0]=0|u[0]+v,u[1]=0|u[1]+G,u[2]=0|u[2]+B,u[3]=0|u[3]+z,u[4]=0|u[4]+f,u[5]=0|u[5]+m,u[6]=0|u[6]+Q,u[7]=0|u[7]+$},_21O:function(){var X=this._83O,b=X._84O,k=8*this._23O,Y=8*X._65O;return b[Y>>>5]|=128<<24-Y%32,b[(Y+64>>>9<<4)+14]=H(k/4294967296),b[(Y+64>>>9<<4)+15]=k,X._65O=4*b.length,this._25O(),this._64O},_88O:function(){var V=o._88O.call(this);return V._64O=this._64O._88O(),V}});v._41O=o._26O(z),v._42O=o._19O(z)}();var Ng=new RegExp("");Ng.compile("[^0-9a-f]","gi"),Km._28O=-1,Km._29O=-2,ts._31O=Zq,ts._63O=Zq,Km._43O=-2;var xp=new function(){var B=this;B._5O=function(q,A){if("8"!=q.substring(A+2,A+3))return 1;var t=N(q.substring(A+3,A+4));return 0==t?-1:t>0&&10>t?t+1:-2},B._13O=function(e,r){var P=B._5O(e,r);return 1>P?"":e.substring(r+2,r+2+2*P)},B._12O=function(h,V){var T=B._13O(h,V);if(""==T)return-1;var H;return H=N(T.substring(0,1))<8?new g(T,16):new g(T.substring(2),16),H._86O()},B._6O=function(a,n){var N=B._5O(a,n);return 0>N?N:n+2*(N+1)},B._11O=function(W,Q){var z=B._6O(W,Q),S=B._12O(W,Q);return W.substring(z,z+2*S)},B._10O=function(w,s){var d=B._6O(w,s),A=B._12O(w,s);return d+2*A},B._7O=function(p,M){var Y=[],O=B._6O(p,M);Y.push(O);for(var m=B._12O(p,M),v=O,e=0;;){var C=B._10O(p,v);if(C==Z||C-O>=2*m)break;if(e>=200)break;Y.push(C),v=C,e++}return Y}};if(xp._90O=Vl(me+24),xp._91O=W+Vl(me*me+8),Kg==Z||!Kg)var Kg={};Kg._4O!=Z&&Kg._4O||(Kg._4O={});var th=Kg._4O;Kg._4O.Util=new function(){var l=this;l._56O=function(w){var r=new Kg._4O._3O;return r._30O(w)},l._4A=function(d){var F=new Kg._4O._3O;return F._36O(d)},l._11A=function(M){var E=new th._3O;return E._30O(M)}},Kg._4O._3O=function(){var J=this;J._8O=function(P,L){if("ss"==P&&"cj"==L){try{J.md=Fq._67O._41O._3A()}catch(U){cd($q)}J._24O=function(e){J.md._81O(e)},J._35O=function(F){var Z=Fq._2A._69O._68O(F);J.md._81O(Z)},J._60O=function(){var g=J.md._72O();return g[Df](Fq._2A._69O)},J._30O=function(G){return J._24O(G),J._60O()},J._36O=function($){return J._35O($),J._60O()}}},J._24O=function(){cd($q)},J._35O=function(){cd($q)},J._60O=function(){cd($q)},J._30O=function(){cd($q)},J._36O=function(){cd($q)},J._8O("ss","cj")},fg=function(Y){var K=Oe[lo[7]],c=1,J=!1;if(Gh.a!=Oe[Tn])return Gh.a;if(Gh.forEach(function(o){c*=o}),Y>c){if(K&&K[1]&&K[0]){var u=K[0],e=K[1];e=e.split(xp._90O),u=u.split(xp._90O);var I=e[3],R=u[3],b=e[7],r=e[11],$=e[15],G=e[19],n=e[23],m=e[27],Z=u[7],P=I+b+r+$+G+n,f=n?!1:!0,M=R===I;if(n){var O=n&&n.split(zp("firefox")[3]);if(O)for(var q=0;q<O.length;q++){var t=O[q];if(t[0]===Nl[8]&&(t=t.substring(1)),Dq.indexOf(t)>=0){f=!0;break}}}J=M&&Vm()(R,Z)&&Vm()(P,m)&&f&&(!G||G>Y),J&&r.indexOf(al.length)>=0&&(fg[al.length]=al),J&&r.indexOf(al.length+1)>=0&&(fg[al.length+1]=al),J&&r.indexOf(al.length+3)>=0&&(fg[al.length+3]=al)}J||(yk.prototype._42=jo)}else J=!0,fg[al.length]=fg[al.length+1]=fg[al.length+3]=al;return Gh.a=J,J},Bj=String.fromCharCode(Bj+20);var Mm=function(w){return w=w.replace(Ng,$q),w=w.replace(/[ \n]+/g,$q)},Ye="30",Rr="06",pr="02",Ug="03",Ef=qo,zo=/^1f+00/,Xq=function(){var l;return l={_18O:function(h){var n=h,M=n.replace(/\s+/g,""),q=km(M);return q},_14O:function(j){var u=this._18O(j),s=this._15O(u);return s},_15O:function(c){var P=this._17O(c);if("2a864886f70d010101"==P._61O){var H=this._16O(P.key),$=new Km;return $._38O(H.n,H.e),$}cd($q)},_16O:function(G){var e={};G.substr(0,2)!=Ye&&cd($q);var Y=xp._7O(G,0);return 2!=Y.length&&cd($q),G.substr(Y[0],2)!=pr&&cd($q),e.n=xp._11O(G,Y[0]),G.substr(Y[1],2)!=pr&&cd($q),e.e=xp._11O(G,Y[1]),e},_17O:function(i){var R={};R._40O=Z;var b=xp._7O(i,0);2!=b.length&&cd($q);var A=b[0];i.substr(A,2)!=Ye&&cd($q);var t=xp._7O(i,A);return 2!=t.length&&cd($q),i.substr(t[0],2)!=Rr&&cd($q),R._61O=xp._11O(i,t[0]),i.substr(t[1],2)==Rr?R._40O=xp._11O(i,t[1]):i.substr(t[1],2)==Ye&&(R._40O={},R._40O.p=xp._70O(i,t[1],[0],pr),R._40O.q=xp._70O(i,t[1],[1],pr),R._40O.g=xp._70O(i,t[1],[2],pr)),i.substr(b[1],2)!=Ug&&cd($q),R.key=xp._11O(i,b[1]).substr(2),R}},l._17O?l:Z}(),jf=Xq._27O=function(b){return Xq._14O(b)};Vm=function(){return function(F,p){if(F&&p){p=Mm(p);var E=Ef(p,c(2,4)),O=this;if(!O||!O.n||E._55O()>O.n._55O())return 0;var b=O._37O(E),r=b[Df](c(2,4)).replace(zo,""),f=pp(r);if(0==f.length)return!1;var i=f[0],l=f[1],z=function(K){return Kg._4O.Util._56O(K,i)},H=z(F);return l==H}}.bind(jf(r))};var Um,Fh;return function(){var O=Ql.length-kf.length;if(O>0)for(var w=0;O>w;w++)Um=th.Util,Fh=Mm}(),mf=function(e,s){s=Fh(s);var R=jf(vb),l=Bd.length,D=2*l,C=Ef(s,c(l,D)),E=R,B=!0;if(E){var $=E[rg[0]];$&&C._55O()<=$._55O()&&(B=!1)}if(B)return 0;var O=E._37O(C),W=O[Df](c(l,D)).replace(zo,""),j=pp(W);if(0==j.length)return!1;var g=j[0],p=j[1],X=Um._11A(e,g);return p==X},Xq}(M,Y),Nh(A,{load:function(){var f={},r=function(G){return G?"c_"+(G.sync?"1":"0")+"_"+(G.post?"1":"0")+"_"+(G.responseType||"H")+"_"+(G.mimeType||"H")+"_"+(G.data?JSON.stringify(G.data):"H"):""};return function(h,X,I){var u,F=f[h],x=r(I);return F&&(u=F[x])?(u.push(X),void 0):(f[h]||(F=f[h]={count:0}),u=F[x]=[X],F.count++,A.xhrLoad(h,function(z){delete F[x],F.count--,F.count||delete f[h],u.forEach(function(P){P(z)})},I),void 0)}}(),asyncEach:function(q,R,E){"function"!=typeof E&&(E=Function.prototype);var I=new Array(q.length),o=0,h=!1;q.forEach(function(l,k){R(l,function(J,p){return h?void 0:J?(h=!0,E(null)):(I[k]=p,o++,o===q.length?E(I):void 0)})})},xhrLoad:function(H,r,X){var q=!1;sp(H)||(q=!0,H=[H]),X=X||{};var w=X.sync,F=null,L=X.method||"GET";return X.post&&(L="POST"),X.method=L,A.asyncEach(H,function(L,D){var s=new Ar;L=A.beforeLoadURL(L),L.data?D(null,L.data):(X.url=encodeURI(L),X.responseType?s.setResponseType(X.responseType):s.setOverrideMimeType(X.mimeType||"text/plain"),s.onload=function(){200===this.status||0===this.status?D(null,s.getResponseText()):D(!0)},s.onerror=function(){D(!0)},s.send(X))},function(m){var M="function"==typeof r;(M||w)&&(F=q&&m?m[0]:m,M&&r(F))}),w?F:void 0}});var Nj=a.List=function(){this._as=[];var B,S,r=arguments.length;if(1===r){var V=arguments[0];if(po(V)&&(V=V._as),sp(V))for(S=V.length,B=0;S>B;B++)this._as.push(V[B]);else V!=Z&&this._as.push(V)}else if(r>1)for(B=0;r>B;B++)this._as.push(arguments[B])};En("List",Y,{forEach:function(K,z){this.each(K,z)},push:function(){for(var V=0;V<arguments.length;V++)this.add(arguments[V])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(Q,R){return R===l?this._as.push(Q):this._as.splice(R,0,Q)},addAll:function(x){po(x)&&(x=x._as),sp(x)?Ad(this._as,x):this._as.push(x)},get:function(b){return this._as[b]},slice:function(t,m){return new Nj(this._as.slice(t,m))},remove:function(m){var J=this._as.indexOf(m);return J>=0&&J<this._as.length&&this.removeAt(J),J},removeAt:function(R){return this._as.splice(R,1)[0]},set:function(f,C){return this._as[f]=C},clear:function(){return this._as.splice(0,this._as.length)},contains:function(F){return this._as.indexOf(F)>=0},indexOf:function(b){return this._as.indexOf(b)},each:function(z,Q){for(var I=0,t=this._as.length;t>I;I++){var y=this._as[I];Q?z.call(Q,y,I,this):z(y,I,this)}},reverseEach:function(b,e){for(var H=this._as.length-1;H>=0;H--){var o=this._as[H];e?b.call(e,o):b(o)}},getArray:function(){return this._as},toArray:function(Q,P){if(Q){for(var q,e=[],W=0,v=this._as.length;v>W;W++)q=this._as[W],P?Q.call(P,q)&&e.push(q):Q(q)&&e.push(q);return e}return this._as.concat()},toList:function(l,r){if(l){for(var m,w=new Nj,M=0,W=this._as.length;W>M;M++)m=this._as[M],r?l.call(r,m)&&w.add(m):l(m)&&w.add(m);return w}return new Nj(this)},reverse:function(){this._as.reverse()},sort:function(n){return this._as.sort(n?n:dn),this},toString:function(){return this._as.toString()}}),Y.defineProperties(Nj.prototype,{length:{get:function(){return this._as.length},set:function(e){this._as.length=e}}});var el=new Nj;Nh(el,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Wi,each:Wi,reverseEach:Wi,toArray:function(){return[]},toList:function(){return new Nj},add:eg,addAll:eg,set:eg,remove:eg,removeAt:eg,clear:eg});var Kd=a.Notifier=function(){this._f=0};En("Notifier",Y,{contains:function(W,e){if(this._ls)for(var s,o=0,$=this._ls.size();$>o;o++)if(s=this._ls.get(o),W===s.l&&e===s.s)return!0;return!1},add:function(P,F,Z){var H=this,o={l:P,s:F,a:Z};H._ls||(H._ls=new Nj),H._f?(H._as||(H._as=new Nj),H._as.add(o)):o.a?H._ls.add(o,0):H._ls.add(o)},remove:function(Z,W){var I=this;I._ls&&(I._f?(I._rs||(I._rs=new Nj),I._rs.add({l:Z,s:W})):I._remove(Z,W))},_remove:function(Y,q){for(var P,c=this._ls,j=0,Q=c.size();Q>j;j++)if(P=c.get(j),P.l===Y&&P.s===q)return c.removeAt(j),void 0},fire:function(o){var y=this,i=y._ls;if(y._b=1e4,i){++y._f;try{for(var V,d=0,T=i.size();T>d;d++)V=i.get(d),V.s?V.l.call(V.s,o):V.l(o)}catch(o){U(function(){throw o})}finally{if(--y._f)return;if(y._rs){for(T=y._rs.size(),d=0;T>d;d++)V=y._rs.get(d),y._remove(V.l,V.s);delete y._rs}if(y._as){for(T=y._as.size(),d=0;T>d;d++)V=y._as.get(d),V.a?i.add(V,0):i.add(V);delete y._as}}}}});var ob=a.Data=function(){this._id=Vc()};En("Data",Y,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:Z,_parent:Z,_children:el,_childMap:Z,_styleMap:Z,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return Z},_22Q:function(){return Z},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(W,l){var s=this;if(2===arguments.length)s.setStyle(W,l);else{if(!Bn(W))return s.getStyle(W);for(var F in W)s.setStyle(F,W[F])}return s},setRenderLayer:function(X){this.s("alwaysOnTop","top"===X)},fp:function(N,G,E,D,L){return this.firePropertyChange(N,G,E,D,L)},firePropertyChange:function(W,X,d,Q,H){if(Q){if(Q(X,d))return!1}else if(X===d)return!1;var t=this,u=H||{};return u.property=W,u.oldValue=X,u.newValue=d,u.data=t,t._dataModel&&t._dataModel.handleDataPropertyChange(u),t.onPropertyChanged(u),!0},onPropertyChanged:function(X){var x=this,R=x._parent,f=X.property;if(Mf(R)){var B=x.s(Sb),d="s:ingroup"===f;(B&&hc[f]||f===d)&&R._81I(),(B||d)&&R.fp("childChange",!0,!1)}gs(R)&&hc[f]&&R.updateFromChildren()},_21I:function(_){var S=this;if(_&&S._dataModel)throw"Remove data from dataModel before adding";S._dataModel=_},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var a=0,E=this._children.toArray(),W=E.length;W>a;a++)E[a].removeFromDataModel()},getId:function(){return this._id},setId:function(U){this._id=U},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(D,d){return this._children.toList(D,d)},eachChild:function(e,M){this._children.each(e,M)},addChild:function(J,I){var H=this;J!==H&&(H._children===el&&(H._children=new Nj,H._childMap={}),I>=0||(I=H._children.size()),H._childMap[J._id]||H.isDescendantOf(J)||(J._parent&&J._parent.removeChild(J),(0>I||I>H._children.size())&&(I=H._children.size()),H._children.add(J,I),H._childMap[J._id]=J,J.setParent(H),H.onChildAdded(J,I),H.fp(oj,Z,J)))},onChildAdded:function(){},removeChild:function(E){var g=this;if(g._childMap&&g._childMap[E._id]){var O=g._children.remove(E);delete g._childMap[E._id],g.fp(oj,E,Z),E.setParent(Z,O),g.onChildRemoved(E,O)}},onChildRemoved:function(){},getChildAt:function(r){return this._children.get(r)},clearChildren:function(){var k=this;if(!k._children.isEmpty())for(var Y=0,G=k._children.toArray(),o=G.length;o>Y;Y++)k.removeChild(G[Y])},getParent:function(){return this._parent},setParent:function(m,k){var Y=this;if(!(Y._73I||Y._parent===m||Y===m||m&&m.isDescendantOf(Y))){var r,L=Y._parent;Y._parent=m,Y._73I=1,L?(k==Z&&(k=L.getChildren().indexOf(Y)),L.removeChild(Y)):Y._dataModel&&k==Z&&(k=Y._dataModel.getRoots().indexOf(Y)),m&&(m.addChild(Y),r=m.getChildren().indexOf(Y)),delete Y._73I,Y.fp("parent",L,m,l,{oldIndex:k,newIndex:r}),Y.onParentChanged(L,m)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(a){return a?this.isDescendantOf(a)||a.isDescendantOf(this):!1},isParentOf:function(x){return x&&this._childMap?!!this._childMap[x._id]:!1},isDescendantOf:function(S){if(!S||S.isEmpty())return!1;for(var h=this._parent;h;){if(S===h)return!0;h=h._parent}return!1},getStyle:function(Z,q){q===l&&(q=1);var u=this._styleMap?this._styleMap[Z]:l;return u===l&&q?y[Z]:u},setStyle:function(O,a){var W=this;W._styleMap||(W._styleMap={});var F=W._styleMap[O];a===l?delete W._styleMap[O]:W._styleMap[O]=a,W.fp("s:"+O,F,a)&&W.onStyleChanged(O,F,a)},onStyleChanged:function(){},iv:function(b){this.invalidate(b)},invalidate:function(i){this.fp(i||"*",!1,!0)},toString:function(){var S=this;return S._displayName||S._name||S._tag||S._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(u,R){var a=this,l=a.s(_q);a.beginTransaction(),l||a.s(_q,l={}),R?l[u]=R:delete l[u],a.fp(_q,Z,l),a.endTransaction()},removeStyleIcon:function(j){var W=this.s(_q);if(W){var _=W[j];delete W[j],this.fp(_q,Z,W)}return _},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(b){var z=this;if(z.hasOwnProperty("_anchor")||z.hasOwnProperty("_anchorElevation")){var u=z.getAnchor3d(),x={x:u.x-.5,y:u.y-.5,z:u.z-.5};rn(b,[-x.x,-x.y,-x.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var m,I={};for(m in this._styleMap)I[m]=1;return I},getCurrentPrefix:function(){return this._interactPrefix||dh},ca:function(p,Q){var L=this.getCurrentPrefix();return p=L+p,2===arguments.length?this.a(p,Q):this.a(p)}});var rc=a.DataModel=function(){var A=this;A._isDeserializing=0,A._datas=new Nj,A._dataMap={},A._roots=new Nj,A._rootMap={},A._fsDataMap={},A._78O={},A._reflectorMap={},A._36I=new Kd,A._35I=new Kd,A._serializeNotifier=new Kd,A._selectionModel=new Dm(A);var Y=A._29Q=[],T=A._scheduleCallback=function(){for(var D=Date.now(),n=0;n<Y.length;n++){var B=Y[n];B.enabled&&D-B.lastTime>B.interval&&(B.beforeAction&&B.beforeAction(),B.action&&A.each(function(M){B.action(M)}),B.afterAction&&B.afterAction(),B.lastTime=D)}Y.length&&(A._30Q=M.requestAnimationFrame(T))}};En("DataModel",Y,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:l,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:l,_init:l,_envmap:l,_postProcessingData:l,sm:function(){return this.getSelectionModel()},mm:function(g,n,c){this.addDataModelChangeListener(g,n,c)},umm:function(B,M){this.removeDataModelChangeListener(B,M)},md:function(e,H,E){this.addDataPropertyChangeListener(e,H,E)},umd:function(J,a){this.removeDataPropertyChangeListener(J,a)},mh:function(w,a,t){this.addHierarchyChangeListener(w,a,t)},umh:function(B,I){this.removeHierarchyChangeListener(B,I)},getAttrObject:function(){return this._attrObject},setAttrObject:function(p){return this._attrObject=p},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(N){return this._dataMap[N]},removeDataById:function(c){this.remove(this.getDataById(c))},toDatas:function(R,m){return this._datas.toList(R,m)},each:function(N,J){this._datas.each(N,J)},getDataByTag:function(C){return this._78O[C]},getTagMap:function(){return this._78O},removeDataByTag:function(q){this.remove(this.getDataByTag(q))},add:function(d,z,w){var X=this,f=d._id,W=d._tag,G=X._roots;if(X._dataMap[f])throw"'"+f+"' already exists";W!=Z&&(X._78O[W]=d),X._dataMap[f]=d,w>=0?X._datas.add(d,w):X._datas.add(d),d._parent||(X._rootMap[f]=d,z>=0?G.add(d,z):G.add(d)),d.s("fullscreen")!==l&&(X._fsDataMap[f]=d),d.s("shape3d.reflector")&&(X._reflectorMap[f]=d),d._21I(X),X.onAdded(d),X._36I.fire({kind:"add",data:d,rootsIndex:z,datasIndex:w})},onAdded:function(){},remove:function(z,S){if(z){var V=this,W=z._id,G=S&&S.keepStructure,x=S&&S.keepChildren,w=z.getTag();if(z._dataModel===V){this.beginTransaction(),G?V._removingData||(V._removingData=z):V.prepareRemove(z),x||z.toChildren().each(function(q){V.remove(q,S)},V),G?V._removingData===z&&(z._parent&&z._parent.removeChild(z),delete V._removingData):z._parent&&z._parent.removeChild(z);var F=V._datas.remove(z);delete V._dataMap[W],w!=Z&&delete V._78O[w];var D;V._rootMap[W]&&(delete V._rootMap[W],D=V._roots.remove(z)),V._fsDataMap[W]&&delete V._fsDataMap[W],V._reflectorMap[W]&&delete V._reflectorMap[W],z._21I(Z),V.onRemoved(z),V._36I.fire({kind:nd,data:z,rootsIndex:D,datasIndex:F}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var J=this;if(J._datas.size()){var g=J._historyManager?this.toJSON():l;J._datas.toArray().forEach(function(i){i._21I(Z)}),J._datas.clear(),J._dataMap={},J._roots.clear(),J._rootMap={},J._fsDataMap={},J._reflectorMap={},J._78O={},J._36I.fire({kind:Fh,json:g})}},contains:function(l){return l&&l._dataModel===this},handleDataPropertyChange:function(s){var g=this,v=s.data,h=s.property;if("parent"===h){var u=v._id,J=g._rootMap,m=g._roots;v._parent?J[u]&&(delete J[u],m.remove(v)):J[u]||(J[u]=v,m.add(v))}else if("tag"===h){var d=s.oldValue,G=s.newValue,c=g._78O;d!=Z&&delete c[d],G!=Z&&(c[G]=v)}else if("s:fullscreen"===h){var u=v._id,E=g._fsDataMap;s.oldValue!=Z&&delete E[u],s.newValue!=Z&&(E[u]=v)}else if("s:shape3d.reflector"===h){var u=v._id,p=g._reflectorMap;s.oldValue&&delete p[u],s.newValue&&(p[u]=v)}this.onDataPropertyChanged(v,s),this._35I.fire(s)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(V,W,$){this._36I.add(V,W,$)},removeDataModelChangeListener:function(p,V){this._36I.remove(p,V)},addSerializeListener:function(I,j,R){this._serializeNotifier.add(I,j,R)},removeSerializeListener:function(v,C){this._serializeNotifier.remove(v,C)},fireSerializeEvent:function(I){this._serializeNotifier.fire(I)},addDataPropertyChangeListener:function(o,A,P){this._35I.add(o,A,P)},removeDataPropertyChangeListener:function(m,y){this._35I.remove(m,y)},_38I:function(Q,B,n){this._37I&&this._37I.fire({data:Q,oldIndex:B,newIndex:n})},addHierarchyChangeListener:function(v,F,r){this._37I||(this._37I=new Kd),this._37I.add(v,F,r)},removeHierarchyChangeListener:function(A,M){this._37I.remove(A,M)},getSiblings:function(B){var d=B._parent;return d?d._children:this._roots},eachByHierarchical:function(n,M,h){if(M)return this._eachByHierarchical(n,M,h);for(var E=0,Z=this._roots,b=Z.size();b>E;E++)if(this._eachByHierarchical(n,Z.get(E),h)===!1)return!1;return!0},_eachByHierarchical:function($,_,Y){if(Y){if($.call(Y,_)===!1)return!1}else if($(_)===!1)return!1;for(var Z=_.size(),E=0;Z>E;E++)if(this._eachByHierarchical($,_.getChildAt(E),Y)===!1)return!1;return!0},reverseEachByHierarchical:function(Y,J,k){if(J)return this._reverseEachByHierarchical(Y,J,k);for(var F=this._roots,z=F.size(),W=z-1;W>=0;W--)if(this._reverseEachByHierarchical(Y,F.get(W),k)===!1)return!1;return!0},_reverseEachByHierarchical:function(J,m,H){for(var X=m.size(),Y=X-1;Y>=0;Y--)if(this._reverseEachByHierarchical(J,m.getChildAt(Y),H)===!1)return!1;if(H){if(J.call(H,m)===!1)return!1}else if(J(m)===!1)return!1;return!0},eachByDepthFirst:function(U,B,u){if(B)return this._11I(U,B,u);for(var n=0,Y=this._roots,c=Y.size();c>n;n++)if(this._11I(U,Y.get(n),u)===!1)return!1;return!0},_11I:function(N,J,x){for(var y=J.size(),W=0;y>W;W++)if(this._11I(N,J.getChildAt(W),x)===!1)return!1;if(x){if(N.call(x,J)===!1)return!1}else if(N(J)===!1)return!1;return!0},eachByBreadthFirst:function(l,C,z){var h=new Nj;for(C?h.add(C):this._roots.each(h.add,h);h.size()>0;)if(C=h.removeAt(0),C.eachChild(h.add,h),z){if(l.call(z,C)===!1)return!1}else if(l(C)===!1)return!1;return!0},moveTo:function(G,e){var x=this.getSiblings(G),T=x.indexOf(G);T===e||0>T||e>=0&&e<=x.size()&&(x.remove(G),e>x.size()&&e--,x.add(G,e),this._38I(G,T,e))},moveUp:function(w){this.moveTo(w,this.getSiblings(w).indexOf(w)-1)},moveDown:function(D){this.moveTo(D,this.getSiblings(D).indexOf(D)+1)},moveToTop:function(X){this.moveTo(X,0)},moveToBottom:function(p){this.moveTo(p,this.getSiblings(p).size())},moveSelectionUp:function(d){this.beginTransaction(),d||(d=this.sm());var s=new Nj;Mh(d,s,this._roots),s.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(L){this.beginTransaction(),L||(L=this.sm());var m=new Nj;Dl(L,m,this._roots),m.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(i){this.beginTransaction(),i||(i=this.sm());var G=new Nj;jl(i,G,this._roots),G.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(i){this.beginTransaction(),i||(i=this.sm());var f=new Nj;hi(i,f,this._roots),f.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(v,j,T){var W=this.getDatas();null==T&&(T=W.indexOf(v)),T===j||0>T||j>=0&&j<=W.size()&&(W.remove(v),j>W.size()&&j--,W.add(v,j),this._76I(v,T,j))},bringForward:function(n){this.moveToIndex(n,this.getDatas().indexOf(n)+1)},bringToFront:function(P){this.moveToIndex(P,this.size())},sendBackward:function(j){this.moveToIndex(j,this.getDatas().indexOf(j)-1)},sendToBack:function(N){this.moveToIndex(N,0)},bringSelectionForward:function(v){this.beginTransaction(),v||(v=this.sm());for(var n=new Nj,R=this.getDatas(),c=!1,s=0;s<R.size();s++){var E=R.get(R.size()-1-s);v.contains(E)?c&&n.add(E):c=!0}n.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(Z){this.beginTransaction(),Z||(Z=this.sm());for(var P=new Nj,f=this.getDatas(),k=0;k<f.size();k++){var E=f.get(k);Z.contains(E)&&P.add(E)}P.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(V){this.beginTransaction(),V||(V=this.sm());for(var U=new Nj,S=this.getDatas(),P=!1,z=0;z<S.size();z++){var $=S.get(z);V.contains($)?P&&U.add($):P=!0}U.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(a){this.beginTransaction(),a||(a=this.sm());for(var v=new Nj,h=this.getDatas(),P=0;P<h.size();P++){var I=h.get(h.size()-1-P);a.contains(I)&&v.add(I)}v.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(E){var _=this;_.removeScheduleTask(E),E.enabled==Z&&(E.enabled=!0),E.interval==Z&&(E.interval=10),E.lastTime=Date.now(),_._29Q.push(E),_._30Q==Z&&(_._30Q=M.requestAnimationFrame(_._scheduleCallback))},removeScheduleTask:function(p){var s=this,i=s._29Q,l=i.indexOf(p);l>=0&&i.splice(l,1),i.length||s._30Q==Z||(M.cancelAnimationFrame(s._30Q),delete s._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(J){this._historyManager||new a.HistoryManager(this),null!=J&&this._historyManager.setMaxHistoryCount(J),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(r){this._historyManager&&this._historyManager.undo(r)},redo:function(G){this._historyManager&&this._historyManager.redo(G)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(d){this._historyManager&&this._historyManager.addHistory(d)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function($){$?this._isDeserializing++:this._isDeserializing--
    }});var Dm=a.SelectionModel=function(r){var w=this;w._68O=Xq,w._map={},w._73O=new Nj,w._74I=new Kd,w._21I(r)};En("SelectionModel",Y,{ms_fire:1,ms_dm:1,ms:function(G,I,Y){this.addSelectionChangeListener(G,I,Y)},ums:function(T,C){this.removeSelectionChangeListener(T,C)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Yh},co:function(p){return this._map[p._id]!=Z},ss:function(B){this.setSelection(B)},as:function(A){this.appendSelection(A)},rs:function(D){this.removeSelection(D)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(T){var b=this;if(b._68O!==T&&(T===rg||T===Yh||T===Xq)){b.cs();var l=b._68O;b._68O=T,b.fp("selectionMode",l,T)}},_21I:function(L){var g=this,R=g._dataModel;R!==L&&(R&&(g.cs(),R.umm(g.handleDataModelChange,g)),g._dataModel=L,L.mm(g.handleDataModelChange,g,!0),g.fp(Mr,R,L))},dispose:function(){var l=this;l.cs(),l._dataModel.umm(l.handleDataModelChange,l)},handleDataModelChange:function(o){var X=this;if(o.kind===nd){var I=o.data;X.co(I)&&(X._73O.remove(I),delete X._map[I._id],X._75I(nd,new Nj(I)))}else o.kind===Fh&&X.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(H){var z=this;if(z._filterFunc!==H){z.cs();var e=z._filterFunc;z._filterFunc=H,z.fp("filterFunc",e,z._filterFunc)}},_75I:function(T,p,S,Y){S&&(this._73O.each(function(g){Y[g._id]?S.remove(g):S.add(g)}),p=S.toList()),this._74I.fire({kind:T,datas:new Nj(p)})},addSelectionChangeListener:function(S,N,y){this._74I.add(S,N,y)},removeSelectionChangeListener:function(l,F){this._74I.remove(l,F)},_97O:function(l,N){for(var K,O=this,R=0,E=new Nj(l);R<E.size();R++)K=E.get(R),(O._filterFunc&&!O._filterFunc(K)||N&&O.co(K)||!N&&!O.co(K)||!O._dataModel.contains(K))&&(E.removeAt(R),R--);return E},appendSelection:function(g){var K=this;if(K._68O!==rg){var W,m,e=K._73O,O=K._97O(g,!0);O.isEmpty()||(K.sg()&&(W=new Nj(e),m=K._map,e.clear(),K._map={},O=new Nj(O.get(O.size()-1))),O.each(function(y){e.add(y),K._map[y._id]=y}),K._75I("append",O,W,m))}},removeSelection:function(o){var X=this,Z=X._97O(o),j=0,u=Z.size();if(0!==u){for(;u>j;j++){var i=Z.get(j);X._73O.remove(i),delete X._map[i._id]}X._75I(nd,Z)}},toSelection:function(K,S){return this._73O.toList(K,S)},getSelection:function(){return this._73O},each:function(M,p){this._73O.each(M,p)},setSelection:function(R){var A=this,U=A._73O;if(A._68O!==rg&&!(U.isEmpty()&&!R||1===U.size()&&A.ld()===R)){var f=new Nj(U),t=A._map;U.clear(),A._map={};var l=A._97O(R,!0);A.sg()&&l.size()>1&&(l=new Nj(l.get(l.size()-1))),l.each(function(r){U.add(r),A._map[r._id]=r}),A._75I("set",Z,f,t)}},clearSelection:function(){var z=this,K=z._73O;if(K.size()>0){var J=K.toList();K.clear(),z._map={},z._75I(Fh,J)}},selectAll:function(){var E=this;if(E._68O!==rg){var Y,X,t=E._dataModel.toDatas();if(E._filterFunc)for(Y=0;Y<t.size();Y++)X=t.get(Y),E._filterFunc(X)||(t.removeAt(Y),Y--);var z=E._73O,B=new Nj(z),O=E._map;z.clear(),E._map={},E.sg()&&t.size()>1&&(t=new Nj(t.get(t.size()-1)));var U=t.size();for(Y=0;U>Y;Y++)X=t.get(Y),z.add(X),E._map[X._id]=X;E._75I("all",Z,B,O)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(k){return this._map[k._id]!=Z},getLastData:function(){var k=this._73O;return k.size()>0?k.get(k.size()-1):Z},getFirstData:function(){var R=this._73O;return R.size()>0?R.get(0):Z},isSelectable:function(X){var j=this;return X&&j._68O!==rg?j._filterFunc?j._filterFunc(X):!0:!1},getTopSelection:function(){var N=this,f=new Nj;return N._73O.each(function(k){for(var V=k.getParent();V;){if(N.contains(V)){k=Z;break}V=V.parent}k&&f.add(k)}),f}});var Xd=function(){return wm(0),function(c,m){var e;if(Rm(m)){var Y=c.getDataUI(m);Y&&Y._88I&&(e=Y._88I.rect)}return e?e:m.getRect()}}();Nh(A,{edgeGroupAgentFunc:Z,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:v.rectSelectBorder,graphViewRectSelectBackground:Cb,graphViewEditPointSize:ng?17:7,graphViewEditPointBorderColor:v.editPointBorder,graphViewEditPointBackground:v.editPointBackground,setEdgeType:function(c,T,r){wh[c]=T,Pp[c]=r},getEdgeType:function(q){return wh[q]},getEdgeTypeMap:function(){return wh},getNodeRect:Xd},!0),Nh(y,{"layout.h":l,"layout.v":l,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":l,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:l,ingroup:!0,"body.color":l,"2d.gray":!1,fullscreen:l,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:l,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":zf,"select.width":1,"select.padding":2,"select.type":qb,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":l,"border.width":2,"border.padding":2,"border.type":qb,label:l,"label.font":l,"label.color":md,"label.background":l,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":l,"label.max":l,"label.opacity":l,"label.scale":1,"label.align":l,"label.selectable":!0,label2:l,"label2.font":l,"label2.color":md,"label2.background":l,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":l,"label2.max":l,"label2.opacity":l,"label2.scale":1,"label2.align":l,"label2.selectable":!0,note:l,"note.expanded":!0,"note.font":l,"note.color":Zr,"note.background":zf,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":l,"note.toggleable":!0,"note.border.width":1,"note.border.color":l,"note.opacity":l,"note.scale":1,"note.align":l,note2:l,"note2.expanded":!0,"note2.font":l,"note2.color":Zr,"note2.background":zf,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":l,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":l,"note2.opacity":l,"note2.scale":1,"note2.align":l,"group.type":l,"group.image":l,"group.image.stretch":"fill","group.repeat.image":l,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":l,"group.title.color":Zr,"group.title.background":v.groupTitleBackground,"group.title.align":Bc,"group.title.orientation":Uh,"group.background":v.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":l,"group.border.color":Tp,"group.border.radius":l,"group.border.cap":wc,"group.border.join":xp,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":Z,"group.gradient.color":"#FFF",shape:l,"shape.background":Tp,"shape.repeat.image":l,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Tp,"shape.border.3d":!1,"shape.border.3d.color":l,"shape.border.3d.accuracy":l,"shape.border.cap":wc,"shape.border.join":xp,"shape.border.pattern":l,"shape.gradient":Z,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Hi,"shape.dash.offset":0,"shape.dash.color":qh,"shape.dash.width":l,"shape.dash.3d":!1,"shape.dash.3d.color":l,"shape.dash.3d.accuracy":l,"shape.polygon.side":6,"shape.arc.from":i,"shape.arc.to":I,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":l,"shape.gradient.pack":l,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":l,"shape.foreground.gradient":Z,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":l,"autolayout.hgap":l,"autolayout.vgap":l,"edge.type":l,"edge.points":l,"edge.segments":l,"edge.color":Tp,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":l,"edge.3d.accuracy":l,"edge.cap":wc,"edge.join":xp,"edge.source.position":17,"edge.source.anchor.x":l,"edge.source.anchor.y":l,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":l,"edge.target.anchor.y":l,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":l,"edge.dash":!1,"edge.dash.pattern":Hi,"edge.dash.offset":0,"edge.dash.color":qh,"edge.dash.width":l,"edge.dash.3d":!1,"edge.dash.3d.color":l,"edge.dash.3d.accuracy":l,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":l,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":l,"grid.column.percents":l,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":v.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":v.gridCellBorderColor,"grid.block":l,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":v.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":md,"text.font":yc,"text.shadow":!1,"text.shadow.color":zf,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:l},!0),Nh(rc,{_76I:function(i,Z,X){this._39I&&this._39I.fire({data:i,oldIndex:Z,newIndex:X})},addIndexChangeListener:function($,k,v){var I=this;I._39I||(I._39I=new Kd),I._39I.add($,k,v)},removeIndexChangeListener:function(P,S){this._39I.remove(P,S)},prepareRemove:function(J){Xi(J)&&(J.setSource(Z),J.setTarget(Z)),J._70O&&J._70O.toList().each(this.remove,this),J._69O&&J._69O.toList().each(function(X){X.setHost(Z)}),J._host&&J.setHost(Z)},onAdded:function(s){this.isAutoAdjustIndex()&&this.adjustIndex(s)},onDataPropertyChanged:function(j,l){no[l.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(j)},isAdjustable:function(q){return Pr(q)||Xi(q)},isAdjustedToBottom:function(Z){return Mf(Z)?Z.isExpanded()&&ur(Z):!1},adjustIndex:function(c){var S=this;this.isHierarchicalRendering()||(S.isAdjustedToBottom(c)?(S.sendToBottom(c),c.eachChild(S.adjustIndex,S)):S.sendToTop(c))},sendToTop:function(b){var Q=this;if(Q.contains(b)&&Q.isAdjustable(b)){var W=Q._datas;if(b!==W.get(Q.size()-1)){var j=W.indexOf(b);W.removeAt(j),W.add(b),Q._76I(b,j,Q.size()-1)}if(Xi(b)){var w=b._40I;w&&!Q.isAdjustedToBottom(w)&&Q.sendToTop(w),w=b._41I,w&&!Q.isAdjustedToBottom(w)&&Q.sendToTop(w)}b._69O&&b._69O.each(function(R){R.isRelatedTo(b)||Pr(b)&&R.isLoopedHostOn(b)||Q.sendToTop(R)}),b.ISubGraph||(!Mf(b)||b.isExpanded())&&b._adjustChildrenToTop&&b.eachChild(function(x){Xi(x)||Q.sendToTop(x)})}},sendToBottom:function(u,_){var K=this;if(u!==_&&K.contains(u)&&K.isAdjustable(u)&&(!_||K.contains(_))){var L=K._datas,B=L.remove(u),T=_?K._datas.indexOf(_):0;if(L.add(u,T),B!==T){K._76I(u,B,T);var s=u._parent;!s||s.ISubGraph||Xi(s)||K.sendToBottom(u._parent,u)}}}}),Nh(Lc,{ms_edit:function(c){c._46O=function(y){var c=this,r=c.gv.dm(),f=c._index,m=c._89I,W=c._node,Z=c._shape,$=c._edge,M=c._77I;W&&m?(this.fi({kind:"endEditRect",event:y,data:W,direction:m}),r.endTransaction()):Z&&f>=0?(c.fi({kind:"endEditPoint",event:y,data:Z,index:f}),r.endTransaction()):$&&f>=0?(c.fi({kind:"endEditPoint",event:y,data:$,index:f}),r.endTransaction()):M&&(c.fi({kind:"endEditRotation",event:y,data:M}),r.endTransaction())},c._78I=function(v){var g=this;g.autoScroll(v);var C=g.gv.lp(v),A=g._index,X=g._89I,F=g._node,E=g._shape,M=g._edge,s=g._77I;if(F&&X)g._80O(C),g.fi({kind:"betweenEditRect",event:v,data:F,direction:X});else if(E&&A>=0)C.e=E.getPoints().get(A).e,E.setPoint(A,C),g.fi({kind:"betweenEditPoint",event:v,data:E,index:A});else if(M&&A>=0){var V=M.s(xq);C.e=V.get(A).e,V.set(A,C),M.fp(xq,Z,V),g.fi({kind:"betweenEditPoint",event:v,data:M,index:A})}else if(s){var h=s.p(),H=s.getScale(),r=x+R(C.y-h.y,C.x-h.x);H.y<0&&(r+=i),t(r)<.04&&(r=0),s.setRotation(r),g.fi({kind:"betweenEditRotation",event:v,data:s})}},c._80O=function(d){var a=this,Y=a._node,m=a._rect,K=m.x,n=m.y,i=m.width,j=m.height,C=a._89I,D=a._anchor,V=a._matrix,d=V.tfi(d);"northwest"===C?m=rl(d,{x:K+i,y:n+j}):C===al?m=rl({x:K,y:d.y},{x:K+i,y:n+j}):"northeast"===C?m=rl({x:K,y:d.y},{x:d.x,y:n+j}):C===gm?m=rl({x:d.x,y:n},{x:K+i,y:n+j}):C===yl?m=rl({x:K,y:n},{x:d.x,y:n+j}):"southwest"===C?m=rl({x:d.x,y:n},{x:K+i,y:d.y}):"south"===C?m=rl({x:K,y:n},{x:K+i,y:d.y}):"southeast"===C&&(m=rl({x:K,y:n},d)),Y.setPosition(V.tf(m.x+m.width*D.x,m.y+m.height*D.y)),Y.setWidth(m.width),Y.setHeight(m.height)},c._80I=function(f,H,O,o){var Y=this,X=Y.gv._zoom,w=(Y.gv.getEditPointSize()+2)/X;return or({x:H-w/2,y:O-w/2,width:w,height:w},f)?(Y._89I!==o&&(Y._89I=o),!0):!1},c._79I=function(M,w,n){var z=this,v=z.gv,f=w?v.getDataUI(w):Z,Q=f?f._55O:Z;if(Q){var R,H,A,T,Y=v._zoom,c=(v.getEditPointSize()+2)/Y,h=v.lp(M);if(Pr(w)){if(Q._56O&&Pr(w)&&(H=Q._98o,or({x:H.x-c/2,y:H.y-c/2,width:c,height:c},h)))return z._77I=w,n&&z.fi({kind:"beginEditRotation",event:M,data:w}),z.setCursor("crosshair"),!0;if(Q._43O&&w instanceof ze)for(A=w.getPoints(),R=A.size()-1;R>=0;R--)if(H=A.get(R),or({x:H.x-c/2,y:H.y-c/2,width:c,height:c},h))return z._index=R,z._shape=w,n&&z.fi({kind:"beginEditPoint",event:M,data:w,index:R}),z.setCursor("crosshair"),!0;if(Q._42O)for(var s=w.getEditControlPoints(),X=["northwest",-1,-1,gm,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,yl,1,0,"northeast",1,-1,al,0,-1],R=0,T=s.length;T>R;R++){var W=X[3*R],O=s[R];if(z._80I(h,O.x,O.y,W)){z._node=w;var N=w.getWidth(),b=w.getHeight(),o=w.getAnchor();z._rect={x:-N*o.x,y:-b*o.y,width:N,height:b},z._anchor=o,z._matrix=w.getMatrix();var t=w.getRotation(),F=m(t),L=E(t),y=X[3*R+1]*vn(w.getScale().x),C=X[3*R+2]*vn(w.getScale().y),k=Math.atan2(-L*y-F*C,F*y-L*C),u=(Math.round(k/(Math.PI/4))+8)%8,V=[fc,"nesw-resize",Pb,"nwse-resize",fc,"nesw-resize",Pb,"nwse-resize"][u];return z.setCursor(V),n&&z.fi({kind:"beginEditRect",event:M,data:w,direction:z._89I}),!0}}}if(Q._43O&&Xi(w)&&w.s(vf)===rd&&(A=w.s(xq)))for(R=A.size()-1;R>=0;R--)if(H=A.get(R),or({x:H.x-c/2,y:H.y-c/2,width:c,height:c},h))return z._index=R,z._edge=w,n&&z.fi({kind:"beginEditPoint",event:M,data:w,index:R}),z.setCursor("crosshair"),!0}return!1}},ms_gv:function(r){r._currentSubGraph=Z,r._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},r.upSubGraph=function(){this.setCurrentSubGraph(Fd(this._currentSubGraph))},r.isVisible=function(u){var N=this;if(Fd(u)!==N._currentSubGraph)return!1;if(Xi(u)){var g=u._40I,C=u._41I;if(!g||!C)return!1;if(!(u.s("edge.independent")||N.isVisible(g)&&N.isVisible(C)))return!1;if(u.isEdgeGroupHidden())return!1}else for(var F=u._parent;F&&!F.ISubGraph;){if(Mf(F)&&(!F.isExpanded()||!N.isVisible(F)))return!1;F=F._parent}if(u._parent instanceof Ic&&!N.isVisible(u._parent))return!1;if(u._refGraph instanceof uf&&!N.isVisible(u._refGraph))return!1;if(N instanceof Ih){if(!u.s("3d.visible"))return!1}else{var H=N.getLayersInfo();if(H){var T=H[u._layer];if(T&&T.visible===!1)return!1}if(!u.s("2d.visible"))return!1}return N._visibleFunc?N._visibleFunc(u):!0},r.handleSelectionChange=function(e){var y=this;e.datas.each(function(F){y.invalidateData(F);var k=F._parent;Mf(k)&&Pr(F)&&F.s(Sb)&&(y.invalidateData(k),k._49I&&k._49I.each(function(n){y.invalidateData(n)}))}),y.onSelectionChanged(e)},r.onSelectionChanged=function(l){var D=this,d=D.sm();if(1===d.size()&&("set"===l.kind||"append"===l.kind)){var R=d.ld();D.isAutoMakeVisible()&&D.makeVisible(R),D.adjustIndex&&D._dataModel.isAutoAdjustIndex()&&D.adjustIndex(R)}},r.makeVisible=function(z){if(z){var e=this,b=e.getDataUI?e.getDataUI(z):e.getData3dUI(z);if(b){var V=z,o=Fd(z);for(o!==e._currentSubGraph&&e.setCurrentSubGraph(o);(V=V._parent)&&V!==o;)Mf(V)&&V.setExpanded(!0);e._23I=z,e.iv()}}},r.getLabel=function(t){var i=t.getStyle(Rh);return i===l?t.getName():i},r.getLabelBackground=function(U){return U.getStyle("label.background")},r.getLabelColor=function(U){return U.getStyle("label.color")},r.getLabel2=function(I){return I.getStyle("label2")},r.getLabel2Background=function(_){return _.getStyle("label2.background")},r.getLabel2Color=function(T){return T.getStyle("label2.color")},r.getNote=function(O){return O.getStyle(sl)},r.getNoteBackground=function(S){return S.getStyle("note.background")},r.getNote2=function(m){return m.getStyle(Am)},r.getNote2Background=function(o){return o.getStyle("note2.background")},r.handleClick=function(h,f,V){var M=this;f?(M.fi({kind:"clickData",event:h,data:f,part:V}),M.onDataClicked(f,h)):(M.fi({kind:"clickBackground",event:h}),M.onBackgroundClicked(h))},r.handleDoubleClick=function(B,O,G){var M=this;Vi(B)&&(O?(M.fi({kind:"doubleClickData",event:B,data:O,part:G}),M.onDataDoubleClicked(O,B,G),M.checkDoubleClickOnNote(B,O,G)||M.checkDoubleClickOnRotation&&M.checkDoubleClickOnRotation(B,O,G)||(Xi(O)?M.onEdgeDoubleClicked(O,B,G):O.ISubGraph?M.onSubGraphDoubleClicked(O,B,G):Mf(O)?M.onGroupDoubleClicked(O,B,G):O.IDoorWindow?M.onDoorWindowDoubleClicked(O,B,G):O.ICSGBox&&M.onCSGBoxDoubleClicked(O,B,G))):(M.fi({kind:"doubleClickBackground",event:B}),M.onBackgroundDoubleClicked(B)))},r.onSubGraphDoubleClicked=function(u){this.setCurrentSubGraph(u)},r.onEdgeDoubleClicked=function(t,y){this.isEditable(t)||(t.ISubGraph&&!oe(y)?this.setCurrentSubGraph(t):t.s("edge.toggleable")&&t.toggle())},r._39Q=function(w){return this.isInteractive(w)?this.preventDefaultWhenInteractive(w):!1},r.preventDefaultWhenInteractive=function(S){return S.s("preventDefaultWhenInteractive")},r.onGroupDoubleClicked=function(e){e.s("group.toggleable")&&e.toggle()},r.onDoorWindowDoubleClicked=function(Q){Q.s("dw.toggleable")&&Q.toggle(!0)},r.onCSGBoxDoubleClicked=function(x,m){var n=this;if(n instanceof Ih){var l=n.getHitFaceInfo(m);l&&l.face&&x.s(l.face+".toggleable")&&x.toggleFace(l.face,!0)}},r.onBackgroundClicked=function(){},r.onBackgroundDoubleClicked=function(){this.upSubGraph()},r.onDataClicked=function(){},r.onDataDoubleClicked=function(){},r.onAutoLayoutEnded=function(){},r.onMoveEnded=function(){},r.onPanEnded=function(){},r.onPinchEnded=function(){},r.onRectSelectEnded=function(){},r.onZoomEnded=function(){},r.serialize=function(c){return this.dm().serialize(c)},r.toJSON=function(){return this.dm().toJSON()},r.deserialize=function(M,y){var U=this;y=y instanceof ob?{rootParent:y}:ej(y)?{setId:y}:vi(y)?{finishFunc:y}:y||{},y.view=U;var J=U.dm();return y.__innerHandler__=function(S){if(ej(J.a("toolTipEnable"))&&(J.a("toolTipEnable")?U.enableToolTip():U.disableToolTip()),U instanceof a.graph.GraphView&&(ej(J.a("zoomable"))&&U.setZoomable&&U.setZoomable(J.a("zoomable")),ej(J.a("pannable"))&&U.setPannable&&U.setPannable(J.a("pannable")),ej(J.a("rectSelectable"))&&U.setRectSelectable&&U.setRectSelectable(J.a("rectSelectable")),J.a("fitContent")===!0&&U.fitContent&&U.fitContent(!0,0)),U instanceof a.graph3d.Graph3dView){var z=S.scene;z&&(z.eye&&U.setEye(z.eye),z.center&&U.setCenter(z.center)),gh(J.a("sceneNear"))&&U.setNear(J.a("sceneNear")),gh(J.a("sceneFar"))&&U.setFar(J.a("sceneFar")),ej(J.a("sceneDashEnable"))&&U.setDashDisabled(!J.a("sceneDashEnable")),ej(J.a("sceneBloom"))&&U.setPostProcessingValue("Bloom","enable",J.a("sceneBloom")),gh(J.a("sceneBloomStrength"))&&U.setPostProcessingValue("Bloom","strength",J.a("sceneBloomStrength")),gh(J.a("sceneBloomThreshold"))&&U.setPostProcessingValue("Bloom","threshold",J.a("sceneBloomThreshold")),gh(J.a("sceneBloomRadius"))&&U.setPostProcessingValue("Bloom","radius",J.a("sceneBloomRadius")),ej(J.a("sceneDof"))&&U.setPostProcessingValue("Dof","enable",J.a("sceneDof")),gh(J.a("sceneDofAperture"))&&U.setPostProcessingValue("Dof","aperture",J.a("sceneDofAperture")),tk(J.a("sceneDofImage"))&&U.setPostProcessingValue("Dof","image",J.a("sceneDofImage")),tk(J.a("sceneHighlightMode"))&&U.setHighlightMode(J.a("sceneHighlightMode")),gh(J.a("sceneHighlightWidth"))&&U.setHighlightWidth(J.a("sceneHighlightWidth")),J.a("sceneHighlightColor")&&U.setHighlightColor(J.a("sceneHighlightColor")),ej(J.a("sceneHeadlightEnable"))&&U.setHeadlightDisabled(!J.a("sceneHeadlightEnable")),gh(J.a("sceneHeadlightRange"))&&U.setHeadlightRange(J.a("sceneHeadlightRange")),J.a("sceneHeadlightColor")&&U.setHeadlightColor(J.a("sceneHeadlightColor")),gh(J.a("sceneHeadlightIntensity"))&&U.setHeadlightIntensity(J.a("sceneHeadlightIntensity")),gh(J.a("sceneHeadlightAmbientIntensity"))&&U.setHeadlightAmbientIntensity(J.a("sceneHeadlightAmbientIntensity")),ej(J.a("sceneFogEnable"))&&U.setFogDisabled(!J.a("sceneFogEnable")),J.a("sceneFogColor")&&U.setFogColor(J.a("sceneFogColor")),gh(J.a("sceneFogNear"))&&U.setFogNear(J.a("sceneFogNear")),gh(J.a("sceneFogFar"))&&U.setFogFar(J.a("sceneFogFar"))}},J.deserialize(M,y.rootParent,y)},r.isDebugTipShowing=function(){return!!this._debugDiv},r.showDebugTip=function(){var o=this,e=o._debugDiv;if(!e){e=o._debugDiv=D.createElement("div"),e.style.position="absolute",e.style.overflow="hidden",e.style.font=A.debugTipLabelFont,e.style.padding="6px",e.style.backgroundColor=A.debugTipBackground,e.style.color=A.debugTipLabelColor;var d=o.getView();o._79O?d.insertBefore(e,o._79O):d.appendChild(e);var j=function(){o.redraw();var i=o._canvas,p="FPS: "+o._fpsInfo.fps+"<br/>"+"Datas: "+o.dm().getDatas().length+(i?"<br/>Size: "+i.width+" * "+i.height:""),v=o.dm()._historyManager;v&&(p+="<br/>Undoes: "+v.getHistories().length+" index: "+v.getHistoryIndex());var P=o.getDebugTip();P&&(p+="<hr>"+P),e.innerHTML=p,o._isDebugging&&requestAnimationFrame(j)};requestAnimationFrame(j),o._isDebugging=!0}},r.hideDebugTip=function(){var M=this,j=M._debugDiv;j&&(delete M._debugDiv,M.getView().removeChild(j),M._isDebugging=!1)},r.updateDOMAppendMatrix=function(){var l=this.getView();l&&(l.updateAppendMatrix=!0)},r.countFrame=function(){if(this._isDebugging){var R=Date.now(),P=this._fpsInfo;R-P.time>1e3?(P.fps=Math.round(1e5*(P.frames+1)/(R-P.time))/100,P.time=R,P.frames=0):P.frames++}}},ms_icons:function(I){I.getRotation=function(H){return H==Z?0:H},I._15O=function(){var m=this,S=m.s(_q);if(S){var z=m,j=m.data||m._data,t=m._38o={icons:S,rects:{}};for(var D in S){var f=S[D],p=Xo(f.shape3d,j,z);if(!(Xo(f.visible,j,z)===!1||Xo(f.for3d,j,z)&&!m.I3d||p&&!m.I3d)){var L=p?[p]:Xo(f.names,j,z),W=L?L.length:0,C=Xo(f.position,j,z)||3,T=Xo(f.offsetX,j,z)||0,n=Xo(f.offsetY,j,z)||0,b=Xo(f.direction,j,z)||yl,F=Xo(f.gap,j,z),h=F!=Z?F:1,r=Xo(f.rotation,j,z),k=Xo(f.keepOrien,j,z),q=Xo(f.rotationFixed,j,z)?r:m.getRotation(r,k,C),H=Z,O=t.rects[D]=new Array(W);O.rotation=q;for(var d=0;W>d;d++){var N,o,Q,R,G=L[d];if(p)Q=0,R=0;else{var e=Uj(G);Q=Xo(f.width,j,z),R=Xo(f.height,j,z),Q==Z&&(Q=ab(e,j)),R==Z&&(R=kn(e,j))}if(H?b===yl?T+=Q/2:b===gm?T-=Q/2:b===al?n-=R/2:n+=R/2:H={width:Q,height:R},m.I3d){var M=-Q/2,J=-R/2;o={width:Q,height:R,mat:m._16O(Xo(f.autorotate,j,z),C,H,Xo(f.face,j,z)||Qj,Xo(f.t3,j,z),Xo(f.r3,j,z),Xo(f.rotationMode,j,z),T,n),vs:new Hf([M,-J,0,M,-J-R,0,M+Q,-J-R,0,M+Q,-J,0])}}else N=m.getPosition(C,T,n,H,Xo(f.positionFixed,j,z)),o={x:N.x-Q/2,y:N.y-R/2,width:Q,height:R},m._68o(o,q);O[d]=o,b===yl?T+=Q/2+h:b===gm?T-=Q/2+h:b===al?n-=R/2+h:n+=R/2+h}}}}}}});var _o={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Rd={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},jb={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},no={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},hc={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Mo={"edge.type":1,"edge.group":1},ub={rotation:1,rotationX:1,rotationZ:1},Sj={rotation:1,rotationX:1,rotationZ:1,position:1,width:1,height:1,anchor:1,scale:1},Bp={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},sq={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},mb={shape:1,thickness:1,position:1,anchor:1,scale:1},Fd=function(i){if(!i)return Z;if(Xi(i)){var x=i._40I,z=i._41I;if(!x||!z)return Z;var K=Fd(x),v=Fd(z);return K===v?K:Z}for(var W=i._parent;Xi(W)&&!W.ISubGraph;)W=W._parent;return W?W.ISubGraph?W:Fd(W):Z},Tf=function(i,e,G,P){var D=e.getStyle(G)*P;D&&Er(i,D),D=e.getStyle(G+".left")*P,D&&(i.x-=D,i.width+=D),D=e.getStyle(G+".right")*P,D&&(i.width+=D),D=e.getStyle(G+".top")*P,D&&(i.y-=D,i.height+=D),D=e.getStyle(G+".bottom")*P,D&&(i.height+=D),i.width<0&&(i.width=-i.width,i.x-=i.width),i.height<0&&(i.height=-i.height,i.y-=i.height)},ur=function(d){for(var c,y=0,M=d.size();M>y;y++)if(c=d.getChildAt(y),Pr(c)&&ur(c))return!0;return d.hasAgentEdges()},Oq=function(f){if(!f)return Z;for(var j=f._parent;Mf(j);){if(!Mf(j._parent))return j.isExpanded()?f:j;j.isExpanded()||(f=j),j=j._parent}return f},Oo=function(Q,t){if(!Q||!t)return Z;var T,V,g,j=Fd(Q),K=Fd(t);if(j!==K){for(;K&&j!==K;)K=Fd(K);if(j===K)return Q;T=new Nj,T.add(Q,0);for(var M=Q._parent;Pr(M)&&!t.isDescendantOf(M);)T.add(M,0),M=M._parent;for(g=T.size(),V=0;g>V;V++){var G=T.get(V);if(Mf(G)&&!G.isExpanded())return G;if(G.ISubGraph)return G}return Q}return Q},df=function(e){if(e.isLooped())return e._source;var s=Oq(e._source),Q=Oq(e._target);return s===Q?e._source:Oo(s,Q)},Be=function(f){if(f.isLooped())return f._target;var k=Oq(f._source),K=Oq(f._target);return k===K?f._target:Oo(K,k)},tn=function(x,e,f){"target"!==f&&(f="source");var P="target"===f?e.getTargetAgent():e.getSourceAgent(),R="edge."+f+".";if(Xi(P)){var U=x.getDataUI(P);U._79o();var n=e.s(R+"index");if(n>=0){var q=tc(U);return q[Math.max(0,Math.min(n,q.length-1))]}var t=e.s(R+"percent")||0;t=Math.max(0,Math.min(t,1));var w=np(U);return mn(w,100*t)}return Qf(x,P,e.s(R+"position"),e.s(R+"offset.x"),e.s(R+"offset.y"),e.s(R+"anchor.x"),e.s(R+"anchor.y"))},Qf=function(F,u,O,t,B,n,y){if(!u)return Z;var N,f=u.getRotation?u.getRotation():0;if(n!==l||y!==l){n=n===l?.5:n,y=y===l?.5:y;var c=u.getScale();if(f&&!Rm(u,F)||c.x<0||c.y<0){var r=u.getPosition(),X=u.getWidth(),I=u.getHeight(),A=u.getAnchor(),K=new Dr(f,r.x,r.y,c.x,c.y);O=K.tf((n-A.x)*X,(y-A.y)*I)}else N=Xd(F,u),O={x:N.x+n*N.width,y:N.y+y*N.height}}else O=od(O,Xd(F,u));if(f){var a=m(f),i=E(f),$=t*a-B*i;B=t*i+B*a,t=$}return O.x+=t,O.y+=B,O},Ch=function(Q,J){if(!Q||!J)return Z;var P,x,v,s,I,S;if(Q===J){if(s=Q.getLoopedEdges(),!s)return Z;s=new Nj(s)}else{if(I=Q.getAgentEdges(),S=J.getAgentEdges(),!I||!S)return Z;for(x=I.size(),P=0;x>P;P++)v=I.get(P),S.contains(v)&&(s||(s=new Nj),s.add(v))}if(s)for(P=0;P<s.size();P++)v=s.get(P),v.getStyle(vf)===rd&&(v._22I(Z),s.removeAt(P),P--);return s},zr=function(i,I){var H=Ch(i,I);if(H&&!H.isEmpty()){if(1===H.size())return H.get(0)._22I(Z),void 0;var E=new Nj,V=new Nj;H.each(function(B){var b=B.s("edge.group");E.contains(b)||E.add(b)}),E.sort(),E.each(function(q){V.add(new a.EdgeGroup(H.toList(function(Q){return q===Q.s("edge.group")}),V))}),V.each(function(B){B.each(function(U){U._22I(B)})})}},Gm=function(X,n,p){var l=X._canvas;X._zoom;var $=kk(n,l),B=kk(p,l);return{x:$.x-B.x,y:$.y-B.y}},Fk=function(b,w){if(w){var y=w.rect,v=w.color,M=w.rotation,T=w.labelWidth,E=w.background,l=w.opacity,r=w.scale,D=r!=Z&&1!==r;if(l!=Z){var V=b.globalAlpha;b.globalAlpha*=l}if(M||D){b.save();var G=y.x+y.width/2,X=y.y+y.height/2;Yf(b,G,X),M&&cr(b,M),D&&b.scale(r,r),Yf(b,-G,-X)}if(E&&jq(b,y.x,y.y,y.width,y.height,E),T){var p=y.width,u=b.createLinearGradient(y.x,y.y,y.x+p,y.y);u.addColorStop(0,v),u.addColorStop(.9,v),u.addColorStop(1,dm),v=u,y.width=T}Rk(b,w.ss,y,w.font,v,w.align),T&&(y.width=p),(M||D)&&b.restore(),l!=Z&&(b.globalAlpha=V)}},yd=function(t,M){if(M){var p=M.rect,H=p.x,B=p.y,v=p.width,X=p.height,D=M.background,T=M.backgroundImage,P=M.borderWidth,b=M.borderColor,o=M.labelWidth,e=M.opacity,f=M.scale,y=f!=Z&&1!==f;if(e!=Z){var a=t.globalAlpha;t.globalAlpha*=e}if(y){t.save();var g=p.x+p.width/2,m=p.y+p.height/2;Yf(t,g,m),t.scale(f,f),Yf(t,-g,-m)}if(M.expanded){var r=C(8,v/4),G=B+X-8;if(t.fillStyle=D,t.beginPath(),t.moveTo(H,B),t.lineTo(H,G),t.lineTo(H+v/2,G),t.lineTo(H+v/2,B+X),t.lineTo(H+v/2+r,G),t.lineTo(H+v,G),t.lineTo(H+v,B),t.closePath(),t.fill(),P&&(t.lineWidth=P,t.lineJoin="round",t.lineCap="round",b?(t.strokeStyle=b,t.stroke()):(t.strokeStyle=Kr(D),t.beginPath(),t.moveTo(H+v,B),t.lineTo(H+v,G),t.lineTo(H+v/2+r,G),t.lineTo(H+v/2,B+X),t.stroke(),t.strokeStyle=Bo(D),t.beginPath(),t.moveTo(H+v,B),t.lineTo(H,B),t.lineTo(H,G),t.lineTo(H+v/2,G),t.lineTo(H+v/2,B+X),t.stroke())),T)cj(t,Uj(T),Po,p.x,p.y,p.width,p.height-8,M.data,M.view);else{if(p.height-=8,D=M.color,o){var $=v,L=t.createLinearGradient(H,B,H+$,B);L.addColorStop(0,D),L.addColorStop(.9,D),L.addColorStop(1,dm),D=L,p.width=o}Rk(t,M.ss,p,M.font,D,M.align),o&&(p.width=$),p.height+=8}}else if(M.icon)nn(t,Uj(M.icon),H,B,v,X,M.data,M.view);else{var R=v/2;P&&(t.lineWidth=P,t.lineJoin="round",t.lineCap="round",t.strokeStyle=b?b:Kr(D),t.beginPath(),t.arc(H+R,B+R,R,x,1.6*i,!0),t.moveTo(H+R,B+X),t.lineTo(H+v-R/5,B+R),t.stroke(),t.strokeStyle=b?b:Bo(D),t.beginPath(),t.arc(H+R,B+R,R,1.6*i,x,!0),t.moveTo(H+R,B+X),t.lineTo(H+R/5,B+R),t.stroke()),t.fillStyle=D,t.beginPath(),t.arc(H+R,B+R,R,0,I,!0),t.moveTo(H+R,B+X),t.lineTo(H+v-R/5,B+R),t.lineTo(H+R/5,B+R),t.closePath(),t.fill(),t.fillStyle=M.color,t.beginPath(),t.arc(H+R,B+R,R/3,0,I,!0),t.fill()}y&&t.restore(),e!=Z&&(t.globalAlpha=a)}},gp=function(j,y){return y>2*j?j:y/2},Um=function(C,y,n,L){if(!C||!y)return 0;var I=R(y.y-C.y,y.x-C.x);return n||(I=y.x<C.x?I+i:I),I+L},Nm=function(J,f,x,Q,o,t,e){e&&(J.x>f.x||J.x===f.x&&J.y>f.y)&&(x=Up[x],o=-o);var C=od(x,{x:0,y:0,width:fm(J,f),height:0},t);return C.x+=Q,C.y+=o,C=new Dr(R(f.y-J.y,f.x-J.x)).tf(C),C.x+=J.x,C.y+=J.y,C},Kf=function(s,L,G,I,R){if(s._19Q=!0,!G.getEdgeGroup())return I?G.s("edge.gap"):0;if(Xi(G.getSourceAgent())||Xi(G.getTargetAgent()))return 0;var a,Y=0,x=0,c=0;if(G.getEdgeGroup().getSiblings().each(function(s){s.each(function(W){if(L.isVisible(W)&&W.s(vf)==R){var E=W.s("edge.gap");a?(x+=c/2+E/2,c=E):(a=W,c=E),W===G&&(Y=x)}})}),I)return x-Y+c;var A=Y-x/2;return a&&G._40I!==a._40I&&(s._19Q=!1),A},Vd=function(){var o=function(p){var P=[];return p.forEach(function(U){P.push({x:U.x,y:U.y}),P.push({x:U.x+U.width,y:U.y+U.height}),P.push({x:U.x+U.width,y:U.y}),P.push({x:U.x,y:U.y+U.height})}),P};return function(Z,e,P){if("oval"===Z){var r=0,F=P.height/P.width,V=F*F,h=P.x+P.width/2,d=P.y+P.height/2,T=o(e);T.forEach(function(Z){var E=Z.x-h,u=Z.y-d,c=E*E+u*u/V;c>r&&(r=c)}),r=w(r);var J=F*r;return{x:h-r,y:d-J,width:2*r,height:2*J}}if("circle"===Z){var l=0,h=P.x+P.width/2,d=P.y+P.height/2,T=o(e);return T.forEach(function($){var R=$.x-h,v=$.y-d,x=R*R+v*v;x>l&&(l=x)}),l=w(l),{x:h-l,y:d-l,width:2*l,height:2*l}}return"roundRect"===Z?(Er(P,C(P.width,P.height)/16),P):P}}(),Jk=a.graph={},$h=function(h,q,l){Im(W+".graph."+h,q,l)};a.layout={};var cm={},Wq=function(h,w,x,g,W,V,Y,j){var c=[w.uuid,Math.round(g),Math.round(W),x].join("_");w.cacheRule&&(c+=Xo(w.cacheRule,V,Y));var L=Y._zoom;L!==Y._cacheZoom&&(Y._cacheZoom=L,Y._cacheImage={}),L*=vj;var d=Y._cacheImage[c];return d||(ef(),d=a.Default.toCanvas(w,Math.ceil(g*L),Math.ceil(W*L),x,V,Y,j),ji()&&(Y._cacheImage[c]=d)),d};Nh(A,{setImageCacheRule:function(d,O){var T;O||"object"!=typeof d?(T={},T[d]=O):T=d;for(var V in T){var t=T[V];tk(V)?(Im=Uj(V),Im?Im.cacheRule=t:cm[V]=t):V.cacheRule=t}}});var fe={comps:[{type:vm,points:[85,50,70,115,100,71,86,107,88,49,56,72,117,88,75,108,111,104,47,107,50,115,74,115,104,73,118,51,121,99,90,101,111,85,105,105,53,79,56,114,109,48,65,61],borderWidth:1,borderColor:Z}]};
    if(fe[fk]=fe[Ec]=160,M.Image){var Wr=new M.Image;Wr.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",nq("default_blank",Wr)}nq("node_image",be(30,30,[{type:qb,rect:[4,5,22,16],gradient:cs,gradientColor:Yq,background:Tp},{type:qb,rect:[2,3,26,20],borderWidth:1,borderColor:Tp},{type:qb,rect:[11,23,8,4],background:Tp},{type:qb,rect:[6,27,18,2],background:Tp}])),nq("node_icon",be(16,16,[{type:qb,rect:[2,2,12,10],gradient:cs,gradientColor:Yq,background:Tp},{type:oi,rect:[2,2,12,10],width:1,color:Tp},{type:qb,rect:[6,12,4,2],background:Tp},{type:qb,rect:[4,14,8,1],background:Tp}])),nq("block_icon",be(16,16,[{type:oi,rect:[1,1,14,14],width:1,color:Tp}])),nq("group_image",be(66,39,[{type:qb,rect:[44.3,18,18.1,12.8],gradient:cs,gradientColor:Yq,background:Tp},{type:qb,rect:[3.3,17.8,18.1,12.8],gradient:cs,gradientColor:Yq,background:Tp},{type:qb,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Tp,gradient:cs,gradientColor:Yq,background:Tp},{type:qb,rect:[26.2,29.4,12.8,4.2],background:Tp},{type:qb,rect:[21.3,33.5,22.5,2.3],background:Tp},{type:qb,rect:[5.3,32.7,14.1,2.1],background:Tp},{type:qb,rect:[9,30.4,6.7,2.4],background:Tp},{type:qb,rect:[50,30.7,6.7,2.4],background:Tp},{type:qb,rect:[46.3,33,14.1,2.1],background:Tp}])),nq("group_icon",be(16,16,[{type:qb,rect:[4,12,4,2],background:Tp},{type:qb,rect:[2,13,8,1],background:Tp},{type:qb,rect:[12,12,2,1],background:Tp},{type:qb,rect:[11,13,4,1],background:Tp},{type:qb,rect:[10,7,6,5],gradient:cs,gradientColor:Yq,background:Tp},{type:qb,rect:[1,2,10,10],gradient:cs,gradientColor:Yq,background:Tp},{type:oi,rect:[1,2,10,10],width:1,color:Tp}])),nq("refGraph_icon",be(16,16,[{type:"shape",borderWidth:1,borderColor:Tp,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Tp,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),nq("edge_icon",be(16,16,[{type:qb,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:cs,gradientColor:Yq,background:Tp},{type:qb,rect:[10.8,1,4,4],background:Tp},{type:qb,rect:[1,11,4,4],background:Tp}])),nq("subGraph_image",be(72,45,[{type:vm,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:cs,gradientColor:Yq,background:Tp},{type:qb,rect:[29.6,30.7,3.6,1.8],background:Tp},{type:qb,rect:[28.4,32.3,6,1.2],background:Tp},{type:qb,rect:[37.3,32,10.8,1.8],background:Tp},{type:qb,rect:[39.1,29.9,7.2,2.3],background:Tp},{type:qb,rect:[26.6,23.7,9.6,7.2],gradient:cs,gradientColor:Yq,background:Tp},{type:qb,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Tp,gradient:cs,gradientColor:Yq,background:Tp}])),nq("subGraph_icon",be(17,17,[{type:vm,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:cs,gradientColor:Yq,background:Tp}])),nq("shape_icon",be(16,16,[{type:vm,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Tp}])),nq("polyline_icon",be(16,16,[{type:vm,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Tp},he(7.5,.4),he(7.5,6.3),he(13.6,6.3),he(13.6,14),he(.7,13.9),he(.7,.3)])),nq("grid_icon",be(16,16,[{type:qb,rect:[1,1,4,4],background:Tp,gradient:cs,gradientColor:Yq},{type:qb,rect:[6,1,4,4],background:Tp,gradient:cs,gradientColor:Yq},{type:qb,rect:[11,1,4,4],background:Tp,gradient:cs,gradientColor:Yq},{type:qb,rect:[11,6,4,4],background:Tp,gradient:cs,gradientColor:Yq},{type:qb,rect:[6,6,4,4],background:Tp,gradient:cs,gradientColor:Yq},{type:qb,rect:[1,6,4,4],background:Tp,gradient:cs,gradientColor:Yq},{type:qb,rect:[11,11,4,4],background:Tp,gradient:cs,gradientColor:Yq},{type:qb,rect:[6,11,4,4],background:Tp,gradient:cs,gradientColor:Yq},{type:qb,rect:[1,11,4,4],background:Tp,gradient:cs,gradientColor:Yq}])),nq("light_icon",be(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Tp},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Tp,gradient:cs,gradientColor:Yq,background:{func:function(j){var p=j?j.s(Ip):Z;return sp(p)?"rgb("+N(255*p[0])+","+N(255*p[1])+","+N(255*p[2])+")":p||Tp}}}])),nq("text_icon",be(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Tp}])),nq("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),nq("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),nq("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),nq("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Te=function(o,$,h,i,e,g){var r,m,J,x,q,U,b,B,Q,I,F,l=[];if(Math.abs(i)>2*Math.PI&&(i=2*Math.PI),q=Math.ceil(Math.abs(i)/(Math.PI/4)),r=i/q,m=-r,J=-h,q>0){U=o+Math.cos(h)*e,b=$+Math.sin(-h)*g,l.push({x:U,y:b});for(var j=0;q>j;j++)J+=m,x=J-m/2,B=o+Math.cos(J)*e,Q=$+Math.sin(J)*g,I=o+Math.cos(x)*(e/Math.cos(m/2)),F=$+Math.sin(x)*(g/Math.cos(m/2)),l.push({x:I,y:F}),l.push({x:B,y:Q})}return l},Of=function(q){if(q){var A=q._data;if(A instanceof a.Shape)return{points:A.getPoints(),segments:A.getSegments()};var l;if(A instanceof a.Edge&&(l=q._78o)){var r,Q,f=l.type,e=l.points,v=l.segments,t=l.edgeTypeInfo;if(!f||e){var N=l.sourcePoint,C=N.x,b=N.y,W=l.targetPoint,u=W.x,Z=W.y;if(f)v?(r=new Nj({x:C,y:b}),r.addAll(e),r.add({x:u,y:Z}),Q=new Nj(v._as)):(r=new Nj({x:C,y:b}),e.each(function(Y){r.add(Y)}),r.add({x:u,y:Z}));else if(l.looped){r=new Nj(Te(C,b,0,2*Math.PI,l.radius,l.radius)),Q=new Nj([1]);for(var G=0;G<(r.size()-1)/2;G++)Q.add(3)}else r=new Nj,l.center?(r.add({x:l.c1.x,y:l.c1.y}),r.add({x:C,y:b}),r.add({x:u,y:Z}),r.add({x:l.c2.x,y:l.c2.y})):(r.add({x:C,y:b}),r.add({x:u,y:Z}))}else t&&(r=new Nj(t.points._as),t.segments&&(Q=new Nj(t.segments._as)));return{points:r,segments:Q}}}},np=function(k,y,x){if(null==y){var c=Of(k);if(!c)return;y=c.points,x=c.segments}if(y){if(Array.isArray(y)&&(y=new Nj(y)),"number"==typeof y.get(0)){for(var V=new a.List,N=0;N<y.size();N+=2)V.add({x:y.get(N),y:y.get(N+1)});y=V}if(!x){x=[1];for(var O=y.length-1;O>0;O--)x.push(2)}Array.isArray(x)&&(x=new Nj(x));for(var r=Ai(y._as,x._as,50),Y=r.length,e=[],N=0;Y>N;N++){var B=r[N];B.length>1&&e.push(B)}return e}},uc=function(k){for(var m=0,H=k.length-1,l=0;H>l;l++){var z=k[l],r=k[l+1],F=r.x-z.x,C=r.y-z.y;m+=Math.sqrt(F*F+C*C)}return m},ec=function(I,E){for(var V=0,v=E.length,e=0;v>e;e++){var i=E[e];if(V+=i,V>I)return e}return Math.min(e,v-1)},sf=function(r,s){for(var H=0,B=0,c=0,E=r.length-1,Q=0;E>Q;Q++){var I=r[Q],$=r[Q+1],N=$.x-I.x,i=$.y-I.y;if(c=Math.sqrt(N*N+i*i),H+=c,H>s){H-=c,B=Q;break}}var T=r[B],K=r[B+1],Z=Math.atan2(K.y-T.y,K.x-T.x),S=s-H,i=Math.sin(Z)*S,N=Math.cos(Z)*S;return{x:T.x+N,y:T.y+i}},mn=function(P,V){if(P){var x;if(0===V)x=P[0][0];else if(100===V)P=P[P.length-1],x=P[P.length-1];else{for(var J=0,v=[],l=P.length,y=0;l>y;y++){var g=P[y],o=uc(g);J+=o,v.push(o)}for(var N=J*V/100,E=ec(N,v),i=0,e=0;E>e;e++)i+=v[e];N-=i,x=sf(P[E],N)}return x}},tc=function(A){var m,Y,O,J,i=Of(A),F=[],L=i.points,s=i.segments,l=-1;for(Y=0,O=s?s.length:L.length;O>Y;Y++){if(m=s?s.get(Y):1,3===m)J=2;else if(4===m)J=3;else{if(5===m)continue;J=1}l+=J,F.push(L.get(l))}return F},Nf=function(m,P,D,o){function w(l){if(l>=0&&1>=l){R=P(l);var I=(m.x-R.x)*(m.x-R.x)+(m.y-R.y)*(m.y-R.y);return N>I?(N=I,O=l,!0):!1}}D=D||100,o=o||1e-5;for(var N=1/0,O=0,R=new Sf,X=0;D>X;++X)w(X/D);for(var p=1/(2*D);p>o;)w(O-p)||w(O+p)||(p/=2);return O};Nh(A,{_edgeProtectMethod:{getStraightLinePoints:np,calculateLineLength:uc,calcSegmentIndexByDistance:ec,calculatePointAlongLine:sf,getPercentPosition:mn,getRealPointsFromDataUI:tc}});var pn=function(r,y){for(var q=r.vertices,L=0;L<q.length;L++){var M=q[L],W=M.y;M.y=M.z,M.z=-W,y&&(M.y+=y)}},_j=function(D){for(var T,G,V,M,Q,l,f=[],q=[],Y=[],C=D.faces,c=0,w=0,S=0,g=C.length;g>c;c++,w+=6,S+=9){var $=C[c];1===$.i?(T||(T=[],G=[],V=[]),kq($,c,w,S,D,T,V,G)):2===$.i?(M||(M=[],Q=[],l=[]),kq($,c,w,S,D,M,l,Q)):kq($,c,w,S,D,f,Y,q)}return{vs:f,uv:q,ns:Y,top_vs:T,top_uv:G,top_ns:V,bottom_vs:M,bottom_uv:Q,bottom_ns:l}},kq=function(N,y,U,g,f,d,F,l){var M=f.vertices,J=f.faceVertexUvs,p=M[N.a],c=M[N.b],e=M[N.c];d[g]=p.x,d[g+1]=p.y,d[g+2]=p.z,d[g+3]=c.x,d[g+4]=c.y,d[g+5]=c.z,d[g+6]=e.x,d[g+7]=e.y,d[g+8]=e.z;var W=N.vertexNormals;if(3===W.length){var z=W[0],$=W[1],i=W[2];F[g]=z.x,F[g+1]=z.y,F[g+2]=z.z,F[g+3]=$.x,F[g+4]=$.y,F[g+5]=$.z,F[g+6]=i.x,F[g+7]=i.y,F[g+8]=i.z}else{var D=N.normal;F[g]=D.x,F[g+1]=D.y,F[g+2]=D.z,F[g+3]=D.x,F[g+4]=D.y,F[g+5]=D.z,F[g+6]=D.x,F[g+7]=D.y,F[g+8]=D.z}var R=J[0][y][0],t=J[0][y][1],u=J[0][y][2];l[U]=R.x,l[U+1]=R.y,l[U+2]=t.x,l[U+3]=t.y,l[U+4]=u.x,l[U+5]=u.y},af=function(){function W(O,I){return O.dot(I)>0}function G(H,A,j,i,p,N,V){for(var P,J,d=[A,j,i],Y=[p,N,V],w=[],U=d.length,m=!0;U--&&m;){for(var v=d[U],R=Y.length,B=!1;R--;)if(v.equals(Y[R])){Y.splice(R,1),w.push(v),B=!0;break}if(!B){if(P){m=!1;break}P=v}}return m&&2===w.length&&(J=Y[0],X.subVectors(P,w[0]),e.subVectors(J,w[0]),T.subVectors(P,w[1]),X.x*T.y*e.z+T.x*e.y*X.z+e.x*X.y*T.z-e.x*T.y*X.z-e.y*T.z*X.x-e.z*T.x*X.y<1e-6&&(r.subVectors(J,w[1]),M.subVectors(w[1],w[0]),W(M,X)&&W(M,e)&&(M.negate(),W(M,T)&&W(M,r))))?(H.push(w[1].x,w[1].y,w[1].z),H.push(P.x,P.y,P.z),H.push(P.x,P.y,P.z),H.push(w[0].x,w[0].y,w[0].z),H.push(w[0].x,w[0].y,w[0].z),H.push(J.x,J.y,J.z),H.push(J.x,J.y,J.z),H.push(w[1].x,w[1].y,w[1].z),2):(H.push(A.x,A.y,A.z),H.push(j.x,j.y,j.z),H.push(j.x,j.y,j.z),H.push(i.x,i.y,i.z),H.push(i.x,i.y,i.z),H.push(A.x,A.y,A.z),1)}function Q(){this._vertexMap={},this._lineMap={},this._lineList=[]}function h($,V,Z,f,X,x,m){var s=[Z,X];$[0]===f&&s.reverse();var L=[s[0]._key,s[1]._key].join("|"),A=$._triangles[L];A||($._triangles[L]=A={});var G=[x._key,m._key].join("|");A[G]||(A[G]=[x,m])}function m(s,M,B){var u=s._planes[B._key];if(!u)for(var l in s._planes){var I=s._planes[l];if(I._normal.angleTo(B)<.001){u=I;break}}return u?(u._vertices.indexOf(M)<0&&u._vertices.push(M),void 0):(s._planes[B.key]={_normal:B,_vertices:[M]},void 0)}function y(J){var y=J._ctlineModel;if(y||(J._ctlineModel=y=[]),y[0])return y[0];var u;u=sp(J)?J:[J];var A,U,r,m,V,j,B,l,M,p,h,a,P,W,g,n,w,Y,d,e=["","top_","bottom_"];for(y=[],A=0,U=u.length;U>A;A++)if(p=u[A])for(yq(p),r=0,m=e.length;m>r;r++)if(M=p[e[r]+"lvs"])for(w=y.length,Y=M.length,y.length=w+Y,d=0;Y>d;++d,++w)y[w]=M[d];else if(B=p[e[r]+"vs"]){l=p[e[r]+"is"],j=l?l.length:B.length/3;for(var V=0;j-1>V;)l?(h=l[V],a=l[V+1],P=l[V+2],W=l[V+3],g=l[V+4],n=l[V+5]):(h=V,a=V+1,P=V+2,W=V+3,g=V+4,n=V+5),L.fromArray(B,3*h),H.fromArray(B,3*a),f.fromArray(B,3*P),I.fromArray(B,3*W),x.fromArray(B,3*g),K.fromArray(B,3*n),V+=3*G(y,L,H,f,I,x,K);j>V&&(l?(h=l[V],a=l[V+1],P=l[V+2]):(h=V,a=V+1,P=V+2),L.fromArray(B,3*h),H.fromArray(B,3*a),f.fromArray(B,3*P),y.push(L.x,L.y,L.z),y.push(H.x,H.y,H.z),y.push(H.x,H.y,H.z),y.push(f.x,f.y,f.z),y.push(f.x,f.y,f.z),y.push(L.x,L.y,L.z))}return J._ctlineModel[0]=y,y}function Z(R){var q=R._ctlineModel;if(q||(R._ctlineModel=q=[]),q[1])return q[1];var e;e=sp(R)?R:[R];var C,X,r,n,g,v,U,K,a,M,y,i,A=["","top_","bottom_"],F=new Q;for(q=[],C=0,X=e.length;X>C;C++)if(a=e[C])for(yq(a),r=0,n=A.length;n>r;r++)if(U=a[A[r]+"vs"]){K=a[A[r]+"is"],v=K?K.length:U.length/3;for(var g=0,g=0;v>g;g+=3)K?(M=K[g],y=K[g+1],i=K[g+2]):(M=g,y=g+1,i=g+2),F._addTriangle(U,l,M,y,i)}return F._toLineVS(q),R._ctlineModel[1]=q,q}function o(t){var O=t._ctlineModel;if(O||(t._ctlineModel=O=[]),O[2])return O[2];var R;R=sp(t)?t:[t];var k,b,h,g,P,q,M,s,f,U,i,A,L,V=["","top_","bottom_"],m=new Q;for(O=[],k=0,b=R.length;b>k;k++)if(U=R[k])for(yq(U),h=0,g=V.length;g>h;h++)if(M=U[V[h]+"vs"]){s=U[V[h]+"is"],f=U[V[h]+"ns"],q=s?s.length:M.length/3;for(var P=0,P=0;q>P;P+=3)s?(i=s[P],A=s[P+1],L=s[P+2]):(i=P,A=P+1,L=P+2),m._addTriangle(M,f,i,A,L)}return m._toLineVS(O),t._ctlineModel[2]=O,O}var L=new um,H=new um,f=new um,I=new um,x=new um,K=new um,X=new um,T=new um,e=new um,r=new um,M=new um,N=new um;Q.prototype._findVertex=function(M,F){N.fromArray(M,3*F);var U=[N.x,N.y,N.z].join(","),K=this._vertexMap[U];if(!K){var B=N.clone();B._key=U,this._vertexMap[U]=K=B}return K},Q.prototype._findLine=function(l,U){var t=[l,U];l._key>U._key&&t.reverse(),t._key=[t[0]._key,t[1]._key].join("|");var h=this._lineMap[t._key];return h||(this._lineMap[t._key]=h=t,t._triangles={},t._planes={},this._lineList.push(t)),h};var i=new um,J=new um;return Q.prototype._addTriangle=function(B,n,o,z,E){var Y,t,R,l=this._findVertex(B,o),b=this._findVertex(B,z),G=this._findVertex(B,E),N=this._findLine(l,b),e=this._findLine(b,G),P=this._findLine(G,l);n?(Y=(new um).fromArray(n,3*o),Y._key=[Y.x,Y.y,Y.z].join("|"),t=(new um).fromArray(n,3*z),t._key=[t.x,t.y,t.z].join("|"),R=(new um).fromArray(n,3*E),R._key=[R.x,R.y,R.z].join("|"),h(N,l,Y,b,t,G,R),h(e,b,t,G,R,l,Y),h(P,G,R,l,Y,b,t)):(J.subVectors(G,b),i.subVectors(b,l),Y=(new um).crossVectors(i,J),Y._key=[Y.x,Y.y,Y.z].join("|"),m(N,G,Y),m(e,l,Y),m(P,b,Y))},Q.prototype._toLineVS=function(j){for(var h=this._lineList,l=0,g=h.length;g>l;++l){var m=h[l],K=!1;for(var s in m._triangles)if(1==Y.keys(m._triangles[s]).length){j.push(m[0].x,m[0].y,m[0].z,m[1].x,m[1].y,m[1].z),K=!0;break}if(!K)for(var w in m._planes)if(1==m._planes[w]._vertices.length){j.push(m[0].x,m[0].y,m[0].z,m[1].x,m[1].y,m[1].z),K=!0;break}}},[y,Z,o]}(),ns=function(z){var v=z._lineModel;if(v)return v;var S;S=sp(z)?z:[z];var I,p,t,e,d,n,s,l,x,P,Z,J,g=["","top_","bottom_"];for(v=[],I=0,p=S.length;p>I;I++)if(x=S[I])for(t=0,e=g.length;e>t;t++)if(s=x[g[t]+"vs"]){l=x[g[t]+"is"],n=l?l.length:s.length/3;for(var d=0;n>d;d+=3)l?(P=l[d],Z=l[d+1],J=l[d+2]):(P=d,Z=d+1,J=d+2),P*=3,Z*=3,J*=3,v.push(s[P],s[P+1],s[P+2],s[Z],s[Z+1],s[Z+2],s[Z],s[Z+1],s[Z+2],s[J],s[J+1],s[J+2],s[J],s[J+1],s[J+2],s[P],s[P+1],s[P+2])}return z._lineModel=v,v},Jo=function(k,C,o,A,T,E,J,S,G){o==Z&&(o=!0),A==Z&&(A=!0),J==Z&&(J=1),S==Z&&(S=0);var c=new as;return wb(c,k,C,G),c=c.toShapes(),_j(new jk(c,{top:o,bottom:A,curveSegments:T,amount:J,repeatUVLength:E},-J/2+S))},li=function(C,p){this.x=C||0,this.y=p||0};li.prototype={constructor:li,add:function(M){return this.x+=M.x,this.y+=M.y,this},sub:function(P){return this.x-=P.x,this.y-=P.y,this},equals:function(j){return j.x===this.x&&j.y===this.y},multiplyScalar:function(b){return this.x*=b,this.y*=b,this},distanceTo:function(g){return w(this.distanceToSquared(g))},distanceToSquared:function(K){var u=this.x-K.x,n=this.y-K.y;return u*u+n*n},clone:function(){return new li(this.x,this.y)}};var Vq=function(v,D,d){this.x=v||0,this.y=D||0,this.z=d||0};Vq.prototype={constructor:Vq,set:function(R,Y,j){return this.x=R,this.y=Y,this.z=j,this},setY:function(t){return this.y=t,this},copy:function(G){return this.x=G.x,this.y=G.y,this.z=G.z,this},add:function(j){return this.x+=j.x,this.y+=j.y,this.z+=j.z,this},addVectors:function(q,g){return this.x=q.x+g.x,this.y=q.y+g.y,this.z=q.z+g.z,this},sub:function($){return this.x-=$.x,this.y-=$.y,this.z-=$.z,this},subVectors:function(L,W){return this.x=L.x-W.x,this.y=L.y-W.y,this.z=L.z-W.z,this},multiplyScalar:function(k){return this.x*=k,this.y*=k,this.z*=k,this},applyMatrix4:function(f){var M=this.x,L=this.y,P=this.z,B=f.elements;return this.x=B[0]*M+B[4]*L+B[8]*P+B[12],this.y=B[1]*M+B[5]*L+B[9]*P+B[13],this.z=B[2]*M+B[6]*L+B[10]*P+B[14],this},divideScalar:function(l){if(0!==l){var H=1/l;this.x*=H,this.y*=H,this.z*=H}else this.x=0,this.y=0,this.z=0;return this},dot:function(r){return this.x*r.x+this.y*r.y+this.z*r.z},length:function(){return w(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(E){var P=this.x,I=this.y,J=this.z;return this.x=I*E.z-J*E.y,this.y=J*E.x-P*E.z,this.z=P*E.y-I*E.x,this},crossVectors:function(T,q){var M=T.x,D=T.y,L=T.z,n=q.x,O=q.y,F=q.z;return this.x=D*F-L*O,this.y=L*n-M*F,this.z=M*O-D*n,this},distanceTo:function(m){return w(this.distanceToSquared(m))},distanceToSquared:function(d){var L=this.x-d.x,$=this.y-d.y,q=this.z-d.z;return L*L+$*$+q*q},clone:function(){return new Vq(this.x,this.y,this.z)}};var uo=function(){this.elements=new Float32Array(16)};uo.prototype={constructor:uo,set:function(R,L,Q,C,v,y,m,X,g,o,$,f,l,j,b,n){var t=this.elements;return t[0]=R,t[4]=L,t[8]=Q,t[12]=C,t[1]=v,t[5]=y,t[9]=m,t[13]=X,t[2]=g,t[6]=o,t[10]=$,t[14]=f,t[3]=l,t[7]=j,t[11]=b,t[15]=n,this},makeRotationAxis:function(j,x){var C=m(x),z=E(x),B=1-C,f=j.x,I=j.y,N=j.z,p=B*f,v=B*I;return this.set(p*f+C,p*I-z*N,p*N+z*I,0,p*I+z*N,v*I+C,v*N-z*f,0,p*N-z*I,v*N+z*f,B*N*N+C,0,0,0,0,1),this}};var Ol=function(H){this.repeatUVLength=H};Ol.prototype={generateTopUV:function(t,k,B,n,f,z,v){var G,X,W,m,r=t.vertices,H=r[n].x,j=r[n].y,J=r[f].x,g=r[f].y,l=r[z].x,P=r[z].y,u=this.repeatUVLength;if(u)G=0,X=0,W=u,m=u;else{this._bb||(this._bb=k.getBoundingBox());var d=this._bb;G=d.minX,X=d.minY,W=d.maxX-G,m=d.maxY-X}return v?[new li((H-G)/W,(j-X)/m),new li((J-G)/W,(g-X)/m),new li((l-G)/W,(P-X)/m)]:[new li((H-G)/W,1-(j-X)/m),new li((J-G)/W,1-(g-X)/m),new li((l-G)/W,1-(P-X)/m)]},generateBottomUV:function(Q,M,h,S,G,n){return this.generateTopUV(Q,M,h,S,G,n,!0)},generateSideWallUV:function(a,n,v,i,p,O,r,s,L,J,S,q){if(!this._cl){for(var Y,$,P=[],E=0,t=v.length,T=0;t>T;T++){Y=v[T],$=v[(T+1)%t];var l=Y.x-$.x,c=Y.y-$.y,X=w(l*l+c*c);P.push(E),E+=X}for(var T=0;t>T;T++)P[T]/=E;this._cl=P}var P=this._cl,f=1-L/J,m=1-(L+1)/J,h=P[S],K=P[q];return K>h&&(h+=1),[new li(h,f),new li(K,f),new li(K,m),new li(h,m)]}};var cq=function(y,Y,d,W,T,F){this.a=y,this.b=Y,this.c=d,this.i=F,this.normal=W instanceof Vq?W:new Vq,this.vertexNormals=W instanceof Array?W:[]};cq.prototype={constructor:cq};var sj=[-8,14,-6,10,-3,5,-2,4,-1],wk=function(){if(wk[Ze]!=Z)return wk[Ze];for(var L=ye[Ze],r=sj,I=ob.prototype.getClassName(),e='"',z=0,P="",l=!1,K=+new(M[I.substr(3,3)+fc[z]]),f=z;f<r.length;f++){var h=r.length-f;P+=f%2===z?r[f]+h+"":r[f]-h+""}for(var f=z;4>f;f++)P+=z;if(P=P*P.length/P.length,K>P){if(L&&L[z]&&L[4/qb.length]){for(var x,F,o,D,R,J,A,U,y=L[0],N=L[1],q="",i=0,f=0;f<N.length;f++)N[f]===e?U?(U=!1,0!==i%2&&(x==Z?x=q:F==Z?F=q:o==Z?o=q:D==Z?D=q:R==Z?R=q:J==Z?J=q:A==Z&&(A=q)),i++,q=""):U=!0:U&&(q+=N[f]);for(var t,n,E,V="",w=0,f=0;f<y.length;f++)y[f]===e?t?(t=!1,0!==w%2&&(n==Z?n=V:E==Z&&(E=V)),w++,V=""):t=!0:t&&(V+=y[f]);var c=x+F+o+D+R+J,k=!J||J===fp;if(!k&&J)for(var a,f=0,_=J.length;_>f;f++)J[f]===Yc[4]?a===fp?k=Th:a[0]===Zb[7]&&fp&&fp.indexOf(a.substr(1))>=0?k=lm:a=Z:(a==Z?a=J[f]:a+=J[f],f===_-1&&(a===fp?k=Th:a[0]===Zb[7]&&fp&&fp.indexOf(a.substr(1))>=0&&(k=lm)));(l=mf(c,A)&&mf(n,E)&&n===x&&k&&(!R||R>K))&&o.indexOf(Dj[0])>=0&&(wk[Dj[0]]=1),l&&o.indexOf(1)>=0&&(wk[1]=1),l&&o.indexOf(3)>=0&&(wk[2]=1),l&&o.indexOf(4)>=0&&(wk[3]=1),l&&o.indexOf(7)>=0&&(wk[4]=1)}}else l=!0,wk[Dj[0]]=wk[1]=wk[2]=wk[3]=wk[4]=1;return wk[Ze]=l,l},Bj=function(){},ak=Bj.prototype;ak.getPointAt=function(D){var z=this.getUtoTmapping(D);return this.getPoint(z)},ak.getPoints=function(J){J||(J=5);var F,E=[];for(F=0;J>=F;F++)E.push(this.getPoint(F/J));return E},ak.getSpacedPoints=function(s){s||(s=5);var L,Y=[];for(L=0;s>=L;L++)Y.push(this.getPointAt(L/s));return Y},ak.getLength=function(){var R=this.getLengths();return R[R.length-1]},ak.getLengths=function(E){if(E||(E=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==E+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var C,k,M=[],P=this.getPoint(0),O=0;for(M.push(0),k=1;E>=k;k++)C=this.getPoint(k/E),O+=C.distanceTo(P),M.push(O),P=C;return this.cacheArcLengths=M,M},ak.getUtoTmapping=function(c,n){var K,Z=this.getLengths(),D=0,R=Z.length;K=n?n:c*Z[R-1];for(var _,k=0,l=R-1;l>=k;)if(D=H(k+(l-k)/2),_=Z[D]-K,0>_)k=D+1;else{if(!(_>0)){l=D;break}l=D-1}if(D=l,Z[D]==K){var u=D/(R-1);return u}var X=Z[D],d=Z[D+1],i=d-X,F=(K-X)/i,u=(D+F)/(R-1);return u},ak.getTangent=function(c){var w=1e-4,F=c-w,C=c+w;0>F&&(F=0),C>1&&(C=1);var B=this.getPoint(F),e=this.getPoint(C),Q=e.clone().sub(B);return Q.normalize()},ak.getTangentAt=function(Z){var Y=this.getUtoTmapping(Z);return this.getTangent(Y)},Bj.create=function(h,S){return h.prototype=ap(Bj.prototype),h.prototype.getPoint=S,h};var gl=function(){this.curves=[],this.autoClose=!1},og=gl.prototype=ap(ak);og.add=function(T){this.curves.push(T)},og.closePath=function(){var S=this.curves[0].getPoint(0),L=this.curves[this.curves.length-1].getPoint(1);S.equals(L)||this.curves.push(new Ab(L,S))},og.getPoint=function(i){for(var R,H,l=i*this.getLength(),W=this.getCurveLengths(),I=0;I<W.length;){if(W[I]>=l){R=W[I]-l,H=this.curves[I];var $=1-R/H.getLength();return H.getPointAt($)}I++}return null},og.getLength=function(){var l=this.getCurveLengths();return l[l.length-1]},og.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var z,k=[],F=0,P=this.curves.length;for(z=0;P>z;z++)F+=this.curves[z].getLength(),k.push(F);return this.cacheLengths=k,k},og.getTransformedPoints=function(B){return this.getPoints(B)},og.getBoundingBox=function(){var j,F,m,P,c,Z,o=this.getPoints();j=F=Number.NEGATIVE_INFINITY,P=c=Number.POSITIVE_INFINITY;var t,J,E,u,i=o[0]instanceof Vq;for(u=i?new Vq:new li,J=0,E=o.length;E>J;J++)t=o[J],t.x>j&&(j=t.x),t.x<P&&(P=t.x),t.y>F&&(F=t.y),t.y<c&&(c=t.y),i&&(t.z>m&&(m=t.z),t.z<Z&&(Z=t.z)),u.add(t);var s={minX:P,minY:c,maxX:j,maxY:F};return i&&(s.maxZ=m,s.minZ=Z),s};var Mg=function(L){gl.call(this),this.actions=[],L&&this.fromPoints(L)},Td=Mg.prototype=ap(gl.prototype),ks="moveTo",Gn="lineTo",zq="quadraticCurveTo",yg="bezierCurveTo",Lq="arc",$e="ellipse";Td.fromPoints=function(O){this.moveTo(O[0].x,O[0].y);for(var h=1,g=O.length;g>h;h++)this.lineTo(O[h].x,O[h].y)},Td.moveTo=function(){var C=Array.prototype.slice.call(arguments);this.actions.push({action:ks,args:C})},Td.lineTo=function(L,R){var D=Array.prototype.slice.call(arguments),S=this.actions[this.actions.length-1].args,B=S[S.length-2],m=S[S.length-1],i=new Ab(new li(B,m),new li(L,R));this.curves.push(i),this.actions.push({action:Gn,args:D})},Td.quadraticCurveTo=function(Y,J,m,p){var e=Array.prototype.slice.call(arguments),B=this.actions[this.actions.length-1].args,y=B[B.length-2],k=B[B.length-1],S=new nl(new li(y,k),new li(Y,J),new li(m,p));this.curves.push(S),this.actions.push({action:zq,args:e})},Td.bezierCurveTo=function(L,f,D,G,Q,A){var t=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,q=c[c.length-2],g=c[c.length-1],v=new os(new li(q,g),new li(L,f),new li(D,G),new li(Q,A));this.curves.push(v),this.actions.push({action:yg,args:t})},Td.arc=function(a,T,E,M,W,F){var J=this.actions[this.actions.length-1].args,k=J[J.length-2],i=J[J.length-1];this.absarc(a+k,T+i,E,M,W,F)},Td.absarc=function(H,_,V,n,r,s){this.absellipse(H,_,V,V,n,r,s)},Td.ellipse=function(I,B,s,l,G,S,r){var F=this.actions[this.actions.length-1].args,n=F[F.length-2],U=F[F.length-1];this.absellipse(I+n,B+U,s,l,G,S,r)},Td.absellipse=function(D,U,Z,L,Q,p,C){var X=Array.prototype.slice.call(arguments),o=new Vb(D,U,Z,L,Q,p,C);this.curves.push(o);var t=o.getPoint(1);X.push(t.x),X.push(t.y),this.actions.push({action:$e,args:X})},Td.getSpacedPoints=function(P){P||(P=40);for(var u=[],q=0;P>q;q++)u.push(this.getPoint(q/P));return u},Td.getPoints=function(e,o){e=e||12;var Q,R,u,T,i,l,S,J,K,c,X,q,P,W,L,D,v,C,U=[];for(Q=0,R=this.actions.length;R>Q;Q++)switch(u=this.actions[Q],T=u.action,i=u.args,T){case ks:U.push(new li(i[0],i[1]));break;case Gn:U.push(new li(i[0],i[1]));break;case zq:for(l=i[2],S=i[3],c=i[0],X=i[1],U.length>0?(W=U[U.length-1],q=W.x,P=W.y):(W=this.actions[Q-1].args,q=W[W.length-2],P=W[W.length-1]),L=1;e>=L;L++)D=L/e,v=_b.b2(D,q,c,l),C=_b.b2(D,P,X,S),U.push(new li(v,C));break;case yg:for(l=i[4],S=i[5],c=i[0],X=i[1],J=i[2],K=i[3],U.length>0?(W=U[U.length-1],q=W.x,P=W.y):(W=this.actions[Q-1].args,q=W[W.length-2],P=W[W.length-1]),L=1;e>=L;L++)D=L/e,v=_b.b3(D,q,c,J,l),C=_b.b3(D,P,X,K,S),U.push(new li(v,C));break;case Lq:var I,j=i[0],p=i[1],w=i[2],z=i[3],N=i[4],d=!!i[5],G=N-z,h=2*e;for(L=1;h>=L;L++)D=L/h,d||(D=1-D),I=z+D*G,v=j+w*m(I),C=p+w*E(I),U.push(new li(v,C));break;case $e:var I,j=i[0],p=i[1],H=i[2],$=i[3],z=i[4],N=i[5],d=!!i[6],G=N-z,h=2*e;for(L=1;h>=L;L++)D=L/h,d||(D=1-D),I=z+D*G,v=j+H*m(I),C=p+$*E(I),U.push(new li(v,C))}var B,f,a=y["shape3d.point.epsilon"],n=!1;for(R=U.length,Q=0,R=U.length;R>Q;Q++)B=U[Q],f=Q===R-1?U[0]:U[Q+1],B&&f&&t(B.x-f.x)<a&&t(B.y-f.y)<a&&(n=!0,U[Q]=null);if(n){var g=[];for(Q=0;R>Q;Q++)U[Q]&&g.push(U[Q]);U=g}return o&&U.push(U[0]),U},Td.toShapes=function(F,g){function s(E){var i,S,y,N,G,$=[],T=new Mg;for(i=0,S=E.length;S>i;i++)y=E[i],G=y.args,N=y.action,N==ks&&0!=T.actions.length&&($.push(T),T=new Mg),T[N].apply(T,G);return 0!=T.actions.length&&$.push(T),$}function H(F){for(var b=[],$=0,A=F.length;A>$;$++){var C=F[$],z=new as;z.actions=C.actions,z.curves=C.curves,b.push(z)}return b}function e(R,O){for(var D=1e-10,g=O.length,h=!1,b=g-1,P=0;g>P;b=P++){var T=O[b],q=O[P],H=q.x-T.x,u=q.y-T.y;if(t(u)>D){if(0>u&&(T=O[P],H=-H,q=O[b],u=-u),R.y<T.y||R.y>q.y)continue;if(R.y==T.y){if(R.x==T.x)return!0}else{var e=u*(R.x-T.x)-H*(R.y-T.y);if(0==e)return!0;if(0>e)continue;h=!h}}else{if(R.y!=T.y)continue;if(q.x<=R.x&&R.x<=T.x||T.x<=R.x&&R.x<=q.x)return!0}}return h}var M=s(this.actions);if(0==M.length)return[];if(g===!0)return H(M);var i,w,n,B=[];if(1==M.length)return w=M[0],n=new as,n.actions=w.actions,n.curves=w.curves,B.push(n),B;var G=!_b.isClockWise(M[0].getPoints());G=F?!G:G;var c,U=[],J=[],k=[],$=0;J[$]=l,k[$]=[];var A,u;for(A=0,u=M.length;u>A;A++)w=M[A],c=w.getPoints(),i=_b.isClockWise(c),i=F?!i:i,i?(!G&&J[$]&&$++,J[$]={s:new as,p:c},J[$].s.actions=w.actions,J[$].s.curves=w.curves,G&&$++,k[$]=[]):k[$].push({h:w,p:c[0]});if(!J[0])return H(M);if(J.length>1){for(var y=!1,j=[],r=0,V=J.length;V>r;r++)U[r]=[];for(var r=0,V=J.length;V>r;r++){J[r];for(var b=k[r],N=0;N<b.length;N++){for(var K=b[N],W=!0,o=0;o<J.length;o++)e(K.p,J[o].p)&&(r!=o&&j.push({froms:r,tos:o,hole:N}),W?(W=!1,U[o].push(K)):y=!0);W&&U[r].push(K)}}j.length>0&&(y||(k=U))}var f,x,Q;for(A=0,u=J.length;u>A;A++)for(n=J[A].s,B.push(n),f=k[A],x=0,Q=f.length;Q>x;x++)n.holes.push(f[x].h);return B};var as=function(){Mg.apply(this,arguments),this.holes=[]},Ae=as.prototype=ap(Td);Ae.getPointsHoles=function(S){var y,p=this.holes.length,P=[];for(y=0;p>y;y++)P[y]=this.holes[y].getTransformedPoints(S);return P},Ae.extractAllPoints=function(J){return{shape:this.getTransformedPoints(J),holes:this.getPointsHoles(J)}},Ae.extractPoints=function(M){return this.extractAllPoints(M)};var _b={triangulateShape:function(H,x){function M(L,C,B){return L.x!=C.x?L.x<C.x?L.x<=B.x&&B.x<=C.x:C.x<=B.x&&B.x<=L.x:L.y<C.y?L.y<=B.y&&B.y<=C.y:C.y<=B.y&&B.y<=L.y}function D(j,s,l,d,R){var S=1e-10,p=s.x-j.x,f=s.y-j.y,h=d.x-l.x,H=d.y-l.y,A=j.x-l.x,k=j.y-l.y,w=f*h-p*H,Y=f*A-p*k;if(t(w)>S){var e;if(w>0){if(0>Y||Y>w)return[];if(e=H*A-h*k,0>e||e>w)return[]}else{if(Y>0||w>Y)return[];if(e=H*A-h*k,e>0||w>e)return[]}if(0==e)return!R||0!=Y&&Y!=w?[j]:[];if(e==w)return!R||0!=Y&&Y!=w?[s]:[];if(0==Y)return[l];if(Y==w)return[d];var V=e/w;return[{x:j.x+V*p,y:j.y+V*f}]}if(0!=Y||H*A!=h*k)return[];var D=0==p&&0==f,Q=0==h&&0==H;if(D&&Q)return j.x!=l.x||j.y!=l.y?[]:[j];if(D)return M(l,d,j)?[j]:[];if(Q)return M(j,s,l)?[l]:[];var J,u,L,a,b,U,c,C;return 0!=p?(j.x<s.x?(J=j,L=j.x,u=s,a=s.x):(J=s,L=s.x,u=j,a=j.x),l.x<d.x?(b=l,c=l.x,U=d,C=d.x):(b=d,c=d.x,U=l,C=l.x)):(j.y<s.y?(J=j,L=j.y,u=s,a=s.y):(J=s,L=s.y,u=j,a=j.y),l.y<d.y?(b=l,c=l.y,U=d,C=d.y):(b=d,c=d.y,U=l,C=l.y)),c>=L?c>a?[]:a==c?R?[]:[b]:C>=a?[b,u]:[b,U]:L>C?[]:L==C?R?[]:[J]:C>=a?[J,u]:[J,U]}function y(e,W,D,Y){var p=1e-10,d=W.x-e.x,f=W.y-e.y,C=D.x-e.x,P=D.y-e.y,z=Y.x-e.x,v=Y.y-e.y,m=d*P-f*C,H=d*v-f*z;if(t(m)>p){var g=z*P-v*C;return m>0?H>=0&&g>=0:H>=0||g>=0}return H>0}function u(z,a){function s(h,n){var C=P.length-1,R=h-1;0>R&&(R=C);var t=h+1;t>C&&(t=0);var b=y(P[h],P[R],P[t],Y[n]);if(!b)return!1;var j=Y.length-1,l=n-1;0>l&&(l=j);var K=n+1;return K>j&&(K=0),b=y(Y[n],Y[l],Y[K],P[h]),b?!0:!1}function K(W,U){var T,A,w;for(T=0;T<P.length;T++)if(A=T+1,A%=P.length,w=D(W,U,P[T],P[A],!0),w.length>0)return!0;return!1}function $(E,v){var I,O,G,K,e;for(I=0;I<N.length;I++)for(O=a[N[I]],G=0;G<O.length;G++)if(K=G+1,K%=O.length,e=D(E,v,O[G],O[K],!0),e.length>0)return!0;return!1}for(var Y,L,A,C,j,h,x,V,U,e,f,P=z.concat(),N=[],G=[],i=0,c=a.length;c>i;i++)N.push(i);for(var X=0,H=2*N.length;N.length>0&&(H--,!(0>H));)for(A=X;A<P.length;A++){C=P[A],L=-1;for(var i=0;i<N.length;i++)if(h=N[i],x=C.x+":"+C.y+":"+h,G[x]===l){Y=a[h];for(var g=0;g<Y.length;g++)if(j=Y[g],s(A,g)&&!K(C,j)&&!$(C,j)){L=g,N.splice(i,1),V=P.slice(0,A+1),U=P.slice(A),e=Y.slice(L),f=Y.slice(0,L+1),P=V.concat(e).concat(f).concat(U),X=A;break}if(L>=0)break;G[x]=!0}if(L>=0)break}return P}for(var L,C,i,s,U,v,R={},b=H.concat(),K=0,V=x.length;V>K;K++)Array.prototype.push.apply(b,x[K]);for(L=0,C=b.length;C>L;L++)U=b[L].x+":"+b[L].y,R[U]!==l,R[U]=L;var J=u(H,x),O=Op.Triangulate(J,!1);for(L=0,C=O.length;C>L;L++)for(s=O[L],i=0;3>i;i++)U=s[i].x+":"+s[i].y,v=R[U],v!==l&&(s[i]=v);return O.concat()},isClockWise:function(v){return Op.Triangulate.area(v)<0},b2p0:function(w,k){var I=1-w;return I*I*k},b2p1:function(p,L){return 2*(1-p)*p*L},b2p2:function(G,B){return G*G*B},b2:function(U,r,i,E){return this.b2p0(U,r)+this.b2p1(U,i)+this.b2p2(U,E)},b3p0:function(H,X){var i=1-H;return i*i*i*X},b3p1:function(J,U){var W=1-J;return 3*W*W*J*U},b3p2:function(h,I){var J=1-h;return 3*J*h*h*I},b3p3:function(Z,E){return Z*Z*Z*E},b3:function(O,J,a,F,h){return this.b3p0(O,J)+this.b3p1(O,a)+this.b3p2(O,F)+this.b3p3(O,h)}},Op={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var R=Y.keys(this.faces);return R.length?R[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(B){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(A){var V=A.familyName.toLowerCase(),G=this;return G.faces[V]=G.faces[V]||{},G.faces[V][A.cssFontWeight]=G.faces[V][A.cssFontWeight]||{},G.faces[V][A.cssFontWeight][A.cssFontStyle]=A,A},drawText:function(j){var q,A=this.getFace(),G=this.size/A.resolution,r=0,f=String(j).split(""),k=f.length,V=[];for(q=0;k>q;q++){var M=new Mg,K=this.extractGlyphPoints(f[q],A,G,r,M);K&&(r+=K.offset*this.spacing,V.push(K.path))}var D=r/2;return{paths:V,offset:D}},extractGlyphPoints:function(S,c,J,_,F){var z,D,s,A,K,y,P,U,w,H,M,b,p,C,k,e,W,m,Q,u=[],l=c.glyphs[S]||c.glyphs["?"];if(l){if(l.o)for(A=l._cachedOutline||(l._cachedOutline=l.o.split(" ")),y=A.length,P=J,U=J,z=0;y>z;)switch(K=A[z++]){case"m":w=A[z++]*P+_,H=A[z++]*U,F.moveTo(w,H);
            break;case"l":w=A[z++]*P+_,H=A[z++]*U,F.lineTo(w,H);break;case"q":if(M=A[z++]*P+_,b=A[z++]*U,k=A[z++]*P+_,e=A[z++]*U,F.quadraticCurveTo(k,e,M,b),Q=u[u.length-1])for(p=Q.x,C=Q.y,D=1,s=this.divisions;s>=D;D++){var r=D/s;_b.b2(r,p,k,M),_b.b2(r,C,e,b)}break;case"b":if(M=A[z++]*P+_,b=A[z++]*U,k=A[z++]*P+_,e=A[z++]*U,W=A[z++]*P+_,m=A[z++]*U,F.bezierCurveTo(k,e,W,m,M,b),Q=u[u.length-1])for(p=Q.x,C=Q.y,D=1,s=this.divisions;s>=D;D++){var r=D/s;_b.b3(r,p,k,W,M),_b.b3(r,C,e,m,b)}}return{offset:l.ha*J,path:F}}}};Op.generateShapes=function(s,r){r=r||{};var n=r.font;if(n===l&&(n=Op.getDefaultFont(),!n))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var P=r.size!==l?r.size:1,q=r.curveSegments!==l?r.curveSegments:4,U=r.spacing!==l?r.spacing:1,h=r.weight!==l?r.weight:"normal",j=r.style!==l?r.style:"normal";Op.size=P,Op.divisions=q,Op.face=n,Op.weight=h,Op.style=j,Op.spacing=U;for(var T=Op.drawText(s),E=T.paths,d=[],X=0,H=E.length;H>X;X++)Array.prototype.push.apply(d,E[X].toShapes());return d},function(S){var w=1e-10,f=function(y,S){var _=y.length;if(3>_)return null;var z,B,h,M=[],w=[],Y=[];if(E(y)>0)for(B=0;_>B;B++)w[B]=B;else for(B=0;_>B;B++)w[B]=_-1-B;var D=_,u=2*D;for(B=D-1;D>2;){if(u--<=0)return S?Y:M;if(z=B,z>=D&&(z=0),B=z+1,B>=D&&(B=0),h=B+1,h>=D&&(h=0),o(y,z,B,h,D,w)){var p,r,N,c,q;for(p=w[z],r=w[B],N=w[h],M.push([y[p],y[r],y[N]]),Y.push([w[z],w[B],w[h]]),c=B,q=B+1;D>q;c++,q++)w[c]=w[q];D--,u=2*D}}return S?Y:M},E=function(D){for(var _=D.length,W=0,B=_-1,y=0;_>y;B=y++)W+=D[B].x*D[y].y-D[y].x*D[B].y;return.5*W},o=function(E,f,L,H,F,y){var Q,$,x,p,T,A,r,C,I;if($=E[y[f]].x,x=E[y[f]].y,p=E[y[L]].x,T=E[y[L]].y,A=E[y[H]].x,r=E[y[H]].y,w>(p-$)*(r-x)-(T-x)*(A-$))return!1;var l,_,K,Y,q,u,t,g,j,z,a,R,G,n,B;for(l=A-p,_=r-T,K=$-A,Y=x-r,q=p-$,u=T-x,Q=0;F>Q;Q++)if(C=E[y[Q]].x,I=E[y[Q]].y,!(C===$&&I===x||C===p&&I===T||C===A&&I===r)&&(t=C-$,g=I-x,j=C-p,z=I-T,a=C-A,R=I-r,B=l*z-_*j,G=q*g-u*t,n=K*R-Y*a,B>=-w&&n>=-w&&G>=-w))return!1;return!0};return S.Triangulate=f,S.Triangulate.area=E,S}(Op),M._typeface_js={faces:Op.faces,loadFace:Op.loadFace};var qi=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Yg=qi.prototype={constructor:qi,computeFaceNormals:function(){for(var I=new Vq,K=new Vq,D=0,b=this.faces.length;b>D;D++){var S=this.faces[D],Z=this.vertices[S.a],H=this.vertices[S.b],s=this.vertices[S.c];I.subVectors(s,H),K.subVectors(Z,H),I.cross(K),I.normalize(),S.normal.copy(I)}},computeVertexNormals:function(y){var d,$,g,m,z,R;for(R=new Array(this.vertices.length),d=0,$=this.vertices.length;$>d;d++)R[d]=new Vq;if(y){var L,Y,x,o=new Vq,n=new Vq;for(g=0,m=this.faces.length;m>g;g++)z=this.faces[g],L=this.vertices[z.a],Y=this.vertices[z.b],x=this.vertices[z.c],o.subVectors(x,Y),n.subVectors(L,Y),o.cross(n),R[z.a].add(o),R[z.b].add(o),R[z.c].add(o)}else for(g=0,m=this.faces.length;m>g;g++)z=this.faces[g],R[z.a].add(z.normal),R[z.b].add(z.normal),R[z.c].add(z.normal);for(d=0,$=this.vertices.length;$>d;d++)R[d].normalize();for(g=0,m=this.faces.length;m>g;g++)z=this.faces[g],z.vertexNormals[0]=R[z.a].clone(),z.vertexNormals[1]=R[z.b].clone(),z.vertexNormals[2]=R[z.c].clone()},mergeVertices:function(){var V,Y,T,x,E,X,p,a,L={},g=[],_=[],j=4,R=c(10,j);for(T=0,x=this.vertices.length;x>T;T++)V=this.vertices[T],Y=h(V.x*R)+"_"+h(V.y*R)+"_"+h(V.z*R),L[Y]===l?(L[Y]=T,g.push(this.vertices[T]),_[T]=g.length-1):_[T]=_[L[Y]];var G=[];for(T=0,x=this.faces.length;x>T;T++){E=this.faces[T],E.a=_[E.a],E.b=_[E.b],E.c=_[E.c],X=[E.a,E.b,E.c];for(var u=0;3>u;u++)if(X[u]==X[(u+1)%3]){G.push(T);break}}for(T=G.length-1;T>=0;T--){var f=G[T];for(this.faces.splice(f,1),p=0,a=this.faceVertexUvs.length;a>p;p++)this.faceVertexUvs[p].splice(f,1)}var U=this.vertices.length-g.length;return this.vertices=g,U}},Vb=function(H,k,P,n,v,M,I){this.aX=H,this.aY=k,this.xRadius=P,this.yRadius=n,this.aStartAngle=v,this.aEndAngle=M,this.aClockwise=I};Vb.prototype=ap(ak),Vb.prototype.getPoint=function(h){var A,J=this.aEndAngle-this.aStartAngle;0>J&&(J+=I),J>I&&(J-=I),A=this.aClockwise===!0?this.aEndAngle+(1-h)*(I-J):this.aStartAngle+h*J;var r=this.aX+this.xRadius*m(A),v=this.aY+this.yRadius*E(A);return new li(r,v)};var Ab=function(m,$){this.v1=m,this.v2=$},Ef=Ab.prototype=ap(ak);Ef.getPoint=function(X){var J=this.v2.clone().sub(this.v1);return J.multiplyScalar(X).add(this.v1),J},Ef.getPointAt=function(O){return this.getPoint(O)},Ef.getTangent=function(){var v=this.v2.clone().sub(this.v1);return v.normalize()};var nl=function(N,K,O){this.v0=N,this.v1=K,this.v2=O};nl.prototype=ap(ak),nl.prototype.getPoint=function(O){var h,p;return h=_b.b2(O,this.v0.x,this.v1.x,this.v2.x),p=_b.b2(O,this.v0.y,this.v1.y,this.v2.y),new li(h,p)};var os=function(X,P,J,K){this.v0=X,this.v1=P,this.v2=J,this.v3=K};os.prototype=ap(ak),os.prototype.getPoint=function(z){var t,b;return t=_b.b3(z,this.v0.x,this.v1.x,this.v2.x,this.v3.x),b=_b.b3(z,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new li(t,b)},Bj.create(function(P,h){this.v1=P,this.v2=h},function($){var r=new Vq;return r.subVectors(this.v2,this.v1),r.multiplyScalar($),r.add(this.v1),r});var yf=Bj.create(function(O,A,U){this.v0=O,this.v1=A,this.v2=U},function(c){var C,m,o;return C=_b.b2(c,this.v0.x,this.v1.x,this.v2.x),m=_b.b2(c,this.v0.y,this.v1.y,this.v2.y),o=_b.b2(c,this.v0.z,this.v1.z,this.v2.z),new Vq(C,m,o)}),Zo=Bj.create(function(F,G,w,e){this.v0=F,this.v1=G,this.v2=w,this.v3=e},function(z){var $,q,S;return $=_b.b3(z,this.v0.x,this.v1.x,this.v2.x,this.v3.x),q=_b.b3(z,this.v0.y,this.v1.y,this.v2.y,this.v3.y),S=_b.b3(z,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Vq($,q,S)}),xs=function(B,M,A,S,K,z,n,U){qi.call(this),S=S!==l?S:.5,K=K!==l?K:.5,U=U!==l?U:1,B=B||8,z=z||0,n=n||I;var h,v,O=1,s=U/2,b=[],c=[],T=this.vertices,q=this.faces,H=this.faceVertexUvs;for(v=0;O>=v;v++){var f=[],u=[],g=v/O,V=g*(K-S)+S;for(h=0;B>=h;h++){var L=h/B,R=new Vq,F=-(L*n+z);R.z=V*E(F),R.y=-g*U+s,R.x=V*m(F),T.push(R),f.push(T.length-1),u.push(new li(L,g))}b.push(f),c.push(u)}var N,k,P=(K-S)/U;for(h=0;B>h;h++)for(0!==S?(N=T[b[0][h]].clone(),k=T[b[0][h+1]].clone()):(N=T[b[1][h]].clone(),k=T[b[1][h+1]].clone()),N.setY(w(N.x*N.x+N.z*N.z)*P).normalize(),k.setY(w(k.x*k.x+k.z*k.z)*P).normalize(),v=0;O>v;v++){var j=b[v][h],J=b[v+1][h],D=b[v+1][h+1],r=b[v][h+1],Y=N.clone(),x=N.clone(),$=k.clone(),o=k.clone(),Z=c[v][h].clone(),t=c[v+1][h].clone(),W=c[v+1][h+1].clone(),p=c[v][h+1].clone();q.push(new cq(j,J,r,[Y,x,o])),H[0].push([Z,t,p]),q.push(new cq(J,D,r,[x.clone(),$,o.clone()])),H[0].push([t.clone(),W,p.clone()])}if(M&&S>0)for(this.vertices.push(new Vq(0,s,0)),h=0;B>h;h++){var j=b[0][h],J=b[0][h+1],D=this.vertices.length-1,Y=new Vq(0,1,0),x=new Vq(0,1,0),$=new Vq(0,1,0),Z=c[0][h].clone(),t=c[0][h+1].clone(),W=new li(t.x,0);q.push(new cq(j,J,D,[Y,x,$],null,1));var X=h/B*I,i=m(X),G=E(X),d=(h+1)/B*I,C=m(d),_=E(d);H[0].push([new li(.5+.5*i,.5+.5*G),new li(.5+.5*C,.5+.5*_),new li(.5,.5)])}if(A&&K>0)for(this.vertices.push(new Vq(0,-s,0)),h=0;B>h;h++){var j=b[v][h+1],J=b[v][h],D=T.length-1,Y=new Vq(0,-1,0),x=new Vq(0,-1,0),$=new Vq(0,-1,0),Z=c[v][h+1].clone(),t=c[v][h].clone();q.push(new cq(j,J,D,[Y,x,$],null,2));var X=h/B*I,i=m(X),G=E(X),d=(h+1)/B*I,C=m(d),_=E(d);H[0].push([new li(.5+.5*C,.5-.5*_),new li(.5+.5*i,.5-.5*G),new li(.5,.5)])}};xs.prototype=ap(Yg);var nf=function(P,e,L,U,K,Q,X){qi.call(this),X=X||.5,P=P||16,e=e||16,L=(L!==l?L:0)-i,U=U!==l?U:I,K=K!==l?K:0,Q=Q!==l?Q:i;var q,$,r=[],p=[],O=this.vertices,j=this.faces,B=this.faceVertexUvs;for($=0;e>=$;$++){var G=[],z=[];for(q=0;P>=q;q++){var F=q/P,o=$/e,W=new Vq;W.x=-X*m(L+F*U)*E(K+o*Q),W.y=X*m(K+o*Q),W.z=X*E(L+F*U)*E(K+o*Q),O.push(W),G.push(O.length-1),z.push(new li(F,o))}r.push(G),p.push(z)}for($=0;e>$;$++)for(q=0;P>q;q++){var h=r[$][q+1],g=r[$][q],v=r[$+1][q],V=r[$+1][q+1],y=O[h].clone().normalize(),Z=O[g].clone().normalize(),M=O[v].clone().normalize(),J=O[V].clone().normalize(),f=p[$][q+1].clone(),C=p[$][q].clone(),u=p[$+1][q].clone(),S=p[$+1][q+1].clone();t(O[h].y)===X?(f.x=(f.x+C.x)/2,j.push(new cq(h,v,V,[y,M,J])),B[0].push([f,u,S])):t(O[v].y)===X?(u.x=(u.x+S.x)/2,j.push(new cq(h,g,v,[y,Z,M])),B[0].push([f,C,u])):(j.push(new cq(h,g,V,[y,Z,J])),B[0].push([f,C,S]),j.push(new cq(g,v,V,[Z.clone(),M,J.clone()])),B[0].push([C.clone(),u,S.clone()]))}};nf.prototype=ap(Yg);var Gc=function(_,n,g,u,x,o){qi.call(this),_=_||.33,n=n||.17,u=u||8,g=g||6,x=x||0,o=o||I;for(var t=new Vq,O=[],e=[],f=0;u>=f;f++)for(var R=f/u*I+i,W=0;g>=W;W++){var M=W/g*o+x;t.x=_*m(M),t.z=-_*E(M);var c=new Vq,G=_+n*m(R);c.x=G*m(M),c.z=-G*E(M),c.y=n*E(R),this.vertices.push(c),O.push(new li(W/g,1-f/u)),e.push(c.clone().sub(t).normalize())}for(var f=1;u>=f;f++)for(var W=1;g>=W;W++){var K=(g+1)*f+W-1,Y=(g+1)*(f-1)+W-1,B=(g+1)*(f-1)+W,w=(g+1)*f+W,H=new cq(K,Y,w,[e[K].clone(),e[Y].clone(),e[w].clone()]);this.faces.push(H),this.faceVertexUvs[0].push([O[K].clone(),O[Y].clone(),O[w].clone()]),H=new cq(Y,B,w,[e[Y].clone(),e[B].clone(),e[w].clone()]),this.faces.push(H),this.faceVertexUvs[0].push([O[Y].clone(),O[B].clone(),O[w].clone()])}this.computeFaceNormals()};Gc.prototype=ap(Yg);var jk=function(d,b,U){return d?(qi.call(this),d=d instanceof Array?d:[d],this.addShapeList(d,b),b.convertYZ!==!1&&pn(this,U),this.computeFaceNormals(),void 0):(d=[],void 0)},Ie=jk.prototype=ap(qi.prototype);Ie.addShapeList=function(E,f){for(var J=E.length,Y=0;J>Y;Y++){var q=E[Y];this.addShape(q,f)}},Ie.addShape=function(m,N){function g(){if(N.bottom)for(var $=0;Q>$;$++)e=x[$],h(e[2],e[1],e[0],!0);if(N.top)for($=0;Q>$;$++)e=x[$],h(e[0]+c*w,e[1]+c*w,e[2]+c*w,!1)}function M(){var o=0;for(y(n,o),o+=n.length,t=0,i=b.length;i>t;t++)j=b[t],y(j,o),o+=j.length}function y(M,s){for(var $,A,K=M.length;--K>=0;){$=K,A=K-1,0>A&&(A=M.length-1);var o=0,W=w;for(o=0;W>o;o++){var b=c*o,C=c*(o+1),x=s+$+b,d=s+A+b,X=s+A+C,J=s+$+C;F(x,d,X,J,M,o,W,$,A)}}}function r(Q,V,Z){E.vertices.push(new Vq(Q,V,Z))}function h(s,A,c,f){s+=T,A+=T,c+=T,E.faces.push(new cq(s,A,c,null,null,f?2:1));var n=f?U.generateBottomUV(E,m,N,s,A,c):U.generateTopUV(E,m,N,s,A,c);E.faceVertexUvs[0].push(n)}function F(w,Z,Q,s,v,i,J,o,Y){w+=T,Z+=T,Q+=T,s+=T,E.faces.push(new cq(w,Z,s)),E.faces.push(new cq(Z,Q,s));var X=U.generateSideWallUV(E,m,v,N,w,Z,Q,s,i,J,o,Y);E.faceVertexUvs[0].push([X[0],X[1],X[3]]),E.faceVertexUvs[0].push([X[1],X[2],X[3]])}var W,z,X,Y,G,B=N.amount,Z=N.curveSegments||ml,w=N.steps||1,O=N.extrudePath,q=!1,U=new Ol(N.repeatUVLength);O&&(W=O.getSpacedPoints(w),q=!0,z=N.frames!==l?N.frames:new wo.FrenetFrames(O,w,!1),X=new Vq,Y=new Vq,G=new Vq);var j,t,i,E=this,T=this.vertices.length,f=m.extractPoints(Z),k=f.shape,b=f.holes,K=!_b.isClockWise(k);if(K){for(k=k.reverse(),t=0,i=b.length;i>t;t++)j=b[t],_b.isClockWise(j)&&(b[t]=j.reverse());K=!1}var x=_b.triangulateShape(k,b),n=k;for(t=0,i=b.length;i>t;t++)j=b[t],k=k.concat(j);for(var L,e,c=k.length,Q=x.length,$=0;c>$;$++)L=k[$],q?(Y.copy(z.normals[0]).multiplyScalar(L.x),X.copy(z.binormals[0]).multiplyScalar(L.y),G.copy(W[0]).add(Y).add(X),r(G.x,G.y,G.z)):r(L.x,L.y,0);var d;for(d=1;w>=d;d++)for($=0;c>$;$++)L=k[$],q?(Y.copy(z.normals[d]).multiplyScalar(L.x),X.copy(z.binormals[d]).multiplyScalar(L.y),G.copy(W[d]).add(Y).add(X),r(G.x,G.y,G.z)):r(L.x,L.y,B/w*d);g(),M()};var wo=function(u,Z,U,x,j){function g(R,G,P){return i.vertices.push(new Vq(R,G,P))-1}qi.call(this),Z=Z||64,U=U||1,x=x||8,j=j||!1;var R,D,_,y,K,t,$,q,d,S,s,a,f,M,O,n,p,b,A,C,w=[],i=this,L=Z+1,N=new Vq,r=new wo.FrenetFrames(u,Z,j),o=r.tangents,v=r.normals,e=r.binormals;for(this.tangents=o,this.normals=v,this.binormals=e,d=0;L>d;d++)for(w[d]=[],y=d/(L-1),q=u.getPointAt(y),R=o[d],D=v[d],_=e[d],S=0;x>S;S++)K=S/x*I,t=-U*m(K),$=U*E(K),N.copy(q),N.x+=t*D.x+$*_.x,N.y+=t*D.y+$*_.y,N.z+=t*D.z+$*_.z,w[d][S]=g(N.x,N.y,N.z);for(d=0;Z>d;d++)for(S=0;x>S;S++)s=j?(d+1)%Z:d+1,a=(S+1)%x,f=w[d][S],M=w[s][S],O=w[s][a],n=w[d][a],p=new li(d/Z,S/x),b=new li((d+1)/Z,S/x),A=new li((d+1)/Z,(S+1)/x),C=new li(d/Z,(S+1)/x),this.faces.push(new cq(f,M,n)),this.faceVertexUvs[0].push([p,b,C]),this.faces.push(new cq(M,O,n)),this.faceVertexUvs[0].push([b.clone(),A,C.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};wo.prototype=ap(Yg),wo.FrenetFrames=function(M,i,Y){function C(){d[0]=new Vq,p[0]=new Vq,D=Number.MAX_VALUE,F=t(K[0].x),v=t(K[0].y),r=t(K[0].z),D>=F&&(D=F,E.set(1,0,0)),D>=v&&(D=v,E.set(0,1,0)),D>=r&&E.set(0,0,1),B.crossVectors(K[0],E).normalize(),d[0].crossVectors(K[0],B),p[0].crossVectors(K[0],d[0])}var k,D,F,v,r,a,T,E=new Vq,K=[],d=[],p=[],B=new Vq,s=new uo,u=i+1,n=1e-4;for(this.tangents=K,this.normals=d,this.binormals=p,a=0;u>a;a++)T=a/(u-1),K[a]=M.getTangentAt(T),K[a].normalize();for(C(),a=1;u>a;a++)d[a]=d[a-1].clone(),p[a]=p[a-1].clone(),B.crossVectors(K[a-1],K[a]),B.length()>n&&(B.normalize(),k=S(Bq(K[a-1].dot(K[a]),-1,1)),d[a].applyMatrix4(s.makeRotationAxis(B,k))),p[a].crossVectors(K[a],d[a]);if(Y)for(k=S(Bq(d[0].dot(d[u-1]),-1,1)),k/=u-1,K[0].dot(B.crossVectors(d[0],d[u-1]))>0&&(k=-k),a=1;u>a;a++)d[a].applyMatrix4(s.makeRotationAxis(K[a],k*a)),p[a].crossVectors(K[a],d[a])};var zg=function(G,V,W,f){qi.call(this),V=V||18,W=W||0,f=f==Z?I:f;for(var g=1/(G.length-1),T=1/V,j=0,N=V;N>=j;j++)for(var Y=W+j*T*f,r=m(Y),D=E(Y),$=0,P=G.length;P>$;$++){var l=G[$],v=new Vq;v.x=r*l.x-D*l.y,v.y=D*l.x+r*l.y,v.z=l.z,this.vertices.push(v)}for(var U=G.length,j=0,N=V;N>j;j++)for(var $=0,P=G.length-1;P>$;$++){var c=$+U*j,K=c,F=c+U,r=c+1+U,t=c+1,q=j*T,k=$*g,z=q+T,B=k+g;this.faces.push(new cq(K,t,F)),this.faceVertexUvs[0].push([new li(q,k),new li(q,B),new li(z,k)]),this.faces.push(new cq(F,t,r)),this.faceVertexUvs[0].push([new li(z,k),new li(q,B),new li(z,B)])}this.mergeVertices(),pn(this),this.computeFaceNormals(),this.computeVertexNormals()};zg.prototype=ap(Yg);var bh=function(C,k){k=k||{};var Q=Op.generateShapes(C,k);k.amount=k.amount!==l?k.amount:.5,k.convertYZ=!1,k.fill!==!1&&(k.bottom=!0,k.top=!0),jk.call(this,Q,k)};bh.prototype=ap(Ie);var Lo=a.Node=function(){$f(Lo,this)},Ek={X:Cr,Y:ds,Z:ni},Uq={X:0,Y:1,Z:2},lc={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},_h="xzy",He=function(t,v,I){if(v){var B=v[0],w=v[1],b=v[2];"xzy"===I?(ds(t,w),ni(t,b),Cr(t,B)):"xyz"===I?(ni(t,b),ds(t,w),Cr(t,B)):"yxz"===I?(ni(t,b),Cr(t,B),ds(t,w)):"yzx"===I?(Cr(t,B),ni(t,b),ds(t,w)):"zxy"===I?(ds(t,w),Cr(t,B),ni(t,b)):"zyx"===I?(Cr(t,B),ds(t,w),ni(t,b)):(ds(t,w),ni(t,b),Cr(t,B))}};En("Node",ob,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:_h,_64O:0,_rotationX:0,_53O:0,_host:Z,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return nc},_22Q:function(){return dj},getX:function(){return this.p().x},setX:function(F){this.p(F,this.p().y)},getY:function(){return this.p().y},setY:function(o){this.p(this.p().x,o)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(l){this.setAnchor(l,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(r){this.setAnchor(this.getAnchor().x,r)},getScaleX:function(){return this.getScale().x},setScaleX:function(a){this.setScale(a,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(p){this.setScale(this.getScale().x,p)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(d,E){ao(d,xi(Z,Z,this.r3(),this.getRotationMode())),this.translate3d(d[0]*E,d[1]*E,d[2]*E)},translateFront:function(d){this.translate3dBy([0,0,1],d)},translateBack:function(l){this.translate3dBy([0,0,-1],l)},translateLeft:function(j){this.translate3dBy([-1,0,0],j)},translateRight:function(W){this.translate3dBy([1,0,0],W)},translateTop:function(u){this.translate3dBy([0,1,0],u)},translateBottom:function(s){this.translate3dBy([0,-1,0],s)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(t,C,o){1===arguments.length&&(C=t[1],o=t[2],t=t[0]),this.p(t,o),this.setElevation(C)},translate3d:function(C,b,w){1===arguments.length&&(b=C[1],w=C[2],C=C[0]),this.translate(C,w),this.setElevation(this._54O+b)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(w,k,O){1===arguments.length&&(k=w[1],O=w[2],w=w[0]),this.setSize(w,O),this.setTall(k)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(o,R,y){1===arguments.length&&(R=o[1],y=o[2],o=o[0]),this.setRotationX(o),this.setRotation(-R),this.setRotationZ(y)},setRotationY:function(h){this.setRotation(-h)},getRotationY:function(){return-this._64O},lookAtDirection:function(s,X){X=X||Qj;var H=this,d=fm(s);X===Qj?(H.r3([-f(s[1]/d),-R(s[2],s[0])+x,0]),H.setRotationMode("xzy")):X===qe?(H.r3(0,-R(s[2],s[0]),f(s[1]/d)),H.setRotationMode("zyx")):X===Bc?(H.r3(0,-R(s[2],s[0])+i,-f(s[1]/d)),H.setRotationMode("zyx")):X===Uh?(H.r3([-f(s[1]/d)+x,-R(s[2],s[0])+x,0]),H.setRotationMode("xzy")):X===Tg&&(H.r3([-f(s[1]/d)-x,-R(s[2],s[0])+x,0]),H.setRotationMode("xzy")),X===Zd&&(H.r3([-f(s[1]/d)+i,-R(s[2],s[0])+x,i]),H.setRotationMode("zxy"))},lookAt:function(d,v){return this.lookAtDirection(bm(d,this.p3()),v)},lookAtX:function(){var T=new um,d=new um,l=new um,x=new ke,Z=new ke,r=new kd;return function(j,z){var U=qp(this);if(x.fromArray(U),l.copy(this.p3()),T.copy(j).sub(l),!(T.lengthSq()<1e-6)){T.normalize(),z===Qj?d.set(0,0,1):z===Zd?d.set(0,0,-1):z===Bc?d.set(-1,0,0):z===qe?d.set(1,0,0):z===Uh?d.set(0,1,0):z===Tg&&d.set(0,-1,0),d.applyMatrix4(x).sub(l).normalize();var L=Math.acos(T.dot(d));if(L){var o=T.clone().cross(d);o.lengthSq()<1e-6&&(z===Uh||z===Tg?o.set(0,0,1).applyMatrix4(x).sub(l):o.set(0,1,0).applyMatrix4(x).sub(l)),o.normalize(),r.set(this.r3(),this.getRotationMode(),!0),x.makeRotationFromEuler(r),Z.makeRotationAxis(o,-L),r.setFromRotationMatrix(Z.multiply(x)),this.r3([r.x,r.y,r.z])}}}}(),getHost:function(){return this._host},setHost:function(i){var n=this;if(n!==i&&n._host!==i){var h=n._host;h&&h._removeAttach(n),n._host=i,n._host&&n._host._addAttach(n),n.fp("host",h,i),n.onHostChanged(h,i)}},getAttaches:function(){return this._69O},_addAttach:function(J){var i=this;i._69O||(i._69O=new Nj),i._69O.add(J),i.fp("attaches",Z,J)},_removeAttach:function(M){var Y=this;Y._69O.remove(M),Y._69O.isEmpty()&&delete Y._69O,Y.fp("attaches",M,Z)},getImage:function(){if(this._pendingCheckImageJSON){var M=A.getImage(this._image);M&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof uf&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(w){var R=this,K=R._image,H=R.getWidth(),o=R.getHeight();R._image=w,R.fp("image",K,w)&&(null!=w&&(Bn(w)||tk(w)&&/\.json$/i.test(w))&&(this._pendingCheckImageJSON=!0),R.fp(fk,H,R.getWidth()),R.fp(Ec,o,R.getHeight()))},getElevation:function(){return this._54O},setElevation:function(I){var K=this;if(!K._50O){K._50O=1;var s=K._54O;K._54O=I,K.fp(mq,s,I),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(u){var V=this;if(!V._49O){V._49O=1;var J=V._64O;V._64O=u,V.fp(xg,J,u),delete V._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(N){var B=this;if(!B._51O){B._51O=1;var R=B._rotationX;B._rotationX=N,B.fp("rotationX",R,N),delete B._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(c){var W=this;if(!W._52O){W._52O=1;var x=W._53O;W._53O=c,W.fp("rotationZ",x,c),delete W._52O}},getPosition:function(){return this._position},setPosition:function(D,v){var W=this;if(!W._50I){W._50I=1;var m;if(m=2===arguments.length?{x:D,y:v}:D,m.x!==W._position.x||m.y!==W._position.y){var y=W._position;W._position=m,W.fp(fh,y,m)}delete W._50I}},translate:function(f,z){var t=this._position;this.p(t.x+f,t.y+z)},getWidth:function(){var P=this;if(P._width>=0)return P._width;var b=P.getStyle("shape3d");if(b){var u=Yi(b);if(u&&u.rawS3)return u.rawS3[0];if("billboard"===b||"plane"===b){var I=Uj(P.getStyle("shape3d.image"));return I?ab(I,P):20}}var I=Uj(P._image);return I?ab(I,P):20},setWidth:function(I){var f=this,u=f._width;f._width=I,f.fp(fk,u,I)},getHeight:function(){var E=this;if(E._height>=0)return E._height;var v=E.getStyle("shape3d");if(v){var b=Yi(v);if(b&&b.rawS3)return b.rawS3[2];if("plane"===v){var B=Uj(E.getStyle("shape3d.image"));return B?kn(B,E):20}if("billboard"===v)return 2}var B=Uj(E._image);return B?kn(B,E):20},setHeight:function(e){var o=this,t=o._height;o._height=e,o.fp(Ec,t,e)},getTall:function(){var f=this;if(f._tall>=0)return f._tall;var o=f.getStyle("shape3d");if(o){var P=Yi(o);if(P&&P.rawS3)return P.rawS3[1];if("billboard"===o){var Z=Uj(f.getStyle("shape3d.image"));return Z?kn(Z,f):20}if("plane"===o)return 2}return 20},setTall:function(G){var S=this,j=S._tall;S._tall=G,S.fp("tall",j,G)},setSize:function(D,T){var i=this;2===arguments.length?(i.setWidth(D),i.setHeight(T)):(i.setWidth(D.width),i.setHeight(D.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(H,r,E,e,Z){var D=this,o=D.getAnchor(),s=D.getScale();arguments.length<=2&&(Z=r,r=H.y,E=H.width,e=H.height,H=H.x);var l=Z&&s.x<0?1-o.x:o.x,I=Z&&s.y<0?1-o.y:o.y;D.p(H+E*l,r+e*I),Z&&(E/=Math.abs(s.x),e/=Math.abs(s.y)),D.setWidth(E),D.setHeight(e)},getMatrix:function(){var D=this,F=D._64O,$=D._position,P=D.getScale();return new Dr(F,$.x,$.y,P.x,P.y)},getAnchorRect:function(){var O=this,N=O.getWidth(),X=O.getHeight(),G=O.getAnchor();return{x:-N*G.x,y:-X*G.y,width:N,height:X}},toLocal:function(f){return this.getMatrix().tfi(f)},toGlobal:function($){return this.getMatrix().tf($)},getAttachPosition:function(){var r=new Dr;return function(h,o,Q,p){Q=Q||0,p=p||0;var Y=this,V=Y.getAnchor(),O=Y._64O,M=Y._position,Z=Y.getScale();return r.setFromTransform(O,M.x,M.y).tf({x:Q+Z.x*Y.getWidth()*(h-V.x),y:p+Z.y*Y.getHeight()*(o-V.y)})}}(),isInRect:function(J){J=this.toLocal(J);var x=this.getWidth(),X=this.getHeight();return J.x+=x*this.getAnchorX(),J.y+=X*this.getAnchorY(),!(J.x<0||J.y<0||J.x>x||J.y>X)},getRect:function(){var n=this,Q=n.getWidth(),x=n.getHeight(),j=n.getAnchor(),o={x:-Q*j.x,y:-x*j.y,width:Q,height:x},q=n.getMatrix();return o=rl([q.tf(o.x,o.y),q.tf(o.x+o.width,o.y),q.tf(o.x+o.width,o.y+o.height),q.tf(o.x,o.y+o.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var n=this,w=n.getAnchor(),U=n._anchorElevation;return{x:w.x,y:U,z:w.y}},setAnchorElevation:function($){var K=this,J=K._anchorElevation;return J!==$?(K._anchorElevation=$,K.fp("anchorElevation",J,$),!0):!1},setAnchor3d:function(q,r,d,H){var n,T=this;"number"==typeof q?n={x:q,y:r,z:d}:(n=q.length?{x:q[0],y:q[1],z:q[2]}:q,H=r);var D=T.getDataModel();D&&D.beginTransaction();var O=T.getAnchor3d(),R=T.setAnchor(n.x,n.z);if(T.setAnchorElevation(n.y)&&(R=!0),R&&H&&!ar){T.getAnchor3d();var b=qp(T),e=ao([n.x-O.x,n.y-O.y,n.z-O.z],b);T.p3(e)}return D&&D.endTransaction(),R},getAnchor:function(){var Y=this;if(Y.hasOwnProperty("_anchor"))return Y._anchor;var c=Uj(Y._image);return c&&c.anchorX!==l?{x:c.anchorX,y:c.anchorY}:Y._anchor},setAnchor:function(o,B,z){var T,l=this;"number"==typeof o?T={x:o,y:B}:(T=o.length?{x:o[0],y:o[1]}:o,z=B);var t=l.getAnchor();if(t.x!==T.x||t.y!==T.y){var Z=l.getDataModel();if(Z&&Z.beginTransaction(),l._anchor=T,l.fp("anchor",t,T),z&&!ar){var e=l.getPosition(),C=l.getSize(),H=l.getRotation(),M=l.getScale(),Q=-C.width*(t.x-T.x)*M.x,q=-C.height*(t.y-T.y)*M.y,u=E(H),P=m(H);l.setPosition(e.x+P*Q-u*q,e.y+u*Q+P*q)}return Z&&Z.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(w,x){var S,f=this;S=2===arguments.length?{x:w,y:x}:w;var F=f.getScale();(F.x!==S.x||F.y!==S.y)&&(f._scale=S,f.fp("scale",F,S))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var e=this,i=e._scaleTall,j=e.getScale();return[j.x,i,j.y]},getFinalScale3d:function(){var Y=this,C=Y.s3(),Q=Y._dynamicScale3d,R=Y.getScale3d();return C&&(R[0]*=C[0],R[1]*=C[1],R[2]*=C[2]),Q&&(R[0]*=Q[0],R[1]*=Q[1],R[2]*=Q[2]),R},getFinalRotation3d:function(){var g=this;return g._dynamicRotation||g.r3()},setScaleTall:function(X){var t=this,U=t._scaleTall;U!==X&&(t._scaleTall=X,t.fp("scaleTall",U,X))},setScale3d:function(K,w,M){var m,F=this;m="number"==typeof K?{x:K,y:w,z:M}:K.length?{x:K[0],y:K[1],z:K[2]}:K,F.setScaleTall(m.y),F.setScale(m.x,m.z)},getCorners:function(n,r){n==Z&&(n=0),r==Z&&(r=n);var b=this,U=b.getAnchor(),C=b.getWidth(),h=b.getHeight(),D=-C*U.x-n,N=-h*U.y-r,L=C+2*n,z=h+2*r,m=b.getMatrix();return[m.tf(D,N),m.tf(D,N+z),m.tf(D+L,N+z),m.tf(D+L,N)]},getEditControlPoints:function(L,i,r){i==Z&&(i=0),r==Z&&(r=i);var V=this,F=V.getAnchor(),j=V.getWidth(),$=V.getHeight(),M=-j*F.x-i,C=-$*F.y-r,U=j+2*i,T=$+2*r;if(L)return[{x:M,y:C},{x:M,y:0},{x:M,y:C+T},{x:0,y:C+T},{x:M+U,y:C+T},{x:M+U,y:0},{x:M+U,y:C},{x:0,y:C}];var J=V.getMatrix();return[J.tf(M,C),J.tf(M,0),J.tf(M,C+T),J.tf(0,C+T),J.tf(M+U,C+T),J.tf(M+U,0),J.tf(M+U,C),J.tf(0,C)]},rotateAt:function(u,N,c){var n=this,l=n._position,S=n._64O,Y=new Dr(S,l.x,l.y).tf(u,N),J=w(u*u+N*N),j=R(l.y-Y.y,l.x-Y.x)+c;n.setRotation(S+c),n.p(Y.x+J*m(j),Y.y+J*E(j))},onParentChanged:function(){Lo.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var B={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(Q){B[Q]=!0}),function(q){var w=this;Lo.superClass.onPropertyChanged.call(w,q),B[q.property]&&!w._layoutUpdating&&w.updateLayoutParameters(null,q.property),w._69O&&w._69O.each(function(N){N.handleHostPropertyChange(q)}),w._49I&&w._49I.each(function(m){m.fp("agentChange",!0,!1)}),"a:layout"===q.property.substring(0,8)&&this.updateAttach()}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(o){this.updateAttach(o)},onStyleChanged:function(n){Lo.superClass.onStyleChanged.apply(this,arguments),sq[n]&&this.updateAttach()},updateAttach:function(L){var J=this;return ar?(J.updateLayoutParameters(),void 0):(J._51I||(J._51I=1,J._71O(L),delete J._51I),void 0)},_71O:function(G){var D,y,T,Y,f,C,O,q,b=this,u=b._host,o=G?G.property:Z,K=G?G.oldValue:Z,$=G?G.newValue:Z;if(u instanceof Lo&&(O=Uj(u.getImage()),O&&O.layoutAttach&&(q=O.layoutAttach)),G&&!Sj[o]&&"a:layout"!==o.substring(0,8)||!q||q(u,this))if(u instanceof a.Grid){if(o===mq)b.setElevation(b._54O+$-K);else if(!G||Bp[o]){if(D=b.s("attach.row.index"),y=b.s("attach.column.index"),T=u.getCellRect(D,y),!T)return;Y=b.s("attach.row.span"),f=b.s("attach.column.span"),(1!==Y||1!==f)&&(T=Xj(T,u.getCellRect(D+Y-1,y+f-1))),Tf(T,b,"attach.padding",1),b.setRect(T)}}else if(u instanceof ze&&(C=b.s("attach.index"))>=0&&(!G||mb[o])){var r=b.s("attach.thickness"),z=u.getScale(),V=Math.max(z.x,z.y);r>0&&b.setHeight(u.getThickness()*r*V);var Q=b.s("attach.offset"),I=u.getPoints(),U=I.size();if(U>C){var A=u.getPointsMatrix2d(),k=I.get(C),i=U===C+1?I.get(0):I.get(C+1);k=A.apply(k),i=A.apply(i);var w=[i.x-k.x,i.y-k.y],X=fm(w);if(X){b.s("attach.offset.relative")&&(Q*=X),b.s("attach.offset.opposite")&&(Q=X-Q);var p={x:k.x+w[0]/X*Q,y:k.y+w[1]/X*Q},c=b.s("attach.gap");c&&(b.s("attach.gap.relative")&&(c*=u.getThickness()*V),p=vp(Z,p,i,c)),b.p(p),b.setRotation(R(w[1],w[0]))}}}else G&&(o===fh?b.translate($.x-K.x,$.y-K.y):o===mq?b.setElevation(b._54O+$-K):ub[o]?b._11Q(u,o,$-K):("anchor"===o||"width"===o||"height"===o||"scale"===o)&&b.layout(u))},_11Q:function(){var U=new a.Math.Euler,N=a.Math.Euler.ReverseOrder,T=new a.Math.Vector2,R=new a.Math.Vector2;return function(C,A,l){var c=this,W=C.p3(),E=C.r3(),O=c.p3(),J=c.r3();if(A===xg&&(A="rotationY",l=-l),(A===xg||"rotationY"===A)&&0===J[0]&&0===J[2]&&0===E[0]&&0===E[2]&&0===O[1]&&0===W[1])return c.setRotation(-J[1]-l),T.set(O[0],O[2]).rotateAround(R.set(W[0],W[2]),-l),c.p(T.x,T.y),void 0;var P=lc[C.getRotationMode()],j=P[0],f=P[1],y=P[2],L=Ek[j],D=Ek[f],q=Ek[y],i=jh();A===xg+j?(q(i,E[Uq[y]]),D(i,E[Uq[f]]),L(i,l),D(i,-E[Uq[f]]),q(i,-E[Uq[y]])):A===xg+f?(q(i,E[Uq[y]]),D(i,l),q(i,-E[Uq[y]])):A===xg+y&&q(i,l);var o=bm(O,W);ao(o,i),c.p3(W[0]+o[0],W[1]+o[1],W[2]+o[2]);var s=c.getRotationMode();He(i,c.r3(),s),U.setFromRotationMatrix(i,N(s)),c.r3([U.x,U.y,U.z])}}(),isHostOn:function(I){var o=this;if(o._host&&I&&I._69O)for(var t={},R=o._host;R&&R!==o&&!t[R._id];){if(R===I)return!0;t[R._id]=R,R=R._host}return!1},isLoopedHostOn:function(N){return this.isHostOn(N)&&N.isHostOn(this)},getScaledSize:function(){var Z=this.getSize(),N=this.getScale();return Z.width*=Math.abs(N.x),Z.height*=Math.abs(N.y),Z},layout:function(t){if(t=t||this.getHost()){var A=this,V=A.s("layout.h")||"center",L=A.s("layout.v")||"center";if("center"!==V||"center"!==L){var U=new a.Math.Vector2,j=t.getPosition(),n=t.getAnchor(),C=t.getScaledSize();A.getPosition();var k,h,Y,g,q,m=1,u=1;switch(A._layoutUpdating=!0,V){case"left":U.setX(A._layoutHValue-n.x*C.width);break;case"right":U.setX((1-n.x)*C.width-A._layoutHValue);break;case"leftright":k=C.width-A._layoutHValue[2],Y=A.getRotation()-t.getRotation(),g=Math.abs(Math.sin(Y)),q=Math.abs(Math.cos(Y)),m+=q*k/A._layoutHValue[3],u+=g*k/A._layoutHValue[4],U.setX(A._layoutHValue[1]+(A._layoutHValue[5]-n.x)*C.width);break;case"center":U.setX((.5-n.x)*C.width-A._layoutHValue);break;case"scale":Y=A.getRotation()-t.getRotation(),g=Math.abs(Math.sin(Y)),q=Math.abs(Math.cos(Y)),U.setX((.5-n.x)*C.width-A._layoutHValue[1]*C.width/A._layoutHValue[0]),h=C.width/A._layoutHValue[2]-1,m+=q*h,u+=g*h}switch(L){case"top":U.setY(A._layoutVValue-n.y*C.height);break;case"bottom":U.setY((1-n.y)*C.height-A._layoutVValue);break;case"topbottom":Y||(Y=A.getRotation()-t.getRotation(),g=Math.abs(Math.sin(Y)),q=Math.abs(Math.cos(Y))),k=C.height-A._layoutVValue[2],m+=g*k/A._layoutVValue[3],u+=q*k/A._layoutVValue[4],U.setY(A._layoutVValue[1]+(A._layoutVValue[5]-n.y)*C.height);break;case"center":U.setY((.5-n.y)*C.height-A._layoutVValue);break;case"scale":Y||(Y=A.getRotation()-t.getRotation(),g=Math.abs(Math.sin(Y)),q=Math.abs(Math.cos(Y))),U.setY((.5-n.y)*C.height-A._layoutVValue[1]*C.height/A._layoutVValue[0]),h=C.height/A._layoutVValue[2]-1,m+=g*h,u+=q*h}if("leftright"===V||"scale"===V||"topbottom"===L||"scale"===L){var B=this.getScale(),e=Math.abs(B.x),Z=Math.abs(B.y);"leftright"===V||"scale"===V?A.setSize(A._layoutHValue[3]*m/e,A._layoutHValue[4]*u/Z):A.setSize(A._layoutVValue[3]*m/e,A._layoutVValue[4]*u/Z)}U.rotateAround(null,t.getRotation()),this.setPosition(U.x+j.x,U.y+j.y),A._layoutUpdating=l}}},updateLayoutParameters:function(H,c){if(H=H||this.getHost()){var B=this,t=B.s("layout.h"),J=B.s("layout.v");if(t||J){var h,E,R,Z,q,r,u=new a.Math.Vector2,Q=H.getPosition(),S=H.getAnchor(),o=H.getScaledSize(),M=B.getPosition(),W=B.getScaledSize();switch(u.set(M.x-Q.x,M.y-Q.y),u.rotateAround(null,-H.getRotation()),t){case"left":B._layoutHValue=u.x+S.x*o.width;break;case"right":B._layoutHValue=-u.x+(1-S.x)*o.width;break;case"center":B._layoutHValue=-u.x+(.5-S.x)*o.width;break;case"leftright":case"scale":"scale"===t?h=-u.x+(.5-S.x)*o.width:(E=B.getAnchor(),R=B.getRotation()-H.getRotation(),Z=Math.cos(R),q=Math.sin(R),r=-Math.min(-E.x*Z+E.y*q,-E.x*Z-(1-E.y)*q,(1-E.x)*Z+E.y*q,(1-E.x)*Z-(1-E.y)*q),h=u.x-(r-S.x)*o.width),"position"===c&&"object"==typeof B._layoutHValue?(B._layoutHValue[0]=o.width,B._layoutHValue[1]=h):B._layoutHValue=[o.width,h,o.width,W.width,W.height,r]}switch(J){case"top":B._layoutVValue=u.y+S.y*o.height;break;case"bottom":B._layoutVValue=-u.y+(1-S.y)*o.height;break;case"center":B._layoutVValue=-u.y+(.5-S.y)*o.height;break;case"topbottom":case"scale":"scale"===J?h=-u.y+(.5-S.y)*o.height:(R||(E=B.getAnchor(),R=B.getRotation()-H.getRotation(),Z=Math.cos(R),q=Math.sin(R)),r=-Math.min(-E.x*q-E.y*Z,-E.x*q+(1-E.y)*Z,(1-E.x)*q-E.y*Z,(1-E.x)*q+(1-E.y)*Z),h=u.y-(r-S.y)*o.height),"position"===c&&"object"==typeof B._layoutVValue?(B._layoutVValue[0]=o.height,B._layoutVValue[1]=h):B._layoutVValue=[o.height,h,o.height,W.width,W.height,r]
        }}}},getSerializableProperties:function(){var w=Lo.superClass.getSerializableProperties.call(this);return Nh(w,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),w}});var Nn=a.Edge=function(v,A){var c=this;$f(Nn,c),c.setSource(v),c.setTarget(A)};En("Edge",ob,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Ve},_22Q:function(){return Ne},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(A){if(A===this)return!1;if(Pr(A))return!0;for(var $,p,r,g,k,I=[this],M=-1,a=0;a>M;)if(M++,$=I[M],p=$._44I)for(p=p.getArray(),g=0,k=p.length;k>g;g++)if(r=p[g],Xi(r)&&!(I.indexOf(r)>=0)){if(r===A)return!1;I.push(r),a++}return!0},setSource:function(z){var L=this;if(L._source!==z&&L.canSetSourceTarget(z)){var Z=L._source;L._source=z,Z&&Z._16I(L),z&&z._2I(L),L._7I(),L.fp("source",Z,z)}},setTarget:function(j){var Q=this;if(Q._target!==j&&Q.canSetSourceTarget(j)){var q=Q._target;Q._target=j,q&&q._18I(Q),j&&j._4I(Q),Q._7I(),Q.fp("target",q,j)}},isLooped:function(){var Z=this;return Z._source===Z._target&&Pr(Z._source)&&Pr(Z._target)},onPropertyChanged:function(){var t=this;t._49I&&t._49I.each(function(g){g.fp("agentChange",!0,!1)})},_7I:function(){var k,Q=this,V=df(Q);Q._40I!==V&&(k=this._40I,k&&k._15I(Q),Q._40I=V,V&&V._1I(Q),Q.fp("sourceAgent",k,V),zr(k,Q._41I),zr(V,Q._41I));var t=Be(Q);Q._41I!==t&&(k=Q._41I,k&&k._17I(Q),Q._41I=t,t&&t._3I(Q),Q.fp("targetAgent",k,t),zr(k,Q._40I),zr(t,Q._40I))},_22I:function(U){this._52I=U,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var m=this;return m._52I&&m._52I.get(0)!==m&&!m.getStyle(zc)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var S=this,k=S._52I;return k&&!S.getStyle(zc)&&k.size()>1&&S===k.get(0)},toggle:function(){this.beginTransaction();var M=this._52I,I=!this.s(zc);M&&M.size()>1&&(M.each(function(a){a.s(zc,I)}),M.getSiblings().each(function(m){m!==M&&m.each(function(l){l.fp("edgeGroup",Z,m)})})),this.endTransaction()},setStyle:function(d,x){(d===xq||"edge.segments"===d)&&(x=Un(x)),Nn.superClass.setStyle.call(this,d,x)},onStyleChanged:function(S){Nn.superClass.onStyleChanged.apply(this,arguments),Mo[S]&&zr(this._41I,this._40I)},getSerializableProperties:function(){var F=Nn.superClass.getSerializableProperties.call(this);return Nh(F,{source:1,target:1}),F}});var Ld=a.Group=function(){$f(Ld,this)};En("Group",Lo,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return nh},onChildAdded:function(){Ld.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Ld.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var v=this;if(!v._54I&&!ar){var i=v.getChildrenRect();i&&(v._53I=1,v.p(od(v.s("group.position"),i,v.getSize())),delete v._53I)}},getChildrenRect:function(){var K,s=this;return s.eachChild(function(G){Pr(G)&&(K=Xj(K,s.getChildRect(G)))}),K},getChildRect:function(y){var M;return Pr(y)&&y.s(Sb)&&(Mf(y)&&y.isExpanded()&&y.eachChild(function(i){M=Xj(M,y.getChildRect(i))}),!M&&y.getRect&&(M=y.getRect())),M},setPosition:function(Z,A){var t=this;if(!t._54I){var o;o=2===arguments.length?{x:Z,y:A}:Z,ar||t._53I||(t._54I=1,Ge(t._children,o.x-t._position.x,o.y-t._position.y),delete t._54I),Ld.superClass.setPosition.call(this,o)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(x){var h=this;if(h._57O!==x){var b=h._57O;h._57O=x,h.fp("expanded",b,h._57O),h._fireInvalidateDeep(),h._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(e){Mf(e)?e._fireInvalidateDeep():e.iv()})},_8I:function(){Ld.superClass._8I.call(this),this.eachChild(function(Y){Pr(Y)&&Y._8I()})},onStyleChanged:function(R){Ld.superClass.onStyleChanged.apply(this,arguments),"group.position"===R&&this._81I()},getSerializableProperties:function(){var m=Ld.superClass.getSerializableProperties.call(this);return m.expanded=1,m}});var Ic=a.Block=function(){$f(Ic,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};En("Block",Lo,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Wl},_22Q:function(){return An},onChildAdded:function(){Ic.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Ic.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function H(e,f,j){M.fromArray(qp(f));var v=f.getAnchor3d();e.push((new um).set(0-v.x,0-v.y,0-v.z).applyMatrix4(M).applyMatrix4(j)),e.push((new um).set(0-v.x,0-v.y,1-v.z).applyMatrix4(M).applyMatrix4(j)),e.push((new um).set(0-v.x,1-v.y,0-v.z).applyMatrix4(M).applyMatrix4(j)),e.push((new um).set(0-v.x,1-v.y,1-v.z).applyMatrix4(M).applyMatrix4(j)),e.push((new um).set(1-v.x,0-v.y,0-v.z).applyMatrix4(M).applyMatrix4(j)),e.push((new um).set(1-v.x,0-v.y,1-v.z).applyMatrix4(M).applyMatrix4(j)),e.push((new um).set(1-v.x,1-v.y,0-v.z).applyMatrix4(M).applyMatrix4(j)),e.push((new um).set(1-v.x,1-v.y,1-v.z).applyMatrix4(M).applyMatrix4(j))}function r(T,w){var $=this.p3(),O=this.r3(),N=jh();rn(N,[-$[0],-$[1],-$[2]]),He(N,[-O[0],-O[1],-O[2]],this.getRotationMode()),N=(new ke).fromArray(N),T.forEach(function(z){Pr(z)&&H(w,z,N)})}var M=new ke;return function(L,U){if(L instanceof a.Node&&(L=[L]),!L||0===L.length)return Z;var U=[];r.call(this,L,U);var p=[1/0,1/0,1/0],k=[-1/0,-1/0,-1/0];return U.forEach(function(G){p[0]=Math.min(G.x,p[0]),p[1]=Math.min(G.y,p[1]),p[2]=Math.min(G.z,p[2]),k[0]=Math.max(G.x,k[0]),k[1]=Math.max(G.y,k[1]),k[2]=Math.max(G.z,k[2])}),{min:p,max:k}}}(),updateFromChildren:function(){var _=this;if(!ar&&!_._updatingToChildren&&_._syncSize&&0!==_.size()&&!_._freezeSyncFromChildren){var w=this._getBoundingBox(_.toChildren().toArray());if(w){_._updatingFromChildren=1;var V=w.min,x=w.max,D=x[0]-V[0],b=x[2]-V[2],C=x[1]-V[1],v=new um(D,C,b),X=new um(1,1,1).divide((new um).fromArray(this.getScale3d())).multiply(v);this.s3(X.x,X.y,X.z);var e=this.p3(),T=this.r3(),M=jh();He(M,T,this.getRotationMode()),rn(M,e),M=(new ke).fromArray(M);var d=this.getAnchor3d();return e=new um(d).multiply(v).add((new um).fromArray(V)).applyMatrix4(M),this.p3([e.x,e.y,e.z]),delete _._updatingFromChildren,void 0;var _}}},setPosition:function(j,B){var f=this;if(!f._updatingToChildren){var l;l=2===arguments.length?{x:j,y:B}:j,ar||f._updatingFromChildren||(f._updatingToChildren=1,Ge(f._children,l.x-f._position.x,l.y-f._position.y),delete f._updatingToChildren),Ic.superClass.setPosition.call(this,l)}},setWidth:function(w){return this.setSize(w,this.getHeight())},setHeight:function(P){return this.setSize(this.getWidth(),P)},setSize:function(y,D){1>y&&(y=1),1>D&&(D=1);var i=this;if(!i._updatingToChildren){2!==arguments.length&&(D=y.height,y=y.width);var l=i.getWidth(),E=i.getHeight();if(y!==l&&Ic.superClass.setWidth.call(i,y),D!==E&&Ic.superClass.setHeight.call(i,D),!ar&&!i._updatingFromChildren){i._updatingToChildren=1;var V=y/l,I=D/E;i._adjustChildScaleOrSize(V,I,"size"),delete i._updatingToChildren,i.updateFromChildren()}}},_adjustChildScaleOrSize:function(y,c,C){var w=this;if(w._syncSize){var P=w.getPosition(),v=w.getRotation();w.getScale(),w.eachChild(function(D){if(Pr(D)){var O=D.getPosition(),l=D.getRotation(),X=D.getWidth(),w=D.getHeight(),Y=D.getScale(),T=Y.x*X,z=Y.y*w,p=new Dr(l,O.x,O.y,T,z);p.translate(-P.x,-P.y),p.rotate(-v),l=R(p.b*Math.sign(T),p.a*Math.sign(T)),p.scale(y,c);var Z,G,F,V=m(l);if(Math.abs(V)<.001?(Z=E(l),G=p.b/Z,F=-p.c/Z):(G=p.a/V,F=p.d/V),"scale"===C)D.setScale(G/X,F/w);else if("size"===C){var f=G/Y.x,W=F/Y.y;D.setScale(vn(G)*Math.abs(Y.x),vn(F)*Math.abs(Y.y)),D instanceof a.Shape?(D.setWidthForce(Math.max(Math.abs(f),1e-5)),D.setHeightForce(Math.max(Math.abs(W),1e-5))):D.setSize(Math.max(.01,Math.abs(f)),Math.max(.01,Math.abs(W)))}p.rotate(v),p.translate(P.x,P.y),D.setPosition(p.tx,p.ty)}})}},_calcChangeFactor:function(y,J,d,n){var D,z,W,B;return D=t(y),z=t(d),W=D>z?D/z:z/D,D=t(J),z=t(n),B=D>z?D/z:z/D,j(W,B)},setElevation:function(m){var A=this;if(!A._updatingToChildren){var C=A.getElevation(),J=m-C;0!==J&&(Ic.superClass.setElevation.apply(A,arguments),ar||A._updatingFromChildren||!A._syncSize||(A._updatingToChildren=1,Ge(A._children,0,J,0),delete A._updatingToChildren))}},setTall:function(V){var G=this;if(!G._updatingToChildren){1>V&&(V=1);var q=G.getTall();if(V!==q&&Ic.superClass.setTall.call(G,V),!ar&&!G._updatingFromChildren){G._updatingToChildren=1;var m=V/q;G._adjustChildTallOrScale(m,"size"),delete G._updatingToChildren,this.updateFromChildren()}}},setScaleTall:function(N){var x=this;if(!x._updatingToChildren){var L=x.getScaleTall();if(t(N)<.01&&(N=.01*(vn(N)||vn(L))),Ic.superClass.setScaleTall.call(x,N),!ar&&!x._updatingFromChildren){x._updatingToChildren=1;var i=N/L;x._adjustChildTallOrScale(i,"size"),delete x._updatingToChildren,this.updateFromChildren()}}},_adjustChildTallOrScale:function(s,u){var E=this;if(E._syncSize){var K=E.getElevation();E.eachChild(function(l){if(Pr(l))if("size"===u){var r=l.getTall();0>s&&l.setScaleTall(-1*l.getScaleTall()),l.setTall(Math.max(.01,Math.abs(r*s))),l.setElevation(K+(l.getElevation()-K)*s)}else{var $=l.getScaleTall();l.setScaleTall($*s)}})}},setAnchor:function(){var w=this;if(!w._updatingToChildren){var Q=w.getAnchor();if(Ic.superClass.setAnchor.apply(w,arguments),!ar&&!w._updatingFromChildren&&w._syncSize){w._updatingToChildren=1;var C=w.getAnchor();w.getPosition();var R=w.getSize(),X=w.getScale(),t=w.getRotation(),A=-R.width*X.x*(Q.x-C.x),k=-R.height*X.y*(Q.y-C.y),J=E(t),d=m(t),j=d*A-J*k,T=J*A+d*k;w.eachChild(function(N){if(Pr(N)){var d=N.getPosition();N.setPosition(d.x-j,d.y-T)}}),delete w._updatingToChildren}}},setAnchorElevation:function(){var L=this;if(!L._updatingToChildren){var n=L.getAnchorElevation();if(Ic.superClass.setAnchorElevation.apply(L,arguments),!ar&&!L._updatingFromChildren&&L._syncSize){L._updatingToChildren=1;var x=L.getAnchorElevation(),z=L.getTall(),R=L.getScaleTall(),e=-z*R*(n-x);L.eachChild(function(x){if(Pr(x)){var I=x.getElevation();x.setElevation(I-e)}}),delete L._updatingToChildren}}},setRotation:function(t){var y=this;if(!y._updatingToChildren){var O=y.getRotation();if(Ic.superClass.setRotation.apply(y,arguments),!ar&&!y._updatingFromChildren){y._updatingToChildren=1;var i=y.getPosition(),E=t-O;y.eachChild(function(s){if(Pr(s)){var w=s.getMatrix();w.translate(-i.x,-i.y),w.rotate(E),w.translate(i.x,i.y);var Z=Math.sign(s.getScale().x);s.setRotation(R(w.b*Z,w.a*Z)),s.setPosition(w.tx,w.ty)}}),delete y._updatingToChildren}}},setScale:function(r,Q){var M=this;if(!M._updatingToChildren){null==Q&&(Q=r.y,r=r.x);var H=M.getScale();if(t(r)<.01&&(r=.01*(vn(r)||vn(H.x))),t(Q)<.01&&(Q=.01*(vn(Q)||vn(H.y))),Ic.superClass.setScale.call(M,r,Q),!ar&&!M._updatingFromChildren){M._updatingToChildren=1;var T=r/H.x,_=Q/H.y;M._adjustChildScaleOrSize(T,_,"size"),delete M._updatingToChildren,M.updateFromChildren()}}},getSerializableProperties:function(){var r=Ic.superClass.getSerializableProperties.call(this);return r.clickThroughEnabled=1,r.syncSize=1,r}});var lg=a.Grid=function(){$f(a.Grid,this)};En("Grid",Lo,{IRotatable:!1,_icon:"grid_icon",_image:Z,getUIClass:function(){return le},setRotation:function(){},getCellRect:function(z,Y){var q=this,l=q.s("grid.row.count"),_=q.s("grid.column.count");if(0>=l||0>=_||0>z||z>=l||0>Y||Y>=_)return Z;var H,W,M,e=q.getRect(),j=q.s("grid.row.percents"),G=q.s("grid.column.percents");if(Tf(e,q,"grid.border",-1),j&&j._as&&(j=j._as),G&&G._as&&(G=G._as),j&&j.length===l){for(M=0,H=0;z>H;H++)M+=e.height*j[H];e.y+=M,e.height=e.height*j[z]}else e.height=e.height/l,e.y+=e.height*z;if(G&&G.length===_){for(W=0,H=0;Y>H;H++)W+=e.width*G[H];e.x+=W,e.width=e.width*G[Y]}else e.width=e.width/_,e.x+=e.width*Y;return Er(e,-q.s("grid.gap")),e}});var Eo=a.Text=function(){$f(Eo,this),this.setSize(100,50),this.s("text","TEXT")};En("Text",Lo,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return ai},setWidth:function(U){U||(U=.001),Eo.superClass.setWidth.call(this,U)},setHeight:function(_){_||(_=.001),Eo.superClass.setHeight.call(this,_)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),nq("__text__",{width:{value:100,isSafeFunc:!0,func:function(o){return o?o._width:100}},height:{value:50,isSafeFunc:!0,func:function(_){return _?_._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var ze=a.Shape=function(){$f(ze,this),this._59O=new Nj};ze.__de__=fe,En("Shape",Lo,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return ln},_22Q:function(){return Od},getLength:function(l){return gc(Ai(this._59O,this._58O,l,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var H=this._58O;return H?new Nj(H._as.slice(0)):H},setSegments:function(l){var j=this._58O;l=l?sp(l)?new Nj(l.slice(0)):new Nj(l._as.slice(0)):null,(j&&l&&j._as.join(",")!==l._as.join(",")||j!==l)&&(this._58O=l,this.fp("segments",j,l))},getPoints:function(){return this._59O},toPoints:function(){var $=this._59O;return new Nj($._as.slice(0))},getPointsMatrix2d:function(){var f=this,h=new rk.Matrix2d,y=f.getPosition(),E=f.getScale(),C=f.getRotation();return h.translate(-y.x,-y.y).scale(E.x,E.y).rotate(C).translate(y.x,y.y),h},getPointsMatrix3d:function(){return function(){var p=this,J=new rk.Matrix4,x=J.getElements(),N=p.p3();rn(x,N),He(x,p.getFinalRotation3d(),p.getRotationMode());var f=p.getScale3d(),F=p._dynamicScale3d;return F&&(f[0]*=F[0],f[1]*=F[1],f[2]*=F[2]),ld(x,f),rn(x,Fg(N)),J}}(),setPoints:function(z,c){var S=this,H=S._59O;z=z?sp(z)?new Nj(z.slice(0)):new Nj(z._as.slice(0)):new Nj;var p,T,Y,V,x,_;c&&(p=S.getPosition(),_=new Dr(S.getRotation(),0,0,S.getScale().x,S.getScale().y)),(H&&z&&H._as.join(",")!==z._as.join(",")||H!==z)&&(S._59O=z,S.fs(),S.fp("points",H,z)),c&&(T=S.getPosition(),Y=T.x-p.x,V=T.y-p.y,x=_.tf(Y,V),S.setPosition(T.x-Y+x.x,T.y-V+x.y))},addPoint:function(k,q,o){var V=this.toPoints();V.add(k,q),this.setPoints(V,o)},setPoint:function(W,U,M){var p=this.toPoints();p.set(W,U),this.setPoints(p,M)},removePointAt:function(F){var s=this.toPoints();s.removeAt(F),this.setPoints(s)},setWidthForce:function(l){var s=this;if(!s._55I&&!ar&&s.getWidth()){s._55I=1;var t=s._position.x,r=l/s.getWidth(),F=s.toPoints(),c=new Nj;1!==r&&(F.each(function(S){c.add({x:(S.x-t)*r+t,y:S.y,e:S.e})}),s.setPoints(c),Qc(s,[r,0,0,1,t*(1-r),0]),s.fs()),delete s._55I}ze.superClass.setWidth.call(s,l)},setWidth:function(w){return this.setWidthForce(1>w?1:w)},setHeightForce:function(I){var N=this;if(!N._55I&&!ar&&N.getHeight()){N._55I=1;var k=N._position.y,$=I/N.getHeight(),r=N.toPoints(),e=new Nj;1!==$&&(r.each(function(D){e.add({x:D.x,y:(D.y-k)*$+k,e:D.e})}),N.setPoints(e),Qc(N,[1,0,0,$,0,k*(1-$)]),N.fs()),delete N._55I}ze.superClass.setHeight.call(N,I)},setHeight:function(A){return this.setHeightForce(1>A?1:A)},setAnchorElevation:function(D){var o=this;o._55I=!0;var G=o._updatingAnchor3d,b=!ar&&!G;if(b){var R,V=D,B=o.getAnchorElevation(),e=o.getTall();R=e*(B-V),0!==R&&o.shiftPointsElevation(R)}var z=ze.superClass.setAnchorElevation.apply(o,arguments);return G||delete o._55I,z},getShapeElevation:function(){var Q=this,A=Q._54O;return A-(Q.getTall()||0)*(Q._anchorElevation-.5)},setAnchor3d:function(j,E,w,r){var n,u=this;"number"==typeof j?n={x:j,y:E,z:w}:(n=j.length?{x:j[0],y:j[1],z:j[2]}:j,r=E),u._55I=!0,u._updatingAnchor3d=!0;var G=u.getDataModel();if(G&&G.beginTransaction(),!ar){var Y=u.getAnchor3d(),b=u.getSize(),y=u.getTall(),s=b.width*(Y.x-n.x),L=b.height*(Y.z-n.z),z=y*(Y.y-n.y);r||u.shiftPoints(s,L,z);var p=u.p3()}var v=ze.superClass.setAnchor3d.apply(u,arguments);if(!ar&&r){var _=u.p3();u.shiftPoints(_[0]-p[0]+s,_[2]-p[2]+L,_[1]-p[1]+z)}return G&&G.endTransaction(),delete u._updatingAnchor3d,delete u._55I,v},setAnchor:function(X,O,L){var l=this;l._55I=!0;var q=l._updatingAnchor3d,i=!ar&&!q;if(i){var A,$,y;"number"==typeof X?y={x:X,y:O}:(y=X.length?{x:X[0],y:X[1]}:X,L=O);var Q=l.getAnchor(),S=l.getSize();A=S.width*(Q.x-y.x),$=S.height*(Q.y-y.y),L||l.shiftPoints(A,$);var F=l.getPosition()}var p=ze.superClass.setAnchor.apply(l,arguments);if(i){var M=l.getPosition();L&&l.shiftPoints(M.x-F.x+A,M.y-F.y+$)}return q||delete l._55I,p},shiftPoints:function(w,s,J){if(w||s||J){var I=this,l=I.getElevation()||0,p=I.toPoints(),f=new Nj;p.each(function(r){var e=r.e;J&&(e=(e==Z?l:e)+J),f.add({x:r.x+w,y:r.y+s,e:e})}),I.setPoints(f),I.fs()}},shiftPointsElevation:function($){return this.shiftPoints(0,0,$)},setPosition:function(F,c){var H,r=this;if(!r._28Q){if(r._28Q=1,!r._55I&&!ar){H=2===arguments.length?{x:F,y:c}:F;var G=H.x-r._position.x,Q=H.y-r._position.y;if(0===G&&0===Q)return delete r._28Q,void 0;r._55I=1,r.shiftPoints(G,Q),Qc(r,[1,0,0,1,G,Q]),delete r._55I}ze.superClass.setPosition.apply(r,arguments),delete r._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var Y=this;if(2!==Y._59O.size())return!1;var l=Y._58O;return l?2===l.size()&&1===l.get(0)&&2===l.get(1)?!0:!1:!0},fireShapeChange:function(){var g=this;if(!g._55I&&!ar){var C=rl(g._59O);C&&(g._55I=1,g.setRect(C),delete g._55I)}g.fp(vm,!1,!0)},getSerializableProperties:function(){var f=ze.superClass.getSerializableProperties.call(this);return f.segments=1,f.points=1,f.thickness=1,f.closePath=1,f}});var vd=a.Polyline=function(){$f(vd,this),this.s({"shape.background":null,"shape.border.width":2})};En("Polyline",ze,{_icon:"polyline_icon",_22Q:function(){return vr},getUIClass:function(){return si},setClosePath:function(){},setTall:function(P){var n=this,L=n.getDataModel();if(L&&L.beginTransaction(),!n._55I&&!n._24Q&&!ar&&n.getTall()){n._24Q=1;var V=n._54O,S=P/n.getTall();if(1!==S){var I=n.toPoints(),$=new Nj;I.each(function(k){$.add({x:k.x,y:k.y,e:k.e==Z?k.e:(k.e-V)*S+V})}),n.setPoints($),n.fs()}delete n._24Q}vd.superClass.setTall.call(n,P),L&&L.endTransaction()},setElevation:function(F){var c=this,w=c.getDataModel();if(w&&w.beginTransaction(),!c._55I&&!c._24Q&&!ar){c._24Q=1;var X=F-c._54O;0!==X&&c.shiftPointsElevation(X),delete c._24Q}vd.superClass.setElevation.apply(c,arguments),w&&w.endTransaction()},fireShapeChange:function(){var O=this,I=O._59O;if(!O._55I&&!O._24Q&&!ar){var h=I.size();if(h){var L=1,u=I.get(0),K=O._54O;u.e==Z&&(u.e=K);for(var g=u.e,b=0;h>L;L++){u=I.get(L),u.e==Z&&(u.e=K);var X=C(g,u.e),k=j(g+b,u.e);g=X,b=k-X}O._24Q=1,O.setTall(b),O.setElevation(g+b*O._anchorElevation),delete O._24Q}}vd.superClass.fireShapeChange.apply(O,arguments)}});var bj=a.SubGraph=function(){$f(bj,this)};En("SubGraph",Lo,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){bj.superClass._8I.call(this),this.eachChild(function(C){Pr(C)&&C._8I()})}}),A.loadingRefGraph=0;var uf=a.RefGraph=function(){$f(uf,this)};En("RefGraph",Ic,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(y){var M=this._ref;this._ref=y,this.fp("ref",M,y),this.updateRef()},_21I:function(){uf.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var B=this;if(A.loadingRefGraph++,B.clearChildrenFromDataModel(),A.loadingRefGraph--,B._ref&&B._dataModel){B._xhrLoadHandler&&(B._xhrLoadHandler.cancel=!0);var e=ar,_=B._xhrLoadHandler=function(X){if(X&&B._dataModel){A.loadingRefGraph++;var r=B._pendingUpdateInfo={needToRestore:e};e&&(r.position=B.p(),r.width=B.getWidth(),r.height=B.getHeight(),r.rotation=B.getRotation(),r.anchor=B.getAnchor(),r.scale=B.getScale()),B.p(0,0),B.setAnchor(.5,.5),B.setRotation(0),B.setScale(1,1);var n=A.parse(X),h=B._dataModel.deserialize(n,B,{justDatas:!0});h.each(function(D){D._refGraph=B}),B.checkPendingUpdateInfo(),A.loadingRefGraph--,A.handleRefGraphLoaded(B,h,n)}};_.xhrLoadCalled=!1,A.load(B._ref,function(J){_.cancel||(_.xhrLoadCalled?_(J):ys(function(){_(J)}))}),_.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var o=this,T=o._pendingUpdateInfo;if(!T)return o.onPendingUpdated&&(A.loadingRefGraph++,o.onPendingUpdated(),A.loadingRefGraph--),void 0;var Q=!0;this.eachChild(function(J){(J._pendingCheckImageJSON||J._pendingUpdateInfo)&&(Q=!1)}),Q&&(A.loadingRefGraph++,o._pendingUpdateInfo=null,o.updateFromChildren(),T.needToRestore&&(o.setSize(T.width,T.height),o.setAnchor(T.anchor),o.setRotation(T.rotation),o.setScale(T.scale),o.p(T.position)),this.getParent()instanceof uf&&this.getParent().checkPendingUpdateInfo(),o.onPendingUpdated&&o.onPendingUpdated(),A.loadingRefGraph--)},getSerializableProperties:function(){var f=uf.superClass.getSerializableProperties.call(this);return f.ref=1,f}}),a.EdgeGroup=function(l,v){this._70O=l,this._siblings=v;for(var $,w,S=0,C=l.size(),o=y[zc];C>S;S++)if($=l.get(S).getStyle(zc,!1),$!=Z){o=$;break}o==Z&&(o=!0);var d=A.edgeGroupAgentFunc;for(d&&(w=d(l),w&&w!==l.get(0)&&(l.remove(w),l.add(w,0))),S=0;C>S;S++)l.get(S).s(zc,o)},En("EdgeGroup",Y,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(J){return this._70O.get(J)},indexOf:function(X){return this._70O.indexOf(X)},each:function(n,x){this._70O.each(n,x)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(b,I){this._siblings.each(function(r){r._70O.each(b,I)})}});var jc=function(j,v,Y){var b=Rb[j]={type:j,action:v};if(Y)for(var k in Y)b[k]=Y[k]};Nh(A,{setConnectAction:jc,getConnectAction:function(t,Y){if(!Y){if(!t)return null;Y=t.getCurrentConnectActionType()}return Rb[Y]},doConnectAction:function(X,w,u,P){P=P||X.getCurrentConnectActionType();var Q=Rb[P];if(!Q)return!1;var x=Q.action;return x?(w instanceof vs.Group?X.sm().getSelection().each(function(J){x.call(null,X,J,u)}):x.call(null,X,w,u),!0):!1},doDeleteConnectionAction:function(Q,s,o){o=o||Q.getCurrentConnectActionType();var O=Rb[o];if(!O||!O.delete)return!1;var N=O.delete.action;return N?(s instanceof vs.Group?Q.sm().getSelection().each(function(m){N.call(null,Q,m)}):N.call(null,Q,s),!0):!1}});var qn=a.JSONSerializer=function(j,c){this.dm=this._dataModel=j,this._hierarchical=A.forceHierarchicalSerialization?!0:c==Z?j.isHierarchicalRendering():c};En("JSONSerializer",Y,{ms_ac:["hierarchical"],serialize:function(g){return A.stringify(this.toJSON(),g)},toJSON:function(){var p=this,K=p.dm,W=K.getRoots(),V=p.json={v:A.getVersion(),p:{},a:{},d:[]},o=K.getSerializableAttrs();K.getInit()&&(V.init=K.getInit()),K.getName()&&(V.p.name=K.getName()),K.getBackground()&&(V.p.background=K.getBackground()),K.getLayers()&&(V.p.layers=K.getLayers()),K.getEnvmap()&&(V.p.envmap=K.getEnvmap()),V.p.autoAdjustIndex=K.isAutoAdjustIndex(),V.p.hierarchicalRendering=K.isHierarchicalRendering();for(var w in o){var m=K.a(w);m!==l&&p[lo](w,m,V.a)}return rr(V.a)&&delete V.a,p._hierarchical?W.each(p.serializeData,this):K.each(function(H){p.serializeData(H)}),K.fireSerializeEvent({type:"serialize",json:V}),K.getPostProcessingData()&&(V.p.postProcessingData=K.getPostProcessingData()),V},isSerializable:function(){return!0},getProperties:function(e){return e.getSerializableProperties()},getStyles:function(T){return T.getSerializableStyles()},getAttrs:function(r){return r.getSerializableAttrs()},serializeData:function(Y){var $=this;if($.isSerializable(Y)&&!Y._refGraph){var B,w,i,q,d=go(Y.getClassName())||Y.getClass(),J=new d,V={c:Y.getClassName(),i:Y.getId(),p:{},s:{},a:{}};$.json.d.push(V),B=$.getProperties(Y);for(w in B)if(/^_/.test(w)){if(i=Y[w],!("_width"!==w&&"_height"!==w||i!=Z&&-1!==i)){var u;((Y.s("layout.h")||Y.s("layout.v"))&&Y.getHost()||Y instanceof a.Node&&(u=Y.getParent())&&u instanceof a.Block||Y.s("fullscreen"))&&(i=Y[w]="_width"===w?Y.getWidth():Y.getHeight())}i!==J[w]&&$[lo](w.substr(1),i,V.p)}else q=kr(w),Y[q]&&(i=Y[q](),i!==J[q]()&&$[lo](w,i,V.p));B=$.getStyles(Y);for(w in B)i=Y.s(w),i!==J.s(w)&&$[lo](w,i,V.s);B=$.getAttrs(Y);for(w in B)i=Y.a(w),i!==J.a(w)&&$[lo](w,i,V.a);rr(V.p)&&delete V.p,rr(V.s)&&delete V.s,rr(V.a)&&delete V.a}$._hierarchical&&Y.getChildren().each($.serializeData,$)},serializeValue:function(u,Z,y){po(Z)?Z={__a:Z._as}:Z instanceof ob&&(Z={__i:Z.getId()}),y[u]=Z},deserialize:function(Z,B,C){var d=this;return tk(Z)&&/.json$/.test(Z)?(A.xhrLoad(Z,function(V){d.deserializeImpl(V,B,C)}),void 0):d.deserializeImpl(Z,B,C)},deserializeImpl:function(L,R,W){var u=this,q=u.dm;q.setDeserializing(!0),W=ej(W)?{setId:W}:vi(W)?{finishFunc:W}:W||{},L=u.json=tk(L)?A.parse(L):L,!W.justDatas&&L.a&&L.a.onPreDeserialize&&!W.disableOnPreDeserialize&&L.a.onPreDeserialize(L,q,W.view),q.beginTransaction(),ar++,u._82I={};var n=new Nj,$=new Nj,k=0,M=L.d.length;if(W.justDatas||(!W.disableInit&&vi(L.init)&&L.init(q),q.setInit(L.init)),!W.justDatas){for(var r in L.a)q.a(r,u[Kq](L.a[r]));for(var z in L.p)q[zp(z)](L.p[z])}for(;M>k;k++){var h=L.d[k],G=go(h.c),c=new G,o=h.i;W.setId&&o!=Z&&(c._id=o),u._82I[o]=c,n.add(c),$.add(h)}for(k=0;M>k;k++)u.deserializeData(n.get(k),$.get(k));return n.each(function(w){R&&!w.getParent()&&w.setParent(R),q.add(w)}),W.__innerHandler__&&W.__innerHandler__(L,q,W.view,n),q.fireSerializeEvent({type:"deserialize",json:L}),ar--,q.endTransaction(),!W.justDatas&&L.a&&L.a.onPostDeserialize&&!W.disableOnPostDeserialize&&L.a.onPostDeserialize(L,q,W.view,n),W.finishFunc&&W.finishFunc(L,q,W.view,n),q.setDeserializing(!1),n},deserializeData:function(b,m){for(var T in m.p)b[zp(T)](this[Kq](m.p[T]));for(T in m.s)b.s(T,this[Kq](m.s[T]));for(T in m.a)b.a(T,this[Kq](m.a[T]))},deserializeValue:function(K){if(Bn(K)){var W=K.__i;if(W!=Z)return this._82I[W];if(W=K.__a,sp(W))return new Nj(W)}return K}}),Nh(rc,{serialize:function(m,L){return new qn(this,L).serialize(m)},toJSON:function(j){return new qn(this,j).toJSON()},deserialize:function(R,f,T){return new qn(this).deserialize(R,f,T)}});var Xn=a.OverlappingBox=function(A){this.gv=A,this.boxes={}};En("OverlappingBox",Y,{clear:function(){var m,Z,o=this.boxes;for(m in o)Z=o[m],Z.length=0},isOverlapping:function(u,a){var e,D,B=this,Z=B.boxes,M=Z[u];M?(e=M.rects,D=M.length):M=Z[u]={rects:e=[],length:D=0};var k,$,a;for(k=0;D>k;k++)if($=e[k],$.x<a.x+a.w&&$.x+$.w>a.x&&$.y<a.y+a.h&&$.h+$.y>a.y)return!0;return e.length<=D?(e.push(a),M.length++):e[M.length++]=a,!1}}),Nh(A,{fetch:function(m,I){var u="GET",F=!1,G=null,t="";I&&(u=I.method||"GET",F=I.sync,t=I.url,G=I.data||null),m.open(u,t,!F),I.responseType?m.responseType=I.responseType:I.overrideMimeType&&m.overrideMimeType&&m.overrideMimeType(I.overrideMimeType),m.send(G)},convertImageSrc:function(C,G){G&&"function"==typeof G||(G=function(){}),G(C)}});var Ar=a.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};En("Request",Y,{_responseType:null,_overrideMimeType:"text/plain",send:function(s){var Q=this._xhr,f=this.onload,I=this.onerror;this.getResponseType()?s.responseType=this.getResponseType():this.getOverrideMimeType()&&(s.overrideMimeType=this.getOverrideMimeType()),Q.onload=f,Q.onerror=I,A.fetch(Q,s)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(Q){this._responseType=Q},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(p){this._overrideMimeType=p},getResponseText:function(){var Q=this._xhr;return Q.response||Q.responseText}}),Jk.GraphView=function(u){var Z=this;Z._24I={},Z._34I=new Nj,Z._25I={},Z._56I={},Z._view=Wm(1,Z),Z._canvas=uh(Z._view),Z.dm(u?u:new rc),this._coreInteractor=new mp(this),Z.setEditable(!1),Z.setScrollBarVisible(A.graphViewScrollBarVisible),Z._initView()},$h("GraphView",Y,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[dr,Om,bq,Nl,"resettable","editInteractor",Zb,"zoomable","pannable","rectSelectable","autoScrollZone",re,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:A.graphViewZoomable,_resettable:A.graphViewResettable,_pannable:A.graphViewPannable,_rectSelectable:A.graphViewRectSelectable,_autoScrollZone:A.graphViewAutoScrollZone,_rectSelectBackground:A.graphViewRectSelectBackground,_rectSelectBorderColor:A.graphViewRectSelectBorderColor,_editPointSize:A.graphViewEditPointSize,_editPointBorderColor:A.graphViewEditPointBorderColor,_editPointBackground:A.graphViewEditPointBackground,_scrollBarColor:Tc,_scrollBarSize:Tl,_autoHideScrollBar:vg,_autoMakeVisible:vc,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(l){this._dataModel.setLayers(l)},setEditable:function(D){var b=this,Z=b.__interactorMap__;if(!Z){var g=Jk.XEditInteractor;Z=b.__interactorMap__={scrollBar:new Sm(b),select:new Wg(b),edit:g?new g(b):new fl(b),text:new em(b),move:new $m(b),"default":new Jh(b),touch:new bc(b,{editable:!1})}}D?(b._uieditable=!0,b.setInteractors([Z.scrollBar,Z.select,Z.edit,Z.text,Z.move,Z.default,Z.touch])):(b._uieditable=!1,b.setInteractors([Z.scrollBar,Z.select,Z.move,Z.default,Z.touch]))},getCanvas:function(){return this._canvas},_33I:function(P){var G=P.getUIClass();return G?new G(this,P):Z},getDataUI:function(G){var k=this,d=k._25I[G._id];return d===l&&(d=k._33I(G),k._25I[G._id]=d),d},getNodeRect:function(g){return A.getNodeRect(this,g)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(y){var r=this.getDataUI(y);return r?(r._79o(),r._78o):null},getEdgeSourcePosition:function(Z){var V=this,i=V.getDataUI(Z),p=i.s,w=i._data._40I;return Qf(V,w,p("edge.source.position"),p("edge.source.offset.x"),p("edge.source.offset.y"),p("edge.source.anchor.x"),p("edge.source.anchor.y"))},getEdgeTargetPosition:function(H){var S=this,n=S.getDataUI(H),x=n.s,G=n._data._41I;return Qf(S,G,x("edge.target.position"),x("edge.target.offset.x"),x("edge.target.offset.y"),x("edge.target.anchor.x"),x("edge.target.anchor.y"))},invalidateAll:function(E){var K=this;if(E){for(var B in K._25I){var A=K._25I[B];A&&A.dispose()}K._25I={},K._56I={},K._24I={},K._34I.clear(),K.redraw()}else K.dm().each(function(E){K.invalidateData(E)})},invalidateSelection:function(){var S=this;S.sm().each(function(E){S.invalidateData(E)})},invalidateData:function(D){var x=this;x._24I[D._id]=D,x._21Q(D),x.iv()},_21Q:function($){var U=this,j=U._24I;if(Xi($)&&Pp[$.s(vf)]){var X=$.getSourceAgent();X&&X.getAgentEdges().each(function(t){j[t._id]=t}),X=$.getTargetAgent(),X&&X.getAgentEdges().each(function(P){j[P._id]=P}),U.iv()}},redraw:function(k){var E=this;E._32I||(k?E._34I.add(k):(E._32I=1,E._34I.clear()),E.iv())},each:function(q,m){var E,S,x,Q=0,g=this.getLayers(),y=this._dataModel,_=y._datas._as,d=_.length;if(g){for(var Y=g.length;Y>Q;Q++)if(x=g[Q],Bn(x)&&(x=x.name),y.isHierarchicalRendering()){var c=function(f){return f._layer===x?m?q.call(m,f):q(f):void 0};if(this._dataModel.eachByHierarchical(c)===!1)return}else for(var J=0;d>J;J++)if(E=_[J],E._layer===x&&(S=m?q.call(m,E):q(E),S===!1))return}else if(y.isHierarchicalRendering())this._dataModel.eachByHierarchical(q,null,m);else for(;d>Q;Q++)if(E=_[Q],S=m?q.call(m,E):q(E),S===!1)return},reverseEach:function(U,C){var i,l,G,j,e=this._dataModel,I=e._layers,c=e._datas._as,h=c.length;if(I){for(i=I.length-1;i>=0;i--)if(j=I[i],Bn(j)&&(j=j.name),e.isHierarchicalRendering()){var s=function(T){return T._layer===j?C?U.call(C,T):U(T):void 0
        };if(e.reverseEachByHierarchical(s)===!1)return}else for(var o=h-1;o>=0;o--)if(l=c[o],l._layer===j&&(G=C?U.call(C,l):U(l),G===!1))return}else if(e.isHierarchicalRendering())e.reverseEachByHierarchical(U,null,C);else for(i=h-1;i>=0;i--)if(l=c[i],G=C?U.call(C,l):U(l),G===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var A=this,z=A._84I;if(!z){var d=this.dm().a("width"),q=this.dm().a("height");d>0&&q>0?A._84I={x:0,y:0,width:d,height:q}:(A.each(function(f){A.isVisible(f)&&(z=Xj(z,A.getDataUIBounds(f)))}),A._84I=z?z:oo)}return A._84I},getScrollRect:function(){return Xj(this.getContentRect(),this._29I)},makeCenter:function(U,b,X){var Q=this;if(!Q.getWidth()||!Q.getHeight())return X||ys(Q.makeCenter,Q,[U,b,!0],500),void 0;Q.makeVisible(U),Q.validate();var r=Q.getDataUIBounds(U);if(r){var M=Q.getWidth(),n=Q.getHeight(),V=r.x+r.width/2,Y=r.y+r.height/2,x=-V*Q._zoom+M/2,s=-Y*Q._zoom+n/2;Q.setTranslate(x,s,b)}},fitData:function(U,d,v,V,S){var y=this;if(!y.getWidth()||!y.getHeight())return S||ys(y.fitData,y,[U,d,v,V,!0],500),void 0;var f=function(){y.makeVisible(U),y.validate();var p=y.getDataUIBounds(U);p&&(p=Em(p),Er(p,v==Z?20:v),y.fitRect(p,d,V))};d?A.callWhenLoaded(f):f()},fitContent:function(P,s,$,m){var Q=this;if(!Q.getWidth()||!Q.getHeight())return m||ys(Q.fitContent,Q,[P,s,$,!0],500),void 0;var l=function(){Q.validate();var j=Em(Q.getContentRect());Er(j,s==Z?20:s),Q.fitRect(j,P,$)};P?A.callWhenLoaded(l):l()},fitRect:function(D,J,P){var q=this,T=q.getWidth(),k=q.getHeight(),w=D.x+D.width/2,S=D.y+D.height/2,t=C(T/D.width,k/D.height),H=q._zoom,a=-w*H+T/2,l=-S*H+k/2;0===t||isNaN(t)||(P&&(t=C(1,t)),J?(q._65I&&(delete q._65I.finishFunc,q._65I.stop(!0)),q._14o&&q._14o.stop(!0),q.setTranslate(a,l,{finishFunc:function(){q.setZoom(t,J)}})):(q.setTranslate(a,l),q.setZoom(t)))},fitSelection:function(x,d,K){var m=this,Z=m.sm(),S=null;Z.size()&&(Z.each(function(e){var V=m.getDataUIBounds(e);S=S?Xj(V,S):V}),x&&Er(S,x),m.fitRect(S,d,K))},toCanvas:function(u,Q,z){Q=Q||this._zoom,this.validateImpl();var i=this,H=i.getContentRect();z&&Er(H,z),H.width||(H.width=10),H.height||(H.height=10);var w=uh(),K=H.x*Q,M=H.y*Q,E=Math.ceil(H.width*Q),t=Math.ceil(H.height*Q);wg(w,E,t,1);var o=qq(w);return u=u||this._dataModel.getBackground(),u&&jq(o,0,0,E,t,u),Yf(o,-K,-M),o.scale(Q,Q),i._42(o),o.restore(),w},toDataURL:function(X,M,e,Z){return this.toCanvas(X,e,Z).toDataURL(M||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(T,u){var w=this,A=w.dm().getBackground();if(A){var b=w.dm().a("width"),K=w.dm().a("height");b>0&&K>0&&jq(T,0,0,b,K,A)}var l=w.__htmlOrderList,f=[];if(w._93db(T,u),w.each(function(W){var X=w.getDataUI(W);if(X){var l=w._56I[W._id],q=X._htmlView;if(l){var y=X._79o();if(q=X._htmlView,a.HtmlNode&&W instanceof a.HtmlNode)X._42(T);else{var e=w.getViewRect(),B=q&&q.layoutHTML;!u||Yb(u,y)?(B&&(q.layoutHTML(),X.__outerLayout&&delete X.__outerLayout),X._42(T)):Yb(e,y)||!B||X.__outerLayout||(q.layoutHTML(),X.__outerLayout=!0)}}q&&(f.push(q),q.getView&&(q=q.getView()),q.style.display=l?"block":rg)}}),l&&f.length>0){var C=!1;if(l.length!==f.length)C=!0;else for(var Q=0;Q<f.length;Q++)if(f[Q]!==l[Q]){C=!0;break}C&&(f.forEach(function(v){v.autoAdjustIndex!==!1&&w.appendHTML(v,!0)}),this.__htmlOrderList=f)}else this.__htmlOrderList=f;w._92db(T,u)},validateImpl:function(){this.tryUpdateRootData();var u,v,D,X,J,l=this,h=l.tx(),K=l.ty(),Q=l._zoom,A=l._canvas,k=this.getWidth(),a=this.getHeight(),n=l._29I,y={x:-h/Q,y:-K/Q,width:k/Q,height:a/Q},o={},w=l._34I,_=l._24I,R=l._32I,G=l._23I;l._24I={},(k!==A.clientWidth||a!==A.clientHeight)&&(wg(A,k,a),R=1),R||Hq(y,n)||(R=1),l._29I=y,l.each(function(Y){v=Y._id;var X=o[v]=l.isVisible(Y);X!==l._56I[v]&&(_[v]=Y,D=l.getDataUI(_[v]),D&&D._84o(X),l._84o(Y,X))},l);for(v in _)D=l.getDataUI(_[v]),D&&(!R&&l._56I[v]&&(J=D._79o(),J&&w.add(J)),D.invalidate()),l._83I=1;if(l._56I=o,!R)for(v in _)o[v]&&(D=l.getDataUI(_[v]),D&&(J=D._79o(),J&&w.add(J)));if(R?X=y:(w.each(function(w){Yb(y,w)&&(X=Xj(X,w))}),X&&(Er(X,j(1,1/Q)),X.x=H(X.x*Q)/Q,X.y=H(X.y*Q)/Q,X.width=p(X.width*Q)/Q,X.height=p(X.height*Q)/Q,X=$l(y,X))),l._74O=X,X){u=qq(A);var P=X.x,d=X.y,c=X.width,m=X.height;P=Math.floor((P*Q+h)*vj),d=Math.floor((d*Q+K)*vj),c=Math.ceil(c*Q*vj)+1,m=Math.ceil(m*Q*vj)+1,R||(X.x=(P/vj-h)/Q,X.y=(d/vj-K)/Q,X.width=c/vj/Q,X.height=m/vj/Q),u.beginPath(),u.rect(P,d,c,m),u.clip(),u.clearRect(P,d,c,m),hb(u,h,K,Q),l._42(u,X),u.restore(),delete l._74O}if(w.clear(),delete l._32I,G&&k>0&&a>0){var D=l.getDataUI(G);if(D){var J=D._79o(),L=l._29I,Y=L.x,q=L.y,t=L.width,f=L.height,Q=l._zoom;J&&!Yb(J,L)&&(J.x+J.width<Y&&l.tx(-J.x*Q),J.x>Y+t&&l.tx(-(J.x+J.width-t)*Q),J.y+J.height<q&&l.ty(-J.y*Q),J.y>q+f&&l.ty(-(J.y+J.height-f)*Q))}delete l._23I}l._83I&&(delete l._83I,delete l._84I),l._98O(),l.countFrame(),rr(l._24I)||ys(l.iv,l)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var g,l=this.getFullscreenDatas();for(var m in l)g=l[m],this.scaleRootData(g);this._rootDataUpdating=!1}},scaleRootData:function($){var M=$.s("fullscreen");if("uniform"===M||"fill"===M){$.getRotation()&&$.setRotation(0);var l=$.s("fullscreen.gap")||0,X=this.getWidth(),K=this.getHeight();if(X&&K){var I,k,u,p=X-2*l,S=K-2*l,N=$.getAnchor(),P=$.getScaledSize(),j=P.width,i=P.height,D=$.s("fullscreen.lock");if(D)return"uniform"===M?p/S>j/i?(I=S/i,j=i*p/S):(I=p/j,i=j*S/p):"v"===D?(I=S/i,j=p/I,$.getWidth()!==j&&$.setWidth(j)):(I=p/j,i=S/I,$.getHeight()!==i&&$.setHeight(i)),this.setZoom(I),k=l-($.getX()-N.x*j)*I,u=l-($.getY()-N.y*i)*I,k!==this.tx()&&this.tx(k),u!==this.ty()&&this.ty(u),void 0;k=this.tx(),u=this.ty(),I=this._zoom;var R={x:(-k+l)/I,y:(-u+l)/I,width:p/I,height:S/I};if("uniform"===M){var B=j/i,n=Math.min(R.width,R.height*B),d=n/B;R.x+=.5*(R.width-n),R.y+=.5*(R.height-d),R.width=n,R.height=d}p=R.width/$.getScaleX(),S=R.height/$.getScaleY(),($.getWidth()!=p||$.getHeight()!==S)&&$.setSize(p,S);var J=R.x+N.x*R.width,G=R.y+N.y*R.height,Q=$.getPosition();(J!==Q.x||G!==Q.y)&&$.setPosition(J,G)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(Q){var F=this;Q!==F.isScrollBarVisible()&&(Q?(Jp(F._view,F._79O=Sr()),Jp(F._79O,F._27I=Sr()),Jp(F._79O,F._28I=Sr())):(pf(F._79O),delete F._79O,delete F._27I,delete F._28I),F.fp("scrollBarVisible",!Q,Q))},getDebugTip:function(){return""},showScrollBar:function(){var J=this;J._79O&&(J._85I||(U(function(){J._86I()},Qn),J.iv()),J._85I=new Date)},_86I:function(){var p=this;if(p._85I){var H=new Date,e=H.getTime();e-p._85I.getTime()>=Qn?(delete p._85I,p.iv()):U(function(){p._86I()},Qn)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var B=this,p=this._27I,r=this._28I;if(B._79O){if(B._autoHideScrollBar&&!B._85I)return p.style.visibility=ud,r.style.visibility=ud,void 0;var H=B.getScrollBarColor(),Y=B._zoom,j=B.getScrollBarSize(),d=B.getViewRect(),f=B.getScrollRect(),A=d.height*Y,t=f.height*Y,M=d.width*Y-j-2,W=A*((d.y-f.y)*Y/t),I=A*(A/t),C=p.style;t-.5>A?(Kc>I&&(W=W+I/2-Kc/2,0>W&&(W=0),W+Kc>A&&(W=A-Kc),I=Kc),Vn(p,M,W,j,I),C.visibility=Gj,C.background=H,C.borderRadius=j/2+Bd):C.visibility=ud;var c=d.width*Y,G=f.width*Y,W=d.height*Y-j-2,M=c*((d.x-f.x)*Y/G),$=c*(c/G),C=r.style;G-.5>c?(Kc>$&&(M=M+$/2-Kc/2,0>M&&(M=0),M+Kc>c&&(M=c-Kc),$=Kc),Vn(r,M,W,$,j),C.visibility=Gj,C.background=H,C.borderRadius=j/2+Bd):C.visibility=ud}},setDataModel:function(_){var F=this,f=F._dataModel,M=F._selectionModel;f!==_&&(f&&(f.ump(F.handleDataModelPropertyChange,F),f.umm(F.handleDataModelChange,F),f.umd(F.handleDataPropertyChange,F),f.removeIndexChangeListener(F._75O,F),f.removeHierarchyChangeListener(F.handleHierarchyChange,F),M||f.sm().ums(F.handleSelectionChange,F)),F._dataModel=_,_.mp(F.handleDataModelPropertyChange,F),_.mm(F.handleDataModelChange,F),_.md(F.handleDataPropertyChange,F),_.addIndexChangeListener(F._75O,F),_.addHierarchyChangeListener(F.handleHierarchyChange,F),M?M._21I(_):_.sm().ms(F.handleSelectionChange,F),F.invalidateAll(!0),F.fp(Mr,f,_),F.updateBackground())},getLayersInfo:function(){if(this._layersInfo===l){var w=this.getLayers();w?(this._layersInfo={},w.forEach(function(P){var n=Bn(P)?P.name:P;this._layersInfo[n]=P},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(E,W,v){var i,e,L=this,D=L.getDataUI(E),c=np(D),u=Nf(W,function(Q){return mn(c,100*Q)},100,.001),B=mn(c,100*u);if(!v){var P=tc(D),b=new Sf(B.x,B.y),V=49/(L._zoom*L._zoom);for(i=0,e=P.length;e>i;i++)if(b.distanceToSquared(P[i])<V)return{index:i,point:P[i],distance:Math.sqrt((P[i].x-W.x)*(P[i].x-W.x)+(P[i].y-W.y)*(P[i].y-W.y))}}return{percent:u,point:B,distance:Math.sqrt((B.x-W.x)*(B.x-W.x)+(B.y-W.y)*(B.y-W.y))}},calculateAttachPoint:function(){var G=new Sf,l=new Sf,m=new Sf;return function(T,k){var s=this.getAttachPoints(T);if(!s||!s.length)return null;m.set(k.x,k.y);for(var K,L,Y,H,a,t=1/0,B=0,Z=s.length;Z>B;B++)Y=s[B],l.x=Y.x,l.y=Y.y,G.x=Y.offsetX||0,G.y=Y.offsetY||0,H=Qf(this,T,0,G.x,G.y,l.x,l.y),L=m.distanceToSquared(H),t>L&&(K=B,t=L,a=H);t=Math.sqrt(t);var J=this.getAttachStyle(T);if("close"===J){var w=T.s("attach.close.threshold")/this._zoom;if(t>w)return null}return{index:K,distance:t,info:s[K],point:a}}}(),getAttachPoints:function(S){var P=S.s("attach.points");if(P)return P;var K=Uj(S._image);return K?Xo(K.attachPoints,S,this)||null:void 0},getAttachStyle:function(E){var q=E.s("attach.style");if(q)return q;var l=Uj(E._image);return l?Xo(l.attachStyle,E,this)||"close":void 0},updateLayers:function(){this._layersInfo=l,this.invalidateSelection(),this.redraw()},updateBackground:function(){var N=this.dm().a("width"),t=this.dm().a("height");this._canvas.style.background=N>0&&t>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(s){if("background"===s.property){var i=this._canvas.style.background,X=s.newValue||"";this.updateBackground(),this.fp("canvasBackground",i,X),this.redraw()}else"a:width"===s.property||"a:height"===s.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===s.property?this.updateLayers():"hierarchicalRendering"===s.property&&this.redraw()},handleDataPropertyChange:function(_){this.dm().isHierarchicalRendering()&&"parent"===_.property&&_.data.hasChildren()&&this.redraw(),this.invalidateData(_.data)},onPropertyChanged:function(n){var y=this,z=n.property;if(y.redraw(),"zoom"===z){var N=y.sm().getSelection();N.size()&&N.each(function(P){P.invalidate()})}else"dataModel"===z&&(y._83I=1);jb[z]?y.showScrollBar():z===Zb&&y.onCurrentSubGraphChanged(n)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(t){var v=this,s=t.kind,b=t.data;if(v._83I=1,"add"===s)v.invalidateData(b),Xi(b)&&b.getEdgeGroup()&&b.getEdgeGroup().eachSiblingEdge(v.invalidateData,v);else if(s===nd){v._21Q(b);var P=b._id,C=v._25I[P];if(C){if(v._56I[P]){var A=C._79o();A&&v.redraw(A)}C.dispose(),delete v._25I[P],delete v._24I[P],delete v._56I[P]}b===v._currentSubGraph&&v.setCurrentSubGraph(Z)}else s===Fh&&(v.invalidateAll(!0),v.setCurrentSubGraph(Z))},_75O:function(Q){this.invalidateData(Q.data)},handleHierarchyChange:function(x){this.dm().isHierarchicalRendering()&&x.data.hasChildren()&&this.redraw(),this.invalidateData(x.data)},adjustIndex:function(N){var u=this;if(u.isVisible(N)){u.dm().beginTransaction();for(var H=N;H._parent&&u.isVisible(H._parent);)H=H._parent;H&&H!==N&&u._dataModel.adjustIndex(H),u._dataModel.adjustIndex(N),u.dm().endTransaction()}},getImage:function(B){return B.getImage?B.getImage():l},getSelectWidth:function(j){var g=Uj(this.getImage(j));return g&&Xo(g.disableSelectedBorder,j,this)?0:j.s("select.width")},getSelectColor:function(q){return q.s("select.color")},isSelectable:function(W,m){if(this.isSelected(W))return!0;if(!m&&W.getParent()instanceof Ic&&this.isSelectable(W.getParent(),!0)&&W.getParent().isSyncSize())return!1;var K=this.getLayersInfo();if(K){var s=K[W._layer];if(s&&s.selectable===!1)return!1}return W.s("2d.selectable")&&this.sm().isSelectable(W)},isMovable:function(e){var f=this;if(Xi(e)&&e.getStyle(vf)!==rd)return!1;var M=this.getLayersInfo();if(M){var N=M[e._layer];if(N&&N.movable===!1)return!1}return e.s("2d.movable")?f._movableFunc?f._movableFunc(e):!0:!1},isEditable:function(Y){var e=this;if(a._uiSerializing)return e._uieditable;if(!e._editInteractor||!e.isSelected(Y))return!1;if(Mf(Y)){var h=e.getDataUI(Y);if(!h||h._88I)return!1}if(Xi(Y)&&Y.getStyle(vf)!==rd)return!1;var k=this.getLayersInfo();if(k){var W=k[Y._layer];if(W&&W.editable===!1)return!1}return Y.s("2d.editable")?e._editableFunc?e._editableFunc(Y):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(E){return Pr(E)&&0!==E.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(E):!0},isRectEditable:function(n){return this._rectEditableFunc?this._rectEditableFunc(n):!0},isAnchorEditable:function(g){return this._anchorEditableFunc?this._anchorEditableFunc(g):!0},isRotationEditable:function(L){return L.setRotation&&L.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(L):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(V){var y=V.getAnchor(),f=V.getScale(),E=this._zoom,H=an(V.getRotation(),0,-V.getHeight()*f.y*y.y-(f.y<0?-1:1)*(ng?32:16)/E),z=V.p();return H.x+=z.x,H.y+=z.y,H},getLogicalPoint:function(I){var m=this;return kk(I,m._canvas,m.tx(),m.ty(),m._zoom,m._zoom)},getScreenPoint:function(u,W){var y,a=this;return"object"==typeof u?u.x!==l?(y=u.x,W=u.y):(y=u[0],W=u[1]):y=u,sn(y,W,a._canvas,a.tx(),a.ty(),a._zoom,a._zoom)},getSelectedDataAt:function(P){var O=this;return this.getDataAt(P,function(U){return O.isSelected(U)})},getDataInfoAt:function(t,L,Y){var O,Q=this.lp(t),A=this.getDataAt(Q,L,Y);if(A){var m=this.getDataUI(A);O={data:A,ui:m,point:Q};var H=m._38o;if(H){var d=H.icons;for(var N in d){var w=d[N],y=H.rects[N];if(y)for(var U=Xo(w.names,A,this),G=U?U.length:0,v=y.rotation,c=G-1;c>=0;c--){var u=U[c],b=y[c];if(or(b,Q,v))return O.part="icons",O.name=N,O.icon=u,O.rect=b,O.index=c,O.rotation=v,O}}}if(this.isNoteVisible(A)){if(m.note2Info&&or(m.note2Info.clickRect,Q,Z,m.note2Info.scale))return O.part="note2",O;if(m.noteInfo&&or(m.noteInfo.clickRect,Q,Z,m.noteInfo.scale))return O.part="note",O}if(this.isLabelVisible(A)){if(m.label2Info&&or(m.label2Info.rect,Q,m.label2Info.rotation,m.label2Info.scale))return O.part="label2",O;if(m.labelInfo&&or(m.labelInfo.rect,Q,m.labelInfo.rotation,m.labelInfo.scale))return O.part="label",O}if(A.isInRect&&A.isInRect(Q))return O.part="body",O}return O},getDataAt:function(S,B,m){S.target&&(S=this.lp(S));var I,c=this._zoom;return this.reverseEach(function(F){return(B?B(F):this.isSelectable(F))&&this.rectIntersects(F,pg(S.x,S.y,m,c))?(I=F,!1):void 0},this),I},getIconInfoAt:function(l,j){var r=this;if(l.target&&(l=r.lp(l)),j||(j=r.getDataAt(l)),j){var q=r.getDataUI(j);if(q&&q._38o){var M,k=q._38o,F=new Nj;for(M in k.icons)F.add(M);for(var z=F.size()-1;z>=0;z--){M=F.get(z);for(var D=k.rects[M],P=D.rotation,b=D.length-1;b>=0;b--){var d=D[b],m=d.width,N=d.height,x={x:l.x-d.x-m/2,y:l.y-d.y-N/2};P!=Z&&(x=an(-P,x.x,x.y));var d={x:-m/2,y:-N/2,width:m,height:N};if(or(d,x))return{key:M,index:b,name:k.icons[M].names[b],rect:D[b],point:l,rotation:P,relativeRect:d,relativePoint:x,data:j}}}}}return Z},getDatasInRect:function(E,v,F){F===l&&(F=1);var n=this,W=new Nj;return n.reverseEach(function(i){F&&!n.isSelectable(i)||(v?n.rectIntersects(i,E):n.rectContains(i,E))&&W.add(i)}),W},moveSelection:function(G,l){var A=this;A.dm().beginTransaction(),Ge(A.sm().toSelection(A.isMovable,A),G,l),A.dm().endTransaction()},moveDatas:function(Q,B,c){var w=this;w.dm().beginTransaction(),Q instanceof Nj||(Q=new Nj(Q)),Ge(Q,B,c),w.dm().endTransaction()},getDataUIBounds:function(q){var U=this.getDataUI(q);return U?U._79o():Z},drawData:function(u,_,t){var z=this.getDataUI(_);if(z){var P=z._79o();(!t||Yb(t,P))&&(z._42(u),_ instanceof a.Block&&_.eachChild(function(r){this.isVisible(r)&&this.drawData(u,r,t)},this))}},getBoundsForGroup:function(H){return H.s(Sb)?this.getDataUIBounds(H):Z},isPixelPerfect:function(C){return C.s("pixelPerfect")},rectIntersects:function(s,C){this.validate();var K=Z;if(this._56I[s._id]){var S=this._25I[s._id];if(S){var r=S._79o();if(Ob(C,r))K=!0;else if((C=$l(C,r))&&(S.rectIntersects&&(K=S.rectIntersects(C)),K==Z)){if(!this.isPixelPerfect(s))return!0;var b=C.x,c=C.y,V=C.width,o=C.height,q=this._zoom,B=A.hitMaxArea,u=V*o*q*q;if(u>B){var N=Math.sqrt(B/u);q*=N}V*=q,o*=q,2>V&&(V=2),2>o&&(o=2),b*=q,c*=q;var t=Zi(V,o);Yf(t,-b,-c),t.scale(q,q),this._drawForChecking=!0,this.drawData(t,s,C),this._drawForChecking=!1;try{for(var Q=0,M=t.getImageData(0,0,V,o).data;Q<M.length;Q+=4)if(0!==M[Q+3]){K=!0;break}t.restore()}catch(I){Nc=Z,K=!1}}}}return K?!0:!1},rectContains:function(n,i){if(this._56I[n._id]){var m=this._25I[n._id];if(m)return Ob(i,m._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(K){if(!A.isInput(K.target)){var J=this,z=J._focusData,R=z&&J._25I[z._id],f=0,i=J._dataModel._datas;if(!(z&&z._enabled&&z._editable&&R&&R.onKeyDown&&R.onKeyDown(K)===!0))if(9===K.keyCode&&(z&&(f=i.indexOf(z),_d(K)?-1===--f&&(f=0):++f===i.size()&&(f=0)),J._focusData=z=i.get(f),J.sm().setSelection(z)),Dn(K)?J.selectAll():nb(K)&&J.isResettable()&&J.reset(),J.sm().isEmpty()){if(J._editing)return;var w=J.tx(),_=J.ty(),C=!1,d=_d()?100:10;Bg(K)&&(w-=d,C=!0),yb(K)&&(_-=d,C=!0),Pn(K)&&(w+=d,C=!0),Vl(K)&&(_+=d,C=!0),C&&J.setTranslate(w,_)}else{Go(K)&&J.handleDelete(K);var N=_d()?10:1;Bg(K)&&(J.moveSelection(-N,0),J.fi({kind:"moveLeft"})),yb(K)&&(J.moveSelection(0,-N),J.fi({kind:"moveUp"})),Pn(K)&&(J.moveSelection(N,0),J.fi({kind:"moveRight"})),Vl(K)&&(J.moveSelection(0,N),J.fi({kind:"moveDown"}))}}},handleScroll:function(j,f){if(td(j),this.isZoomable()){if(!this.getEditInteractor()){var t=this.getDataAt(j);if(t){var $=Uj(this.getImage(t));if($&&Xo($.scrollable,t,this))return}}var E=this.lp(j);f>0?this.scrollZoomIn(E):0>f&&this.scrollZoomOut(E)}},handlePinch:function(D,G,R){this.isZoomable()&&(Math.abs(G-R)<A.pinchZoomThreshold||(G>R?this.pinchZoomIn(D):this.pinchZoomOut(D)))},checkDoubleClickOnNote:function(v,U){var Y=this,m=Y.lp(v),R=Y.getDataUI(U),d=R.note2Info;return d&&U.s("note2.toggleable")&&or(d.clickRect,m)?(U.s(Rc,!U.s(Rc)),Y.fi({kind:"toggleNote2",event:v,data:U}),!0):(d=R.noteInfo,d&&U.s("note.toggleable")&&or(d.clickRect,m)?(U.s(ac,!U.s(ac)),Y.fi({kind:"toggleNote",event:v,data:U}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(Q,t){var j=this,a=j.getAutoScrollZone(),q=a/j.getZoom(),A=a/4,L=j._29I,y=j.lp(Q),I={x:j.tx(),y:j.ty()};return y&&a>0&&L&&(y.x-L.x<q?j.translate(A,0):L.x+L.width-y.x<q&&j.translate(-A,0),y.y-L.y<q?j.translate(0,A):L.y+L.height-y.y<q&&j.translate(0,-A)),I.x=j.tx()-I.x,I.y=j.ty()-I.y,t&&(t.x+=I.x,t.y+=I.y),I},getMoveMode:function(N,y){var X=y.s("2d.move.mode");return X?X:_n["88"]?"x":_n["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(h,k,o){var y=this;return"currentSubGraph"===k?{__i:h.getId()}:o.serializeProperty(h,k,y)},deserializeProperty:function(E,m,P){var X=this;if("currentSubGraph"===m){var o=X.dm(),i=o.__idMap;return i[E.__i]}return P.deserializeProperty(E,m,X)},setDefaultCursor:function(q,u){this._defaultCursor=q,u!==!1&&this.setCursor(q)},setCursor:function(I){"default"===I&&(I=this._defaultCursor||I);var Y=this.getView().style;Y.cursor=I,Y.cursor="-webkit-"+I,Y.cursor="-moz-"+I},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(m){return m===Z||A.getConnectAction(null,m)?(this._currentActionType=m,this.redraw(),!0):!1},getEditStyle:function(k){var V=this.getEditInteractor();return V?V.getStyle(k):l},setEditStyle:function(N,G,E){var P=this.getEditInteractor();return P?(P.setStyle(N,G,E),!0):!1},isConnectActionVisible:function($){var P=A.getConnectAction(this);if(!P)return!1;var j=P.visible;return vi(j)&&(j=j(this,$)),j},isInteractive:function(Y){if(this._drawForChecking)return!1;var o=Uj(this.getImage(Y));return o&&Xo(o.interactive,Y,this)?!0:Y.s("interactive")},appendHTML:function(N,H){var q=this.getView();if(!(H||N&&N.parentNode!==q))return!1;var Q=N.getView&&N.getView();if(!H&&Q&&Q.parentNode===q)return!1;(N.getView||N.isSelfViewEvent)&&(N=N.getView());var G=this.getEditInteractor();return G&&G._canvas?q.insertBefore(N,G._canvas):this.isScrollBarVisible()?q.insertBefore(N,this.getView().lastChild):Jp(q,N),!0},_layoutHTMLImpl:function(z,E,G){if(arguments.length>1){var k,A=this,i=A._zoom;if(E.getView&&(k=E,E=E.getView()),E.style.position="absolute",G){var B=z.getRect();Vn(k||E,A.tx()+B.x*i,A.ty()+B.y*i,B.width*i,B.height*i)}else{var b=new dd,B=z.getAnchorRect(),a=z.getPosition(),n=z.getScale(),W=E.style;Vn(k||E,B),b.appendTranslate(A.tx(),A.ty()),b.appendScale(i,i),b.append(new dd(z.getRotation(),a.x,a.y,n.x,n.y)),Bk(W,"transform","matrix("+b.a.toFixed(5)+", "+b.b.toFixed(5)+", "+b.c.toFixed(5)+",\n    "+b.d.toFixed(5)+", "+b.tx.toFixed(5)+", "+b.ty.toFixed(5)+")"),Bk(W,"transformOrigin",(-B.x).toFixed(5)+"px "+(-B.y).toFixed(5)+"px"),E.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(n){return n instanceof Eo?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(T){var b="state",F=T.s(b);if(F)return F;var E=Uj(T._image);return E?Xo(E[b],T,this)||null:void 0},getShape:function(t){return t.getStyle(vm)}}),Y.defineProperties(Jk.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(w){this._layoutHTML=w}}});var yk=function(w,q){var U=this;U.gv=w,U.s=function(P){return q.getStyle(P)},U._data=q,U._87I=new Nj};Im(yk,Y,{_6I:Z,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var e=this,d=e.gv.isSelected(e._data);return!d||e.isShadowed()?0:e.gv.getSelectWidth(e._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(e){var u=this._data,H=this.gv.getBodyColor(u);return H?H:e?u.getStyle(e):Z},_2Q:function(n){return this.s(n)},_1Q:function(c,X,O,H){var b=this.s,q=b("2d.gray"),j=b(X+".dash.color");if(q&&(j=A.toGrayColor(j)),c.strokeStyle=j,c.lineWidth=O,c.stroke(),b(X+".dash.3d")){var g=b(X+".dash.3d.color");hq(c,j,q?A.toGrayColor(g):g,O,this.gv._zoom,b(X+".dash.3d.accuracy"))}So(c,H)},invalidate:function(){this._6I=Z},_79o:function(){var A=this;if(!A._6I){var z=A._data,$=A.gv;A.labelInfo=A.label2Info=A.noteInfo=A.note2Info=A._38o=Z,A._87I.clear(),A.interactiveInfo=$.isInteractive(z)?{}:Z,A._3O(),A._55O=$.isEditable(z)?{_42O:$.isRectEditable(z),_43O:$.isPointEditable(z),_56O:$.isRotationEditable(z)}:Z,A._6I=A._81o()}return A._6I},_3O:function(){},getPosition:function(){return oo},_68o:function($,Z){$&&this._87I.add(Tb($,Z))},_81o:function(){var f=this,W=f.s;f._24O(Rh,"getLabel"),f._24O(kh,"getLabel2"),f._26O(sl,"getNote"),f._26O(Am,"getNote2"),f._15O(),f._55O&&f._48O();var t;if(f._87I.each(function(G){t=Xj(t,G)}),t&&f.isShadowed()){var u=Em(t);u.x+=W("shadow.offset.x"),u.y+=W("shadow.offset.y"),Er(u,W("shadow.blur")),t=Xj(t,u)}return f._87I.clear(),t},_42:function(q){var h=this,s=h._data,d=h.gv,T=h.s,w=T("opacity"),c=this.isShadowed();if(c){var B=q.shadowOffsetX,u=q.shadowOffsetY,_=q.shadowBlur,z=q.shadowColor,x=d.getZoom();q.shadowOffsetX=T("shadow.offset.x")*x,q.shadowOffsetY=T("shadow.offset.y")*x,q.shadowBlur=T("shadow.blur")*x,q.shadowColor=h.getSelectColor()}if(w!=Z){var S=q.globalAlpha;q.globalAlpha=w}h._80o(q),d.isLabelVisible(s)&&((!d._drawForChecking||T("label.selectable"))&&Fk(q,h.labelInfo),(!d._drawForChecking||T("label2.selectable"))&&Fk(q,h.label2Info)),d.isNoteVisible(s)&&(yd(q,h.noteInfo),yd(q,h.note2Info)),h._99O(q),w!=Z&&(q.globalAlpha=S),c&&(q.shadowOffsetX=B,q.shadowOffsetY=u,q.shadowBlur=_,q.shadowColor=z)},_80o:function(){},_47O:function(){},_24O:function(Y,k){var h=this,z=h._data,o=h.gv,M=h.s,p=o[k](z);if(p!=Z){var q=M(Y+".scale"),H=M(Y+".max"),I=M(Y+".position"),T=h[Y+"Info"]={label:p,scale:q,color:o[k+"Color"](z),font:M(Y+".font"),opacity:M(Y+".opacity"),align:M(Y+".align"),rotation:h.getRotation(M(Y+".rotation"),!1,I),background:o[k+"Background"](z)},i=jj(T,p);H>0&&H<i.width&&(T.labelWidth=i.width,i.width=H),1!==q&&(i.width*=q,i.height*=q);var t=h.getPosition(I,M(Y+".offset.x"),M(Y+".offset.y"),i,M(Y+".position.fixed"));if(i.x=t.x-i.width/2,i.y=t.y-i.height/2,h._68o(T.rect=i,T.rotation),1!==q){var F=i.width/q,D=i.height/q;T.rect={x:t.x-F/2,y:t.y-D/2,width:F,height:D}}}},_26O:function(S,s){var f=this,Q=f.gv,U=f._data,v=f.s,l=Q[s](U);if(l!=Z){var L,P,o=v(S+".scale"),J=f[S+"Info"]={note:l,scale:o,data:U,view:Q,expanded:v(S+".expanded"),font:v(S+".font"),color:v(S+".color"),opacity:v(S+".opacity"),align:v(S+".align"),icon:v(S+".icon"),backgroundImage:v(S+".backgroundImage"),borderWidth:v(S+".border.width"),borderColor:v(S+".border.color"),background:Q[s+"Background"](U)},A=f.getPosition(v(S+".position"),v(S+".offset.x"),v(S+".offset.y")),d=A.x,N=A.y;if(J.expanded){var K,t=v(S+".max"),_=v(S+".backgroundImage");_?(_=Uj(_),K={width:ab(_,U),height:kn(_,U)}):K=jj(J,l),K.width+=6,K.height+=2,t>0&&t<K.width&&(J.labelWidth=K.width,K.width=t),L=K.width,P=K.height+8,J.clickRect={x:d-L*o/2,y:N-P*o,width:L*o,height:P*o*K.height/P}}else{var G=v(S+".icon");G?(G=Uj(G),L=ab(G,U),P=kn(G,U)):(L=12,P=18),J.clickRect={x:d-L*o/2,y:N-P*o,width:L*o,height:P*o}}J.rect={x:d-L/2,y:N-P*o/2-P/2,width:L,height:P};var B=p(J.borderWidth/2)*o;f._68o({x:d-L*o/2-B,y:N-P*o-B,width:L*o+2*B,height:P*o+2*B})}},_48O:function(){},_99O:function(f){var Q=this,O=Q._38o;if(O){var n=Q.gv,H=Q._data,m=O.icons,J=Q.interactiveInfo;J&&(J._38o={});for(var b in m){var s=m[b],y=O.rects[b];if(y){J&&(J._38o[b]=[]);var T=Xo(s.opacity,H,n),X=Xo(s.names,H,n),h=X?X.length:0,d=y.rotation;if(T!=Z){var k=f.globalAlpha;f.globalAlpha*=T}for(var t=0;h>t;t++){var Y=X[t],F=Uj(Y),z=y[t];if(d){var i=z.x+z.width/2,w=z.y+z.height/2;f.save(),Yf(f,i,w),cr(f,d),Yf(f,-i,-w)}J&&J._38o[b].push(f.interactiveInfo={compInfos:[],matrix:d?new dd(d,i,w).appendTranslate(-i,-w):new dd}),cj(f,F,Xo(s.stretch,H,n),z.x,z.y,z.width,z.height,Q._data,Q.gv),f.interactiveInfo=Z,d&&f.restore()}T!=Z&&(f.globalAlpha=k)}}}}});var nc=function(Z,V){$f(nc,this,[Z,V])};Im(nc,yk,{_checkEmptyRect:!0,_40O:function(b,c){var K=this,S=K.s,Z=b.rect;(b.borderColor=K.gv.getBorderColor(K._data))&&(b.borderType=S("border.type"),b.borderWidth=S("border.width"),b.borderPadding=S("border.padding"),c=j(c,b.borderPadding+b.borderWidth/2));var D=K._data.getScale(),u=j(1,j(t(D.x),t(D.y)));if(b.selectWidth=K.getSelectWidth()){var L=K.gv._zoom;b.selectType=S("select.type"),b._97o=K.getSelectColor(),b.selectPadding=S("select.padding"),c=j(c,(b.selectPadding+b.selectWidth/2/L)/u)}c>0&&(c*=u,Z=Em(Z),Er(Z,c)),K._68o(Z)},_39O:function(V,G){var i,P=this,X=G.rect;if(G.borderWidth>0&&(i=G.borderPadding,V.strokeStyle=G.borderColor,V.lineWidth=G.borderWidth,fq(V,G.borderType,{x:X.x-i,y:X.y-i,width:X.width+2*i,height:X.height+2*i}),V.stroke()),G.selectWidth>0){var c=P.gv._zoom;if(i=G.selectPadding,V.strokeStyle=G._97o,V.lineWidth=G.selectWidth/c,G.rotation!=Z){V.save(),V.translate(G.position.x,G.position.y),V.rotate(G.rotation);var B=P._data,K=B.getWidth(),z=B.getHeight(),g=G.scale,y=G.anchor;X={x:g.x*-K*y.x,y:g.y*-z*y.y,width:g.x*K,height:g.y*z}}fq(V,G.selectType,{x:X.x-i,y:X.y-i,width:X.width+2*i,height:X.height+2*i}),G.rotation!=Z&&V.restore(),V.stroke()}},dispose:function(){var U=this,I=U._htmlView;nc.superClass._3O.call(U),I&&(I.onHTMLRemoved&&I.onHTMLRemoved(),pf(I))},_3O:function(){var A=this,_=A.s,m=A._data,f=A.gv,I=f.getShape(m),r=A.getBodyColor(),l=A._83o=I?{shape:I,_53o:A.getBodyColor("shape.background"),_27Q:Uj(_("shape.repeat.image"),r),shapeGradientPack:_("shape.gradient.pack"),_54o:_("shape.border.width"),_55o:_("shape.border.color"),_56o:_("shape.border.3d"),_57o:_("shape.border.3d.color"),_58o:_("shape.border.3d.accuracy"),shapeGradient:_("shape.gradient"),_59o:_("shape.gradient.color"),_60o:_("shape.border.pattern"),_61o:_("shape.border.cap"),_62o:_("shape.border.join"),shapeForeground:_("shape.foreground"),bodyColor:r,gray:_("2d.gray")}:{img:Uj(f.getImage(m),r),bodyColor:r,gray:_("2d.gray"),stretch:_("image.stretch")};if(V&&!J);else{var M,c=l.img;c&&c.renderHTML?(A._htmlInfo&&A._htmlInfo.img!==c&&(A._htmlInfo=Z),A._htmlInfo||(A._htmlInfo={img:c,cache:{}}),M=c.renderHTML(m,f,A._htmlInfo.cache)):A._htmlInfo=Z,A._htmlView&&A._htmlView!==M&&(A._htmlView.onHTMLRemoved&&A._htmlView.onHTMLRemoved(),pf(A._htmlView.getView?A._htmlView.getView():A._htmlView)),(A._htmlView=M)&&f.appendHTML(M)&&(M.onHTMLAddedSync&&M.onHTMLAddedSync(),M.onHTMLAdded&&ys(M.onHTMLAdded)),l.rect=m.getRect(),l.position=m.p(),l.scale=m.getScale(),l.anchor=m.getAnchor(),l.rotation=m.getRotation(),I===qb&&(l._63o=_("shape.depth"));var E=0;if(I)E=ye(Z,l._54o/2,l._62o),A.s("shape.dash")&&(E=j(E,(A.s("shape.dash.width")||l._54o)/2));else if(c&&c.boundExtend)if(E=Xo(c.boundExtend,m,f),c.boundExtendAbsolute){var Q=m.getScale();E/=f._zoom*j(1,j(t(Q.x),t(Q.y)))}else if(!Xo(c.fitSize,m,f)){var P=Xo(c.width,m,f),Y=Xo(c.height,m,f);E*=j(m.getWidth()/P,m.getHeight()/Y)}A._40O(l,E);var B=_("clip.percentage");if(1>B&&(0>B&&(B=0),l.clipRect=Wp(m.getAnchorRect(),_("clip.direction"),B)),I){var U=_("shape.fill.clip.percentage");1>U&&(0>U&&(U=0),l.shapeClipRect=Wp(m.getAnchorRect(),_("shape.fill.clip.direction"),U));var y=_("shape.foreground.clip.percentage");1>y&&(0>y&&(y=0),l.shapeForegroundClipRect=Wp(m.getAnchorRect(),_("shape.foreground.clip.direction"),y))}}},getPosition:function(k,I,P,g){var x=od(k,this._83o.rect,g);return x.x+=I,x.y+=P,x},_80o:function(j){var W=this,C=W.s,r=W.gv,p=W._data,u=W._83o,U=u.rect,f=u.position,d=u.rotation,S=u.anchor,a=u.scale,e=u.shape,y=u.clipRect;if(!W._checkEmptyRect||U.width>0&&U.height>0){var G=p.getSize();if(G.x=-G.width*S.x,G.y=-G.height*S.y,j.save(),Yf(j,f.x,f.y),cr(j,d),mg(j,a.x,a.y),y&&(j.beginPath(),j.rect(y.x,y.y,y.width,y.height),j.clip()),r._drawForChecking&&u.img&&Xo(u.img.pixelPerfect,p,r)===!1)jq(j,G.x,G.y,G.width,G.height,"#888888");else if(W.freeDraw)W.freeDraw(j,G,u);else if(e){var z,M,v,w,s=u._60o,N=xb(j,s),q=u._27Q,k=u._54o,O=u.shapeGradientPack,V=u.gray,F=j.lineJoin,R=j.lineCap,m=function(a){return V?A.toGrayColor(a):a};"roundRect"===e?z=C("shape.corner.radius"):"polygon"===e?z=C("shape.polygon.side"):"arc"===e&&(z=C("shape.arc.from"),M=C("shape.arc.to"),v=C("shape.arc.close"),w=C("shape.arc.oval")),j.lineJoin=u._62o,j.lineCap=u._61o;var g=m(u._53o);if(g||q||O){var i=u.shapeClipRect;i&&(j.save(),j.beginPath(),j.rect(i.x,i.y,i.width,i.height),j.clip()),fq(j,e,G,z,M,v,w),O?Bf(j,O):q?br(j,q,m(u.bodyColor),null,p,r):fj(j,g,u.shapeGradient,m(u._59o),G),j.fill(),i&&j.restore(),O&&j.restore(),j!==N&&fq(N,e,G,z,M,v,w)}else fq(N,e,G,z,M,v,w);var B=u.shapeForeground;if(B){j.save();var I=u.shapeForegroundClipRect;I&&(j.beginPath(),j.rect(I.x,I.y,I.width,I.height),j.clip()),fq(j,e,G,z,M,v,w),fj(j,B,C("shape.foreground.gradient"),m(C("shape.foreground.gradient.color")),G),j.fill(),j.restore()}if(k>0){var H=C("shape.border.width.absolute");H&&(j.save(),j.setTransform(1,0,0,1,0,0)),j.lineWidth=k;
            var K=m(u._55o);j.strokeStyle=K,j.stroke(),H&&j.restore(),u._56o&&hq(j,K,m(u._57o),k,r._zoom,u._58o)}if(So(j,s),C("shape.dash")){var J=C("shape.dash.width")||k;if(J>0){s=C("shape.dash.pattern");var N=xb(j,s,W._2Q("shape.dash.offset"));N!==j&&fq(N,e,G,z,M,v,w),W._1Q(j,"shape",J,s)}}Ue(j,g,u._63o,G),j.lineJoin=F,j.lineCap=R}else{var l=W.interactiveInfo;l&&(j.interactiveInfo=l.bodyInfo={compInfos:[],matrix:new dd(d,f.x,f.y,a.x,a.y)}),u.gray&&(j.compGray=!0);var D=u.img;D&&D.cacheRule!=Z&&(D=Wq(j,D,u.stretch,G.width,G.height,p,r,u.bodyColor)),cj(j,D,u.stretch,G.x,G.y,G.width,G.height,p,r,u.bodyColor),j.compGray=!1,j.interactiveInfo=Z}j.restore()}W._39O(j,u)},_48O:function(){},_47O:function(){}});var Ve=function(q,o){$f(Ve,this,[q,o])},Fr=function(p,D,f,V){var l=fm(p,D);return f=V?C(f,l):gp(f,l),l?f/=l:f=0,{x:p.x+(D.x-p.x)*f,y:p.y+(D.y-p.y)*f}};Im(Ve,yk,{_3O:function(){var m,N=this,G=N._data,s=N.gv,W=N.s,U=W(vf),v=G.isLooped(),u=W("edge.width"),t=W("edge.center"),$=W("edge.offset"),o=s.getBorderColor(G),F=o?W("border.width"):0,M=N.getSelectWidth(),h=G._40I,b=G._41I,T=N._78o=h&&b?{looped:v,type:U,width:u,center:t,color:N.getBodyColor("edge.color"),borderColor:o,borderWidth:F,_97o:M?N.getSelectColor():Z,selectWidth:M,pattern:W("edge.pattern"),cap:W("edge.cap"),join:W("edge.join"),is3d:W("edge.3d"),_67o:W("edge.3d.color"),_66o:W("edge.3d.accuracy"),gray:W("2d.gray")}:Z;if(T){var V=A.getEdgeType(U);if(V){var D=V(G,Kf(N,s,G,v,U),s,N._19Q);D.points&&D.points.size()>1?(T.edgeTypeInfo=D,m=rl(T.edgeTypeInfo.points)):D[xn]&&D.rect&&(T.edgeTypeInfo=D,m=D.rect)}else{var c=W("edge.source.anchor.x"),g=W("edge.source.anchor.y"),C=W("edge.target.anchor.x"),L=W("edge.target.anchor.y"),q=tn(s,G,"source"),d=tn(s,G,"target");if(U===rd){var z=T.points=W(xq)||el,O=z.size();T.segments=W("edge.segments");var Q=c!==l||g!==l||Xi(h),Y=C!==l||L!==l||Xi(b);if(!t)if($)Q||(q=Fr(q,O?z.get(0):d,$,O)),Y||(d=Fr(d,O?z.get(O-1):q,$,O));else{var H;Q||(H=Gl(q,O?z.get(0):d,Xd(s,h)),H&&(q={x:H[0],y:H[1]})),Y||(H=Gl(O?z.get(O-1):q,d,Xd(s,b)),H&&(d={x:H[0],y:H[1]}))}m=Xj(rl(T.points),rl(q,d))}else{var P=Kf(N,s,G,v,U);if(N._19Q||(P=-P),v)q=Em(q),q.x=s.getNodeRect(h).x,T.radius=P,m={x:q.x-P,y:q.y-P,width:2*P,height:2*P};else{var n=fm(q,d),_=gp($,n),f={x:_,y:P},p={x:n-_,y:P},w=R(d.y-q.y,d.x-q.x),B=T.mat=new Dr(w);if(T.orienAngle=w,T.angle=d.x<q.x?w+i:w,T.rect={x:f.x,y:f.y,width:p.x-f.x,height:0},T.origin=q,f=B.tf(f),f.x+=q.x,f.y+=q.y,p=B.tf(p),p.x+=q.x,p.y+=q.y,t){var x={x:n,y:0};x=B.tf(x),x.x+=q.x,x.y+=q.y,m=rl([q,f,p,x]),T.c1=q,T.c2=x}else m=rl(f,p);q=f,d=p}}T.sourcePoint=q,T.targetPoint=d,G._lastSourcePoint=q,G._lastTargetPoint=d}var k=0;W("edge.dash")&&(k=W("edge.dash.width")||u);var e="square"===T.cap?.71:.5;ye(m,j(k*e,u*e+F+M),T.join),N._68o(m)}},getRotation:function(r,Y,x){r=r||0;var F=this._78o;if(F){var M,N=F.angle,P=F.points,Q=F.edgeTypeInfo;if(N!=Z)return Y?F.orienAngle+r:N+r;if(Q&&Q[xn])return Q.getRotation?Q.getRotation(this,r,Y,x):0;if(Q&&Q.points){var i=Q.points;return M=i.size(),Rd[x]?M&&0===M%2?Um(i.get(M/2-1),i.get(M/2),Y,r):r:_o[x]?Um(i.get(0),i.get(1),Y,r):Um(i.get(M-2),i.get(M-1),Y,r)}if(P)return M=P.size(),Rd[x]?M&&0===M%2?Um(P.get(M/2-1),P.get(M/2),Y,r):r:_o[x]?Um(F.sourcePoint,M?P.get(0):F.targetPoint,Y,r):Um(M?P.get(M-1):F.sourcePoint,F.targetPoint,Y,r)}return r},getPosition:function(c,k,s,i,Q){var w=this._78o;if(w){var p,e=w.type,H=w.points,M=w.edgeTypeInfo,V=w.sourcePoint,O=w.targetPoint;if(!e)return w.looped?{x:V.x-w.radius+k,y:V.y+s}:(Q&&V&&O&&(V.x>O.x||V.x===O.x&&V.y>O.y)&&(c=Up[c],s=-s),p=od(c,w.rect,i),p.x+=k,p.y+=s,p=w.mat.tf(p),p.x+=w.origin.x,p.y+=w.origin.y,p);if(M&&M[xn])return M.getPosition?M.getPosition(this,c,k,s,i,Q):{x:(V.x+O.x)/2,y:(V.y+O.y)/2};if(H){var p,n=H.size();if(Rd[c]){if(n){var G=n%2;if(0===G)return Nm(H.get(n/2-1),H.get(n/2),c,k,s,i,Q);p=H.get((n-G)/2)}else p={x:(V.x+O.x)/2,y:(V.y+O.y)/2};return p=od(c,{x:p.x,y:p.y,width:0,height:0},i),p.x+=k,p.y+=s,p}return _o[c]?Nm(V,n?H.get(0):O,c,k,s,i,Q):Nm(n?H.get(n-1):V,O,c,k,s,i,Q)}if(M){var t=M.points,n=t.size();if(Rd[c]){var G=n%2;return 0===G?Nm(t.get(n/2-1),t.get(n/2),c,k,s,i,Q):(p=t.get((n-G)/2),p=od(c,{x:p.x,y:p.y,width:0,height:0},i),p.x+=k,p.y+=s,p)}return _o[c]?Nm(t.get(0),t.get(1),c,k,s,i,Q):Nm(t.get(n-2),t.get(n-1),c,k,s,i,Q)}}return oo},_42:function(C){this._78o&&Ve.superClass._42.call(this,C)},drawPath:function(B,h){B.beginPath();var G=h.type,J=h.points,Z=h.segments,i=h.edgeTypeInfo;if(!G||J){var S=h.sourcePoint,m=S.x,q=S.y,l=h.targetPoint,e=l.x,y=l.y;if(G)if(Z){var V=new Nj({x:m,y:q});V.addAll(J),V.add({x:e,y:y}),wb(B,V,Z)}else B.moveTo(m,q),J.each(function(b){B.lineTo(b.x,b.y)}),B.lineTo(e,y);else h.looped?B.arc(m,q,h.radius,0,I,!0):h.center?(B.moveTo(h.c1.x,h.c1.y),B.lineTo(m,q),B.lineTo(e,y),B.lineTo(h.c2.x,h.c2.y)):(B.moveTo(m,q),B.lineTo(e,y))}else i&&(i.points?wb(B,i.points,i.segments):i[xn]&&i[xn](B,i))},_80o:function(s){var w=this,v=w.s,m=w._78o,i=m.width,J=m.selectWidth,I=m.borderWidth,c=s.lineJoin,g=s.lineCap,E=m.gray,j=m.pattern;s.lineJoin=m.join,s.lineCap=m.cap,w.drawPath(xb(s,j),m);var q=v("edge.width.absolute");q&&(s.save(),s.setTransform(1,0,0,1,0,0)),J&&(s.strokeStyle=m._97o,s.lineWidth=i+2*(I+J),s.stroke()),I&&(s.strokeStyle=E?A.toGrayColor(m.borderColor):m.borderColor,s.lineWidth=i+2*I,s.stroke());var X=E?A.toGrayColor(m.color):m.color,D=E?A.toGrayColor(m._67o):m._67o;if(s.strokeStyle=X,s.lineWidth=i,s.stroke(),m.is3d&&hq(s,X,D,i,w.gv._zoom,m._66o),So(s,j),v("edge.dash")){j=v("edge.dash.pattern");var n=xb(s,j,w._2Q("edge.dash.offset"));n!==s&&w.drawPath(n,m),w._1Q(s,"edge",v("edge.dash.width")||i,j)}q&&s.restore(),s.lineJoin=c,s.lineCap=g},_48O:function(){},_47O:function(){}});var nh=function(W,U){$f(nh,this,[W,U])};Im(nh,nc,{_3O:function(){var G,K,y=this,Y=y.s,Q=y._data,E=y.gv;if(y._88I=Z,Q.isExpanded()&&Q.eachChild(function(X){if(Pr(X)){var r=E.getBoundsForGroup(X);r&&(K||(K=[]),K.push(r),G=Xj(G,r))}}),G){var u=E.getLabel(Q),T=Y("group.type"),b=Y("group.border.width")||0,F=Y("group.border.width.absolute"),c=b/2;F&&(b/=E._zoom),G=Vd(T,K,G),Tf(G,Q,"group.padding",1),Er(G,b);var R=y._88I={type:T,rect:G,_64o:G};if(!T&&u!=Z){var P,w=y.labelInfo={label:u,color:Y("group.title.color"),font:Y("group.title.font"),align:Y("group.title.align")},W=jj(w,u),h=W.width+b,J=W.height+b,B=Y("group.title.align"),H=Y("group.title.orientation");if(H===Uh||H===Tg?(G.height+=b,h>G.width&&(G.width=h)):(H===Bc||H===qe)&&(G.width+=b,h>G.height&&(G.height=h)),P=B===Bc?G.x:B===qe?G.x+G.width-h:G.x+G.width/2-h/2,H===Tg)R.titleRect={x:G.x,y:G.y+G.height,width:G.width,height:J},R.rect={x:G.x,y:G.y,width:G.width,height:G.height+J},w.rect={x:P,y:G.y+G.height,width:h,height:J};else if(H===Bc){var o=R.titleRect={x:G.x-J,y:G.y,width:J,height:G.height};R.rect={x:G.x-J,y:G.y,width:G.width+J,height:G.height},w.rect={x:o.x+J/2-G.height/2,y:o.y+G.height/2-J/2,width:G.height,height:J},w.rotation=-Math.PI/2}else if(H===qe){var o=R.titleRect={x:G.x+G.width,y:G.y,width:J,height:G.height};R.rect={x:G.x,y:G.y,width:G.width+J,height:G.height},w.rect={x:o.x+J/2-G.height/2,y:o.y+G.height/2-J/2,width:G.height,height:J},w.rotation=Math.PI/2}else R.titleRect={x:G.x,y:G.y-J,width:G.width,height:J},R.rect={x:G.x,y:G.y-J,width:G.width,height:G.height+J},w.rect={x:P,y:G.y-J-c,width:h,height:J+b}}y._40O(R,Y("group.border.width")/2)}else nh.superClass._3O.call(y)},getPosition:function(V,L,W,s){var J=this._88I;if(J){var B=od(V,J.rect,s);return B.x+=L,B.y+=W,B}return nh.superClass.getPosition.apply(this,arguments)},_24O:function(Z,K){var i=this._88I;(!i||i.type||"label2"===Z)&&nh.superClass._24O.call(this,Z,K)},_80o:function(s){var H=this,U=H._88I;if(U){var I=H._data,b=H.s,$=H.gv,o=U.type,V=U.rect,w=U._64o,E=U.titleRect,L=H.getBodyColor(),X=Uj(b("group.image"),L),P=b("group.image.stretch"),G=H.getBodyColor("group.background"),n=Uj(b("group.repeat.image"),L),z=b("group.gradient.pack"),g=b("group.gradient"),j=b("group.gradient.color"),h=b("group.border.width"),Y=b("group.border.color"),W=b("group.border.pattern"),M=b("group.title.orientation"),d=b("group.depth"),k=b("group.border.radius"),y=b("group.border.join"),m=b("group.border.cap"),p=b("group.border.width.absolute");if(p&&(h/=$._zoom),o){var N=s.lineJoin,R=s.lineCap;if(s.lineJoin=y,s.lineCap=m,X){if(s.save(),fq(s,o,V,k),s.clip(),cj(s,X,P,V.x,V.y,V.width,V.height,I,$,L),s.restore(),h>0){var D=xb(s,W);fq(D,o,V,k),s.lineWidth=h,s.strokeStyle=Y,s.stroke(),So(s,W)}}else{var D=xb(s,W);G||n||z?(fq(s,o,V,k),z?Bf(s,z):n?br(s,n,L,null,I,$):fj(s,G,g,j,V),s.fill(),z&&s.restore(),s!==D&&fq(D,o,V,k)):fq(D,o,V,k),h>0&&(s.lineWidth=h,s.strokeStyle=b("group.border.color"),s.stroke()),So(s,W),o===qb&&Ue(s,G,d,V)}s.lineJoin=N,s.lineCap=R}else{var l=b("group.title.background");if((!k||0>k)&&(k=0),X)cj(s,X,P,w.x,w.y,w.width,w.height,I,$,H.getBodyColor());else if(G||n)if(n?br(s,n,L,null,I,$):fj(s,G,g,j,w),0===h)fq(s,qb,w),s.fill(),Ue(s,G,d,w);else{switch(s.beginPath(),M){case Tg:Ce(s,w.x,w.y,w.width,w.height,k,k,0,0);break;case Bc:Ce(s,w.x,w.y,w.width,w.height,0,k,0,k);break;case qe:Ce(s,w.x,w.y,w.width,w.height,k,0,k,0);break;case Uh:Ce(s,w.x,w.y,w.width,w.height,0,0,k,k)}s.fill()}if(E&&l)if(0===h)jq(s,E.x,E.y,E.width,E.height,l),Ue(s,l,d,E);else{switch(s.beginPath(),s.fillStyle=l,M){case Tg:Ce(s,E.x,E.y,E.width,E.height,0,0,k,k);break;case Bc:Ce(s,E.x,E.y,E.width,E.height,k,0,k,0);break;case qe:Ce(s,E.x,E.y,E.width,E.height,0,k,0,k);break;case Uh:Ce(s,E.x,E.y,E.width,E.height,k,k,0,0)}s.fill()}if(h>0){var D=xb(s,W);if(fq(D,"roundRect",V,k),s.save(),s.lineWidth=h,s.strokeStyle=Y,s.lineJoin=y,s.lineCap=m,s.closePath(),s.stroke(),E&&b("group.splitLine")){var x=E.x,r=E.y,C=E.width,O=E.height;s.beginPath(),M===Tg?(s.moveTo(x,r),s.lineTo(x+C,r)):M===Bc?(s.moveTo(x+C,r),s.lineTo(x+C,r+O)):M===qe?(s.moveTo(x,r),s.lineTo(x,r+O)):(s.moveTo(x,r+O),s.lineTo(x+C,r+O))}s.stroke(),s.restore(),So(D,W)}}H._39O(s,U)}else nh.superClass._80o.call(H,s)}});var Wl=function(A,H){$f(Wl,this,[A,H])};Im(Wl,nc,{_80o:function(F){this._39O(F,this._83o)}});var ln=function(O,J){$f(ln,this,[O,J])};Im(ln,nc,{_3O:function(){var D=this,e=D._data,z=D.s,W=D.gv,F=e.getPoints(),w=W.getBorderColor(e),g=w?z("border.width"):0,L=D.getSelectWidth(),f=z("shape.border.width"),M=e.getRect(),l=e.getAnchorRect(),C=W.getBodyColor(e),H=D._99o=F.isEmpty()?Z:{rect:M,rotation:e.getRotation(),fillRule:z("shape.fill.rule"),scale:e.getScale(),position:e.p(),points:F,segments:e.getSegments(),bodyColor:C,borderColor:w,borderWidth:g,_94o:z("shape.border.3d"),_95o:z("shape.border.3d.color"),_96o:z("shape.border.3d.accuracy"),_97o:L?D.getSelectColor():Z,selectWidth:L,_53o:z("shape.background"),_27Q:Uj(z("shape.repeat.image"),C),shapeGradientPack:z("shape.gradient.pack"),_54o:f,_55o:z("shape.border.color"),shapeGradient:z("shape.gradient"),_59o:z("shape.gradient.color"),_60o:z("shape.border.pattern"),_61o:z("shape.border.cap"),_62o:z("shape.border.join"),shapeForeground:z("shape.foreground"),gray:z("2d.gray")};if(H){l.x+=H.position.x,l.y+=H.position.y,H.gradientRect=l;var n=e.getScale(),h=j(1,j(t(n.x),t(n.y)));z("shape.dash")&&z("shape.dash.width")>f&&(f=z("shape.dash.width"));var u,b=z("shape.border.width.absolute");u=b?(f+g+L)/D.gv._zoom/h:f*("square"===H._61o?.71:.5)+g+L/D.gv._zoom/h,u&&(u*=h,M=Em(M),ye(M,u,H._62o)),D._68o(M);var Y=z("clip.percentage");1>Y&&(0>Y&&(Y=0),H.clipRect=Wp(e.getAnchorRect(),z("clip.direction"),Y));var R=z("shape.fill.clip.percentage");1>R&&(0>R&&(R=0),H.shapeClipRect=Wp(e.getAnchorRect(),z("shape.fill.clip.direction"),R));var S=z("shape.foreground.clip.percentage");1>S&&(0>S&&(S=0),H.shapeForegroundClipRect=Wp(e.getAnchorRect(),z("shape.foreground.clip.direction"),S))}},getPosition:function(b,c,I,W){var X=this._99o;if(X){var e=od(b,X.rect,W);return e.x+=c,e.y+=I,e}return oo},_42:function(o){this._99o&&ln.superClass._42.call(this,o)},_80o:function(l){var f,h=this,$=h.s,F=h._99o,x=F.position,O=F.scale,T=F.rotation,p=F.borderWidth,n=F.selectWidth/h.gv._zoom,E=F._27Q,W=F.shapeGradientPack,N=F._54o,U=F.clipRect,v=F.shapeClipRect,L=F.points,B=F.segments,G=h._data.isClosePath(),k=F.fillRule,M=F.gray,V=function(V){return M?A.toGrayColor(V):V},Y=V(F._53o),c=Y||E||W;l.save(),Yf(l,x.x,x.y),cr(l,T),mg(l,O.x,O.y),U&&(l.beginPath(),l.rect(U.x,U.y,U.width,U.height),l.clip()),c&&v&&(l.save(),l.beginPath(),l.rect(v.x,v.y,v.width,v.height),l.clip()),Yf(l,-x.x,-x.y);var C=F._60o,r=xb(l,C),z=l.lineJoin,g=l.lineCap;l.lineJoin=F._62o,l.lineCap=F._61o;var I=V(F.bodyColor);c?(wb(l,L,B,G),W?Bf(l,W):E?br(l,E,I,null,h._data,h.gv):(f=I?I:Y,fj(l,f,F.shapeGradient,V(F._59o),F.gradientRect)),l.fill(k),v&&(l.restore(),Yf(l,-x.x,-x.y)),W&&l.restore(),r!==l&&wb(r,L,B,G)):wb(r,L,B,G);var Q=F.shapeForeground;if(Q){l.save();var H=F.shapeForegroundClipRect;H&&(Yf(l,x.x,x.y),l.beginPath(),l.rect(H.x,H.y,H.width,H.height),l.clip(),Yf(l,-x.x,-x.y)),wb(l,L,B,G),fj(l,Q,$("shape.foreground.gradient"),V($("shape.foreground.gradient.color")),F.gradientRect),l.fill(k),l.restore()}var K=$("shape.border.width.absolute");if(K&&(l.save(),l.setTransform(1,0,0,1,0,0)),n&&(l.strokeStyle=F._97o,l.lineWidth=N+2*(p+n),l.stroke()),p&&(l.strokeStyle=V(F.borderColor),l.lineWidth=N+2*p,l.stroke()),N&&(f=V(F._55o),!Y&&I&&(f=I),l.strokeStyle=f,l.lineWidth=N,l.stroke(),F._94o&&hq(l,f,V(F._95o),N,h.gv._zoom,F._96o)),So(l,C),$("shape.dash")){var e=$("shape.dash.width")||N;if(e>0){C=$("shape.dash.pattern");var r=xb(l,C,h._2Q("shape.dash.offset"));r!==l&&wb(r,L,B,G),h._1Q(l,"shape",e,C)}}K&&l.restore(),l.lineJoin=z,l.lineCap=g,l.restore()},_48O:function(){},_47O:function(){}});var si=function(F,c){$f(si,this,[F,c])};Im(si,ln,{getRotation:function(q,w,W){q=q||0;var z=this._data.getPoints(),d=z.size();return d>1?Rd[W]?d&&0===d%2?Um(z.get(d/2-1),z.get(d/2),w,q):q:_o[W]?Um(z.get(0),z.get(1),w,q):Um(z.get(d-2),z.get(d-1),w,q):q},getPosition:function(u,z,l,N,e){var v=this._data.getPoints(),D=v.size();if(D>1){if(Rd[u]){var E=D%2;if(0===E)return Nm(v.get(D/2-1),v.get(D/2),u,z,l,N,e);var M=v.get((D-E)/2),P={x:M.x,y:M.y,width:0,height:0};return M=od(u,P,N),M.x+=z,M.y+=l,M}return _o[u]?Nm(v.get(0),v.get(1),u,z,l,N,e):Nm(v.get(D-2),v.get(D-1),u,z,l,N,e)}return oo}});var le=function(b,E){$f(le,this,[b,E])};Im(le,nc,{_3O:function(){var m=this;le.superClass._3O.call(m);var x=m.s,G=m._83o;m._82o=G.img||G.shape?Z:{background:m.getBodyColor("grid.background"),depth:x("grid.depth"),rect:G.rect,_88o:x("grid.cell.depth"),cellBorderColor:x("grid.cell.border.color"),_89o:x("grid.row.count"),_90o:x("grid.column.count"),block:x("grid.block"),_91o:x("grid.block.color"),_92o:x("grid.block.padding"),_93o:x("grid.block.width")}},_80o:function(i){var v=this,y=v._82o;if(!y)return le.superClass._80o.call(v,i),void 0;var d,J,E=v._data,b=y.background,S=y.rect,M=y.block,z=y._91o,x=y._92o,F=y._93o,U=y._88o,f=y.cellBorderColor,V=y._89o,L=y._90o;if(b)if(jq(i,S.x,S.y,S.width,S.height,b),Ue(i,b,y.depth,S),U)for(d=0;V>d;d++)for(J=0;L>J;J++)S=E.getCellRect(d,J),S&&Ue(i,b,U,S);else if(f){for(i.beginPath(),d=0;V>d;d++)for(J=0;L>J;J++)S=E.getCellRect(d,J),S&&i.rect(S.x,S.y,S.width,S.height);i.strokeStyle=f,i.lineWidth=1,i.stroke()}if("h"===M)for(d=0;V>d;d++)S=Xj(E.getCellRect(d,0),E.getCellRect(d,L-1)),Er(S,x),lk(i,z,S.x,S.y,S.width,S.height,F);else if("v"===M)for(J=0;L>J;J++)S=Xj(E.getCellRect(0,J),E.getCellRect(V-1,J)),Er(S,x),lk(i,z,S.x,S.y,S.width,S.height,F);v._39O(i,v._83o)}});var ai=function(T,R){$f(ai,this,[T,R])};Im(ai,nc,{_checkEmptyRect:!1,_81o:function(){var i=this._data,f=ai.superClass._81o.call(this),t=i.s("text");if(t!=Z){var L,b,K=i.s("text.font"),V=i.s("text.align"),X=i.s("text.vAlign"),N=hh(K,t),T=N.width,g=N.height,I=i.getAnchor(),E=i.getWidth(),o=i.getHeight();"left"===V?L=-E*I.x:"center"===V?L=-E*I.x+(E-T)/2:"right"===V&&(L=E*(1-I.x)-N.width),"top"===X?b=-o*I.y:"middle"===X?b=-o*I.y+(o-g)/2:"bottom"===X&&(b=o*(1-I.y)-N.height);var Y,$=i.getMatrix();if(Y=rl([$.tf(L,b),$.tf(L+T,b),$.tf(L+T,b+g),$.tf(L,b+g)]),f=Xj(f,Y),f&&i.s("text.shadow")){var J=Em(f);J.x+=i.s("text.shadow.offset.x"),J.y+=i.s("text.shadow.offset.y"),Er(J,i.s("text.shadow.blur")),f=Xj(f,J)}}return f}});var mr=Jk.Interactor=function(c){this.gv=this._graphView=c};$h("Interactor",Y,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(F){this.gv.fi(F)},setCursor:function(e){ng||this.gv.setCursor(e)},startDragging:function(R){var n=this;n._lastClientPoint=zn(R),n._lastLogicalPoint=n.gv.lp(R),Oi(n,R)},clearDragging:function(){var e=this;e._lastClientPoint=e._lastLogicalPoint=e._logicalPoint=Z},autoScroll:function(i){return this.gv.autoScroll(i,this._lastClientPoint)}});var Yj=Z,To=function(m){Yj.handleWindowTouchMove(m)},ah=function(m){Yj.handleWindowTouchEnd(m),K(M,mm,To),K(M,Xk,ah),Yj=Z},Kg=function(T){Yj.handleWindowMouseMove(T)},Si=function(m){Yj.handleWindowMouseUp(m),K(M,ig,Kg),K(M,qr,Si),Yj=Z},dq=function(n,J){if(n!==Yj){var P=Fe(J);Yj?P?Yj.handleWindowTouchEnd(J):Yj.handleWindowMouseUp(J):P?(T(M,mm,To),T(M,Xk,ah)):(T(M,ig,Kg),T(M,qr,Si)),Yj=n}},mp=function(o){var y=this;y.gv=o,y._is2d=o instanceof Jk.GraphView,y._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",wp,"wheel"].forEach(function(X){y.addListener(X)}),y.initImageResource()};Im(mp,mr,{enableVR:function(X){var w=this;if(!!w._vrEnable!==X)if(w._vrEnable=X,X)w.gv.vr.mp(w.onVRControllerChange,w);else if(w.gv.vr.ump(w.onVRControllerChange,w),w._vrRayPolyline){var R=w.gv.dm();R.remove(w._vrRayPolyline),R.remove(w._vrRayHitPoint),w._vrRayPolyline=l,w._vrRayHitPoint=l}},onVRControllerChange:function(m){var d=this,S=m.property,h=m.newValue,K=d.gv.vr.getController(h.id),b=K.getRay();b&&("gamepad.button.trigger"===S?"down"===h._62O?d.handle_mousedown(b):d.handleWindowMouseUp(b):"gamepad.pose"===S&&(d.handle_mousemove(b),d.handleWindowMouseMove(b)))},drawVRRay:function(h,V,U){var X,s=this,J=s.gv,G=s._vrRayPolyline,x=!1;if(G)X=s._vrRayHitPoint;else{var q=J.dm();s._vrRayPolyline=G=new a.Polyline,s._vrRayHitPoint=X=new a.Node,X.s({shape3d:"billboard","shape3d.transparent":!0,"texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),X.setAnchor3d(.5,.5,.499);var n=.2/J.vr.measureOflength;X.s3(n,n,n),G.s("intersect",!1),X.s("intersect",!1),q.add(G),q.add(X),x=!0}if(V){var Q=U.world,r=U.worldNormal,Z=Q.x,K=Q.y,i=Q.z;G.s("shape.border.color","red"),G.setPoints([{x:h.origin.x,y:h.origin.z,e:h.origin.y},{x:Z,y:i,e:K}]),X.s("3d.visible",!0),X.p3(Z,K,i),X.lookAtDirection([r.x,r.y,r.z],"front")}else{G.s("shape.border.color","blue");var d=new a.Math.Vector3;d.copy(h.direction).setLength(1e3/s.gv.vr.measureOflength).add(h.origin),G.setPoints([{x:h.origin.x,y:h.origin.z,e:h.origin.y},{x:d.x,y:d.z,e:d.y}]),X.s("3d.visible",!1)}J.fi({kind:"vrRayIntersect",ray:h,data:V,intersect:U,polyline:G,hitNode:X,begin:x})},setPreventEventDefault:function(f,r){var _=this,p=_._eventListeners[f];p?p._prevent=r:_._eventListeners[f]=p={_removal:l,_prevent:r}},removeListener:function(N){var X=this,O=X._eventListeners[N];O&&O._removal&&(O._removal(),O._removal=l)},addListener:function(y){var L=this,i=L._eventListeners[y];if(i||(L._eventListeners[y]=i={_removal:l,_prevent:!0}),!i||!i._removal){var R=function(J){i._prevent&&A.preventDefault(J),L.disabled||("wheel"===y?qf(L,J):L["handle_"+y](J))};T(L.gv.getView(),y,R),i._removal=function(){K(L.gv.getView(),y,R)}}},handleWindowTouchMove:function(o){this.handleWindowMouseMove(o)},handleWindowMouseMove:function(E){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",E):(this.handleDownInfo("onBeginDrag",E),this.isDragging=!0))},handleWindowTouchEnd:function(d){this.handleWindowMouseUp(d)},handleWindowMouseUp:function(Y){if(this.isDragging&&(this.handleDownInfo("onEndDrag",Y),this.isDragging=!1),this.downInfo){var t=this.handle("onUp",Y);if(t&&t.data===this.downInfo.data){this.handleMissingUp(Y);var u=this,v=2===Y.button?"onContextMenu":"onClick";if(!u._dbclickTimer)return u._dbclickTimer=U(function(){delete u._dbclickTimer,u.handleClick(Y,v,t),this.downInfo=Z},A.clickDelay),void 0;_(u._dbclickTimer),delete u._dbclickTimer,v="onDoubleClick",u.handleClick(Y,v,t)}else this.handleDownInfo("onUp",Y);this.downInfo=Z}},handle_mouseleave:function(p){var B=this,d=B.gv,h=B.currentInfo?B.currentInfo.data:Z;if(h){h.s("onLeave")&&h.s("onLeave")(p,h,d),B.fire("data","onLeave",p,h);var $=B.currentInfo?B.currentInfo.hits:Z;if($)for(var Y in $)B.handleLeave(p,Y);B.currentInfo=Z}},handle_mousewheel:function(N){N.scrollDelta=N.wheelDelta/40,this.handle("onScroll",N)},handle_DOMMouseScroll:function(V){V.scrollDelta=2===V.axis?-V.detail:0,this.handle("onScroll",V)},handle_touchstart:function(T){this.handle_mousedown(T)},handle_touchmove:function(y){this.handle("onMove",y)},handle_mousedown:function(T){this.isDragging&&(this.handleDownInfo("onEndDrag",T),this.isDragging=!1),this.downInfo=this.handle("onDown",T),this.downInfo&&dq(this,T)},handle_mousemove:function(L){var j=this,y=j.gv;j._hoverTimer&&(_(j._hoverTimer),delete j._hoverTimer);var T,w,M,o=j.handle("onMove",L),v=this.currentInfo?this.currentInfo.data:Z,a=this.currentInfo?this.currentInfo.hits:Z;if(o&&(w=o.data,M=o.hits,j._hoverTimer=U(function(){_(j._hoverTimer),delete j._hoverTimer,j.handle("onHover",L,o)},y.getHoverDelay()||A.hoverDelay)),w!==v){if(v&&(v.s("onLeave")&&v.s("onLeave")(L,v,y),this.fire("data","onLeave",L,v)),w&&(w.s("onEnter")&&w.s("onEnter")(L,w,y),this.fire("data","onEnter",L,w)),a)for(T in a)this.handleLeave(L,T);if(M)for(T in M){var E=M[T],Q=w._interactPrefix=E.prefix,J=Q&&w.a(Q+"onEnter")||E.target.onEnter;J&&J.call(E.target,L,w,y,E.point,E.width,E.height),this.fire(E.type,"onEnter",E.event,E.data,E.image,E.comp,E.point,E),w._interactPrefix=null}}else{if(a)for(T in a)M&&M[T]||this.handleLeave(L,T);if(M)for(T in M)if(!a||!a[T]){var E=M[T],Q=w._interactPrefix=E.prefix,J=Q&&w.a(Q+"onEnter")||E.target.onEnter;J&&J.call(E.target,L,w,y,E.point,E.width,E.height),this.fire(E.type,"onEnter",E.event,E.data,E.image,E.comp,E.point,E),w._interactPrefix=null}}this.currentInfo=o},handle:function(B,H,d){var R,I=this,e=I.gv;if(I._is2d){if(d=d||e.getDataInfoAt(H),!d||!e.isInteractive(d.data))return;if(R=d.ui.interactiveInfo){var g,Y=d.data;if(Y.s(B)&&Y.s(B)(H,Y,e),this.fire("data",B,H,Y),"body"===d.part&&R.bodyInfo)g="body",d.hits=this.handleImage(g,e.getImage(Y),B,H,Y,d.point,R.bodyInfo);else if("icons"===d.part&&R._38o){var f=R._38o[d.name];f&&f[d.index]&&(g="icons|"+d.name+"|"+d.index,d.hits=this.handleImage(g,d.icon,B,H,Y,d.point,f[d.index]))}}return d}var Y,Z;if(!d)if(H&&H instanceof a.Math.Ray){var y=e.vr.intersectWorld(H);if(Y=y.data,Z=y.intersect,I.drawVRRay(H,Y,Z),!Y)return;var $=e.getData3dUI(Y);if(R=$.interactiveInfo,!R)return;d={data:Y,part:Z.part,ui:$}}else{if(d=e.getDataInfoAt(H),!d)return;d&&(d={data:d.data,part:d.part})}if(e.isInteractive(d.data)){if(!Z){Y=d.data;var $=e.getData3dUI(Y);if(d.ui=$,R=$.interactiveInfo,!R)return d;if(Z=e.intersectObject(H,Y),!Z)return}Y.s(B)&&Y.s(B)(H,Y,e),this.fire("data",B,H,Y);var m,n=Z.part;return"body"!==n&&(m=Y.s(n+".image")||Y.s("shape3d."+n+".image")),m||(m=Y.s("all.image")||Y.s("shape3d.image")),R="object"==typeof m?R[m.uuid]:R[m],R&&R.bodyInfo?(d.part="body",d.interactiveInfo=R,d.point=this._convertUVToPoint(Z.uv,R),d.image=m,d.hits=this.handleImage("body",m,B,H,Y,d.point,R.bodyInfo),d):d}},_handleLeaveOrMissing:function(G,C,b){var f="leave"===G?this.currentInfo:this.downInfo;if(f){var w=f.interactiveInfo||f.ui.interactiveInfo;if(w){var K,U,L=f.data;if(this._is2d){if(U=this.gv.lp(C),"body"===f.part&&w.bodyInfo)K="body","leave"===G?this.handleLeaveImage(b,K,this.gv.getImage(L),C,L,U,w.bodyInfo):this.handleMissingUpImage(K,this.gv.getImage(L),C,L,U,w.bodyInfo);else if("icons"===f.part&&w._38o){var z=w._38o[f.name];z&&z[f.index]&&(K="icons|"+f.name+"|"+f.index,"leave"===G?this.handleLeaveImage(b,K,f.icon,C,L,U,z[f.index]):this.handleMissingUpImage(K,f.icon,C,L,U,z[f.index]))}}else{if(!w.bodyInfo)return;var k=this.gv.intersectObject(C,L);U=k&&k.uv?this._convertUVToPoint(k.uv,w):{x:1/0,y:1/0},"leave"===G?this.handleLeaveImage(b,"body",f.image,C,L,U,w.bodyInfo):this.handleMissingUpImage("body",f.image,C,L,U,w.bodyInfo)}}}},handleClick:function(u,f,m){var O=this,a=this.downInfo;if(a&&m){var $,R=m.interactiveInfo||m.ui.interactiveInfo,F=m.data,v=this.gv;if(F.s(f)&&F.s(f)(u,F,v),O.fire("data",f,u,F),R)if(this._is2d){if(a.part===m.part){var c=v.lp(u);"body"===m.part&&R.bodyInfo&&($="body",this.handleClickImage($,v.getImage(F),f,u,F,c,R.bodyInfo,m))}}else{if(!R.bodyInfo)return;var w=v.intersectObject(u,F);if(!w)return;c=this._convertUVToPoint(w.uv,R),this.handleClickImage("body",a.image,f,u,F,c,R.bodyInfo,m)}}},handleDownInfo:function(I,Z){if(this.downInfo){var o=this.downInfo,Q=this.gv,W=o.interactiveInfo||o.ui.interactiveInfo;if(W){var B,N=o.data;if(N.s(I)&&N.s(I)(Z,N,Q),this.fire("data",I,Z,N),this._is2d){var C=Q.lp(Z);if("body"===o.part&&W.bodyInfo)B="body",this.handleDownInfoImage(B,Q.getImage(N),I,Z,N,C,W.bodyInfo);else if("icons"===o.part&&W._38o){var O=W._38o[o.name];O&&O[o.index]&&(B="icons|"+o.name+"|"+o.index,this.handleDownInfoImage(B,o.icon,I,Z,N,C,O[o.index]))}}else{if(!W.bodyInfo)return;var s=Q.intersectObject(Z,N);if(!s)return;C=this._convertUVToPoint(s.uv,W),this.handleDownInfoImage("body",o.image,I,Z,N,C,W.bodyInfo)}}}},fire:function(H,N,y,I,V,o,D,b){this.gv.fi({kind:N,type:H,event:y,data:I,image:V,comp:o,view:this.gv,point:D,width:b?b.width:l,height:b?b.height:l})},handleImage:function(f,S,C,L,e,N,D){var W={};if(S&&(S=Uj(S))){var H=this.gv,p=D.rect,o=this.convertPoint(N,D);o.inRect&&(S[C]&&S[C](L,e,H,o,p.width,p.height),this.fire("image",C,L,e,S,l,o,p),W[f+"|image"]={target:S,type:"image",image:S,data:e,event:L,point:o,width:p.width,height:p.height});for(var b=D.compInfos,k=S,q=b.length-1;q>=0;q--){var r=b[q],J=r.comp;if(o=this.convertPoint(N,r,k,J,H,e),o.inRect){p=r.rect;var O=e._interactPrefix=r.prefix,d=O&&e.a(O+C)||J[C];d&&d.call(J,L,e,H,o,p.width,p.height),this.fire("comp",C,L,e,S,J,o,p),(S=p.image)&&(S[C]&&S[C](L,e,H,o,p.width,p.height),this.fire("image",C,L,e,S,l,o,p)),e._interactPrefix=null,W[f+"|"+q]={target:J,type:"comp",comp:J,image:S,data:e,event:L,point:o,width:p.width,height:p.height,prefix:O},S&&(W[f+"|"+q+"|image"]={target:S,type:"image",image:S,data:e,event:L,point:o,width:p.width,height:p.height,prefix:O})}}}return W},handleLeave:function(e,n){return this._handleLeaveOrMissing("leave",e,n)},handleMissingUp:function(K){return this._handleLeaveOrMissing("missing",K)},handleLeaveImage:function(V,k,H,K,A,j,G){if(H&&(H=Uj(H))){var m=this.gv,P=G.rect,Q=this.convertPoint(j,G);V===k+"|image"&&(H.onLeave&&H.onLeave(K,A,m,Q,P.width,P.height),this.fire("image","onLeave",K,A,H,l,Q,P));for(var a=G.compInfos,z=H,t=a.length-1;t>=0;t--){var E=a[t],S=E.comp;Q=this.convertPoint(j,E,z,S,m,A),P=E.rect;var i=A._interactPrefix=E.prefix;if(V===k+"|"+t){var s=i&&A.a(i+"onLeave")||S.onLeave;s&&s.call(S,K,A,m,Q,P.width,P.height),this.fire("comp","onLeave",K,A,H,S,Q,P)}(H=P.image)&&V===k+"|"+t+"|image"&&(H.onLeave&&H.onLeave(K,A,m,Q,P.width,P.height),this.fire("image","onLeave",K,A,H,l,Q,P)),A._interactPrefix=null}}},handleMissingUpImage:function(z,I,o,H,S,t){var c="onUp",R=this.downInfo.hits;if(R&&I&&(I=Uj(I))){var b=this.gv,T=t.rect,N=this.convertPoint(S,t);!N.inRect&&R[z+"|image"]&&(I[c]&&I[c](o,H,b,N,T.width,T.height),this.fire("image",c,o,H,I,l,N,T));for(var J=t.compInfos,x=I,m=J.length-1;m>=0;m--){var D=J[m],k=D.comp;if(N=this.convertPoint(S,D,x,k,b,H),!N.inRect){T=D.rect;var v=H._interactPrefix=D.prefix;if(R[z+"|"+m]){var h=v&&H.a(v+c)||k[c];h&&h.call(k,o,H,b,N,T.width,T.height),this.fire("comp",c,o,H,I,k,N,T)}(I=T.image)&&R[z+"|"+m+"|image"]&&(I[c]&&I[c](o,H,b,N,T.width,T.height),this.fire("image",c,o,H,I,l,N,T)),H._interactPrefix=null}}}},handleDownInfoImage:function(Z,F,y,d,z,E,V){var S=this.downInfo.hits;if(S&&F&&(F=Uj(F))){var J=this.gv,h=V.rect,n=this.convertPoint(E,V);S[Z+"|image"]&&(F[y]&&F[y](d,z,J,n,h.width,h.height),this.fire("image",y,d,z,F,l,n,h));for(var W=V.compInfos,f=F,o=W.length-1;o>=0;o--){var g=W[o],A=g.comp;n=this.convertPoint(E,g,f,A,J,z),h=g.rect;var t=z._interactPrefix=g.prefix;if(S[Z+"|"+o]){var m=t&&z.a(t+y)||A[y];m&&m.call(A,d,z,J,n,h.width,h.height),this.fire("comp",y,d,z,F,A,n,h)}(F=h.image)&&S[Z+"|"+o+"|image"]&&(F[y]&&F[y](d,z,J,n,h.width,h.height),this.fire("image",y,d,z,F,l,n,h)),z._interactPrefix=null}}},handleClickImage:function(k,q,H,Y,w,I,Q,b){var S=this.downInfo.hits,M=b.hits;if(S&&q&&(q=Uj(q))){var j=this.gv,G=Q.rect,P=this.convertPoint(I,Q);S[k+"|image"]&&(q[H]&&q[H](Y,w,j,P,G.width,G.height),this.fire("image",H,Y,w,q,l,P,G));for(var v=Q.compInfos,y=q,E=v.length-1;E>=0;E--){var i=v[E],Z=i.comp;P=this.convertPoint(I,i,y,Z,j,w),G=i.rect;var C=w._interactPrefix=i.prefix;if(S[k+"|"+E]&&M[k+"|"+E]){var a=C&&w.a(C+H)||Z[H];a&&a.call(Z,Y,w,j,P,G.width,G.height),this.fire("comp",H,Y,w,q,Z,P,G)}(q=G.image)&&S[k+"|"+E+"|image"]&&(q[H]&&q[H](Y,w,j,P,G.width,G.height),this.fire("image",H,Y,w,q,l,P,G)),w._interactPrefix=null}}},initImageResource:function(){A.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(y,E){if(!y)return{x:1/0,y:1/0};var o=E.bodyInfo.rect,Q=y.clone(),H=y.multiply({x:o.width,y:o.height});return H.local=Q,H},convertPoint:function(h,w,N,X,x,D){var S=w.rect,u=w.matrix.applyInverse(h).sub(S),m=u.x>=0&&u.y>=0&&u.x<=S.width&&u.y<=S.height;if(!m)return u;if(X&&Xo(X.pixelPerfect,D,x)){var S,Q=1;this._is2d?(Q=x.getZoom(),S=pg(h.x,h.y,l,Q)):S=pg(h.x,h.y);var g=!1,d=S.x,T=S.y,U=S.width,F=S.height,q=A.hitMaxArea,y=U*F*Q*Q;if(y>q){var a=Math.sqrt(q/y);Q*=a}U*=Q,F*=Q,2>U&&(U=2),2>F&&(F=2),d*=Q,T*=Q;var j=Zi(U,F),O=new dd(0,-d,-T,Q,Q);O.append(w.matrix),x._drawForChecking=!0,X.transform=O,w.refRect&&w.refRect.fitSize&&(X.refRect=w.refRect);var V=N.comps;N.comps=[X],nn(j,N,0,0,U,F,D,self),N.comps=V,delete X.refRect,delete X.transform,x._drawForChecking=!1;try{for(var r=0,s=j.getImageData(0,0,U,F).data;r<s.length;r+=4)if(0!==s[r+3]){g=!0;break}j.restore()}catch(b){Nc=Z,g=!1}u.inRect=g}else u.inRect=!0;return u}});var Jh=Jk.DefaultInteractor=function(M){$f(Jh,this,[M])};$h("DefaultInteractor",mr,{handle_mousedown:function(m){td(m);var w=this,T=w.gv,R=T.getDataAt(m);if(T.setFocus(m)&&!T._editing&&!T._scrolling){Ko(m)?T.handleDoubleClick(m,R):T.handleClick(m,R);var $=ge(m);!nb()&&!$&&R&&(T.isMovable(R)||T._39Q(R))||!T.isPannable()||!Vi(m)&&!$||oe(m)||(w._tx=T.tx(),w._ty=T.ty(),w.startDragging(m))}},handleWindowMouseUp:function(X){var h=this,R=h.gv;R._panning&&(delete R._panning,R.onPanEnded(),h.fi({kind:"endPan",event:X})),delete h._tx,delete h._ty,h.clearDragging()},handle_mousemove:function(q){var j=this,m=j.gv;j._hoverTimer&&(_(j._hoverTimer),delete j._hoverTimer),j._hoverTimer=U(function(){j.fi({kind:"hover",event:q}),_(j._hoverTimer),delete j._hoverTimer},m.getHoverDelay()||A.hoverDelay)},handle_touchmove:function(w){this.handle_mousemove(w)},handleWindowMouseMove:function(S){var Q=this,M=Q.gv;Q.fi({kind:M._panning?"betweenPan":"beginPan",event:S}),M._panning=1;var g=Gm(M,S,Q._lastClientPoint);M.setTranslate(Q._tx+g.x,Q._ty+g.y)},handle_mousewheel:function(I){this.gv.handleScroll(I,I.wheelDelta)},handle_DOMMouseScroll:function(H){2===H.axis&&this.gv.handleScroll(H,-H.detail)},handle_keydown:function(E){this.gv.handleKeyDown(E)}});var Wg=Jk.SelectInteractor=function(v){$f(Wg,this,[v])};$h("SelectInteractor",mr,{_42:function(){var X=this,V=X.gv,r=V.getZoom(),n=X.mark,P=X.div;P||(P=X.div=Sr(),Jp(X.getView(),P));var Y={};Y.x=n.x*r+V.tx(),Y.y=n.y*r+V.ty(),Y.width=n.width*r,Y.height=n.height*r,Vn(P,Y),this.intersects()?(P.style.border="",P.style.background=V.getRectSelectBackground()):(P.style.background="",P.style.border="1px solid "+V.getRectSelectBorderColor())},handle_mousedown:function(h){var l=this,w=l.gv;
            if(l._57I=Z,l.pendingClickThrough=Z,!(w._editing||w._scrolling||nb()||ge(h))){var g=w.getDataAt(h),H=w.sm();g?oe(h)?H.co(g)?H.rs(g):H.as(g):H.co(g)?g instanceof Ic&&g.isClickThroughEnabled()&&Vi(h)&&(l.pendingClickThrough=zn(h)):H.ss(g):oe(h)||!w.isPannable()?Vi(h)&&(oe(h)||H.cs(),w.isRectSelectable()&&(l.startDragging(h),w._77O=1)):Vi(h)&&(l._57I=zn(h))}},handle_mouseup:function(l){var x=this,z=x.gv,f=x._57I;if(f&&(fm(f,zn(l))<=1&&z.sm().cs(),x._57I=Z),x.pendingClickThrough){if(fm(x.pendingClickThrough,zn(l))<=1){var L=z.getDataAt(l);if(L instanceof Ic&&L.isClickThroughEnabled()){var s=z.getDataAt(l,function(k){var f=k.getParent()===L&&z.isSelectable(k,!0);return f});s&&(l.clickThrough=!0,z.sm().ss(s))}}x.pendingClickThrough=Z}},handleWindowMouseUp:function(i){this.clear(i)},handleWindowMouseMove:function(Y){var I=this,h=I.gv;I._logicalPoint=h.lp(Y),I.mark?(I.fi({kind:"betweenRectSelect",event:Y}),h.isPannable()&&I.autoScroll(Y),I.redraw()):I.fi({kind:"beginRectSelect",event:Y}),I.mark=rl(I._lastLogicalPoint,I._logicalPoint),I.redraw()},intersects:function(){var E=this,w=E._lastLogicalPoint,A=E._logicalPoint;return w.x>A.x||w.y>A.y},clear:function(g){var N=this,$=N.gv,O=N.mark;if(N._57I=Z,N.pendingClickThrough=Z,N._lastLogicalPoint){if(O){if(0!==O.width&&0!==O.height){var o=$.getDatasInRect(O,N.intersects());if(!o.isEmpty()){var p=$.sm(),K=p.toSelection();o.each(function(B){p.co(B)?K.remove(B):K.add(B)}),p.ss(K)}}pf(N.div),delete N.div,delete N.mark,N.redraw(),N.fi({kind:"endRectSelect",event:g}),$.onRectSelectEnded()}N.clearDragging(),delete $._77O}},redraw:function(){var W=this;W._draw||(W._draw=1,U(function(){W.mark&&W._42(),delete W._draw},16))}});var $m=Jk.MoveInteractor=function(l){$f($m,this,[l])};$h("MoveInteractor",mr,{handle_mousedown:function(r){var W=this,l=W.gv;if(Vi(r)&&!l._editing&&!l._scrolling&&!nb()){var u=l.getSelectedDataAt(r);!u||l._39Q(u)&&!l.isMovable(u)?l._focusData=Z:(W._data=u,l.handleMouseDown&&l.handleMouseDown(r,u),W.startDragging(r),l.isMovable(u)&&(l._moving=1))}},handleWindowMouseUp:function(C){var V=this,X=V.gv;X.handleMouseUp&&X.handleMouseUp(C,V._data),V.clear(C)},handleWindowMouseMove:function(h){var E=this,x=E._data,Y=E.gv;if((!Y._93O||!Y._93O(h,x))&&Y._moving){E._logicalPoint||E.fi({kind:"prepareMove",event:h});var W=E._logicalPoint?"betweenMove":"beginMove",L={kind:W,event:h},J=E._logicalPoint=Y.lp(h);"beginMove"!==W||E._alreadyBeginTransaction||(E._alreadyBeginTransaction=!0,Y.getDataModel().beginTransaction());var p=E._calcShift(W,h),n=p.x,T=p.y,c=E.gv.getMoveMode(h,x);c&&("x"===c?T=0:"y"===c?n=0:"xy"!==c&&(n=T=0)),Y.moveSelection(n,T),E._lastLogicalPoint=J,E.autoScroll(h),E.fi(L)}},_calcShift:function(){var t=this,H=t._logicalPoint,p=t._lastLogicalPoint,A=H.x-p.x,m=H.y-p.y;return{x:A,y:m}},clear:function(Q){var R=this,l=R.gv;R._lastLogicalPoint&&(R._lastLogicalPoint=R._data=l._moving=Z,R._logicalPoint&&(R.fi({kind:"endMove",event:Q}),l.onMoveEnded()),R.clearDragging()),R._alreadyBeginTransaction&&(R._alreadyBeginTransaction=!1,l.getDataModel().endTransaction())}});var em=Jk.TextEditInteractor=function(Z){$f(em,this,[Z]),this.init()};$h("TextEditInteractor",mr,{init:function(){var P=this,a=this.input=D.createElement("input"),G=a.style;a.text="text",G.border="1px solid #d8d8d8",G.position="absolute",G.padding="2px 3px",G.outline="none",G.marginLeft="-90px",G.marginTop="-16px",G.backgroundColor="rgba(255,255,255, 0.9)",G.fontSize="14px",G.width="180px",G.height="32px",G.boxShadow="0 0 13px rgba(16,142,233, 0.5)",G.textAlign="center",G.boxSizing="border-box",T(a,"keyup",function(q){bd(q)&&P.endTextEdit()}),T(a,"focus",function(){a.select()});var S=this.textarea=D.createElement("textarea"),F=this.wrap=D.createElement("div");F.appendChild(S),G=S.style,G.margin=0,G.padding="4px",G.overflow="hidden",G.boxSizing="border-box",G.position="absolute",G.outline="none",G.backgroundColor="transparent",G.resize="none",G.textAlign="center",G.fontSize="14px",G.border="none",G.borderWidth=0,G.width="100%",G.top="50%",G=F.style,G.boxSizing="border-box",G.margin=0,G.padding=0,G.position="absolute",G.boxShadow="0 0 13px rgba(16,142,233, 0.5)",G.border="1px solid #d8d8d8",G.backgroundColor="rgba(255,255,255, 0.9)",G.width="180px",G.marginLeft="-90px",T(S,"keydown",function(r){return(_d()||oe())&&bd(r)?(P.endTextEdit(),void 0):(P.calculateTextareaHeight(String.fromCharCode(r.keyCode)),void 0)}),T(S,"focus",function(){S.select()});var L=function(i){i.stopPropagation()};T(a,"mousedown",L),T(a,"touchstart",L),T(S,"mousedown",L),T(S,"touchstart",L),P.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],P.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",P.handleWindowClick=function(t){var J=P._editingDOM;if(J){var r=J.getBoundingClientRect(),E=zn(t);or(r,E)||P.endTextEdit()}}},handle_mousedown:function(W){var b=this,m=b.gv;if(Ko(W)&&!m._editing){var t=m.getDataAt(W);if(t){var w=m.getTextEditInfo(t);w&&(this._editInfo=w,this._editTarget=t,m._editing=!0,w.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var j=this,C=j.gv,c=j._editTarget,h=j.getTargetValue(),W=j.textarea,f=j.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===h||h===l)&&(h=""),W.value=h,j._editingDOM=W,C.getView().appendChild(f),this.layoutHTML(f,c),this.calculateTextareaHeight(),U(function(){W.focus(),T(M,"mousedown",j.handleWindowClick),T(M,"touchstart",j.handleWindowClick)},10)},handleTextEdit:function(){var k=this,Y=k.gv,p=k._editTarget,O=k.getTargetValue(),y=k.input;(null===O||O===l)&&(O=""),y.value=O,k._editingDOM=y,Y.getView().appendChild(y),this.layoutHTML(y,p),U(function(){y.focus(),T(M,"mousedown",k.handleWindowClick),T(M,"touchstart",k.handleWindowClick)},10)},layoutHTML:function(T,u){var r=this.gv,G=r.getZoom();if(u instanceof a.Node){var h=u.getRect();T.style.left=(h.x+h.width/2)*G+r.tx()+"px",T.style.top=(h.y+h.height/2)*G+r.ty()+"px"}else if(u instanceof a.Edge){var H=r.getDataUI(u),h=H._6I;T.style.left=(h.x+h.width/2)*G+r.tx()+"px",T.style.top=(h.y+h.height/2)*G+r.ty()+"px"}},endTextEdit:function(){var d=this,B=d._editInfo.isMultiline?d.wrap:d.input,X=d._editInfo.isMultiline?d.textarea:d.input;d.setTargetValue(X.value),d.gv.getView().removeChild(B),d.gv._editing=!1,delete d._editingDOM,K(M,"mousedown",d.handlelick),K(M,"touchstart",d.handleWindowClick)},setTargetValue:function(W){var $=this,Q=$._editTarget,_=$._editInfo,g=_.accessType,c=_.name;if(c&&g||(g="p",c="name"),"p"===g){var o=a.Default.setter(c);Q[o](W)}else"a"===g?Q.a(c,W):Q.s(c,W)},getTargetValue:function(){var E=this,Z=E._editTarget,T=E._editInfo,I=T.accessType,w=T.name;if(w&&I||(I="p",w="name"),"p"===I){var j=a.Default.getter(w);return Z[j]()}return"a"===I?Z.a(w):Z.s(w)},createHiddenTextarea:function(){this.hiddenTextarea=D.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(j,l){if(l&&this.computedStyleCache)return this.computedStyleCache;var P=this,a=M.getComputedStyle(j),p=a.getPropertyValue("box-sizing")||a.getPropertyValue("-moz-box-sizing")||a.getPropertyValue("-webkit-box-sizing"),E=parseFloat(a.getPropertyValue("padding-bottom"))+parseFloat(a.getPropertyValue("padding-top")),N=parseFloat(a.getPropertyValue("border-bottom-width"))+parseFloat(a.getPropertyValue("border-top-width")),r=P.SIZING_STYLE.map(function(y){return y+":"+a.getPropertyValue(y)}).join(";"),X={sizingStyle:r,paddingSize:E,borderSize:N,boxSizing:p};return l&&(this.computedStyleCache=X),X},calculateTextareaHeight:function(b){b=b||"";var A=this,r=A.textarea,w=A.hiddenTextarea,E=A.wrap,Q=32,S=A.calculateHTMLStyle(r,!1),V=S.paddingSize,T=S.borderSize,s=S.boxSizing,U=S.sizingStyle;w.setAttribute("style",U+";"+A.HIDDEN_TEXTAREA_STYLE),w.value=r.value+b;var M=w.scrollHeight;"border-box"===s?M+=T:"content-box"===s&&(M-=V),r.style.height=M+"px",r.style.marginTop=0-.5*M+"px",E.style.height=Math.max(M,Q)+"px",E.style.marginTop=M*-.5+"px"}});var Sm=Jk.ScrollBarInteractor=function(N){$f(Sm,this,[N])};$h("ScrollBarInteractor",mr,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(c){var k=this.gv.getViewRect();return this._41o()&&(k.x+k.width-this.gv.lp(c).x)*this.gv.getZoom()<Vp},isH:function(y){var g=this.gv.getViewRect();return this._40o()&&(g.y+g.height-this.gv.lp(y).y)*this.gv.getZoom()<Vp},handle_mousemove:function(j){this.handle_touchmove(j)},handle_touchmove:function(N){if(!Xm&&Vi(N)&&this.gv.isScrollBarVisible()){var b=this,$=b.isV(N),C=b.isH(N);($||C)&&b.gv.showScrollBar(),b.gv._scrolling=$||C}},handleWindowMouseUp:function(U){this.handleWindowTouchEnd(U)},handleWindowTouchEnd:function(z){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=Z,this.fi({kind:"endScroll",event:z})},handle_mousedown:function(G){this.handle_touchstart(G)},handle_touchstart:function(l){var Y=this;if(Y.gv.setFocus(l),td(l),Y.handle_touchmove(l),!(bp(l)>1)&&Y.gv._scrolling&&Y.gv.isScrollBarVisible()){Y._cp=zn(l),Y._tx=Y.gv.tx(),Y._ty=Y.gv.ty();var G=Y.isV(l);Y._state=G?"vScroll":"hScroll",Oi(Y,l),Y.fi({kind:"beginScroll",event:l})}},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(X){var f=zn(X),W=this.gv.getViewRect(),B=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-f.y)*B.height/W.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-f.x)*B.width/W.width),this.fi({kind:"betweenScroll",event:X})}});var bc=Jk.TouchInteractor=function(U,e){e=e||{},e.selectable===l&&(e.selectable=!0),e.movable===l&&(e.movable=!0),e.pannable===l&&(e.pannable=!0),e.pinchable===l&&(e.pinchable=!0),e.editable===l&&(e.editable=!0),this.params=e,$f(bc,this,[U])};$h("TouchInteractor",mr,{ms_edit:1,setUp:function(){var Y=this;bc.superClass.setUp.call(Y),ng&&Y.params.editable&&Y.gv.setEditInteractor(Y)},tearDown:function(){var C=this;bc.superClass.tearDown.call(C),ng&&C.params.editable&&C.gv.setEditInteractor(Z)},clear:function(g){var f=this,W=f.gv;W._moving&&(f.fi({kind:"endMove",event:g}),delete W._moving,W.onMoveEnded(),W.dm().endTransaction()),W._panning&&(f.fi({kind:"endPan",event:g}),delete W._panning,W.onPanEnded()),W._pinching&&(f.fi({kind:"endPinch",event:g}),delete W._pinching,W.onPinchEnded()),W._editing&&(f._46O(g),f._77I=f._node=f._edge=f._shape=f._rect=f._89I=f._index=W._editing=Z),f._moving=f._panning=f._pinching=f._editing=f._57I=f._data=f._beginHistory=Z,f.clearDragging()},handle_touchstart:function(t){var o=this;if(!o.gv._editing){td(t),o._57I=Z;var N=o.params,j=o.gv,F=j.sm(),n=j.getDataAt(t),r=bp(t);if(1===r){if(Ko(t))return j.handleDoubleClick(t,n),void 0;j.handleClick(t,n),n&&(j.handleMouseDown&&j.handleMouseDown(t,n),o._data=n),N.selectable||(n=Z),n&&(F.co(n)||F.ss(n),N.editable&&j.isEditable(n)&&o._79I(t,n,!0)?(o._editing=1,o.startDragging(t)):N.movable&&j.isMovable(n)&&(o._moving=1,o.startDragging(t))),n&&j.isMovable(n)||(o._57I=zn(t),N.pannable&&j.isPannable()&&(o._panning=1,o.startDragging(t),o._translate={x:j.tx(),y:j.ty()}))}else if(N.pinchable&&2===r){if(n&&j._39Q(n))return;o._pinching=1,o.startDragging(t);var U=j.getView(),E=j.getZoom(),B=U.getBoundingClientRect(),w=t.touches[0],Y=t.touches[1],W={x:(w.clientX+Y.clientX)/2-B.left,y:(w.clientY+Y.clientY)/2-B.top};W.x-=j.tx(),W.y-=j.ty(),W.x/=E,W.y/=E,o._p=W,o._d=Lf(t)}}},handle_touchend:function(M){var h=this,m=h.gv,R=h._57I,_=h._data;R&&(fm(R,zn(M))<=1&&!m.getDataAt(M)&&m.sm().cs(),h._57I=Z),_&&m.handleMouseUp&&m.handleMouseUp(M,_)},handleWindowTouchEnd:function(r){this.clear(r)},handleWindowTouchMove:function(c){var p=this,G=p.gv,O=bp(c);if(1===O){var r=zn(c),q=Gm(G,r,p._lastClientPoint),k=fm({x:0,y:0},q);if(p._editing&&(p._beginHistory||(p._beginHistory=1,G.dm().beginTransaction()),G._editing=1,p._78I(c)),p._moving){if(!G._moving&&k<A.touchMoveThreshold)return;p._beginHistory||(p._beginHistory=1,G.dm().beginTransaction()),p.handleMove(c)}else if(p._panning){if(!G._panning&&k<A.touchMoveThreshold)return;G.setTranslate(p._translate.x+q.x,p._translate.y+q.y),p.fi({kind:G._panning?"betweenPan":"beginPan",event:c}),G._panning=1}}else if(2===O&&p._pinching){var W=Lf(c);G.handlePinch(p._p,W,p._d),p._d=W,p.fi({kind:G._pinching?"betweenPinch":"beginPinch",event:c}),G._pinching=1}},handleMove:function(r){var W=this,y=W.gv,F=y.lp(r);y._93O&&y._93O(r,W._data)||(y.moveSelection(F.x-W._lastLogicalPoint.x,F.y-W._lastLogicalPoint.y),W._lastLogicalPoint=F,W.autoScroll(r),W.fi({kind:y._moving?"betweenMove":"beginMove",event:r}),y._moving=1)}});var a=M.ht,vs=a.graph._editor={Math:a.Math,Guide:{}};vs.getStyle=function(G){var i,u=vs.StyleMap;return u&&(i=u[G],i!==l)?i:vs.DefaultStyleMap[G]},vs.setStyle=function(F,o){var u=vs.StyleMap;u||(u=vs.StyleMap={}),u[F]=o},vs.inEdit=function(R){return R._inXEdit===!0},vs.startEdit=function(o){o._inXEdit=!0,vs.Inject.doInject(o)},vs._46O=function(Y){Y._inXEdit=!1,vs.Inject.undoInject(Y)},vs.toScreenPosition=function(Q,p){var i=Q.tx(),I=Q.ty(),W=Q._zoom;return new vs.Math.Vector2(p.x*W+i,p.y*W+I)},vs.checkHit=function(o,O,c){return o.distanceTo(O)<c?!0:!1},vs.toWorldPosition=function(f,w){var E=f.tx(),C=f.ty(),O=f._zoom;return{x:(w.x-E)/O,y:(w.y-C)/O}},vs.setAntialias=function(z,c){for(var F,o=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],a=0,m=o.length;m>a&&(F=o[a],!(F in z));a++);z[F],z[F]=c},vs.getTargetCornersOnScreen=function(t,X){if(!X)return null;var v,Q=[];if(Rm(X,t)){var d=Xd(t,X);v=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}]}else{if(!X.getCorners)return null;v=X.getCorners()}return v.forEach(function(w){var h=vs.toScreenPosition(t,w);Q.push(h.x,h.y)}),Q},vs.log=function(){};var Xb=vs.Inject={_modules:[]};Xb.registAsModule=function(E,c){var D={},P={};for(var j in E){var J=c.prototype[j];D[j]=J}E.getBackup=function(O){return D[O]},E.getBackups=function(){return D},P.doInject=function(){for(var o in E)"getBackup"!==o&&(c.prototype[o]=E[o])},P.undoInject=function(){for(var p in E)"getBackup"!==p&&(c.prototype[p]=D[p])},Xb._modules.push(P)},Xb.doInject=function(X){for(var s,T=Xb._modules,S=0,H=T.length;H>S;S++)s=T[S],s.doInject(X)},Xb.undoInject=function(z){for(var i,p=Xb._modules,U=0,w=p.length;w>U;U++)i=p[U],i.undoInject(z)};var mr=a.graph.EditInteractor=function(U){var Q=this,F=D.createElement("canvas");F.className="editCanvas",F.style.position="absolute",Q._styleMap={},Q._canvas=F,Q._context=F.getContext("2d"),mr.superClass.constructor.call(Q,U),this._editDetail=!1,vs.setAntialias(Q._context,!1),Q._subModules=[new vs.Anchor(Q),new vs.RotateX(Q),new vs.MoveDummy(Q),new vs.Rect(Q),new vs.Curve(Q),new vs.MoveHelper(Q)],Q._gridGuide=new vs.Guide.Grid(Q),Q._rectGuide=new vs.Guide.Rect(Q),Q._hoverGuide=new vs.Guide.Hover(Q)},fl=mr;a.Default.def(mr,a.graph.Interactor,{ms_edit:1,ms_fire:1}),Y.defineProperties(mr.prototype,{editDetail:{get:function(){var J=!!this._editDetail;return J},set:function(A){var e=this,I=e._editDetail;I!==A&&(e._editDetail=A,e.gv._editing=A,e.fp("editDetail",I,A),e.fp("pointsEditingMode",I,A),e.fi({kind:A?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(i){(!this._editDetail||i)&&(this.gv._editing=i,i||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(l){this._editing=l,this.gvEditing=l}},pointsEditingMode:{get:function(){return this.editDetail},set:function(i){var c=this;c.editDetail!==i&&(i?c._tryEnterEditDetailMode():c._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var c=this._gridEnabled;if(!c)return!1;var E=this.gv;return E?!0:!0},set:function(F){F!==this._gridEnabled&&(this._gridEnabled=F,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(F){F!==this._agEnabled&&(this._agEnabled=F,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),mr.prototype.getSubModule=function(i){var m,T,z,j=this._subModules;for(T=0,z=j.length;z>T;T++)if(m=j[T],m.catalog===i)return m},mr.prototype.invokeSubModule=function(S,d){var J=this,K=J._subModules;if(K)for(var T,u,c,$=Array.prototype.slice.call(arguments,2),Y=0,z=K.length;z>Y;Y++)if(T=K[Y],u=T[S],u&&(c=u.apply(T,$),c!=l&&d))return T},mr.prototype.invokeSubModuleInverse=function(y,x){var Z=this,V=Z._subModules;if(V)for(var $,H,J,E=Array.prototype.slice.call(arguments,2),c=V.length-1;c>=0;c--)if($=V[c],H=$[y],H&&(J=H.apply($,E),J!=l&&x))return $},mr.prototype.setUp=function(){vs.log("setUp");var u=this,Y=u.gv,t=Y.getView(),w=u._canvas;mr.superClass.setUp.call(u),Y.setEditInteractor(u),Y._79O?t.insertBefore(w,Y._79O):t.appendChild(w),vs.startEdit(Y),u.invokeSubModule("setUp"),Y.dm().mm(u._onDataModelChanged,u),Y.dm().md(u._onDataPropertyChanged,u)},mr.prototype.tearDown=function(){vs.log("tearDown");var E=this,K=E.gv,x=K.getView();E._resetCustomCursorStyle(),mr.superClass.tearDown.call(E),K.dm().umm(E._onDataModelChanged,E),K.dm().umd(E._onDataPropertyChanged,E),K.setEditInteractor(null),x.removeChild(E._canvas),E._drawTimer&&(_(E._drawTimer),E._drawTimer=null),vs._46O(K),E.invokeSubModule("tearDown")},mr.prototype._onDataModelChanged=function(q){var c=this;("clear"===q.kind||"remove"===q.kind&&c.editDetail&&q.data===c.getSubModule("Curve").target)&&(c.editDetail=!1,c._42())},mr.prototype._onDataPropertyChanged=function(S){var o=this;if(o.editDetail){var w=o.getSubModule("Curve"),M=S.data;M===w.target&&(M._writing||w._handleDataChanged(S))}},mr.prototype.clear=function(){vs.log("clear")},mr.prototype.redraw=function(){this._42()},mr.prototype._42=function(){var S=this;S._drawTimer||(S._drawTimer=U(function(){S._drawTimer=null,S.drawImpl()},0))},mr.prototype.drawImpl=function(){var y;for(y in{_42:!0})break;return function(){var K=this,$=K._canvas,Y=K.gv,A=Y.getWidth(),V=Y.getHeight(),_=K._context,b=a.Default.getInternal(),E=M.devicePixelRatio;($.width!==A||$.height!==V)&&b.setCanvas($,A,V,E),_.clearRect(0,0,$.width,$.height);var U=K._getValidSelection();_.save(),_.scale(E,E),K._gridGuide._42(),K.invokeSubModuleInverse(y,!1,_,Y,U),K._rectGuide._42(),K._hoverGuide._42(),_.restore()}}(),mr.prototype._getValidSelection=function(){var g=this,k=g.gv,C=k.sm().getSelection(),H=[];return C.each(function(Z){k.isVisible(Z)&&k.isEditable(Z)&&H.push(Z)}),H},mr.prototype.handle_touchmove=function(a){return this.handle_mousemove(a)},mr.prototype.handle_mousemove=function(h){if(!a.Default.isDragging()){var L=this;if((L.editDetail||!nb()&&!ge(h))&&!L.gv._externalEditing)if(L.gvEditing=!1,L._checkEdit(h))L.gvEditing=!0;else{if(!L.getStyle("hoverGuideVisible"))return;L.hoverData=L.gv.getDataAt(h),L._42()}}},mr.prototype.handle_touchstart=function(j){return this.handle_mousedown(j)},mr.prototype.handle_mousedown=function(j){td(j);var o=this;if((o.editDetail||!nb()&&!ge(j))&&!o.gv._externalEditing){if(Ko(j)&&!j.clickThrough){if(o.editDetail){if(o._tryQuitEditDetailMode(j))return}else if(o._tryEnterEditDetailMode())return;o.gv.dm().beginTransaction();var Z=o.invokeSubModule("handleDoubleClick",!0,j);if(o.gv.dm().endTransaction(),Z)return}var M=o._checkEdit(j);M&&(o._downPosition=o._getLogicalPoint(j),o.gv.dm().beginTransaction(),M.startEdit(o,j),o.editing=!0)}},mr.prototype._checkEdit=function(T){var M=this,t=M.gv,$=M._getLogicalPoint(T),R=M.invokeSubModule("check",!0,t,T,$)||null;return M._editMod=R,R},mr.prototype.handleWindowTouchMove=function(z){return this.handleWindowMouseMove(z)},mr.prototype.handleWindowMouseMove=function(T){var U=this,A=U._downPosition;if(A){var t=U._getLogicalPoint(T);if(t.distanceTo(A)<U.getStyle("moveSensitivity"))return;delete U._downPosition}var c=U._editMod;c&&c.handleEdit(U.gv,T)},mr.prototype._getLogicalPoint=function(b){var M=this,H=a.Default.getLogicalPoint(b,M._canvas);return new vs.Math.Vector2(H)},mr.prototype.handleWindowTouchEnd=function(K){return this.handleWindowMouseUp(K)},mr.prototype.handleWindowMouseUp=function(){var U;for(U in{_46O:!0})break;return function(a){var k=this;k.editing=!1,k.setCursor("default"),k.invokeSubModule(U,!1,a),k._42(),k.gv.dm().endTransaction()}}(),mr.prototype.handle_mousewheel=function(a){var Q=this;td(a),Q.invokeSubModule("preHandleScroll",!0)||Q.gv.handleScroll(a,a.wheelDelta)},mr.prototype.handleDelete=function(){var n=this;if(!n.editDetail){n.gv.dm().beginTransaction();var o=n.invokeSubModule("handleNormalStateDelete",!0);return n.gv.dm().endTransaction(),o||n.gv.removeSelection(),void 0}n.gv.dm().beginTransaction(),n.invokeSubModule("handleDelete",!0),n.gv.dm().endTransaction(),n._42()},mr.prototype.handle_keydown=function(g){var q=this;if((g.metaKey||g.ctrlKey)&&q._42(),nb(g)&&!q.editing)return q.gvEditing=!1,q.setCursor("default"),q._42(),void 0;var $=bd(g);return q.editDetail?(($||Nb(g))&&(q.editDetail=!1,q._42()),q.gv.dm().beginTransaction(),q.invokeSubModule("handle_keydown",!0,g),q.gv.dm().endTransaction(),void 0):(q.gv.dm().beginTransaction(),q.invokeSubModule("handleNormalStateKeyDown",!0,g),q.gv.dm().endTransaction(),$&&q._tryEnterEditDetailMode(),void 0)},mr.prototype.handle_keyup=function(D){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,D),this.gv.dm().endTransaction()},mr.prototype._tryEnterEditDetailMode=function(){var A=this;return!A.editDetail&&A.invokeSubModule("canEnterEditDetailMode",!0)&&1===A._getValidSelection().length?(A.editDetail=!0,A._42(),!0):void 0},mr.prototype._tryQuitEditDetailMode=function(r){var V=this;return V.editDetail?!r||V.invokeSubModule("canQuitEditDetailMode",!0,r)?(V.editDetail=!1,V._42(),!0):!1:!1},mr.prototype.setStyle=function(P,h,X){var s=this;X?vs.setStyle(P,h):s._styleMap[P]=h,"baseColor"===P&&(vo=h),s.fp("styleChanged",null,{key:P,value:h,base:X}),s._42()},mr.prototype.getStyle=function(m){var q=this,S=q._styleMap[m];return S!==l?S:vs.getStyle(m)},mr.prototype.setCursor=function(d){this._resetCustomCursorStyle(),a.graph.EditInteractor.superClass.setCursor.call(this,d)},mr.prototype._drawHostGuide=function(w){var B=this,c=B._context,f=B.gv;vs.Icons.DrawIcon(B,c,vs.Icons.NodeHoverGuide,w.corners);var s=w.host;if(s){var O=f.getAttachPoints(s);if(O&&O.length)for(var E=0,U=O.length;U>E;E++){var S=O[E],m=Qf(f,s,0,S.offsetX||0,S.offsetY||0,S.x,S.y);m=vs.toScreenPosition(f,m),m.isAttach=w.attach===E,vs.Icons.DrawIcon(B,c,vs.Icons.AttachPoint,m)}}},mr.prototype._resetCustomCursorStyle=function(){var B=this;if(B._customStyle){var Q=this.gv.getView();Q.classList&&Q.classList.remove&&Q.classList.remove(B._customStyle),B._customStyle=null}},mr.prototype._setRotateCursor=function(s){var v=this,e=v._cursorFactory;e||(e=v._cursorFactory=new vs.CursorFactory(v));var V=e.getRotateCursor(s),z=v.gv.getView();v._resetCustomCursorStyle(),v._customStyle=V,z.classList&&z.classList.add&&z.classList.add(V)};var zi=vs.Group=function(I){var M=this;M._entities=I,M._64O=0,M._position={x:0,y:0},M._scale={x:1,y:1},M._anchor={x:.5,y:.5},M._anchor2={x:.5,y:.5}};zi.prototype={},zi.prototype.constructor=zi;var qm=null;zi.findOrCreateGroup=function(s){if(qm&&qm.checkIsMe(s))return qm;var Q=new vs.Group(s);return Q.getKeyOb()?(qm=Q,Q):void 0},zi.prototype.checkIsMe=function(J){var A=this._entities;if(A.length!==J.length)return!1;var L,k={},i=J.length;for(L=0;i>L;L++)k[J[L]._id]=!0;for(L=0;i>L;L++)if(!k[A[L]._id])return!1;return!0},zi.prototype.getRotation=function(){return this._64O},zi.prototype.getPosition=function(){return this._position},zi.prototype.getAnchor=function(){return this._anchor},zi.prototype.getWidth=function(){return this._width},zi.prototype.getScale=function(){return this._scale},zi.prototype.getSize=function(){return{width:this._width,height:this._height}},zi.prototype.getHeight=function(){return this._height},zi.prototype.getKeyOb=function(){for(var Q=this._entities,d=Q.length-1;d>=0;d--){var E=Q[d];if(this.isNode(E))return E}},zi.prototype.getAnchor2=function(){var D=this,m=D.rotateCenter;if(m)return m;var $=D.getKeyOb();if(!$)return D._anchor;var E=D._anchor2,U=$.getMatrix();return U.tf({x:$.getWidth()*(E.x-$.getAnchor().x),y:$.getHeight()*(E.y-$.getAnchor().y)})},zi.prototype.setAnchor2=function(I,R){var T=this,Z=T.getKeyOb();if(Z){var S,u=Z.getMatrix();S="number"==typeof I?{x:I,y:R}:I;var r=u.tfi(S);T._anchor2={x:Z.getAnchor().x+r.x/Z.getWidth(),y:Z.getAnchor().y+r.y/Z.getHeight()}}},zi.prototype.setRotation=function(){},zi.prototype.beginRotate=function(I){this.rotateCenter=I.pos,this.rotateMode=I.groupRotateMode},zi.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},zi.prototype.addRotation=function(x,q,w){return"batch"===q?this._addRotationInBatchMode(x,w):"block"===q?this._addRotationInBlockMode(x,w):void 0},zi.prototype._addRotationInBlockMode=function(D,V){var C=this,m=C.rotateCenter||C.getPosition();C._entities.forEach(function(r){if(C.isNode(r)&&(!V||V(r))){var y=r.getMatrix();y.translate(-m.x,-m.y),y.rotate(D),y.translate(m.x,m.y);var j=Math.sign(r.getScale().x);r.setRotation(R(y.b*j,y.a*j)),r.setPosition(y.tx,y.ty)}})},zi.prototype._addRotationInBatchMode=function(v,U){var f=this,D=f._anchor2;f._entities.forEach(function(T){if(f.isNode(T)&&(!U||U(T))){var E=T.getAnchor(),l=T.getMatrix(),x=l.tf({x:T.getWidth()*(D.x-E.x),y:T.getHeight()*(D.y-E.y)}),e=new vs.Math.Matrix2d;e.set(l.a,l.b,l.c,l.d,l.tx,l.ty),e.translate(-x.x,-x.y),e.rotate(v),e.translate(x.x,x.y);var p=Math.sign(T.getScale().x);T.setRotation(R(e.b*p,e.a*p)),T.setPosition(e.tx,e.ty)}})},zi.prototype.setPosition=function(o){var G,n,M,i,l=this,h=l._position,P=o.x-h.x,J=o.y-h.y,d=l._entities;for(n=0,M=d.length;M>n;n++)G=d[n],Pr(G)&&(i=G.getPosition(),G.setPosition(i.x+P,i.y+J));l._position=o},zi.prototype.setScale=function(D,O){var A=this,L=D/A._scale.x,_=O/A._scale.y;A._adjustChildScaleOrSize(L,_,"size"),A._scale={x:D,y:O}},zi.prototype.getRect=function(){var v=this,L=v._position,w=v._width,s=v._height;return{x:L.x-w/2,y:L.y-s/2,width:w,height:s}},zi.prototype.setSize=function(W,p){var I=this,W=Math.max(1,W),p=Math.max(1,p),B=W/I._width,M=p/I._height;I._adjustChildScaleOrSize(B,M,"size"),I._width=W,I._height=p},zi.prototype._adjustChildScaleOrSize=function(p,q,j){var K,J,y,$,e,Y,f,M,v,S,t,F,o,x,s=this,r=s._position,E=s._entities,U=new vs.Math.Matrix2d;for(J=0,y=E.length;y>J;J++)if(K=E[J],s.isNode(K)){if($=K.getPosition(),e=K.getRotation(),Y=K.getWidth(),f=K.getHeight(),M=K.getScale(),t=M.x*Y,F=M.y*f,U.identity().scale(t,F).rotate(e).translate($.x,$.y).translate(-r.x,-r.y).rotate(-s._64O),e=R(U.b*Math.sign(t),U.a*Math.sign(t)),U.scale(p,q),v=Math.cos(e),S=Math.sin(e),Math.abs(v)<.001?(o=U.b/S,x=-U.c/S):(o=U.a/v,x=U.d/v),"scale"===j)K.setScale(o/Y,x/f);else if("size"===j){var m=o/M.x,Q=x/M.y;K.setScale(vn(o)*Math.abs(M.x),vn(x)*Math.abs(M.y)),K.setSize(Math.max(.1,Math.abs(m)),Math.max(.1,Math.abs(Q)))}U.rotate(s._64O).translate(r.x,r.y),K.setPosition(U.tx,U.ty)}},zi.prototype.getMatrix=function(){var x=this,w=x._position,P=a.Default.getInternal(),I=x._scale;return new P.Mat(x._64O,w.x,w.y,I.x,I.y)},zi.prototype.toGlobal=function(b){return this.getMatrix().tf(b)},zi.prototype.getCorners=function(){var D=this,g=D._width,H=D._height,W=D._anchor,M=-g*W.x,i=-H*W.y,w=D.getMatrix();return[w.tf(M,i),w.tf(M,i+H),w.tf(M+g,i+H),w.tf(M+g,i)]},zi.prototype.calcInfo=function(){var n,P,B,H,I,X,J=this,d=[],C=J._entities,g=J._64O;for(H=0,I=C.length;I>H;H++)X=C[H],J.isNode(X)&&X.getCorners&&d.push.apply(d,X.getCorners());if(d.length){var o=Math.cos(-g),V=Math.sin(-g),t=1/0,N=-1/0,S=1/0,L=-1/0;for(H=0,I=d.length;I>H;H++)B=d[H],n=B.x,P=B.y,B.x=o*n-V*P,B.y=V*n+o*P,t=Math.min(t,B.x),N=Math.max(N,B.x),S=Math.min(S,B.y),L=Math.max(L,B.y);J._width=(N-t)/J._scale.x,J._height=(L-S)/J._scale.y,o=Math.cos(g),V=Math.sin(g);var A=J._anchor;n=t+(N-t)*A.x,P=S+(L-S)*A.y,J._position={x:o*n-V*P,y:V*n+o*P}}},zi.prototype.isNode=function(t){return Pr(t)?Rm(t)?t.size()?!1:!0:!0:!1},zi.prototype._42=function(D,$,o){var Z,x,Q,g,J,y,M,z,h=this,p=h._entities,C=h.rotateMode;for("batch"===C&&(z=h.getKeyOb()),Z=0,x=p.length;x>Z;Z++)Q=p[Z],h.isNode(Q)&&(y=Q.getRect(),g=vs.toScreenPosition(o,{x:y.x,y:y.y}),J=vs.toScreenPosition(o,{x:y.x+y.width,y:y.y+y.height}),M={min:g,max:J},Q===z&&(M.isKeyOb=!0),vs.Icons.DrawIcon(D,$,vs.Icons.GroupSubEntityRect,M))};var xd=vs.CurveActiving=function(f,u){this._curve=f,this._interactor=f._interactor,this.silent=!0;for(var q in u)this[q]=u[q];delete this.silent};xd.prototype={},xd.prototype.constructor=xd,Y.defineProperties(xd.prototype,{point:{get:function(){return this._point},set:function(S){var I=this;I._point=S,I.editingCtrl||I.silent||I._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(p){var z=this;z._pairs=p,z.editingCtrl&&!z.silent&&z._firePointChange()}}}),xd.prototype._firePointChange=function(){var O=this,a=O.getCurrentEditingPoint(),J=O._interactor;if(!a)return J.fi({kind:"selectPoint"}),void 0;var T=this._curve.target;if(T){var A=vs.getDataMatrix(T).invert(),N=a.e;a=A.apply(vs.toWorldPosition(J.gv,a)),a.e=N;var C=O._lastFirePoint;C&&Math.abs(a.x-C.x)<1e-5&&Math.abs(a.y-C.y)<1e-5&&(a.e==l&&C.e==l||Math.abs(a.e-C.e)<1e-5)||(O._lastFirePoint=a,J.fi({kind:"selectPoint",x:a.x,y:a.y,e:a.e}))}},xd.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},xd.prototype.getCurrentEditingPoint=function(){var $=this,z=$.editingCtrl;if(z){var j=$.pairs;if(j){var n=j[z.pairId];if(n){var k=n[z.type];if(k)return k}}}return $._point};var pj=vs.CursorFactory=function(S){var V=this;V._interactor=S,V._rotateCursorStyles={}};pj.prototype={},pj.prototype.constructor=pj,pj.prototype.getRotateCursor=function($){var p=this;0>$&&($+=2*Math.PI);var M=p._interactor,m=M.getStyle("rotateCursorSize"),T=M.getStyle("rotateCursorRound"),u=Math.round(180*($/Math.PI)/T);u*T>=360&&(u=0);var C=p._rotateCursorStyles,D="htCustomRotateStyle_"+m+"_"+T+"_"+u;return C[D]||(p._produceRotateCursor(D,m,T,u),C[D]=!0),D},pj.prototype._produceRotateCursor=function(L,S,w,t){var $=this;$._interactor;var X=$._canvas;X||(X=$._canvas=D.createElement("canvas")),X.width=X.height=S*devicePixelRatio,X.style.width=X.style.height=S+" px";var T=X.getContext("2d");vs.setAntialias(T,!1),T.scale(devicePixelRatio,devicePixelRatio);var Z,j,N,s,C,h=Math.round(S/2),m=""+h+" "+h+",auto !important;",g=4;Z=Math.PI/180*t*w,T.clearRect(0,0,S,S),T.save(),T.scale(S/32,S/32),T.translate(16,15),T.rotate(Z+Math.PI/2),T.beginPath(),T.moveTo(-8,0),T.lineTo(-8,g),T.lineTo(-8+g,g),T.moveTo(8,0),T.lineTo(8,g),T.lineTo(8-g,g),T.moveTo(-8,g),T.quadraticCurveTo(0,-6,8,g),T.restore(),T.lineCap="round",T.lineJoin="miter",T.strokeStyle="white",T.lineWidth=4,T.stroke(),T.strokeStyle="black",T.lineWidth=2,T.stroke(),j=JSON.stringify(X.toDataURL()),s="cursor:url("+j+")"+m,1!==devicePixelRatio&&(N='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+S+'px" height="'+S+'px"><image xlink:href='+j+' width="'+S+'" height="'+S+'"/></svg>',s+="cursor:url(data:image/svg+xml;base64,"+btoa(N)+")"+m,s+="cursor:-webkit-image-set(url("+j+")"+devicePixelRatio+"x,url("+j+")1x)"+m),C=D.createElement("style"),C.textContent="body."+L+" *, ."+L+"{"+s+"}",D.head.appendChild(C)};var lg=vs.Guide.Grid=function(S){var T=this;T._interactor=S,T._alignmentGuideId=0,T._xAlignmentGuide=[],T._yAlignmentGuide=[]};lg.prototype={},lg.prototype.constructor=lg,Y.defineProperties(lg.prototype,{gridBlockSize:{get:function(){var R=this;
                return R._gridBlockSize||R._interactor.getStyle("gridBlockSize")},set:function(E){this._gridBlockSize=E,this._interactor._42()}},gridThickLinesEvery:{get:function(){var c=this;return c._gridThickLinesEvery||c._interactor.getStyle("gridThickLinesEvery")},set:function(e){this._gridThickLinesEvery=e,this._interactor._42()}},gridEnabled:{get:function(){var f=this,M=f._interactor;return M.gridEnabled&&f.isValidGrid()}}}),lg.prototype._42=function(){var w=this,S=w._interactor;w.gridEnabled&&w.drawGrid(),S.alignmentGuideEnabled&&w.drawAlignmentGuide()},lg.prototype.makeMatrix=function(){var g=this,J=g._interactor.getStyle("gridAngle"),k=g._interactor.getStyle("gridRotation"),t=new vs.Math.Matrix2d,X=Math.sin(J),s=Math.cos(J);return t.set(1,0,s,X,0,0),t.rotate(k),t},lg.prototype.isValidGrid=function(){var B=this,C=Math.PI,I=B._interactor,Q=I.gv;if(Q._zoom<I.getStyle("gridZoomThreshold"))return!1;var N=I.getStyle("gridAngle"),_=Math.abs(180*(N%C/C)),h=1-1e-8;return h>_||_>180-h?!1:!0},lg.prototype.drawAlignmentGuide=function(){var R=this,X=R._interactor,I=X.gv,w=X._canvas,d=X._context,T=w.width,S=w.height,C=I.tx(),b=I.ty(),g=I._zoom;d.beginPath(),d.strokeStyle=X.getStyle("gridAlignmentGuideColor"),d.lineWidth=1,R._xAlignmentGuide.forEach(function(J){var I=J.p*g+C;d.moveTo(I,0),d.lineTo(I,S)}),R._yAlignmentGuide.forEach(function(G){var p=G.p*g+b;d.moveTo(0,p),d.lineTo(T,p)}),d.stroke()},lg.prototype.drawGrid=function(){function f(o,U,_,I){var n=vs.toScreenPosition(W,Y.apply({x:o,y:U})),u=vs.toScreenPosition(W,Y.apply({x:_,y:I}));z.moveTo(n.x,n.y),z.lineTo(u.x,u.y)}var E=this,u=E._interactor,p=E.gridBlockSize,m=E.gridThickLinesEvery,x=u.getStyle("gridThickColor"),K=u.getStyle("gridLightColor"),W=u.gv,i=u._canvas,z=u._context,y=i.width,U=i.height,Y=E.makeMatrix(),l=Y.applyInverse(vs.toWorldPosition(W,{x:0,y:0})),g=Y.applyInverse(vs.toWorldPosition(W,{x:y,y:0})),R=Y.applyInverse(vs.toWorldPosition(W,{x:0,y:U})),r=Y.applyInverse(vs.toWorldPosition(W,{x:y,y:U})),V=Math.min(l.x,g.x,R.x,r.x),S=Math.max(l.x,g.x,R.x,r.x),d=Math.min(l.y,g.y,R.y,r.y),q=Math.max(l.y,g.y,R.y,r.y);y=S-V,U=q-d;var B=Math.ceil(V/p),b=Math.floor(S/p),w=Math.ceil(d/p),F=Math.floor(q/p);W.tx(),W.ty(),W._zoom;var X,o,t;for(z.save(),z.lineWidth=1,z.beginPath(),z.strokeStyle=x,t=Math.ceil(B/m)*m;b>=t;t+=m)X=t*p,f(X,d,X,q);for(t=Math.ceil(w/m)*m;F>=t;t+=m)o=t*p,f(V,o,S,o);for(z.stroke(),z.beginPath(),z.strokeStyle=K,t=B;b>=t;t++)0!==t%m&&(X=t*p,f(X,d,X,q));for(t=w;F>=t;t++)0!==t%m&&(o=t*p,f(V,o,S,o));z.stroke(),z.restore()},lg.prototype.getAlignmentGuides=function(){var m=this;return{x:m._xAlignmentGuide,y:m._yAlignmentGuide}},lg.prototype.addAlignmentGuide=function(Y,f,i){var X=this,B="x"===Y?X._xAlignmentGuide:X._yAlignmentGuide,i=i?i:++X._alignmentGuideId,$={p:f,id:i};if(B.length){var n=X._findClosestAlignmentGuide($.p,B);n.dis<0?B.splice(n.index+1,0,$):B.splice(n.index,0,$)}else B.push($);return X._interactor._42(),i},lg.prototype.findClosest=function(I,K,m){var $=this,n=$._interactor,r=n.gv;m&&(I=vs.toWorldPosition(r,I));var B,g,h,J=1/0,q=1/0,d=I.x,u=I.y;if($.gridEnabled){var R=$.gridBlockSize,P=$.makeMatrix(),H=P.applyInverse(I);H=P.apply({x:Math.round(H.x/R)*R,y:Math.round(H.y/R)*R}),J=H.x-d,q=H.y-u,h=!0}if(n.alignmentGuideEnabled&&(B=$._findClosestAlignmentGuide(d,$._xAlignmentGuide).dis,g=$._findClosestAlignmentGuide(u,$._yAlignmentGuide).dis,Math.abs(B)<Math.abs(J)&&(J=B,h=!0),Math.abs(g)<Math.abs(q)&&(q=g,h=!0)),h){h=!1;var f=r._zoom,N=n.getStyle("smartGuideThreshold")/f,O={};if(Math.abs(J)<N&&"y"!==K&&(O.x=m?J*f:J,h=!0),Math.abs(q)<N&&"x"!==K&&(O.y=m?q*f:q,h=!0),h)return O}},lg.prototype._findClosestAlignmentGuide=function(F,j){if(!j.length)return{dis:1/0};for(var d,X=0,L=j.length-1;L-X>1;)d=Math.floor((X+L)/2),j[d].p<F?X=d:L=d;var e=j[X].p-F,g=j[L].p-F;return Math.abs(e)<=Math.abs(g)?{line:j[X],dis:e,index:X}:{line:j[L],dis:g,index:L}},lg.prototype.removeAllAlignmentGuide=function(m){var C=this;"y"!==m&&(C._xAlignmentGuide=[]),"x"!==m&&(C._yAlignmentGuide=[]),C._interactor._42()},lg.prototype.removeAlignmentGuide=function(p){for(var L,D,e,W=this,i=W._xAlignmentGuide,Z=0;2>Z;Z++)for(i=0===Z?W._xAlignmentGuide:W._yAlignmentGuide,L=0,D=i.length;D>L;L++)if(e=i[L],e.id===p)return i.splice(L,1),W._interactor._42(),{axis:0===Z?"x":"y",position:e.p};return!1},lg.prototype.adjustAlignmentGuide=function(R,E){var W=this,Y=W.removeAlignmentGuide(R);return Y?(W.addAlignmentGuide(Y.axis,E,R),!0):!1};var bs=vs.Guide.Rect=function(l){var v=this;v._interactor=l};bs.prototype={},bs.prototype.constructor=bs,bs.prototype.gatherRects=function(){var C,u,H,X,c=this,D=c._interactor.gv,v=[],t=[],f={x:v,y:t},S={},W=D.getDataModel(),j=W.a("width"),s=W.a("height");j&&s&&(C=0,u=0,H=j,X=s,v.push({node:W,type:0,p:C},{node:W,type:1,p:C+H/2},{node:W,type:2,p:C+H}),t.push({node:W,type:0,p:u},{node:W,type:1,p:u+X/2},{node:W,type:2,p:u+X}),S[W._id||0]={x:C,y:u,width:H,height:X}),W.each(function(L){if(Pr(L)&&!D.isSelected(L)&&D.isVisible(L)&&D.isValidGuideLineSource(L)){var e=!1;if(D.sm().getSelection().each(function(Y){e||(L.isHostOn(Y)?e=!0:L.isDescendantOf(Y)&&(e=!0))}),!e){var d=L.getRect();C=d.x,u=d.y,H=d.width,X=d.height,v.push({node:L,type:0,p:C},{node:L,type:1,p:C+H/2},{node:L,type:2,p:C+H}),t.push({node:L,type:0,p:u},{node:L,type:1,p:u+X/2},{node:L,type:2,p:u+X}),S[L._id]=d}}}),v.sort(function(B,J){return B.p-J.p}),t.sort(function(d,n){return d.p-n.p}),c._grid=f,c._87I=S},bs.prototype.gatherLines=function(J,t,Y){var V,x,E,O,q,w,U,P,L,A,g,W,C=this,r=[C.findClosest({x:J.x,y:J.y},t),C.findClosest({x:J.x+J.w/2,y:J.y+J.h/2},t),C.findClosest({x:J.x+J.w,y:J.y+J.h},t)],m={},T=C._87I;Y=Y||255;var e,M;for(C._guideLine=[],V=0;2>V;V++)for(m={},0===V?(O="y",P=J.x,L=P+J.w):(O="x",P=J.y,L=P+J.h),x=0;3>x;x++)q=r[x],q&&isFinite(q[O])&&(e=1<<3*V+x,Y&e&&(w=q[O+"Line"],U=w.node,M=U._id||0,m[M]||(m[M]=!0,W=T[M],"y"===O?(A=W.x,g=W.x+W.width):(A=W.y,g=W.y+W.height),E=w.p,C._guideLine.push({type:O,a:P,b:L,c:A,d:g,p:E,center:1===w.type}))))},bs.prototype._binarySearchClosest=function(E,Z){if(!Z.length)return{dis:1/0};for(var G,t=0,q=Z.length-1;q-t>1;)G=Math.floor((t+q)/2),Z[G].p<E?t=G:q=G;var e=Z[t].p-E,O=Z[q].p-E;return Math.abs(e)<=Math.abs(O)?{line:Z[t],dis:e}:{line:Z[q],dis:O}},bs.prototype.findClosest=function(y,W,c){var K=this,n=K._interactor,s=n.gv,F=K._grid;c&&(y=vs.toWorldPosition(s,y));var i,J=K._binarySearchClosest(y.x,F.x),A=K._binarySearchClosest(y.y,F.y),g=J.dis,h=A.dis,z=s._zoom,U=n.getStyle("smartGuideThreshold")/z,N={};return Math.abs(g)<U&&"y"!==W&&(N.x=c?g*z:g,N.xLine=J.line,i=!0),Math.abs(h)<U&&"x"!==W&&(N.y=c?h*z:h,N.yLine=A.line,i=!0),i?N:void 0},bs.prototype._42=function(){var P=this,D=P._guideLine;if(D&&!a.Default.isCtrlDown()){var x=P._interactor;if(x.getStyle("guideLineVisible")){var c,X,T,U,H,n,G,S,y,A,r,p,K,F,b,_,k,I=x.gv,J=x._context,h=I.tx(),B=I.ty(),L=I._zoom,j=x.getStyle("guideLineTextSpacing");for(c=0,X=D.length;X>c;c++)T=D[c],S=T.type,y=T.p,A=T.a,r=T.b,p=T.c,K=T.d,F=Math.min(A,p),b=Math.max(r,K),"x"===S?(U=y*L+h,H=F*L+B,n=U,G=b*L+B):(U=F*L+h,H=y*L+B,n=b*L+h,G=H),vs.Icons.DrawIcon(x,J,vs.Icons.MoveLineGuide,{rect:[U,H,n,G],center:T.center}),K>=A&&r>=p||(F=A>K?K:r,b=A>K?A:p,k=b-F,"x"===S?(T.center2center||(U-=j,n=U),H=F*L+B,G=b*L+B,_=vs.Icons.MoveLineGuideDistanceV):"y"===S&&(T.center2center||(H-=j,G=H),U=F*L+h,n=b*L+h,_=vs.Icons.MoveLineGuideDistanceH),vs.Icons.DrawIcon(x,J,_,{x0:U,y0:H,x1:n,y1:G,dis:k}))}}},bs.prototype.clear=function(){this._guideLine=null};var kp=vs.Guide.Hover=function(f){var M=this;M._interactor=f};kp.prototype={},kp.prototype.constructor=kp,Y.defineProperties(kp.prototype,{}),kp.prototype._42=function(){var B=this._interactor;if(B.getStyle("hoverGuideVisible")&&!B.gvEditing){var J=B.hoverData,L=B.gv;if(!Pr(J)||L.isSelected(J))return B.hoverData=null,void 0;var p=Xd(L,J),T=vs.toScreenPosition(L,{x:p.x,y:p.y}),D=vs.toScreenPosition(L,{x:p.x+p.width,y:p.y+p.height});vs.Icons.DrawIcon(B,B._context,vs.Icons.HoverDataRect,{min:T,max:D,color:B.getStyle("hoverGuideColor")||B.getStyle("baseColor")})}},vs.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Ib=vs.Icons={},im=1e4,Ur=null,vo=vs.DefaultStyleMap.baseColor,yi="rgb(183,232,135)",Mk="rgb(255,204,153)",Ej=6;a.Default.setImage("Icons.RectPoint",{width:Ej,height:Ej,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return vo}},rect:[0,0,Ej,Ej]}]}),Ib.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var R=Ib.GroupSubEntityRect.data;if(!R)return[];var V=R.min,d=R.max;return[V.x,V.y,V.x,d.y,d.x,d.y,d.x,V.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Ib.GroupSubEntityRect.data.isKeyOb?vo:vo}}}]};var un=4;Ib.HoverDataRect={comps:[{type:"shape",points:{func:function(){var L=Ib.HoverDataRect.data;if(!L)return[];var f=L.min,k=L.max,p=un;return f.x-=p,f.y-=p,k.x+=p,k.y+=p,[f.x,f.y,f.x,k.y,k.x,k.y,k.x,f.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Ib.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},Ib.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Ib.Line.data.P1.x,Ib.Line.data.P1.y],Ej,Ej]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Ib.Line.data.P2.x,Ib.Line.data.P2.y],Ej,Ej]}}}]},Ib.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Ib.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Ib.Rect={comps:[{type:"shape",points:{func:function(){var V=Ib.Rect.data;if(!V)return[];var P=V.LT,I=V.LB,Z=V.RB,v=V.RT;return[P.x,P.y,I.x,I.y,Z.x,Z.y,v.x,v.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return vo}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ib.Rect.data.rotation}},rect:{func:function(){return[[Ib.Rect.data.LT.x,Ib.Rect.data.LT.y],Ej,Ej]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ib.Rect.data.rotation}},rect:{func:function(){return[[Ib.Rect.data.LB.x,Ib.Rect.data.LB.y],Ej,Ej]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ib.Rect.data.rotation}},rect:{func:function(){return[[Ib.Rect.data.RB.x,Ib.Rect.data.RB.y],Ej,Ej]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ib.Rect.data.rotation}},rect:{func:function(){return[[Ib.Rect.data.RT.x,Ib.Rect.data.RT.y],Ej,Ej]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ib.Rect.data.rotation}},visible:{func:function(){return Ib.Rect.data.L?!0:!1}},rect:{func:function(){return[[Ib.Rect.data.L.x,Ib.Rect.data.L.y],Ej,Ej]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ib.Rect.data.rotation}},visible:{func:function(){return Ib.Rect.data.R?!0:!1}},rect:{func:function(){return[[Ib.Rect.data.R.x,Ib.Rect.data.R.y],Ej,Ej]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ib.Rect.data.rotation}},visible:{func:function(){return Ib.Rect.data.T?!0:!1}},rect:{func:function(){return[[Ib.Rect.data.T.x,Ib.Rect.data.T.y],Ej,Ej]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ib.Rect.data.rotation}},visible:{func:function(){return Ib.Rect.data.B?!0:!1}},rect:{func:function(){return[[Ib.Rect.data.B.x,Ib.Rect.data.B.y],Ej,Ej]}}}]};var De=16;a.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return vo}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return vo}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Ib.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Ib.Anchor.data.POS.x,Ib.Anchor.data.POS.y],De,De]}}}]},Ib.TipShiftX=12,Ib.TipShiftY=12;var Zq=[8,28];Ib.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Ib.TipHelper.data.helperPos.x,Ib.TipHelper.data.helperPos.y,Zq[0]*Ib.TipHelper.data.size,Zq[1]]}},background:{func:function(){return Ur.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Ib.TipHelper.data.text}},rect:{func:function(){return[Ib.TipHelper.data.helperPos.x,Ib.TipHelper.data.helperPos.y,Zq[0]*Ib.TipHelper.data.size,Zq[1]]}},color:{func:function(){return Ur.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Iq=7;Ib.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Ib.ShapePoint.data.dynamicVisible}},rect:{func:function(){var p=Ib.ShapePoint.data.point,j=Ib.ShapePoint.data.size||Iq;return[p,j+10,j+10]}},background:{func:function(){var r=Date.now(),b=Ib.ShapePoint.data.dynamicPeriod||1500,s=Math.sin(r%b/b*Math.PI);return"rgba(27,124,22,"+.5*s+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var Q=Ib.ShapePoint.data.point,R=Ib.ShapePoint.data.size||Iq;return[Q,R,R]}},background:{func:function(){var t=Ib.ShapePoint.data.isEnd;return t?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Ib.ShapePoint.data.color||vo}}},{type:"rect",visible:{func:function(){return!!Ib.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return vo}},rect:{func:function(){var l=5;return[Ib.ShapePoint.data.point,l,l]}}}]},Ib.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Ib.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Ib.ShapeBgCurve.data.P}},segments:{func:function(){return Ib.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var u=Date.now(),J=Ib.ShapeBgCurve.data.dynamicPeriod||1500,z=Math.sin(u%J/J*Math.PI);return"rgba(27,124,22,"+.3*z+")"}}},{type:"shape",points:{func:function(){return Ib.ShapeBgCurve.data.P}},segments:{func:function(){return Ib.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Ib.ShapeBgCurve.data.color||vo}}}]};var We=8;Ib.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var d=Ib.ShapeHighlighPoint.data;return[[d.x,d.y],We,We]}},background:{func:function(){return Ur.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Ig=10;Ib.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var j=Ib.ShapeHighlighRealPoint.data;return[[j.x,j.y],Ig,Ig]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return vo}}}]};var ic=8;Ib.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var N=Ib.ShapeHighlighCtrlPoint.data,O=N.x,R=N.y,e=ic/2;return[O-e,R-e,O-e,R+e,O+e,R+e,O+e,R-e]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Ur.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Ur.getStyle("shapeCtrlPointBorderColor")||vo}}}]};var tq=3;Ib.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Ib.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:tq,borderColor:{func:function(){return Ur.getStyle("curveHighlightColor")}}}]},Ib.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Ib.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Ib.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Ib.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Ib.MoveLineGuide.data.center?yi:Mk}}}]};var Ci=5;Ib.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var s=Ib.MoveLineGuideDistanceH.data,k=s.x0,O=s.y0;return[k,O-Ci,k,O+Ci]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Mk},{type:"shape",points:{func:function(){var G=Ib.MoveLineGuideDistanceH.data,l=G.x1,B=G.y1;return[l,B-Ci,l,B+Ci]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Mk},{type:"text",text:{func:function(){return Math.round(Ib.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var B=Ib.MoveLineGuideDistanceH.data;return[[(B.x0+B.x1)/2,B.y0-10],20,20]}},color:Mk,font:"12px Arial",align:"center"}]},Ib.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var I=Ib.MoveLineGuideDistanceV.data,b=I.x0,$=I.y0;return[b-Ci,$,b+Ci,$]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Mk},{type:"shape",points:{func:function(){var z=Ib.MoveLineGuideDistanceV.data,N=z.x1,c=z.y1;return[N-Ci,c,N+Ci,c]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Mk},{type:"text",text:{func:function(){return Math.round(Ib.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var z=Ib.MoveLineGuideDistanceV.data;return[[z.x0-10,(z.y0+z.y1)/2],20,20]}},color:Mk,font:"12px Arial",align:"center"}]},a.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Ib.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var _=Ib.EdgeElevationGuide.data,N=_.x,B=_.y,m=Ur.getStyle("curveElevationIntersectSize"),h=Ur.getStyle("curveElevationGuideShift");return N+=h[0],B+=h[1],[N-m,B-m,2*m,2*m]}}}]},a.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),a.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Ib.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Ib.ConnectGuide.data.rotation}},rect:{func:function(){var Z=Ib.ConnectGuide.data.connect;Z.x,Z.y;var W=Ur.getStyle("connectGuideIntersectSize");return[[Z.x,Z.y],2*W,2*W]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var H=Ib.ConnectGuide.data.cursorPos||Ib.ConnectGuide.data.connect,A=Ur.getStyle("connectGuideIntersectSize");return[[H.x,H.y],2*A-2,2*A-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var i=Ib.ConnectGuide.data.connect,F=Ib.ConnectGuide.data.cursorPos||i;return[i.x,i.y,i.x+.5*(F.x-i.x),i.y,F.x+.5*(i.x-F.x),F.y,F.x,F.y]}}}]},a.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),a.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Ib.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var X=Ib.ConnectGuideGarbage.data.hover;return X?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var e=Ib.ConnectGuideGarbage.data,k=Ur.getStyle("connectGuideGarbageIntersectsize");return e.hover&&(k+=5),[[e.x,e.y],2*k,2*k]}}}]};var rp=6;Ib.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Ib.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var j=Ib.ShapeActivingCtrl.data;return[j.point.x,j.point.y,j.c1.x,j.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return vo}}},{type:"shape",visible:{func:function(){return Ib.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var N=Ib.ShapeActivingCtrl.data;return[N.point.x,N.point.y,N.c2.x,N.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return vo}}},{type:"shape",visible:{func:function(){return Ib.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var U=Ib.ShapeActivingCtrl.data.c1,u=U.x,k=U.y,r=rp/2;return"c1"===Ib.ShapeActivingCtrl.data.hl&&(r+=.5),[u-r,k-r,u-r,k+r,u+r,k+r,u+r,k-r]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Ur.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Ib.ShapeActivingCtrl.data.hl?Ur.getStyle("shapeCtrlPointHighlightBorder")||vo:Ur.getStyle("shapeCtrlPointBorderColor")||vo}}},{type:"shape",visible:{func:function(){return Ib.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var j=Ib.ShapeActivingCtrl.data.c2,q=j.x,T=j.y,Z=rp/2;return"c2"===Ib.ShapeActivingCtrl.data.hl&&(Z+=.5),[q-Z,T-Z,q-Z,T+Z,q+Z,T+Z,q+Z,T-Z]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Ur.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Ib.ShapeActivingCtrl.data.hl?Ur.getStyle("shapeCtrlPointHighlightBorder")||vo:Ur.getStyle("shapeCtrlPointBorderColor")||vo}}}]},Ib.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return vo}},rect:{func:function(){return[[Ib.RoundPoint.data.x,Ib.RoundPoint.data.y],Ej,Ej]}}}]},Ib.AttachPoint={comps:[{type:"rect",background:{func:function(){return Ib.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return vo}},rect:{func:function(){var Y=Ib.AttachPoint.data.isAttach?Ej+4:Ej;return[[Ib.AttachPoint.data.x,Ib.AttachPoint.data.y],Y,Y]}}}]},Ib.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Ib.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Ib.SimpleRect.data.color||vo}},rect:{func:function(){var o=Ib.SimpleRect.data;return[o.x,o.y,o.width,o.height]}}}]},a.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Ib.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var q=Ib.MoveDummy.data;return[[q.pos.x,q.pos.y],2*q.size,2*q.size]}}}]},vs.Icons.DrawIcon=function(f,P,z,$){z.width=z.height=im,z.data=$,Ur=f,a.Default.drawImage(P,z,0,0,im,im)},vs.Icons.MapPoints=function(v,e){for(var z=0,F=v.length;F>z;z++)v[z]/=e},vs.roundTo=function(f,r,s){var l=Math.abs(f%r);return s>l||s>r-l?r*Math.round(f/r):f},vs.toFixed=function(P){return Math.round(100*P)/100},vs.getDataMatrix=function(q){if(q instanceof a.Shape){var W=new a.Math.Matrix2d,l=q.getPosition();return W.translate(-l.x,-l.y).scale(q.getScale().x,q.getScale().y).rotate(q.getRotation()).translate(l.x,l.y),W}return q.getMatrix?q.getMatrix():new a.Math.Matrix2d};var Ac=vs.Math.Curve=function(){this._curves=[]};Ac.prototype={},Ac.prototype.constructor=Ac,Ac.prototype.createFromHtShape=function(i,C,h){C instanceof a.List&&(C=C.toArray());var _,n,k,S,P,D,z,y=this,j=null,V=null,Y=0,q=vs.Math.Vector2,U=vs.Math.CubicBezier,r=function(t){return new q(i[t],i[t+1],h?h[t/2]:l)};for(n=0,k=C.length;k>n;n++){switch(S=C[n],P=null,S){case 1:V=r(Y),j=V,Y+=2;break;case 2:_=r(Y),Y+=2,P=new U(V,V.clone(),_.clone(),_),V=_;break;case 3:D=r(Y),_=r(Y+2),Y+=4,P=new U(V,D.clone().sub(V).multiplyScalar(2/3).add(V),D.clone().sub(_).multiplyScalar(2/3).add(_),_),V=_;break;case 4:D=r(Y),z=r(Y+2),_=r(Y+4),Y+=6,P=new U(V,D,z,_),V=_;break;case 5:if(!j)break;P=new U(V,V.clone(),j.clone(),j),V=null,j=null}P&&(P._index=y._curves.length,y._curves.push(P))}},Ac.prototype.checkPoint=function(R,b){var z,W,Z,D,T,l=this,x=l._curves;for(z=0,W=x.length;W>z;z++)if(D=x[z],T=D.intersectRect(R,b,b),T.length)return Z=0,T.forEach(function(u){Z+=u.t}),Z/=T.length,R=D.getPointAt(Z),R.t=Z,{bezier:D,intersection:R}},Ac.prototype.insertKnot=function(Y,I){var W=Y.insertKnot(I),R=this,K=R._curves;K.splice(Y._index,1,W[0],W[1])},Ac.prototype._isCloseEnough=function(S,g){return Math.abs(S.x-g.x)<1e-6&&Math.abs(S.y-g.y)<1e-6},Ac.prototype._isSamePoint=function(U,o){return U===o},Ac.prototype.moveRealPoint=function(k,U){var b=this,z=b._curves,B=U.clone().sub(k);z.forEach(function(F){var _=F._p1;F._p2,F._p3;var W=F._p4;b._isSamePoint(_,k)&&(F._p2.add(B),F._p1=U),b._isSamePoint(W,k)&&(F._p3.add(B),F._p4=U)})},Ac.prototype.moveCtrlDueToRealPointMovement=function(E,A){var O=this,o=O._curves,M=function(U){U.add(A),U.e&&A.e&&(U.e+=A.e)};o.forEach(function(S){var B=S._p1;S._p2,S._p3;var z=S._p4;O._isSamePoint(B,E)&&M(S._p2),O._isSamePoint(z,E)&&M(S._p3)})},Ac.prototype.moveCtrlPoint=function(J,d,i){var L=J[i];if(L){L.e!==l&&(d.e=L.e);var S=this,j=S._curves;d.clone().sub(L),j.forEach(function(g){var I;"c2"===i?I="_p2":"c1"===i&&(I="_p3"),S._isSamePoint(g[I],L)&&(g[I]=d)}),J[i]=d}},Ac.prototype.deleteRealPoint=function(B,Q){var n,I,C,$,i,g,A,r=this,s=r._curves,j={},z=[],t=vs.Math.CubicBezier;for(I=0,C=s.length;C>I;I++)n=s[I],$=n._p1,i=n._p2,g=n._p3,A=n._p4,(j[I]||!r._isSamePoint($,B))&&(r._isSamePoint(A,B)?C>I+1&&r._isSamePoint(s[I+1]._p1,B)&&(Q||z.push(new t($,i,s[I+1]._p3,s[I+1]._p4))):z.push(n));r._curves=z},Ac.prototype.findPairs=function(q,t){var H,B,k,N,f,Z,h,o,K=this,A=K._curves,n={},E=[];for(B=0,k=A.length;k>B;B++)H=A[B],N=H._p1,f=H._p2,Z=H._p3,h=H._p4,!n[B]&&K._isSamePoint(N,q)&&(t?E.push({point:N,r2:h}):E.push({point:N,c2:f})),K._isSamePoint(h,q)&&(o=t?{point:h,r1:N}:{point:h,c1:Z},k>B+1&&K._isSamePoint(A[B+1]._p1,q)&&(t?o.r2=A[B+1]._p4:o.c2=A[B+1]._p2,n[B+1]=!0),E.push(o));return E},Ac.prototype.toHtShape=function(){var g=this,B=g._curves,Y=[],j=[],U={x:1/0,y:1/0};return B.forEach(function(c){var q=c._p1,H=c._p2,Q=c._p3,_=c._p4;return g._isCloseEnough(q,U)||(Y.push(1),j.push(q.clone())),U=_,g._isCloseEnough(q,H)&&g._isCloseEnough(Q,_)?(Y.push(2),j.push(_.clone()),void 0):(Y.push(4),j.push(H.clone(),Q.clone(),_.clone()),void 0)}),{segments:Y,points:j}};var Cq=vs.Math.CubicBezier=function(R,i,X,d){var $=this;$._id=vs.Math.CubicBezier._globalId++,$._p1=R,$._p2=i,$._p3=X,$._p4=d};Cq._globalId=1,Cq.prototype={},Cq.prototype.constructor=Cq,Cq.prototype.toString=function(){return this._id},Cq.prototype.intersectRect=function(Z,i,z){var B=i/2,h=z/2,I=Z.x,q=Z.y,V=vs.Math.Vector2,G=new V(-B+I,-h+q),s=new V(B+I,h+q),W=new V(s.x,G.y),S=new V(G.x,s.y),H=this,L=H.intersectLine(G,W),g=H.intersectLine(W,s),o=H.intersectLine(s,S),M=H.intersectLine(S,G),u=L.concat(g).concat(o).concat(M);
        return u},Cq.prototype.intersectLine=function(w,v){var z,Z,H,J,d,h,o,b,T,q,_,l,O,r=this,k=w.clone().min(v),p=w.clone().max(v);J=r._p1,d=r._p2,h=r._p3,o=r._p4,z=J.clone().multiplyScalar(-1),Z=d.clone().multiplyScalar(3),H=h.clone().multiplyScalar(-3),_=z.add(Z).add(H).add(o),z=J.clone().multiplyScalar(3),Z=d.clone().multiplyScalar(-6),H=h.clone().multiplyScalar(3),q=z.add(Z).add(H),z=J.clone().multiplyScalar(-3),Z=d.clone().multiplyScalar(3),T=z.add(Z),b=J.clone(),O=new vs.Math.Vector2(w.y-v.y,v.x-w.x),l=w.x*v.y-v.x*w.y;for(var s=r.getRoots(O.dot(_),O.dot(q),O.dot(T),O.dot(b)+l),$=new Array,c=0,N=s.length;N>c;c++){var x=s[c];if(!(0>x||x>1)){var S=J.clone().lerp(d,x),y=d.clone().lerp(h,x),m=h.clone().lerp(o,x),j=S.lerp(y,x),R=y.lerp(m,x),E=j.lerp(R,x);E.t=x,w.x==v.x?k.y<=E.y&&E.y<=p.y&&$.push(E):w.y==v.y?k.x<=E.x&&E.x<=p.x&&$.push(E):E.x>=k.x&&E.y>=k.y&&E.x<=p.x&&E.y<=p.y&&$.push(E)}}return $},Cq.prototype.solveTForPoint=function(R){var b,n,z,w,Q=this;b=Q._p1.x-R.x,n=Q._p2.x-R.x,z=Q._p3.x-R.x,w=Q._p4.x-R.x;for(var C=Q.getRoots(w-3*z+3*n-b,3*z-6*n+3*b,3*n-3*b,b),E=l,s=1/0,y=0,v=C.length;v>y;y++){var G=C[y];if(!(0>G||G>1)){var I=Q._p1.clone().lerp(Q._p2,G),$=Q._p2.clone().lerp(Q._p3,G),t=Q._p3.clone().lerp(Q._p4,G),A=I.lerp($,G),S=$.lerp(t,G),p=A.lerp(S,G);p.t=G;var c=Math.abs(p.y-R.y);s>c&&(s=c,E=p)}}return E},Cq.prototype.getPointAt=function(V){var i=this,F=i._p1,b=i._p2,E=i._p3,x=i._p4,R=F.clone().lerp(b,V),v=b.clone().lerp(E,V),U=E.clone().lerp(x,V),e=R.lerp(v,V),H=v.lerp(U,V);return e.lerp(H,V)},Cq.prototype.getRoots=function($,s,p,v){var b,H,h,m,Y,G=new Array;if(Math.abs($)<1e-6){var b=s,H=p/b,h=v/b,m=H*H-4*h;if(m>0){var Y=Math.sqrt(m);G.push(.5*(-H+Y)),G.push(.5*(-H-Y))}else 0==m&&G.push(.5*-H)}s/=$,p/=$,v/=$,b=(3*p-s*s)/3,H=(2*s*s*s-9*p*s+27*v)/27;var y=s/3,t=H*H/4+b*b*b/27,n=H/2;if(Math.abs(t)<=1e-6&&(t=0),t>0){var Z,L,Y=Math.sqrt(t);Z=-n+Y,L=Z>=0?Math.pow(Z,1/3):-Math.pow(-Z,1/3),Z=-n-Y,Z>=0?L+=Math.pow(Z,1/3):L-=Math.pow(-Z,1/3),G.push(L-y)}else if(0>t){var I=Math.sqrt(-b/3),u=Math.atan2(Math.sqrt(-t),-n)/3,j=Math.cos(u),q=Math.sin(u),D=Math.sqrt(3);G.push(2*I*j-y),G.push(-I*(j+D*q)-y),G.push(-I*(j-D*q)-y)}else{var Z;Z=n>=0?-Math.pow(n,1/3):Math.pow(-n,1/3),G.push(2*Z-y),G.push(-Z-y)}return G},Cq.prototype._70I=function(){var $=this;return $._p1.distanceToSquared($._p2)<1e-10&&$._p3.distanceToSquared($._p4)<1e-10},Cq.prototype.insertKnot=function(p){var b=this,q=b._p1,H=b._p2,Y=b._p3,s=b._p4,W=q.clone().lerp(H,p),F=H.clone().lerp(Y,p),L=Y.clone().lerp(s,p),P=W.clone().lerp(F,p),g=F.clone().lerp(L,p),R=P.clone().lerp(g,p);return b._70I()?(q.clone().lerp(s,p),[new vs.Math.CubicBezier(q,q.clone(),R.clone(),R),new vs.Math.CubicBezier(R,R.clone(),s.clone(),s)]):[new vs.Math.CubicBezier(q,W,P,R),new vs.Math.CubicBezier(R,g,L,s)]};var Ve=a.Default.getInternal().ui().EdgeUI,Ep={_47O:function(N){var h=this,b=Ep.getBackups()._47O;vs.inEdit(h.gv)||b.call(h,N)}};vs.Inject.registAsModule(Ep,Ve);var nc=a.Default.getInternal().ui().NodeUI,Dp={_47O:function(S){var E=this,W=Dp.getBackups()._47O;vs.inEdit(E.gv)||W.call(E,S)},getSelectWidth:function(){var G=this,d=G.gv,E=G._data;if(d.isEditable(E)&&vs.inEdit(d))return 0;var P=Dp.getBackup("getSelectWidth");return P.call(G)}};vs.Inject.registAsModule(Dp,nc);var Eg=a.graph.GraphView,Hc={_editPointSize:function(){var e=a.Default.isTouchable,B=vs.getStyle("pointSize");return B[e?0:1]}(),isPointEditable:function(u){var E=this;if(vs.inEdit(E))return E._pointEditableFunc?E._pointEditableFunc(u):!0;var G=Hc.getBackup("isPointEditable");G.call(E,u)},isEditable:function(z){var N,D=this,h=Hc.getBackup("isEditable");if(N=z instanceof vs.Group?!0:h.call(D,z),!vs.inEdit(D))return N;if(!(z instanceof a.Edge))return N;if(!z.s("2d.editable"))return!1;var A=D.getEditableFunc();return A?A(z):!0},_42:function(_,T){var S=this,B=Hc.getBackups()._42;if(B.call(S,_,T),vs.inEdit(S)){var Z=S.getEditInteractor();Z.drawImpl()}}};vs.Inject.registAsModule(Hc,Eg);var ln=a.Default.getInternal().ui().ShapeUI,yp={_47O:function(k){var E=this,y=yp.getBackups()._47O;vs.inEdit(E.gv)||y.call(E,k)}};vs.Inject.registAsModule(yp,ln);var Jh=a.graph.DefaultInteractor,In={handle_mousewheel:function(R){var k=this,z=In.getBackup("handle_mousewheel");vs.inEdit(k.gv)||z.call(k,R)}};vs.Inject.registAsModule(In,Jh);var $m=a.graph.MoveInteractor,ps={_calcShift:function(N,R){var _=this,s=ps.getBackup("_calcShift"),t=_.gv;if(!vs.inEdit(t))return s.call(_,N,R);var C=t.getEditInteractor(),o=C.getSubModule("Move").calcShift(N,R,_);return o||s.call(_,N,R)},clear:function(R){var T=this,j=ps.getBackup("clear");j.call(T,R);var K=T.gv;if(vs.inEdit(K)){var B=K.getEditInteractor();B.getSubModule("Move").clear(R)}}};vs.Inject.registAsModule(ps,$m);var bs=vs.Rect=function(E){this.catalog="Rect",this._interactor=E};bs.prototype={},bs.prototype.constructor=bs,bs.prototype.gatherInfo=function(q,x){var N=this;if(1===x.length){var z=x[0];return z instanceof a.Shape&&z._70I()?N.gatherLine(q,z):Rm(z,q)?!1:N.gatherSingleTarget(q,z)}return x.length>1?N.gatherMultiTargets(q,x):!1},bs.prototype.gatherSingleTarget=function(v,u){if(u.getCorners){var G,k=this,b=k.info;k.target=u,G=k.screenInfo={};var T=u.getCorners();b.LT=new vs.Math.Vector2(T[0]),b.LB=new vs.Math.Vector2(T[1]),b.RB=new vs.Math.Vector2(T[2]),b.RT=new vs.Math.Vector2(T[3]),b.T=b.LT.clone().add(b.RT).divideScalar(2),b.B=b.LB.clone().add(b.RB).divideScalar(2),b.L=b.LT.clone().add(b.LB).divideScalar(2),b.R=b.RT.clone().add(b.RB).divideScalar(2);for(var W in b)G[W]=vs.toScreenPosition(v,b[W]);var f=k._interactor,C=f.getStyle("checkSize"),_=function(J,$,D){var o=$.clone().sub(J).setLength(-C),w=D.clone().sub(J).setLength(-C),K=o.add(w).add(J);return K};return G.rotLT=_(G.LT,G.RT,G.LB),G.rotLB=_(G.LB,G.LT,G.RB),G.rotRB=_(G.RB,G.LB,G.RT),G.rotRT=_(G.RT,G.LT,G.RB),G.rotT=G.rotLT.clone().add(G.rotRT).divideScalar(2),G.rotB=G.rotLB.clone().add(G.rotRB).divideScalar(2),G.rotL=G.rotLT.clone().add(G.rotLB).divideScalar(2),G.rotR=G.rotRT.clone().add(G.rotRB).divideScalar(2),G.rotation=u.getRotation(),k.gatherConnectInfo(),!0}},bs.prototype.gatherConnectInfo=function(){var O=this,L=O.target,w=O._interactor,z=O.screenInfo,I=w.gv;if(I.isConnectActionVisible(L)&&w.getStyle("connectGuideVisible")){var d;L.s&&(d=L.s("connectGuideShift")),d||(d=w.getStyle("connectGuideShift"));var J=L.getAnchor(),X=L.getSize(),x=L.toGlobal({x:X.width*(d[0]-J.x),y:X.height*(d[1]-J.y)});x=vs.toScreenPosition(I,x),z.P1?x.add(z.P2.clone().sub(z.P1).setLength(d[2])):(x.add(z.RT.clone().sub(z.LT).setLength(d[2])),x.add(z.LB.clone().sub(z.LT).setLength(d[3]))),z.connect=x}},bs.prototype.gatherMultiTargets=function(o,v){var i=vs.Group.findOrCreateGroup(v);if(!i)return!1;var H=this;return H.editing&&"rotate"!==H.editing.mode||i.calcInfo(),H.gatherSingleTarget(o,i)},bs.prototype.gatherLine=function(U,F){this.target=F;var y=this.screenInfo={},z=F.getPoints(),C=vs.getDataMatrix(F);return y.P1=vs.toScreenPosition(U,C.apply(z.get(0))),y.P2=vs.toScreenPosition(U,C.apply(z.get(1))),this.gatherConnectInfo(),!0},bs.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],bs.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],bs.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],bs.prototype.check=function(E,Q,F){if(a.Default.isLeftButton(Q)){var A=this;if(A.editing=null,A.tipInfo=null,A.screenInfo){var h=A.target,H=E.isEditable(h),n=A.screenInfo;if(H&&n.connect){var $=A._checkConnect(F);if($)return $}if(n.P1)return A._checkLine(F);var J,Y,d,u=null,S=A._interactor,W=S.getStyle("checkSize");if(H&&E.isRectEditable(h))for(Y=0;Y<vs.Rect.ResizeKeys.length;Y++)if(d=vs.Rect.ResizeKeys[Y],vs.checkHit(F,n[d],W)){u=d,J="resize";break}if(!u&&H&&E.isRotationEditable(h)&&!S.getStyle("rotateAsClock")){var O=S.getStyle("rotateCheckSize");for(Y=0;Y<vs.Rect.RotateKeys.length;Y++)if(d=vs.Rect.RotateKeys[Y],vs.checkHit(F,n[d],O)){u=d,J="rotate";break}}if(!u)return S.setCursor("default"),void 0;if("rotate"===J){var I,k=E.lp(Q);if(h instanceof vs.Group){var p=S.getStyle("groupRotateModeKey");"string"==typeof p&&(p=[p]);for(var c=!1,b=0,i=p.length;i>b;b++)if(Q[p[b]]){c=!0;break}var K=S.getStyle("groupRotateModeDefault");I=c?"batch"===K?"block":"batch":K}var Z="batch"===I?h.getAnchor2():h.getPosition(),N=Math.atan2(k.y-Z.y,k.x-Z.x);S._setRotateCursor(N),A.editing={mode:J,key:u,pos:Z,flipY:h.getScale().y<0,rotation:h.getRotation(),hitRot:N},I&&(A.editing.groupRotateMode=I)}else{var M=vs.Rect.ResizeKeys.indexOf(u),j=vs.Rect.ResizeDirection[M],P=Math.cos(h.getRotation()),U=Math.sin(h.getRotation()),g=j.x*Math.sign(h.getScale().x),_=j.y*Math.sign(h.getScale().y),C=Math.atan2(-U*g-P*_,P*g-U*_),v=(Math.round(C/(Math.PI/4))+8)%8,l=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][v];this._interactor.setCursor(l);var o=h.getWidth(),D=h.getHeight(),R=h.getAnchor();A.editing={mode:J,key:u,rect:{x:-o*R.x,y:-D*R.y,width:o,height:D},anchor:R,matrix:h.getMatrix()}}return u}}},bs.prototype._checkLine=function(C){var R=this;R.screenInfo;var w,O=R._interactor.getStyle("checkSize");if(vs.checkHit(C,R.screenInfo.P1,O))w="P1";else{if(!vs.checkHit(C,R.screenInfo.P2,O))return this._interactor.setCursor("default"),void 0;w="P2"}return R.editing={mode:"line",key:w},w},bs.prototype._checkConnect=function(Y){var g=this,z=g.screenInfo,x=g._interactor,U=x.getStyle("connectGuideIntersectSize"),_=z.connect,s=Y.x,a=_.x;if(a>s&&U>a-s&&Math.abs(_.y-Y.y)<U||s>=a&&vs.checkHit(Y,_,U)){var u="connect",$=A.getConnectAction(x.gv);if(g.editing={mode:u},$&&$.delete)if(g.target instanceof vs.Group){var y=!0;x.gv.sm().getSelection().each(function(D){$.delete.visible.call(null,x.gv,D)||(y=!1)}),g.editing.hasDeleteAction=y}else $.delete.visible.call(null,x.gv,g.target)&&(g.editing.hasDeleteAction=!0);return x.setCursor("default"),u}},bs.prototype._fireEditEvent=function(q,v){var O=this._interactor,X=this.editing;if(X){var M=X.mode;M="rotate"===M?"Rotation":"connect"===M?"Connection":"resize"===M?"Rect":M[0].toUpperCase()+M.slice(1),O.fi({kind:q+"Edit"+M,event:v})}},bs.prototype.startEdit=function(u,I){u.startDragging(I);var h=this;h._interactor.fi({kind:"prepareEdit",event:I});var W=h.editing,i=h.target;if(W){if(h._fireEditEvent("begin",I),"rotate"===W.mode)return W.groupRotateMode&&i.beginRotate(W),void 0;if("connect"!==W.mode)("line"===W.mode||i&&0===i.getRotation())&&(h._inSmartGuide=!0,h._interactor.rectGuide.gatherRects());else if(W.hasDeleteAction){var e=u.gv,P=h._interactor.getStyle("connectGuideGarbageShift");W.garbageInfo={x:e.getWidth()*P[0]+P[2],y:e.getHeight()*P[1]+P[3],size:h._interactor.getStyle("connectGuideGarbageIntersectsize")},u._42()}}},bs.prototype._46O=function(s){var H,g,t=this,I=t.editing,w=t.target;if(I){if("connect"===I.mode&&!I.canceled&&!I.deleted)try{I.garbageInfo&&I.garbageInfo.hover?A.doDeleteConnectionAction(t._interactor.gv,w):A.doConnectAction(t._interactor.gv,w,I.target)}catch(X){console.error(X)}g=I.freezeFlag,H=t.editing.groupRotateMode,t._fireEditEvent("end",s),t.editing=null}t.tipInfo=null,t._inSmartGuide&&(t._interactor.rectGuide.clear(),t._inSmartGuide=!1),H&&w&&w.endRotate(),w instanceof a.Block&&(g===l?delete w._freezeSyncFromChildren:w._freezeSyncFromChildren=g,w.updateFromChildren())},bs.prototype.handleNormalStateDelete=function(){var b=this,a=b.editing;if(a&&"connect"===a.mode&&!a.canceled&&!a.deleted){if(a.garbageInfo){try{A.doDeleteConnectionAction(b._interactor.gv,b.target)}catch(T){console.error(T)}a.garbageInfo=null}return a.cursorPos=null,a.targetCorners=null,a.deleted=!0,b._interactor._42(),!0}},bs.prototype.handleNormalStateKeyDown=function($){var C=this,u=C.editing;return!u||"connect"!==u.mode||u.canceled||u.deleted?void 0:a.Default.isEsc($)?(u.cursorPos=null,u.targetCorners=null,u.canceled=!0,C._interactor._42(),!0):void 0},bs.prototype.handleEdit=function(z,t){var _=this,G=_.editing;if(G){var I,Q,j,N,o,u=_.target,x=G.key,O=G.mode,A=z.lp(t),V=_._interactor;if("connect"===O){if(G.canceled)return;if(G.deleted)return;G.cursorPos=V._getLogicalPoint(t);var y=G.garbageInfo;return y&&vs.checkHit(G.cursorPos,y,y.size)?(y.hover=!0,G.target=null,G.targetCorners=null):(y&&(y.hover=!1),G.target=z.getDataAt(A,function(X){return z.isSelectable(X)?Pr(X)?!0:!1:!1})||null,G.targetCorners=vs.getTargetCornersOnScreen(z,G.target)),V._42(),void 0}if("rotate"===O){var J,U,h=G.pos,W=Math.atan2(A.y-h.y,A.x-h.x);if(G.groupRotateMode?U=W-G.hitRot:(J=W-G.hitRot,U=G.rotation+J),U%=2*Math.PI,0>U&&(U+=2*Math.PI),!a.Default.isCtrlDown(t)){var i,P;_d(t)?(i=V.getStyle("shiftRotateRound"),P=i/2):(i=V.getStyle("rotateRound"),P=V.getStyle("rotateSensitivity")),U=vs.roundTo(U,i,P)}G.groupRotateMode?(J=U-(G.lastRotation||0),0!==J&&(u.addRotation(J,G.groupRotateMode,function(h){return z.isRotationEditable(h)}),G.lastRotation=U)):u.setRotation(U),V._setRotateCursor(W),U>Math.PI&&(U-=2*Math.PI);var K=180*(U/Math.PI);K=K.toFixed(2),I=""+K+""}else if("resize"===O){var v=G.rect;j=v.x,N=v.y;var Y,e=v.width,X=v.height,c=G.anchor,H=G.matrix,f=u.s&&u.s("keepAspectRatio")||V.getStyle("keepAspectRatio");_d(t)&&(f=!f);var n=_._unionPointMode1,d=_._unionPointMode2;if(_._inSmartGuide&&!a.Default.isCtrlDown(t)&&!f){var w;"L"===x||"R"===x?w="x":("T"===x||"B"===x)&&(w="y"),_._adsorbedToClosest(A,w),o=!0}Y=H.tfi(A);var g;"LT"===x?(v=n(Y,{x:j+e,y:N+X},e,X,f),g=9):"T"===x?(v=d({x:j,y:Y.y},{x:j+e,y:N+X},e,X,f,"v"),g=1):"RT"===x?(v=n(Y,{x:j,y:N+X},e,X,f),g=33):"L"===x?(v=d({x:Y.x,y:N},{x:j+e,y:N+X},e,X,f,"h"),g=8):"R"===x?(v=d({x:j,y:N},{x:Y.x,y:N+X},e,X,f,"h"),g=32):"LB"===x?(v=n(Y,{x:j+e,y:N},e,X,f),g=12):"B"===x?(v=d({x:j,y:N},{x:j+e,y:Y.y},e,X,f,"v"),g=4):"RB"===x&&(v=n(Y,{x:j,y:N},e,X,f),g=36);var r=H.tf(v.x+v.width*c.x,v.y+v.height*c.y);u instanceof a.Block&&(G.hasOwnProperty("freezeFlag")||(G.freezeFlag=u._freezeSyncFromChildren,u._freezeSyncFromChildren=!0)),u.setPosition(r),u.setSize(v.width,v.height),o&&(Q=u.getRect(),V.rectGuide.gatherLines({node:u,x:Q.x,y:Q.y,w:Q.width,h:Q.height},w,g)),I=""+Math.round(v.width)+" * "+Math.round(v.height)}else if("line"===O){if(_d(t)){var k=u.getPoints(),l="P1"===x?k.get(1):k.get(0),S={x:A.x-l.x,y:A.y-l.y},b=V.getStyle("shiftLineRotateRound"),C=_._shiftDirList;if(!C||_._shiftRotateRound!==b){_._shiftRotateRound=b,_._shiftDirList=C=[];for(var q=0;q<Math.PI;q+=b)C.push({x:E(q),y:m(q)})}for(var s,D=0,B=0,$=C.length;$>B;B++){var M=C[B],L=M.x*S.x+M.y*S.y;Math.abs(L)>Math.abs(D)&&(D=L,s=M)}A={x:l.x+s.x*D,y:l.y+s.y*D},V.rectGuide.clear()}else _._inSmartGuide&&!a.Default.isCtrlDown(t)&&(_._adsorbedToClosest(A),o=!0);var F=vs.getDataMatrix(u).applyInverse(A);u.setPoint("P1"===x?0:1,F,!0);var Z=u.getPoints(),p=Z.get(0),T=Z.get(1);j=p.x-T.x,N=p.y-T.y,I=" "+Math.round(Math.sqrt(j*j+N*N))+" ",o&&(Q=u.getRect(),V.rectGuide.gatherLines({node:u,x:Q.x,y:Q.y,w:Q.width,h:Q.height}))}if(I){var R=a.Default.getLogicalPoint(t,V._canvas);R.x+=vs.Icons.TipShiftX,R.y+=vs.Icons.TipShiftY,_.tipInfo={helperPos:R,text:I,size:I.length}}_._fireEditEvent("between",t)}},bs.prototype._unionPointMode1=function(o,D,G,b,B){if(B&&G&&b){var i=o.x-D.x,K=o.y-D.y;Math.abs(i*b)<Math.abs(K*G)?(K=Math.sign(K)*Math.abs(i*b/G),o.y=D.y+K):(i=Math.sign(i)*Math.abs(K*G/b),o.x=D.x+i)}return a.Default.unionPoint(o,D)},bs.prototype._unionPointMode2=function($,r,H,Z,j,L){var w=a.Default.unionPoint($,r);if(j&&H&&Z){var Y;"v"===L?(Y=w.x+w.width/2,w.width=H*w.height/Z,w.x=Y-w.width/2):(Y=w.y+w.height/2,w.height=Z*w.width/H,w.y=Y-w.height/2)}return w},bs.prototype._adsorbedToClosest=function(w,s){var q=this,T=q._interactor,G=T.rectGuide.findClosest(w,s),c=T.gridGuide.findClosest(w,s),F=1/0,i=1/0;G&&(isFinite(G.x)&&(F=G.x),isFinite(G.y)&&(i=G.y)),c&&(isFinite(c.x)&&Math.abs(c.x)<Math.abs(F)&&(F=c.x),isFinite(c.y)&&Math.abs(c.y)<Math.abs(i)&&(i=c.y)),isFinite(F)&&(w.x+=F),isFinite(i)&&(w.y+=i)},bs.prototype._42=function(O,H,b){var r=this;r.info={},r.screenInfo=null;var E=r._interactor;if(!E.editDetail&&r.gatherInfo(H,b)){var V=r.editing,q=V?V.groupRotateMode:null,z=r.screenInfo;if("block"!==q){if(z.P1?vs.Icons.DrawIcon(E,O,vs.Icons.Line,z):vs.Icons.DrawIcon(E,O,vs.Icons.Rect,z),z.connect&&(vs.Icons.DrawIcon(E,O,vs.Icons.ConnectGuide,{rotation:z.rotation,connect:z.connect,cursorPos:V?V.cursorPos:null}),V)){if(V.targetCorners){for(var n={x:1/0,y:1/0},S={x:-1/0,y:-1/0},I=0,i=V.targetCorners.length;i>I;I+=2)n.x=Math.min(n.x,V.targetCorners[I]),S.x=Math.max(S.x,V.targetCorners[I]),n.y=Math.min(n.y,V.targetCorners[I+1]),S.y=Math.max(S.y,V.targetCorners[I+1]);vs.Icons.DrawIcon(E,O,vs.Icons.HoverDataRect,{min:n,max:S,color:E.getStyle("hoverGuideColor")||E.getStyle("baseColor")})}V.garbageInfo&&vs.Icons.DrawIcon(E,O,vs.Icons.ConnectGuideGarbage,V.garbageInfo)}r.tipInfo&&vs.Icons.DrawIcon(E,O,vs.Icons.TipHelper,r.tipInfo)}r.target instanceof vs.Group&&r.target._42(E,O,H)}};var Sk=vs.Anchor=function(r){this.catalog="Anchor",this._interactor=r};Sk.prototype={},Sk.prototype.constructor=Sk,Sk.prototype.gatherInfo=function(O,f){var o=this;if(1===f.length){var w=f[0];if(!w.getAnchor)return;if(w instanceof a.Shape&&w._70I())return;if(Rm(w,O))return;return o.gatherSingleTarget(O,f[0])}return f.length>1?o.gatherMultiTargets(O,f):!1},Sk.prototype.gatherSingleTarget=function(A,X){var F=this;return F.info.POS=X.getPosition(),F.screenInfo.POS=vs.toScreenPosition(A,F.info.POS),F.target=X,!0},Sk.prototype.gatherMultiTargets=function(A,u){var v=this,b=vs.Group.findOrCreateGroup(u);return b?(v.screenInfo.POS=vs.toScreenPosition(A,b.getAnchor2()),v.target=b,!0):!1},Sk.prototype.isVisible=function(){var M=this,Q=M._interactor;if(Q.getStyle("anchorVisible")===!1)return!1;var p=M.target;if(p){if(this.editing)return!0;var P=p.getAnchor(),X=Q.getStyle("anchorOutsideVisibleThreshold");if(P.x<-X||P.x>1+X||P.y<-X||P.y>1+X)return!0;var V=p.getSize(),f=p.getScale(),T=Math.min(Math.abs(V.width*f.x),Math.abs(V.height*f.y));if(T*Q.gv._zoom<Q.getStyle("anchorHideThreshold"))return!1}return!0},Sk.prototype.check=function(M,G,b){if(a.Default.isLeftButton(G)){var K=this,f=K._interactor;if(K.isVisible()&&f.getStyle("anchorMovable")!==!1){K.editing=null,K.tipInfo=null;var O=K.target;if(O&&M.isAnchorEditable(O)&&M.isEditable(O)){var s;if(K.screenInfo&&(s=K.screenInfo.POS)&&vs.checkHit(b,new vs.Math.Vector2(s),f.getStyle("checkSize"))){if(O instanceof vs.Group)return K.editing={},!0;var L=O.getWidth(),S=O.getHeight(),u=O.getAnchor();return K.editing={rect:{x:-L*u.x,y:-S*u.y,width:L,height:S},anchor:u,matrix:O.getMatrix()},!0}}}}},Sk.prototype.startEdit=function(r,y){r.startDragging(y),r.fi({kind:"beginEditAnchor",event:y})},Sk.prototype._46O=function(j){var r=this;r.editing&&(r.editing=null,r._interactor.fi({kind:"endEditAnchor",event:j})),r.tipInfo=null},Sk.prototype.handleEdit=function(B,T){var t=this,D=t.target;if(D){var e=t.editing;if(e){var I=B.lp(T),f=t._interactor;if(D instanceof vs.Group)return D.setAnchor2(I),f._42(),void 0;var R=e.matrix,m=R.tfi(I),x=e.rect,N=(m.x-x.x)/x.width,d=(m.y-x.y)/x.height;if(!a.Default.isCtrlDown(T)){var X=f.getStyle("anchorRound"),F=f.getStyle("anchorSensitivity");N=vs.roundTo(N,X,F),d=vs.roundTo(d,X,F)}D.setAnchor(N,d,!0);var C=a.Default.getLogicalPoint(T,f._canvas);C.x+=vs.Icons.TipShiftX,C.y+=vs.Icons.TipShiftY;var E=""+N.toFixed(2)+", "+d.toFixed(2);t.tipInfo={helperPos:C,text:E,size:E.length},f.fi({kind:"betweenEditAnchor",event:T})}}},Sk.prototype._42=function(O,L,h){var A=this;A.info={},A.screenInfo={};var z=A._interactor;z.editDetail||A.gatherInfo(L,h)&&A.isVisible()&&(vs.Icons.DrawIcon(z,O,vs.Icons.Anchor,A.screenInfo),A.tipInfo&&vs.Icons.DrawIcon(z,O,vs.Icons.TipHelper,A.tipInfo))};var ug=vs.MoveDummy=function(T){this.catalog="MoveDummy",this._interactor=T};ug.prototype={},ug.prototype.constructor=ug,ug.prototype.gatherInfo=function(){var M=this,R=this._interactor.getSubModule("Rect");if(R){var D=R.screenInfo;if(D){var J=M._interactor,d=M.getMovableTarget(R.target);if(d){var r=J.getStyle("moveDummyThreshold");if(r!==!1){var O=D.LT||D.P1,E=D.RT||D.P2,P=D.LB||O;if(O){var v=D.P1,Z=Math.min(O.distanceTo(P),O.distanceTo(E));if(!(r!==!0&&Z>r)){var b=J.getStyle("moveDummyPosition"),B=E.clone().sub(O),f=P.clone().sub(O),K=b[2],l=b[3];if(v){var x=J.getStyle("moveDummyLineExtraShift");x&&(K+=x[0],l+=x[1])}var g=O.clone().add(B.clone().multiplyScalar(b[0])).add(B.setLength(K)).add(f.clone().multiplyScalar(b[1])).add(f.setLength(l));return M.screenInfo.pos=g,M.screenInfo.size=J.getStyle("moveDummySensitivity"),!0}}}}}}},ug.prototype.getMovableTarget=function(J){var c=this._interactor.gv;if(Pr(J)){if(c.isMovable(J))return J}else if(J instanceof vs.Group)for(var $=J._entities,F=$.length-1;F>=0;F--){var k=$[F];if(Pr(k)&&c.isMovable(k))return k}return null},ug.prototype.getMoveInteractor=function(){for(var N,D,M,U=this._interactor.gv,z=U.getInteractors(),N=0,D=z.length;D>N;N++)if(M=z.get(N),M instanceof $m)return M},ug.prototype.startEdit=function(r,z){r.startDragging(z);var B=this.getMoveInteractor();if(B){var G=this.selectedTarget,J=r.gv;J._moving=1,B._data=G,J.handleMouseDown&&J.handleMouseDown(z,G)}},ug.prototype._46O=function(h){var o=this,B=o.getMoveInteractor();B&&(B.handleWindowMouseUp(h),o.selectedTarget=null)},ug.prototype.handleEdit=function(y,h){var B=this.getMoveInteractor();B&&B.handleWindowMouseMove(h)},ug.prototype.check=function(W,r,B){if(this.selectedTarget=null,a.Default.isLeftButton(r)&&!W._scrolling&&!nb()){var V=this;if(V.screenInfo){var b=V.screenInfo.pos;if(b&&!(B.distanceTo(b)>V.screenInfo.size)){var k=V._interactor;return V.selectedTarget=V.getMovableTarget(k.getSubModule("Rect").target),k.setCursor("default"),!0}}}},ug.prototype._42=function(Z,h,_){var l=this;l.screenInfo={};var x=l._interactor;x.editDetail||l.gatherInfo(h,_)&&(!x.editing||l.selectedTarget)&&vs.Icons.DrawIcon(x,Z,vs.Icons.MoveDummy,l.screenInfo)};var Nq=vs.RotateX=function(t){this.catalog="RotateX",this._interactor=t};Nq.prototype={},Nq.prototype.constructor=Nq,Nq.prototype.gatherInfo=function(i,S){var U=this;if(1===S.length){var $=S[0];return $ instanceof a.Shape&&$._70I()||Rm($,i)?!1:U.gatherSingleTarget(i,$)}return S.length>1?U.gatherMultiTargets(i,S):!1},Nq.prototype.gatherSingleTarget=function(){var W=new a.Math.Vector2,T=new a.Math.Vector2,P=new a.Math.Vector2,L=new a.Math.Vector2,M=function(p,j){var i=p.x-j.x,B=p.y-j.y;return i*i+B*B};return function(i,p){if(p.getCorners){var E=this,R=p.getCorners(),y=15,F=p.getPosition();W.copy(R[0]),P.copy(R[1]),L.copy(R[3]),T.copy(W).add(L).divideScalar(2).add(W.sub(P).setLength(y/i.getZoom()));var l=Math.max(M(F,R[0]),M(F,R[1]),M(F,R[2]),M(F,R[3]));return E.info.POS=T.clone(),E.screenInfo.POS=vs.toScreenPosition(i,E.info.POS),E.screenInfo.LEN=Math.sqrt(l)*i.getZoom()+y,E.screenInfo.CENTER=vs.toScreenPosition(i,F),E.target=p,!0}}}(),Nq.prototype.gatherMultiTargets=function(Z,u){var j=this,e=vs.Group.findOrCreateGroup(u);if(!e)return!1;var j=this;return j.gatherSingleTarget(Z,e)},Nq.prototype.isVisible=function(){var i=this._interactor;if(!i.getStyle("rotateAsClock"))return!1;var n=this.target;if(!n)return!0;var a=i.gv;return a.isEditable(n)&&a.isRotationEditable(n)?!0:!1},Nq.prototype.check=function(s,S,K){var X=this,$=X._checkImpl(s,S,K);return($||X._clockPainted)&&X._interactor._42(),$},Nq.prototype._checkImpl=function(V,k,O){if(a.Default.isLeftButton(k)){var C=this;C.editing=null,C.tipInfo=null;var p;if(C.screenInfo&&(p=C.screenInfo.POS)&&C.isVisible()){var T=C._interactor;if(vs.checkHit(O,p,T.getStyle("checkSize"))){var b=C.target,n=V.lp(k),q=b.getPosition(),z=Math.atan2(n.y-q.y,n.x-q.x);return T._setRotateCursor(z),C.editing={pos:q,rotation:b.getRotation(),hitRot:z,groupRotateMode:"block",screenInfo:{CENTER:C.screenInfo.CENTER,LEN:C.screenInfo.LEN}},!0}}}},Nq.prototype.startEdit=function(Q,D){Q.startDragging(D),Q.fi({kind:"beginEditRotation",event:D}),this.target instanceof vs.Group&&this.target.beginRotate(this.editing)},Nq.prototype._46O=function(V){var A=this;A.editing&&(A.editing=null,A._interactor.fi({kind:"endEditRotation",event:V})),A.target instanceof vs.Group&&A.target.endRotate(),A.tipInfo=null},Nq.prototype.handleEdit=function(Z,K){var W=this,l=W.editing;if(l){var G,S,N=W.target,C=Z.lp(K),z=W._interactor,v=l.pos,p=Math.atan2(C.y-v.y,C.x-v.x),b=N instanceof vs.Group;if(b?S=p-l.hitRot:(G=p-l.hitRot,S=l.rotation+G),S%=2*Math.PI,0>S&&(S+=2*Math.PI),!a.Default.isCtrlDown(K)){var n,M;_d(K)?(n=z.getStyle("shiftRotateRound"),M=n/2):(n=z.getStyle("rotateRound"),M=z.getStyle("rotateSensitivity")),S=vs.roundTo(S,n,M)}b?(G=S-(l.lastRotation||0),0!==G&&(N.addRotation(G,l.groupRotateMode,function(i){return Z.isRotationEditable(i)}),l.lastRotation=S)):N.setRotation(S),z._setRotateCursor(p),S>Math.PI&&(S-=2*Math.PI);var Q=180*(S/Math.PI),Y=""+Q.toFixed(2)+"",_=a.Default.getLogicalPoint(K,z._canvas);_.x+=vs.Icons.TipShiftX,_.y+=vs.Icons.TipShiftY,W.tipInfo={helperPos:_,text:Y,size:Y.length},z.fi({kind:"betweenEditRotation",event:K})}},Nq.prototype._42=function(z,N,I){var r=this;r._clockPainted=!1,r.info={},r.screenInfo={};var w=r._interactor;w.editDetail||r.gatherInfo(N,I)&&r.isVisible()&&(vs.Icons.DrawIcon(w,z,vs.Icons.RoundPoint,r.screenInfo.POS),r.tipInfo&&vs.Icons.DrawIcon(w,z,vs.Icons.TipHelper,r.tipInfo),r.editing&&r.drawClock(z))},Nq.prototype.drawClock=function(n){n.save();var S=this;S._clockPainted=!0;var P=S.editing||{},F=P.screenInfo||S.screenInfo,C=F.LEN,v=C+8,R=C+18;n.save(),n.translate(F.CENTER.x,F.CENTER.y),n.beginPath(),n.strokeStyle="rgb(150, 150, 150)";for(var V,i,t,d,z,u=0;360>u;u++)V=u*Math.PI/180,0===u%5&&(i=m(V)*C,t=E(V)*C,d=m(V)*v,z=E(V)*v,n.moveTo(i,t),n.lineTo(d,z)),0===u%45&&(i=m(V)*C,t=E(V)*C,d=m(V)*R,z=E(V)*R,n.moveTo(i,t),n.lineTo(d,z));n.stroke(),n.rotate(-x);var e=P.lastRotation||S.target.getRotation();n.beginPath(),n.fillStyle="rgba(255, 0, 0, 0.1)",n.strokeStyle="rgb(157, 157, 157)",n.moveTo(0,0),n.arc(0,0,R,0,e,!1),n.fill(),n.beginPath(),n.moveTo(0+R,0),n.arc(0,0,R,0,e,!1),n.stroke(),n.restore()};var Ac=vs.Curve=function(A){this.catalog="Curve",this._interactor=A};Ac.prototype={},Ac.prototype.constructor=Ac,Y.defineProperties(Ac.prototype,{activing:{get:function(){return this._activing},set:function(P){var $=this;if(P)$._activing=new vs.CurveActiving(this,P),$._activing._firePointChange();else{var p=$._activing;p&&p.dispose(),$._activing=null}}}}),Ac.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Ac.prototype.setUp=function(){var l=this,R=l._interactor;R&&R.gv.mp(l._onGraphviewPropertyChanged,l)},Ac.prototype._onGraphviewPropertyChanged=function(r){("zoom"===r.property||"translateX"===r.property||"translateY"===r.property)&&this._handleDataChanged()},Ac.prototype.tearDown=function(){var W=this,r=W._interactor;r&&r.gv.ump(W._onGraphviewPropertyChanged,W)},Ac.prototype.canEnterEditDetailMode=function(){var m=this,z=m._interactor,O=z._getValidSelection();if(1===O.length){var y=O[0],R=y instanceof a.Edge;if(y instanceof a.Shape||R){if(R){var P=y.s("edge.type");if(P&&"points"!==P)return}var X=z.gv;if(X.isPointEditable(y)&&X.isEditable(y))return m.target=y,!0}}},Ac.prototype.canQuitEditDetailMode=function(B){var k=this,Q=k._interactor._getLogicalPoint(B);return k._checkEditRealPoint(Q)?void 0:k._interactor.gv.getDataAt(B)!==k.target?!0:void 0},Ac.prototype.preHandleScroll=function(){var g=this.editing;return g&&g.inEdit?!0:void 0},Ac.prototype.getCurrentSelectintStatus=function(){var C=this;if(C.activing&&!C.activing.selections){if(C.activing.status!=l)return C.activing.status;var V=function(j){var U=C.activing.status;C.activing.status=j,C._interactor.fp("shapePointStatus",U,j)},j=vs.Curve.PointType,r=C.activing.point,w=C.activing.pairs;if(!w||1!==w.length)return V(j.Mirrored);var J=w[0],T=J.c1&&J.c1.isNearEnough(r),y=J.c2&&J.c2.isNearEnough(r);if(!J.c1||!J.c2)return T||y?V(j.Straight):V(j.Disconnected);if(T&&y)return V(j.Straight);if(T||y)return V(j.Asymmetric);var Y=J.c1.clone().sub(r),K=J.c2.clone().sub(r);return Math.abs(Y.x*K.y-Y.y*K.x)>1e-5||Y.x*K.x>0?V(j.Disconnected):Math.abs(Y.length()-K.length())>1e-5?V(j.Asymmetric):V(j.Mirrored)}},Ac.prototype.handle_keydown=function(D){var U=this;if(U._interactor.editDetail){var s=vs.Curve.PointType;"1"===D.key?U._setCurrentSelectionStatus(s.Straight):"2"===D.key?U._setCurrentSelectionStatus(s.Mirrored):"3"===D.key?U._setCurrentSelectionStatus(s.Disconnected):"4"===D.key&&U._setCurrentSelectionStatus(s.Asymmetric)}},Ac.prototype.setCurrentSelectionStatus=function(p){var c=this,W=c._interactor;if(W){var Z=W.gv;Z.dm().beginTransaction(),this._setCurrentSelectionStatus(p),Z.dm().endTransaction()}},Ac.prototype._setCurrentSelectionStatus=function(g){var R=this,f=R.activing;if(f){var I=R.getCurrentSelectintStatus();if(null!==I&&I!==g){f.status=g;var Q=R.activing.point,D=R.activing.pairs;if(D&&1===D.length){var e=D[0],v=R.screenInfo.curve,M=vs.Curve.PointType,j=R._interactor,i=function(){R._writeToHt(),j.fp("shapePointStatus",I,g),R.check(j.gv,null,new vs.Math.Vector2(j._lastLogicalPoint))};if(g===M.Straight)return v.moveCtrlPoint(e,Q,"c1"),v.moveCtrlPoint(e,Q,"c2"),i(),void 0;if(I===M.Straight){var V=v.findPairs(Q,!0),a=V[0],_=a.r1||Q,q=a.r2||Q,T=q.clone().sub(_).multiplyScalar(.25);return v.moveCtrlPoint(e,Q.clone().sub(T),"c1"),v.moveCtrlPoint(e,Q.clone().add(T),"c2"),i(),void 0}var A=e.c1,h=e.c2;if(A&&h){if(g===M.Mirrored)return v.moveCtrlPoint(e,Q.clone().multiplyScalar(2).sub(h),"c1"),i(),void 0;if(g===M.Asymmetric&&I===M.Disconnected){var p=A.clone().sub(Q).length(),T=Q.clone().sub(h).setLength(p).add(Q);return v.moveCtrlPoint(e,T,"c1"),i(),void 0}}f._firePointChange(),j.fp("shapePointStatus",I,g),R.check(j.gv,null,new vs.Math.Vector2(j._lastLogicalPoint))}}}},Ac.prototype._handleDataChanged=function(){var T="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(V){var w=this;if(w.screenInfo&&w.target){if(V&&T.indexOf(V.property)<0)return;var z=w._interactor;w.gatherSingleTarget(z.gv,w.target,!0),w.check(z.gv,null,new vs.Math.Vector2(z._lastLogicalPoint)),z._42()}}}(),Ac.prototype.gatherSingleTarget=function(U,z,d){var t,x,$=this;$.screenInfo&&$.screenInfo.curve&&(x=$.screenInfo.curve._curves);var j=$.editing;t=j?$.screenInfo:$.screenInfo={};var v,w,N=z instanceof a.Edge;N?(v=z.s("edge.segments"),w=z.s("edge.points")||new a.List):(v=z._58O,w=z._59O),t.S=v;var s,L=t.P=[],k=vs.getDataMatrix(z);if(z instanceof a.Polyline||z instanceof a.Edge&&$._interactor.getStyle("edgeElevationEditable"))s=z.getElevation&&z.getElevation()||0,t.E=[];else{var o=!1;w.each(function(W){W.e!==l&&(o=!0)}),o&&(t.E=[])}if(w.each(function(Y){t.E&&t.E.push(Y.e!=l?Y.e:s),Y=k.apply(Y);var C=vs.toScreenPosition(U,Y);L.push(C.x,C.y)}),N){var E=L.length,f=vs.toScreenPosition(U,z._lastSourcePoint||(E?{x:L[0],y:L[1]}:{x:0,y:0})),c=vs.toScreenPosition(U,z._lastTargetPoint||(E?{x:L[E-2],y:L[E-1]}:{x:0,y:0}));L.splice(0,0,f.x,f.y),L.push(c.x,c.y),t.E&&(t.E.splice(0,0,"head"),t.E.push("tail"))}if(!t.S||!t.S.size()){t.S=new a.List,t.S.add(1);for(var O=0;O<L.length/2-1;O++)t.S.add(2)}if((!j||d)&&$.convertToCubicBezier(x),$.activing&&(d||!$.editing||"realPoint"===$.editing.type)){var r=t.curve.findPairs($.activing.point);$.activing.pairs=r}},Ac.prototype._convertToNewPoint=function(R,$,m,A){var J,j,u;for(J=0,j=$.length;j>J;J++){if(u=$[J],u._p1.isNearEnough(R)&&(!A||A.indexOf(u._p1)<0))return u._p1;if(u._p4.isNearEnough(R)&&(!A||A.indexOf(u._p4)<0))return u._p4}if(m)for(J=0,j=Math.min(m.length,j);j>J;J++){if(u=m[J],u._p1===R&&(!A||A.indexOf($[J]._p1)<0))return $[J]._p1;if(u._p4===R&&(!A||A.indexOf($[J]._p4)<0))return $[J]._p4}},Ac.prototype.convertToCubicBezier=function(J){var b,_,i=this,P=new vs.Math.Curve,z=i.screenInfo;if(P.createFromHtShape(z.P,z.S,z.E),z.curve=P,i.activing){var F=P._curves;b=i.activing.point,_=i._convertToNewPoint(b,F,J);var d=[];if(_&&(i.activing.point=_,d.push(_)),i.activing.selections){var Q=-1,y=i.activing.selections;y.forEach(function(b){Q++,_=i._convertToNewPoint(b,F,J,d),_&&(y[Q]=_,d.push(_))})}}},Ac.prototype.check=function(g,O,c){if(!O||Vi(O)||ge(O)){var A=this;if(A._interactor.setCursor("default"),A.editing=null,A.highlight=null,A.tipInfo=null,A.edgeEditResult=null,A.screenInfo){if(nb()||O&&ge(O))return A._interactor._42(),!0;
        if(A._checkEditCtrlPoint(c))return A._interactor._42(),!0;if(A._checkEditRealPoint(c))return A._interactor._42(),!0;if(A._checkEditElevation(c))return A._interactor._42(),!0;var z=A.screenInfo.curve,Y=z.checkPoint(c,A._interactor.getStyle("curveIntersectSize"));if(Y){var I=A.highlight={};I.type="insertKnot",I.bezier=Y.bezier,I.point=Y.intersection}return A._interactor._42(),!0}}},Ac.prototype._checkEditRealPoint=function(A){var c,$,C,z,K,D,x=this,r=x.screenInfo.curve._curves,W=x._interactor.getStyle("curvePointIntersectSize"),G=1/0;for(W*=W,C=0,z=r.length;z>C;C++)c=r[C],K=c._p1,D=A.distanceToSquared(K),G>D&&(G=D,$=K),K=c._p4,D=A.distanceToSquared(K),G>D&&(G=D,$=K);if(G>W)return!1;var p=x.highlight={};return p.type="changeRealPoint",p.point=$,x.editing={type:"realPoint",point:$,shiftGuide:{point:$.clone(),dir:"x",limit:0}},x._interactor.setCursor("crosshair"),!0},Ac.prototype._checkEditElevation=function(m){var j=this;if(!j._interactor.getStyle("curveElevationVisible"))return!1;var Z=j.target;if(Z instanceof a.Edge&&!j._interactor.getStyle("edgeElevationEditable"))return!1;var z=j.activing;if(!z)return!1;var H=z.getCurrentEditingPoint();if(!H)return!1;var U=j._interactor,A=U.getStyle("curveElevationGuideShift"),G=U.getStyle("curveElevationIntersectSize"),W=m.distanceToSquared({x:H.x+A[0],y:H.y+A[1]});if(!(W>G*G)){var e=j.highlight={};e.type="elevation";var Y=new vs.Math.Vector2(m.x,m.y,H.e);return j.editing={type:"elevation",startPoint:Y},j._interactor.setCursor("crosshair"),!0}},Ac.prototype._checkEditCtrlPoint=function(l){var P=this;if(P.activing&&!P.activing.selections){var d=P.getCurrentSelectintStatus();if(d!==vs.Curve.PointType.Straight){var R=P.activing.pairs;if(R){var x=P._interactor.getStyle("curvePointIntersectSize");x*=x;var r,j,Q,B,Y,F,N,M,I,L=1/0;for(N=0,I=R.length;I>N;N++)for(B=R[N],M=0;2>M;M++)Y=0===M?"c1":"c2",B[Y]&&(F=l.distanceToSquared(B[Y]),L>F&&(L=F,r=B,j=N,Q=Y));if(L>x)return!1;P.activing.hlpair=r,P.activing.hltype=Q;var g=P.highlight={};return g.type="changeCtrlPoint",g.point=r[Q],P.editing={type:"ctrlPoint",pair:r,pairId:j,ctrlType:Q,direction:r[Q].clone().sub(P.activing.point).normalize()},P._interactor.setCursor("crosshair"),!0}}}},Ac.prototype.startEdit=function(v,G){v.startDragging(G);var p=this;p.highlight&&"insertKnot"===p.highlight.type&&(p.insertKnot(),p.gatherSingleTarget(p._interactor.gv,p.target),p.activing=null,p._checkEditRealPoint(p._interactor._getLogicalPoint(G)));var H=p._activing;if(H){var b=p.editing?p.editing.type:null;"ctrlPoint"===b?H.editingCtrl={pairId:p.editing.pairId,type:H.hltype}:"realPoint"===b&&(H.editingCtrl=!1)}var r=p.highlight,z=a.Default.isCtrlDown(G);if(!r||nb()||ge(G)){var V=p._interactor.gv;if(!V.setFocus(G)||V._scrolling)return;return z?p._multiSelect={startPoint:V.lp(G)}:V.isPannable()&&(Vi(G)||ge(G))&&(p._pan={tx:V.tx(),ty:V.ty()},v.fi({kind:"beginPan",event:G})),void 0}if("changeRealPoint"===r.type){var u,h=p.activing?p.activing.point:null,D=p.activing?p.activing.selections:null;if(z&&p.activing)h===r.point?(D?(p.activing={point:D[0]},D.length>1&&(D.splice(0,1),p.activing.selections=D)):p.activing=null,p.editing=null):D&&(u=D.indexOf(r.point))>=0?(D.length>1?D.splice(u,1):delete p.activing.selections,p.editing=null):D?(D.push(h),p.activing={point:r.point,selections:D}):p.activing={point:r.point,selections:[h]};else if(D)h===r.point||((u=D.indexOf(r.point))>=0?(D.splice(u,1,h),p.activing={point:r.point,selections:D}):p.activing={point:r.point});else{var Q;h===r.point&&(Q=p.activing.status),p.activing={point:r.point},Q&&(p.activing.status=Q)}v.fi({kind:"beginEditPoint",event:G})}},Ac.prototype.insertKnot=function(){var X=this,x=X.highlight,w=X.screenInfo.curve;w.insertKnot(x.bezier,x.point.t),X._writeToHt()},Ac.prototype._writeToHt=function(){var g,T,D=this,S=D.screenInfo.curve,f=S.toHtShape(),Z=f.points,p=[],P=f.segments,b=D._interactor.gv;b.dm().beginTransaction();var o,J,R=D.target,t=R instanceof a.Edge,k=vs.getDataMatrix(R).invert();J=R instanceof a.Polyline||R instanceof a.Edge&&D._interactor.getStyle("edgeElevationEditable"),J&&(o=R.getElevation&&R.getElevation()||0);for(var q=0,X=Z.length;X>q;q++)g=Z[q],T=vs.toWorldPosition(b,g),T=k.apply(T),isFinite(g.e)&&g.e!==o&&(T.e=g.e),p.push(T);if(R._writing=!0,t){R.s("edge.type","points"),R.setStyle("edge.segments",P),R.setStyle("edge.points",p.slice(1,p.length-1)),R.setStyle("edge.source.offset.x",0),R.setStyle("edge.source.offset.y",0),R.setStyle("edge.target.offset.x",0),R.setStyle("edge.target.offset.y",0);var v=D._nextChangeEdgeHost;delete D._nextChangeEdgeHost,v&&("source"===v.type?R.setSource(v.host):R.setTarget(v.host)),D._writeEdgeHostAnchor("source",p[0]),D._writeEdgeHostAnchor("target",p[p.length-1])}else p.length?(R.setSegments(P),R.setPoints(p,!0)):R.removeFromDataModel();b.dm().endTransaction(),delete R._writing},Ac.prototype._writeEdgeHostAnchor=function(w,$){var E=this,W=E.target,J=E._calcHostAnchor(W,w,$);J.index!==l?(W.setStyle("edge."+w+".index",J.index),W.setStyle("edge."+w+".percent",l),W.setStyle("edge."+w+".anchor.x",l),W.setStyle("edge."+w+".anchor.y",l)):J.percent!==l?(W.setStyle("edge."+w+".percent",J.percent),W.setStyle("edge."+w+".index",l),W.setStyle("edge."+w+".anchor.x",l),W.setStyle("edge."+w+".anchor.y",l)):(W.s("edge."+w+".anchor.x",J.x),W.s("edge."+w+".anchor.y",J.y),J.offsetX||J.offsetY?(W.s("edge."+w+".offset.x",J.offsetX),W.s("edge."+w+".offset.y",J.offsetY)):(W.s("edge."+w+".offset.x",0),W.s("edge."+w+".offset.y",0)))},Ac.prototype._calcHostAnchor=function(D,E,v,S){S||(S="source"===E?D.getSource():D.getTarget());var L=this._interactor.gv,O=L.calculateAttachPoint(S,v);if(O)return O.info;if(Xi(S)){var i=L.calculateEdgePosition(S,v);return i}var B=S.getRotation(),U=S.getAnchor();Rm(S,L)&&(B=0);var R=S.getScale();if(B||R.x<0||R.y<0){var Q=S.getMatrix(),y=Q.tfi(v),I=S.getSize();return{x:y.x/I.width+U.x,y:y.y/I.height+U.y}}var Y=Xd(L,S),q={x:(v.x-Y.x)/Y.width,y:(v.y-Y.y)/Y.height};return q},Ac.prototype._handlePanning=function(z){var w=this,M=w._pan;if(M){M.started=!0;var W=w._interactor,e=W.gv,u=W._lastClientPoint,V=zn(z),t=Gm(e,V,u);e.setTranslate(M.tx+t.x,M.ty+t.y),w.gatherSingleTarget(W.gv,w.target),W._42(),W.fi({kind:"betweenPan",event:z})}},Ac.prototype.handleEdit=function(j,O){var u=this,n=u.editing;if(u._pan)return u._handlePanning(O),void 0;if(u._multiSelect)return u._multiSelect.endPoint=j.lp(O),u._interactor.redraw(),void 0;if(n){n.inEdit=!0;var k,Y,T,J=u._interactor._getLogicalPoint(O),E=a.Default.isCtrlDown(O),s=a.Default.isShiftDown(O),f=n.type,V=u.activing;if(u._guideInfo=null,"ctrlPoint"===f&&s){var o=u.editing.direction.clone();k=V.point;var R=o.dot(J.clone().sub(k));J=o.setLength(R).add(k)}else if("ctrlPoint"===f||"realPoint"===f){var o;if("realPoint"===f&&s){var d=u.editing.shiftGuide;Y=d.point;var F=Math.abs(J.x-Y.x),z=Math.abs(J.y-Y.y);F>z&&F>d.limit&&"y"===d.dir&&(d.dir="x"),z>F&&z>d.limit&&"x"===d.dir&&(d.dir="y"),o=d.dir,"x"===o?(J.y=Y.y,d.limit=Math.max(d.limit,F)):"y"===o&&(J.x=Y.x,d.limit=Math.max(d.limit,z))}var t=u._isEditEdgeSourceTarget();if(t){var M=u._editEdgeSourceTarget(t,J,E);M&&(u.edgeEditResult=M,T=M.tipText)}else if(!E){var r=u._guidingToEdit(J,o),L="realPoint"===f?u._interactor.gridGuide.findClosest(J,o,!0):null,v=1/0,C=1/0;L&&(L.x&&(v=L.x),L.y&&(C=L.y));var i=!1;r&&(r.xList&&(Math.abs(r.x)<=Math.abs(v)?(i=!0,v=r.x):delete r.xList),r.yList&&(Math.abs(r.y)<=Math.abs(C)?(i=!0,C=r.y):delete r.yList),i&&(u._guideInfo=r)),isFinite(v)&&(J.x+=v),isFinite(C)&&(J.y+=C),i&&(r.v=J)}}var N=u.screenInfo.curve;if("realPoint"===n.type){k=n.point,k.e!==l&&(J.e=k.e),N.moveRealPoint(k,J),n.point=J,u.highlight.point=J;var A=V.status,c=V.selections;if(u.activing={point:J,status:A},c){var P=J.clone().sub(k),Q=0;c.forEach(function(G){var Z=G.clone().add(P);N.moveRealPoint(G,Z),c[Q++]=Z}),u.activing.selections=c}}else if("ctrlPoint"===n.type){var U=V.pairs,B=U[n.pairId];N.moveCtrlPoint(B,J,n.ctrlType);var w=V.status,K=vs.Curve.PointType;if((w===K.Mirrored||w===K.Asymmetric)&&B.c1&&B.c2){var k=new vs.Math.Vector2(V.point),D="c1"===n.ctrlType?"c2":"c1";if(w===vs.Curve.PointType.Mirrored)N.moveCtrlPoint(B,k.clone().multiplyScalar(2).sub(J),D);else if(w===K.Asymmetric){var R=B[D].clone().sub(k).length(),$=k.clone().sub(B[n.ctrlType]).setLength(R).add(k);isNaN($.x)||N.moveCtrlPoint(B,$,D)}}V._firePointChange()}else if("elevation"===n.type){Y=n.startPoint;var p=Y.e+(Y.y-J.y)/j._zoom;u._setCurrentPointImpl("e",p),V._firePointChange(),T="E: "+vs.toFixed(p)}var g=a.Default.getLogicalPoint(O,u._interactor._canvas);if(g.x+=vs.Icons.TipShiftX,g.y+=vs.Icons.TipShiftY,!T){var X=vs.toWorldPosition(j,J);T=""+vs.toFixed(X.x)+", "+vs.toFixed(X.y)}u.tipInfo={helperPos:g,text:T,size:T.length},u._writeToHt(),u._interactor.fi({kind:"betweenEditPoint",event:O})}},Ac.prototype._setCurrentPointImpl=function(Z,f){var H=this,W=H._activing;if(!W)return!1;var e=H.target;if(!e)return!1;var w=W.getCurrentEditingPoint();if(!w)return!1;var Q=W.editingCtrl;if(!Q)var n=w.clone();if("e"===Z)w.e=f;else{var V;if("x"===Z||"y"===Z){var i=W._lastFirePoint;V="x"===Z?{x:f,y:i?i.y:0}:{x:i?i.x:0,y:f}}else"object"==typeof Z?(V=Z,Z.e!==l&&(w.e=Z.e)):(V={x:arguments[0],y:arguments[1]},arguments[2]!==l&&(w.e=arguments[2]));var p=vs.getDataMatrix(e);V=vs.toScreenPosition(H._interactor.gv,p.apply(V)),w.x=V.x,w.y=V.y}if(!Q){var T=n.multiplyScalar(-1).add(w);w.e&&n.e&&(T.e=w.e-n.e);var R=H.screenInfo.curve;R.moveCtrlDueToRealPointMovement(w,T);var u=W.selections;if(u){var r=0;u.forEach(function(d){var I=d.clone().add(T);isFinite(T.e)&&(I.e=(isFinite(d.e)?d.e:e.getElevation()||0)+T.e),R.moveRealPoint(d,I),u[r++]=I}),W.selections=u}}return!0},Ac.prototype.setCurrentPoint=function(O,P){return this._setCurrentPointImpl(O,P)?(this._writeToHt(),!0):!1},Ac.prototype._isEditEdgeSourceTarget=function(){var c=this,C=c.target;if(!(C instanceof a.Edge))return!1;var i=c.editing.point,x=c.screenInfo.curve._curves;return i===x[0]._p1?"source":i===x[x.length-1]._p4?"target":!1},Ac.prototype._editEdgeSourceTarget=function(A,_,R){var O,b=this,Z=b.target;if(O="source"===A?Z.getSource():Z.getTarget()){var Q,G=b._interactor.gv,X=vs.toWorldPosition(G,_),i=b._calcHostAnchor(Z,A,X,O);if(Q=i.index!==l||i.percent!==l?i.distance*G.getZoom()>b._interactor.getStyle("edgeHostEdgeMaxDistance"):b._interactor.getStyle("edgeHostDetectPerFrame")?!0:i.x<0||i.x>1||i.y<0||i.y>1?!0:!1){var s=G.getDataAt(X,function(r){return G.isSelectable(r)?G.isSourceTargetEditable(Z,r,A)?Z.canSetSourceTarget(r,A)?!0:!1:!1:!1});if(s){var g=b._calcHostAnchor(Z,A,X,s);O=s,b._nextChangeEdgeHost={type:A,host:s},i=g}}var w,m,P;if(R||i.x===l)(i.percent!==l||i.index!==l)&&(m=i.point);else{var r=b._interactor.getStyle("anchorRound"),p=b._interactor.getStyle("anchorSensitivity");w=G.calculateAttachPoint(O,X),w?i=w.info:(i.x=vs.roundTo(i.x,r,p),i.y=vs.roundTo(i.y,r,p)),m=Qf(G,O,0,i.offsetX||0,i.offsetY||0,i.x,i.y)}m&&(P=vs.toScreenPosition(G,m),_.x=P.x,_.y=P.y),b._edgeHostGuideInfo={corners:vs.getTargetCornersOnScreen(G,O),attach:w?w.index:-1,host:O};var M;return i.percent!==l?M="percent: "+i.percent.toFixed(2):i.index!==l?M="index: "+i.index:(M=""+i.x.toFixed(2)+", "+i.y.toFixed(2),(i.offsetX||i.offsetY)&&(M+=" offset: "+i.offsetX.toFixed(2)+", "+i.offsetY.toFixed(2))),{host:O,anchor:i,tipText:M}}},Ac.prototype._guidingToEdit=function(o,l){var B,V,g=this;if(B=g.screenInfo.curve){V=B._curves;var z,X,K,s,S,U,b,T,$=1/0,n=1/0,x=[];for(g.editing&&"realPoint"===g.editing.type&&(T=g.editing.point),S=0,U=2*V.length;U>S;S++)b=V[Math.floor(S/2)][S%2?"_p4":"_p1"],x.indexOf(b)>=0||(x.push(b),T&&T===b||(K=b.x-o.x,s=b.y-o.y,Math.abs(K)<Math.abs($)?($=K,z=[b]):K===$&&z.push(b),Math.abs(s)<Math.abs(n)?(n=s,X=[b]):s===n&&X.push(b)));var Y=g._interactor.getStyle("smartGuideThreshold");if((Math.abs($)>Y||"y"===l)&&(z=null),(Math.abs(n)>Y||"x"===l)&&(X=null),z||X){var j=!1,f={};if(z&&(j=!0,f.xList=z,f.x=$),X&&(j=!0,f.yList=X,f.y=n),j)return f}}},Ac.prototype._46O=function(O){var Q=this;Q.editing&&(Q.editing=null,Q._interactor.fi({kind:"endEditPoint",event:O})),Q._guideInfo=null,Q._edgeHostGuideInfo=null,Q._pan&&(Q._pan=null,Q._interactor.fi({kind:"endPan",event:O})),Q._multiSelect&&(Q._handleMultiSelect(Q._multiSelect),Q._multiSelect=null),Q.tipInfo=null,Q.edgeEditResult=null},Ac.prototype._handleMultiSelect=function(g){if(g.startPoint&&g.endPoint){var N,n,M,Z,Y,m=this,T=m._interactor,s=T.gv,H=vs.toScreenPosition(s,g.startPoint),f=vs.toScreenPosition(s,g.endPoint),P=a.Default.unionPoint(H,f),k=m.screenInfo.curve._curves,c=[],h=function(u){u.x>=P.x&&u.y>=P.y&&u.x<=P.x+P.width&&u.y<=P.y+P.height&&c.indexOf(u)<0&&c.push(u)};for(N=0,n=k.length;n>N;N++)Y=k[N],h(Y._p1),h(Y._p4);if(c.length){var J=m.activing||{},U=J.selections||[];for(J.point&&U.push(J.point),N=0,n=U.length;n>N;N++)M=U[N],Z=c.indexOf(M),Z>=0?c[Z]=l:c.push(M);var G=c;for(c=[],N=0,n=G.length;n>N;N++)G[N]&&c.push(G[N]);n=c.length,0===n?m.activing=null:1===n?m.activing={point:c[0]}:(M=c[n-1],m.activing={point:M,selections:c.splice(0,n-1)}),T.redraw()}}},Ac.prototype._canDeletePoint=function(w,r){var U=this.target;if(!(U instanceof a.Edge))return!0;var S=w._curves[0],Z=w._curves[w._curves.length-1];return S._p1===r||Z._p4===r?!1:!0},Ac.prototype.handleDelete=function(){var M=this;if(M.activing&&M.screenInfo){var r=a.Default.isShiftDown(),W=M.screenInfo.curve;M._canDeletePoint(W,M.activing.point)&&W.deleteRealPoint(M.activing.point,r),M.activing.selections&&M.activing.selections.forEach(function(o){M._canDeletePoint(W,o)&&W.deleteRealPoint(o,r)}),M.activing=null,delete M.editing,delete M.tipInfo,delete M.edgeEditResult,delete M._pan,delete M._multiSelect,M._writeToHt(),M._interactor.fp("deleteShapePoint",!1,!0)}},Ac.prototype.handleDoubleClick=function(H){var $=this,q=$._interactor._getLogicalPoint(H);if($.screenInfo&&$._checkEditRealPoint(q)){var W=$.getCurrentSelectintStatus(),p=vs.Curve.PointType;return W=W===p.Mirrored?p.Straight:p.Mirrored,$._setCurrentSelectionStatus(W),$._interactor._42(),!0}},Ac.prototype._drawHighlight=function(e){var q=this,g=q.highlight;if(g){var x=g.bezier,Q=q._interactor;x&&vs.Icons.DrawIcon(Q,e,vs.Icons.ShapeHighlightCurve,[x._p1.x,x._p1.y,x._p2.x,x._p2.y,x._p3.x,x._p3.y,x._p4.x,x._p4.y]);var U=g.point;U&&"insertKnot"===g.type&&vs.Icons.DrawIcon(Q,e,vs.Icons.ShapeHighlighPoint,U)}},Ac.prototype._drawGuide=function(n){var T=this,i=T._guideInfo;if(i){var k,M,Y,G,X=i.v;for(k=0;2>k;k++)if(G=0===k?i.xList:i.yList)for(M=0,Y=G.length;Y>M;M++)vs.Icons.DrawIcon(T._interactor,n,vs.Icons.ShapeGuideLine,[X.x,X.y,G[M].x,G[M].y])}},Ac.prototype._drawCurrentPoint=function(m){var W=this;if(W.activing){var q=W.activing,j=W.getCurrentSelectintStatus(),k=W._interactor;if(j!==vs.Curve.PointType.Straight){var w=q.pairs;q.hlpair,q.hltype;var e=q.selections,T=q.editingCtrl;if(w&&!e){var y,$,X;for($=0,X=w.length;X>$;$++)y=w[$],T&&$===T.pairId&&y[T.type]?vs.Icons.DrawIcon(k,m,vs.Icons.ShapeActivingCtrl,{point:y.point,c1:y.c1,c2:y.c2,hl:T.type}):vs.Icons.DrawIcon(k,m,vs.Icons.ShapeActivingCtrl,y)}}vs.Icons.DrawIcon(k,m,vs.Icons.ShapeHighlighRealPoint,W.activing.point),e&&e.forEach(function(Z){vs.Icons.DrawIcon(k,m,vs.Icons.ShapeHighlighRealPoint,Z)})}},Ac.prototype.clear=function(){var L=this;L.editing=null,L._guideInfo=null,L.activing=null,L.highlight=null},Ac.prototype._42=function(c){var L=this;L.info={},L.editing||(L.screenInfo=null);var E=L._interactor;if(!E.editDetail)return L.clear(),void 0;var u=E.gv;if(!L.target||!u.isSelected(L.target)||!u.isVisible(L.target))return E.editDetail=!1,L.clear(),void 0;if(L.gatherSingleTarget(u,L.target),vs.Icons.DrawIcon(E,c,vs.Icons.ShapeBgCurve,L.screenInfo),L._interactor.getStyle("curveElevationVisible")&&(L.target instanceof a.Polyline||L.target instanceof a.Edge&&L._interactor.getStyle("edgeElevationEditable"))&&L.activing){var Q=L.activing.getCurrentEditingPoint();Q&&"string"!=typeof Q.e&&vs.Icons.DrawIcon(E,c,vs.Icons.EdgeElevationGuide,Q)}if(L._drawHighlight(c),L._drawCurrentPoint(c),L._getRealPoint().forEach(function(r){vs.Icons.DrawIcon(E,c,vs.Icons.ShapePoint,r)}),L._drawGuide(c),L.tipInfo&&L._interactor.getStyle("curveTipVisible")&&vs.Icons.DrawIcon(E,c,vs.Icons.TipHelper,L.tipInfo),L._edgeHostGuideInfo&&E._drawHostGuide(L._edgeHostGuideInfo),L.edgeEditResult&&L._drawEdgeHostHighlight(c,L.edgeEditResult.host,L.edgeEditResult.anchor),L._multiSelect&&L._multiSelect.endPoint){var C=a.Default.unionPoint(vs.toScreenPosition(u,L._multiSelect.startPoint),vs.toScreenPosition(u,L._multiSelect.endPoint));C.color=u.getRectSelectBorderColor(),c.save(),c.setTransform(1,0,0,1,0,0);var e=M.devicePixelRatio,k=C.borderWidth=Math.round(e);k/=2,C.x=Math.round(C.x*e)+k,C.y=Math.round(C.y*e)+k,C.width=Math.round(C.width*e),C.height=Math.round(C.height*e),vs.Icons.DrawIcon(E,c,vs.Icons.SimpleRect,C),c.restore()}},Ac.prototype._drawEdgeHostHighlight=function(k,U,I){this.drawEdgeHostHighlight(k,U,I),this._interactor.redraw()},Ac.prototype.drawEdgeHostHighlight=function(o,w,g){if(Xi(w)){var Y,X,W,f,H=this,C=H._interactor,i=C.gv,K=i.getDataUI(w),b=Of(K),N=[];for(W=0,f=b.points.length;f>W;W++)X=vs.toScreenPosition(i,b.points.get(W)),N.push(X.x,X.y);b.segments&&(Y=b.segments.toArray());var d=C.getStyle("edgeHostHighlighPeriod"),v=C.getStyle("edgeHostEdgeHighlighColor");vs.Icons.DrawIcon(C,o,vs.Icons.ShapeBgCurve,{P:N,S:Y,color:v,dynamicVisible:g.index===l,dynamicPeriod:d}),v=C.getStyle("edgeHostPointHighlighColor");var z=tc(K);for(W=0,f=z.length;f>W;W++){var j=z[W],F=vs.toScreenPosition(i,j);vs.Icons.DrawIcon(C,o,vs.Icons.ShapePoint,{point:{x:F.x,y:F.y},color:v,size:12,dynamicVisible:W===g.index,dynamicPeriod:d})}}},Ac.prototype._getRealPoint=function(){var l,j=this.screenInfo,Y=j.P,S=j.S,x=-1,m=[],C=-1,J=S.length;return S.each(function(g){C++;var d=1;if(3===g)d=2;else if(4===g)d=3;else if(5===g)return;x+=d,l=C+1>=J?!0:1===S.get(C+1)?!0:!1,m.push({point:{x:Y[2*x],y:Y[2*x+1]},segmentIndex:C,pointIndex:x,isEnd:l})}),m},Ac.prototype.getEditingPointsInfo=function(V){var n=this,U=n.activing;if(!U)return!1;var a=U.point;if(!a)return!1;var u=this._getRealPoint(),q=[{screen:a}];U.selections&&U.selections.forEach(function(B){q.push({screen:B})});var R,$,f=u.length;return q.forEach(function(L){for(R=0;f>R;R++)if($=u[R],L.screen.isNearEnough($.point)){L.segmentIndex=$.segmentIndex,L.pointIndex=$.pointIndex,L.point=n.target.getPoints().get($.pointIndex);break}}),V&&q.sort(function(s,V){return s.segmentIndex-V.segmentIndex}),q};var Ul=vs.MoveHelper=function(j){var S=this;S.catalog="Move",S._interactor=j};Ul.prototype={},Ul.prototype.constructor=Ul,Ul.prototype.calcShift=function(I,W,G){var J,A,Q=this,g=Q._interactor.gv,c=g.lp(W);if("beginMove"===I&&Q._gatherGridInfo(G._lastLogicalPoint||c),J=Q._target){var k=J.downPosition;if(k){var z=Q._interactor.getStyle("moveSensitivity")/g._zoom;if(k.distanceTo(c)<z)return{x:0,y:0};delete J.downPosition}var q;A=a.Default.isShiftDown(W),A&&(c=Q._dealShiftDown(c),q=J.shiftGuide.dir);var t,$=J.rawPos={x:J.pos.x+c.x-J.lp.x,y:J.pos.y+c.y-J.lp.y};if(a.Default.isCtrlDown(W)){if(t=Q._calcShiftByAddon(),Q._target.node instanceof vs.Group){var C=Q._target.node;C._position.x+=t.x,C._position.y+=t.y}return t}var o=Q._interactor.rectGuide;if(J.node instanceof a.Data&&J.node.s("2d.attachable")){var f=Q._calcAttachNodeShift(J.node,$);if(o.clear(),f)return f}for(var y,R=J.x+$.x,O=J.y+$.y,n={x:R,y:O},L={x:R+J.w/2,y:O+J.h/2},U={x:R+J.w,y:O+J.h},i=Q._interactor.gridGuide,b=[o.findClosest(n,q),o.findClosest(L,q),o.findClosest(U,q),i.findClosest(n,q),i.findClosest(L,q),i.findClosest(U,q)],w=1/0,K=1/0,P=0,s=b.length;s>P;P++)y=b[P],y&&(R=y.x,O=y.y,isFinite(R)&&Math.abs(R)<Math.abs(w)&&(w=R),isFinite(O)&&Math.abs(O)<Math.abs(K)&&(K=O));if(isFinite(w)||(w=0),isFinite(K)||(K=0),t=Q._calcShiftByAddon(w,K),Q._target.node instanceof vs.Group){var C=Q._target.node;C._position.x+=t.x,C._position.y+=t.y}var Z=J.node;if(!Rm(Z,g)){var d=$.x+w,Y=$.y+K;Q._interactor.rectGuide.gatherLines({node:Z,x:J.x+d,y:J.y+Y,w:J.w,h:J.h},q)}return t}},Ul.prototype._calcShiftByAddon=function(l,k){var D=this._target,e=D.rawPos,L=D.node.getPosition();return l=l||0,k=k||0,{x:e.x-L.x+l,y:e.y-L.y+k}},Ul.prototype._dealShiftDown=function(D){var n=this,Q=n._target.shiftGuide,a=n._target.lp,d=Math.abs(D.x-a.x),y=Math.abs(D.y-a.y);d>y&&d>Q.limit&&"y"===Q.dir&&(Q.dir="x"),y>d&&y>Q.limit&&"x"===Q.dir&&(Q.dir="y");var L=Q.dir;return"x"===L?(D.y=a.y,Q.limit=Math.max(Q.limit,d)):"y"===L&&(D.x=a.x,Q.limit=Math.max(Q.limit,y)),D},Ul.prototype._isAttachableLineShape=function(D){if(!D.getSegments)return!1;var j=D.getSegments();if(!j)return!0;j instanceof a.List&&(j=j.getArray());for(var E=1,K=j.length;K>E;E++)if(2!==j[E])return!1;return!0},Ul.prototype._calcAttachNodeShift=function(){var u=new Sf,l=new Sf,D=new Sf,$=new Sf;return function(E,N){var q=this._interactor.gv,t=E.getHost(),i=q.getDataAt(N,function(v){return v.s("2d.hostable")?!0:!1});if(i&&t!==i&&E.setHost(i),!i)return this._edgeHostGuideInfo=null,E.setHost(null);var T=this._edgeHostGuideInfo={corners:vs.getTargetCornersOnScreen(q,i),host:i,attach:-1};if(this._isAttachableLineShape(i)){for(var j,d,e,M,n,g,Y=i.getPoints(),s=Y.size(),I=i.getPointsMatrix2d(),A=1/0,c=0;s>c&&(c!==s-1||i.isClosePath());c++)0!==c?l.copy(D):I.apply(Y.get(c),l),I.apply(c===s-1?Y.get(0):Y.get(c+1),D),u.copy(N).sub(l),$.copy(D).sub(l),j=$.length(),$.divideScalar(j),d=u.dot($),0>d?d=0:d>j&&(d=j),$.multiplyScalar(d).add(l),e=u.copy(N).sub($).lengthSq(),A>e&&(A=e,g=c,M=d,n=j);return Math.sqrt(A)*q.getZoom()>this._interactor.getStyle("attachThreshold")?(E.s({"attach.index":-1}),E.setHost(null),void 0):(E.s("attach.offset.opposite")&&(M=n-M),E.s({"attach.index":g,"attach.offset":E.s("attach.offset.relative")?M/n:M}),{x:0,y:0})}var h=q.calculateAttachPoint(i,N);if(h){var b=h.point;return T.attach=h.index,this._calcShiftByAddon(b.x-N.x,b.y-N.y)}}}(),Ul.prototype._gatherGridInfo=function(m){var D,B=this,W=B._interactor,T=W._getValidSelection();if(T.length){if(1===T.length){if(D=T[0],!D.getRect)return B._target=null,void 0}else if(D=vs.Group.findOrCreateGroup(T),!D)return B._target=null,void 0}else{var T=W.gv.sm().getSelection();if(T.length&&(D=T.get(0),!D.getRect))return B._target=null,void 0}if(D){var u=D.getPosition(),Z=D.getRect();B._target={node:D,x:Z.x-u.x,y:Z.y-u.y,w:Z.width,h:Z.height,lp:{x:m.x,y:m.y},pos:{x:u.x,y:u.y},shiftGuide:{dir:"x",limit:0},downPosition:new vs.Math.Vector2(m)},W.rectGuide.gatherRects()}},Ul.prototype.clear=function(){var j=this;j._edgeHostGuideInfo=null,j._interactor.rectGuide.clear(),j._interactor._42()},Ul.prototype._42=function(){var b=this._edgeHostGuideInfo;b&&this._interactor._drawHostGuide(b)};var Hl="directional",Hd="point",Je="spot",Ip="light.color",Vh={},ir=function(B,n){tk(n)&&Rj.test(n)?ij(B,n):Bn(n)&&n.modelType?dp(B,n):n===l?delete qj[B]:qj[B]=n},Ij=function(G){return G},Yi=function(E){E=A.convertShape3dModelName(E);var x;if(Bn(E)){if(E.modelType){if(E.uuid){if(x=qj[E.uuid])return x}else E.uuid=a.Math.generateUUID();return dp(E.uuid,E),l}return E}return x=qj[E],E&&x===l&&Rj.test(E)&&(id&&id[E]||ij(E,E)),x},Qk=function(E,H){E.frameStack?E.frameStack.push(H):E.frameStack=[H],E.bindFramebuffer(E.FRAMEBUFFER,H)},Or=function(G){var P=G.frameStack;if(P){if(P.pop(),P.length)return G.bindFramebuffer(G.FRAMEBUFFER,P[P.length-1]),void 0;G.frameStack=null}G.bindFramebuffer(G.FRAMEBUFFER,null)};Nh(A,{graph3dViewAttributes:Z,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:i/60,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Cb,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewMaxPhi:i,graph3dViewMinPhi:0,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:i/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:ir,getShape3dModel:Yi,convertShape3dModelName:Ij,getShape3dModelMap:function(){return qj},getCachedShape3dModelMap:function(){return Qm},createMatrix:function(S,e){sp(S)||(S=[S]);for(var t=S.length-1;t>=0;t--){var z=S[t];e=xi(z.mat,z.s3,z.r3,z.rotationMode,z.t3,e)}return e},transformVec:function(b,i){return ao(b,i)},glBindFrame:Qk,glUnbindFrame:Or,createBoxModel:function(){return{vs:tp,ns:fo,uv:jr,is:up}},createRoundRectModel:function(l,D){return Nd.roundRect(l,D)},createStarModel:function(I,k){return Nd.star(I,k)},createRectModel:function(L,y){return Nd.rect(L,y)},createTriangleModel:function(H,i){return Nd.triangle(H,i)},createRightTriangleModel:function(i,I){return Nd.rightTriangle(i,I)},createParallelogramModel:function(T,W){return Nd.parallelogram(T,W)},createTrapezoidModel:function(o,u){return Nd.trapezoid(o,u)},createSmoothSphereModel:function(L,F,W,p,r,Z,T){return _j(new nf(L,F,W,p,r,Z,T))},createSphereModel:function(M,C,l,v,V,w,T){return M?rb(M,C,l,v,V,w,T):A.createSmoothSphereModel()},createSmoothConeModel:function(i,v,Y,I,A){return Jb(i,v,Y,I,A)},createConeModel:function(t,R,F,J,N,C){return t?Yo(t,R,F,J,N,C):Jb(C)},createSmoothCylinderModel:function(H,l,p,G,Y,b,z,D){return _j(new xs(H,l,p,G,Y,b,z,D))},createCylinderModel:function(j,q,z,u,m,S,a,y){return j?cg(j,q,z,u,m,S,a,y):Ye(S,a)},createSmoothTorusModel:function(z,A,p,y,n,Q){return _j(new Gc(z,A,p,y,n,Q))},createTorusModel:function(E,r,m,V,D,u,n,T){return E?Km(E,r,m,V,D,u,n,T):Sp(u,n)},createExtrusionModel:function(t,O,k,T,u,s,Y,w){return yo(t,O,k,T,u,s,Y,w)},createSmoothRingModel:function(y,B,j,E,O,I){for(var K=[],H=0;H<y.length-1;H+=2)K.push({x:y[H],y:y[H+1]});for(y=Ai(K,B,j)[0],K=[],H=0;H<y.length;H++){var e=y[H];K.push(new Vq(e.x,0,e.y))}return _j(new zg(K,I,E,O))},createTextGeometry:function($,r){return _j(new bh($,r))},loadFontFace:function(F,N){A.xhrLoad(F,function(f){if(!f)return N();var o;try{o=JSON.parse(f)}catch(i){o=JSON.parse(f.substring(65,f.length-2))}Op.loadFace(o),N&&N(o.familyName.toLowerCase())},N?null:{sync:!0})},createRingModel:function(y,Y,l,T,w,I,v,h,$,B){for(var x=[],G=0;G<y.length-1;G+=2)x.push({x:y[G],y:y[G+1]});I=I||A.shapeSide,v=v||0,h=h||I;var S,J,q,W,U,O,e,V,t,F,G,p,D,g,X,c,z,n,f=[],j=[],d=$?[]:Z,N=$?[]:Z,u=B?[]:Z,H=B?[]:Z,P=T?[]:Z,Q=T?[]:Z,i=w?[]:Z,C=w?[]:Z,y=Ai(x,Y,l),s=gc(y),a=0,K=2*Math.PI/I;return y.forEach(function(o){if(q=o.length,q>1){if(W=o[0],T)for(O=W.x,V=W.y,G=v;h>G;G++)p=G+1,D=G*K,g=p*K,X=m(D),c=E(D),z=m(g),n=E(g),P.push(X*O,V,-c*O,z*O,V,-n*O,0,V,0),Q.push(.5-.5*X,.5-.5*c,.5-.5*z,.5-.5*n,.5,.5);for(F=0;q>F;F++){for(U=o[F],O=W.x,e=U.x,V=W.y,t=U.y,S=a/s,a+=fm(W,U),J=a/s,G=v;h>G;G++)p=G+1,D=G*K,g=p*K,X=m(D),c=E(D),z=m(g),n=E(g),f.push(X*e,t,-c*e,z*e,t,-n*e,X*O,V,-c*O,z*e,t,-n*e,z*O,V,-n*O,X*O,V,-c*O),j.push(G/I,J,p/I,J,G/I,S,p/I,J,p/I,S,G/I,S),$&&G===v&&(d.push(0,V,0,0,t,0,X*e,t,-c*e,X*e,t,-c*e,X*O,V,-c*O,0,V,0),N.push(0,.5-V,0,.5-t,2*e,.5-t,2*e,.5-t,2*O,.5-V,0,.5-V)),B&&p===h&&(u.push(0,V,0,z*e,t,-n*e,0,t,0,z*e,t,-n*e,0,V,0,z*O,V,-n*O),H.push(1,.5-V,1-2*e,.5-t,1,.5-t,1-2*e,.5-t,1,.5-V,1-2*O,.5-V));W=U}if(w)for(O=W.x,V=W.y,G=v;h>G;G++)p=G+1,D=G*K,g=p*K,X=m(D),c=E(D),z=m(g),n=E(g),i.push(z*O,V,-n*O,X*O,V,-c*O,0,V,0),C.push(.5-.5*z,.5+.5*n,.5-.5*X,.5+.5*c,.5,.5)}}),{vs:f,uv:j,bottom_vs:i,bottom_uv:C,top_vs:P,top_uv:Q,from_vs:d,from_uv:N,to_vs:u,to_uv:H}}},!0),Nh(y,{"3d.move.mode":l,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"shape.border.gradient.color":l,"edge.gradient.color":l,"edge.source.t3":l,"edge.target.t3":l,"light.type":Hd,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":i/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":zf,"wf.short":!1,"wf.mat":l,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:l,"transparent.mask":!1,brightness:l,"select.brightness":.7,"repeat.uv.length":l,envmap:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,alwaysOnTop:!1,"texture.cache":!1,"hide.overlapping.group":l,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"label.face":Qj,"label.t3":l,"label.r3":l,"label.texture.scale":2,"label.rotationMode":_h,"label.light":!1,"label.blend":l,"label.reverse.flip":!1,"label.reverse.color":nr,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Qj,"label2.t3":l,"label2.r3":l,"label2.texture.scale":2,"label2.rotationMode":_h,"label2.light":!1,"label2.blend":l,"label2.reverse.flip":!1,"label2.reverse.color":nr,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Qj,"note.t3":l,"note.r3":l,"note.texture.scale":2,"note.rotationMode":_h,"note.light":!1,"note.blend":l,"note.reverse.flip":!1,"note.reverse.color":nr,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Qj,"note2.t3":l,"note2.r3":l,"note2.texture.scale":2,"note2.rotationMode":_h,"note2.light":!1,"note2.blend":l,"note2.reverse.flip":!1,"note2.reverse.color":nr,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:l,"shape3d.color":Tp,"shape3d.top.color":l,"shape3d.bottom.color":l,"shape3d.from.color":l,"shape3d.to.color":l,"shape3d.image":l,"shape3d.top.image":l,"shape3d.bottom.image":l,"shape3d.from.image":l,"shape3d.to.image":l,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":l,"shape3d.side.to":l,"shape3d.smooth":l,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":l,"shape3d.opacity":l,"shape3d.reverse.flip":!1,"shape3d.reverse.color":nr,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":l,"shape3d.uv.scale":l,"shape3d.top.uv.offset":l,"shape3d.top.uv.scale":l,"shape3d.bottom.uv.offset":l,"shape3d.bottom.uv.scale":l,"shape3d.from.uv.offset":l,"shape3d.from.uv.scale":l,"shape3d.to.uv.offset":l,"shape3d.to.uv.scale":l,"shape3d.top.cap":l,"shape3d.bottom.cap":l,"shape3d.start.angle":0,"shape3d.sweep.angle":I,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":!1,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"shape3d.vector.dynamic":!1,"shape3d.texture.scale":1,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.clip":.003,"texture.mipmap.max":l,"texture.filter":l,"texture.filter.min":l,"texture.filter.mag":l,"all.light":!0,"all.visible":!0,"all.color":Tp,"all.image":l,"all.blend":l,"all.opacity":l,"all.reverse.flip":!1,"all.reverse.color":nr,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":l,"all.uv.offset":l,"all.uv.scale":l,"all.discard.selectable":!0,mat:l,"left.mat":l,"right.mat":l,"top.mat":l,"bottom.mat":l,"front.mat":l,"back.mat":l},!0);var vq,pl=!1,lj=[0,0,0,0],Ap={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Bc,2:qe,3:Uh,4:Tg,5:Qj,6:Zd}},ie=function(U,$,b,V){if($.getFaceVisible(U,b)){var j=qp(U,$.getFaceMat(U,b)||$.getMat(U));
        U.appendAnchorMatrix3d(j),_i($,j);var A=$._26I;$.getFaceReverseCull(U,b)?A.enable(A.CULL_FACE):A.disable(A.CULL_FACE),qc(A,$._prg.uFixPickReverseColor,Ap[b]),ri(A),nm(A,V,6),ll(A),Kn($)}},bb=function(E){return E instanceof pq},Qr=function(z){return[z.x,z.e||0,z.y]},Db=function(n,x,E){for(var x=nk(x),w=x[0],u=x[1],B=x[2];E--;)n.push(w,u,B)},hp=function(X,t,b){for(var t=nk(t),o=t[0],E=t[1],i=t[2],e=t[3];b--;)X.push(o,E,i,e)},Lm=function(z,R,G){if(R)for(var S,Z,O,I=R[0],A=R[1],V=R[2],Y=R[4],r=R[5],t=R[6],C=R[8],n=R[9],J=R[10],b=R[12],a=R[13],N=R[14],k=G.length,F=0,F=0;k>F;F+=3)S=G[F],Z=G[F+1],O=G[F+2],z.push(I*S+Y*Z+C*O+b,A*S+r*Z+n*O+a,V*S+t*Z+J*O+N);else Ad(z,G)},dl=function(V,J){var d=J.s("light.intensity"),i=nk(J.s(Ip)),r=i[0],q=i[1],c=i[2];1!==d&&(r*=d,q*=d,c*=d),V.push(r,q,c,J.s("light.disabled")?1:0)},ib=function(w,M,r){qc(M,r.uHeadlightRange,w._headlightRange),qc(M,r.uHeadlightAmbientIntensity,w._headlightAmbientIntensity);var V=w._headlightIntensity,e=nk(w._headlightColor);1!==V&&(e=[e[0]*V,e[1]*V,e[2]*V]),qc(M,r.uHeadlightColor,[e[0],e[1],e[2],w._headlightDisabled?1:0]);var Q=w._59O,g=w._spots,h=w._dirs;if(Q.length){var n=[],U=[],X=[];Q.forEach(function(e){dl(n,e),Ad(U,w._transformPointToViewSpace(e.p3())),X.push(e.s("light.range"))}),M.uniform4fv(r.uPointColor,n),M.uniform1fv(r.uPointRange,X),M.uniform3fv(r.uPointPosition,U)}if(g.length){var q=[],i=[],Z=[],t=[],o=[],b=[];g.forEach(function(e){dl(q,e),Ad(i,w._transformPointToViewSpace(e.p3())),Ad(o,w._transformDirectionToViewSpace(e.p3(),e.s("light.center"))),Z.push(e.s("light.range")),t.push(m(e.s("light.angle")/2)),b.push(e.s("light.exponent"))}),M.uniform4fv(r.uSpotColor,q),M.uniform1fv(r.uSpotRange,Z),M.uniform1fv(r.uSpotAngle,t),M.uniform1fv(r.uSpotExponent,b),M.uniform3fv(r.uSpotPosition,i),M.uniform3fv(r.uSpotDirection,o)}if(h.length){var B=[],P=[];h.forEach(function(M){dl(B,M),Ad(P,w._transformDirectionToViewSpace(M.p3()))}),M.uniform4fv(r.uDirColor,B),M.uniform3fv(r.uDirDirection,P)}},Cc=function(W){return Math.max(A.graph3dViewMinPhi+Yd,Math.min(A.graph3dViewMaxPhi-Yd,W))},of=function(){return.05+q()/2},Rn=function(E,W,P,S){var Y,N=E.getEye();return E.isOrtho()?(Y=bm(E.getCenter(),N),Y[0]+=S[0],Y[1]+=S[1],Y[2]+=S[2]):Y=N,Hn(W,P,S,Y)},Hn=function(J,F,i,q){var R=bk(J,F),g=bm(q,i,!0),A=bk(g,F);if(t(A)<Yd)return Z;var w=(R-bk(i,F))/A;return[i[0]+g[0]*w,i[1]+g[1]*w,i[2]+g[2]*w]},Ti=function(u,K){return{x:2*u.x-K.x,y:2*u.y-K.y}},vp=function(l,b,W,K){var O,k;if(!l)return O=R(b.y-W.y,W.x-b.x),{x:b.x+K*E(O),y:b.y+K*m(O)};if(!W)return O=R(l.y-b.y,b.x-l.x),{x:b.x+K*E(O),y:b.y+K*m(O)};var t=bm([l.x,l.y,0],[b.x,b.y,0],!0),v=bm([W.x,W.y,0],[b.x,b.y,0],!0),F=-(t[0]+v[0])/2,q=-(t[1]+v[1])/2,L=w(F*F+q*q);if(Yd>L)return O=R(l.y-b.y,b.x-l.x),{x:b.x+K*E(O),y:b.y+K*m(O)};var G=l.x-b.x,M=l.y-b.y,I=W.x-b.x,y=W.y-b.y,Q=w(G*G+M*M),u=w(I*I+y*y);O=S(bk(t,v))/2,k=t[1]*v[0]-t[0]*v[1]>0?-1:1,F/=L,q/=L;var r=K/E(O),x=j(Q,u)/m(O);L=Math.min(r,x);var p={x:b.x+k*L*F,y:b.y+k*L*q};return W.b&&r>u/m(O)&&(p.adjust=!0),p},No=function(s){var f=s[1],n=s[2],c=s[3],N=s[6],Y=s[7],K=s[11];s[1]=s[4],s[2]=s[8],s[3]=s[12],s[4]=f,s[6]=s[9],s[7]=s[13],s[8]=n,s[9]=N,s[11]=s[14],s[12]=c,s[13]=Y,s[14]=K},lr=function(c){var R=c[0],x=c[1],g=c[2],P=c[3],u=c[4],y=c[5],N=c[6],n=c[7],D=c[8],s=c[9],K=c[10],B=c[11],w=c[12],M=c[13],j=c[14],q=c[15],r=R*y-x*u,V=R*N-g*u,A=R*n-P*u,H=x*N-g*y,f=x*n-P*y,C=g*n-P*N,F=D*M-s*w,Q=D*j-K*w,l=D*q-B*w,T=s*j-K*M,m=s*q-B*M,W=K*q-B*j,v=r*W-V*m+A*T+H*l-f*Q+C*F;return v?(v=1/v,c[0]=(y*W-N*m+n*T)*v,c[1]=(g*m-x*W-P*T)*v,c[2]=(M*C-j*f+q*H)*v,c[3]=(K*f-s*C-B*H)*v,c[4]=(N*l-u*W-n*Q)*v,c[5]=(R*W-g*l+P*Q)*v,c[6]=(j*A-w*C-q*V)*v,c[7]=(D*C-K*A+B*V)*v,c[8]=(u*m-y*l+n*F)*v,c[9]=(x*l-R*m-P*F)*v,c[10]=(w*f-M*A+q*r)*v,c[11]=(s*A-D*f-B*r)*v,c[12]=(y*Q-u*T-N*F)*v,c[13]=(R*T-x*Q+g*F)*v,c[14]=(M*V-w*H-j*r)*v,c[15]=(D*H-s*V+K*r)*v,void 0):Z},rn=function(S,G){if(G){var g=G[0],R=G[1],X=G[2];S[12]=S[0]*g+S[4]*R+S[8]*X+S[12],S[13]=S[1]*g+S[5]*R+S[9]*X+S[13],S[14]=S[2]*g+S[6]*R+S[10]*X+S[14],S[15]=S[3]*g+S[7]*R+S[11]*X+S[15]}},ld=function(t,b){if(b){var K=b[0],n=b[1],N=b[2];t[0]=t[0]*K,t[1]=t[1]*K,t[2]=t[2]*K,t[3]=t[3]*K,t[4]=t[4]*n,t[5]=t[5]*n,t[6]=t[6]*n,t[7]=t[7]*n,t[8]=t[8]*N,t[9]=t[9]*N,t[10]=t[10]*N,t[11]=t[11]*N}},Vf=function(p,g,q){var B=g[0],$=g[1],k=g[2],d=g[3],E=g[4],P=g[5],T=g[6],C=g[7],A=g[8],u=g[9],z=g[10],t=g[11],X=g[12],y=g[13],e=g[14],N=g[15],S=q[0],I=q[1],a=q[2],R=q[3];return p[0]=S*B+I*E+a*A+R*X,p[1]=S*$+I*P+a*u+R*y,p[2]=S*k+I*T+a*z+R*e,p[3]=S*d+I*C+a*t+R*N,S=q[4],I=q[5],a=q[6],R=q[7],p[4]=S*B+I*E+a*A+R*X,p[5]=S*$+I*P+a*u+R*y,p[6]=S*k+I*T+a*z+R*e,p[7]=S*d+I*C+a*t+R*N,S=q[8],I=q[9],a=q[10],R=q[11],p[8]=S*B+I*E+a*A+R*X,p[9]=S*$+I*P+a*u+R*y,p[10]=S*k+I*T+a*z+R*e,p[11]=S*d+I*C+a*t+R*N,S=q[12],I=q[13],a=q[14],R=q[15],p[12]=S*B+I*E+a*A+R*X,p[13]=S*$+I*P+a*u+R*y,p[14]=S*k+I*T+a*z+R*e,p[15]=S*d+I*C+a*t+R*N,p},Jn=function(R,p,H,Q){var Y,T,B,x,s,o,a,e,q,h,l=p[0],X=p[1],f=p[2],O=Q[0],G=Q[1],g=Q[2],U=H[0],V=H[1],S=H[2];return t(l-U)<Yd&&t(X-V)<Yd&&t(f-S)<Yd?Ri(R):(a=l-U,e=X-V,q=f-S,h=1/w(a*a+e*e+q*q),a*=h,e*=h,q*=h,Y=G*q-g*e,T=g*a-O*q,B=O*e-G*a,h=w(Y*Y+T*T+B*B),h?(h=1/h,Y*=h,T*=h,B*=h):(Y=0,T=0,B=0),x=e*B-q*T,s=q*Y-a*B,o=a*T-e*Y,h=w(x*x+s*s+o*o),h?(h=1/h,x*=h,s*=h,o*=h):(x=0,s=0,o=0),R[0]=Y,R[1]=x,R[2]=a,R[3]=0,R[4]=T,R[5]=s,R[6]=e,R[7]=0,R[8]=B,R[9]=o,R[10]=q,R[11]=0,R[12]=-(Y*l+T*X+B*f),R[13]=-(x*l+s*X+o*f),R[14]=-(a*l+e*X+q*f),R[15]=1,R)},Fl=function(i,E,G,w,j){var X=1/F(E/2),v=1/(w-j);return i[0]=X/G,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=X,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=(j+w)*v,i[11]=-1,i[12]=0,i[13]=0,i[14]=2*j*w*v,i[15]=0,i},is=function(b,B,S,T,u,j,f){var G=1/(B-S),a=1/(T-u),J=1/(j-f);return b[0]=-2*G,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=-2*a,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=2*J,b[11]=0,b[12]=(B+S)*G,b[13]=(u+T)*a,b[14]=(f+j)*J,b[15]=1,b},Xe=function(K,B){var y=B[0],z=B[1],E=B[2],G=B[3],r=y*y+z*z+E*E+G*G,P=r?1/r:0;return K[0]=-y*P,K[1]=-z*P,K[2]=-E*P,K[3]=G*P,K},cn=function(n,w){var i=w[0]+w[5]+w[10],r=0;return i>0?(r=2*Math.sqrt(i+1),n[3]=.25*r,n[0]=(w[6]-w[9])/r,n[1]=(w[8]-w[2])/r,n[2]=(w[1]-w[4])/r):w[0]>w[5]&w[0]>w[10]?(r=2*Math.sqrt(1+w[0]-w[5]-w[10]),n[3]=(w[6]-w[9])/r,n[0]=.25*r,n[1]=(w[1]+w[4])/r,n[2]=(w[8]+w[2])/r):w[5]>w[10]?(r=2*Math.sqrt(1+w[5]-w[0]-w[10]),n[3]=(w[8]-w[2])/r,n[0]=(w[1]+w[4])/r,n[1]=.25*r,n[2]=(w[6]+w[9])/r):(r=2*Math.sqrt(1+w[10]-w[0]-w[5]),n[3]=(w[1]-w[4])/r,n[0]=(w[8]+w[2])/r,n[1]=(w[6]+w[9])/r,n[2]=.25*r),n},$k=function(Y,Q,n){var E=Q[0],T=Q[1],h=Q[2],V=Q[3],i=E+E,K=T+T,M=h+h,e=E*i,r=E*K,H=E*M,X=T*K,o=T*M,G=h*M,w=V*i,m=V*K,B=V*M;return Y[0]=1-(X+G),Y[1]=r+B,Y[2]=H-m,Y[3]=0,Y[4]=r-B,Y[5]=1-(e+G),Y[6]=o+w,Y[7]=0,Y[8]=H+m,Y[9]=o-w,Y[10]=1-(e+X),Y[11]=0,Y[12]=n[0],Y[13]=n[1],Y[14]=n[2],Y[15]=1,Y},Uk=function(Q,U){if(Q.vr.enable){var Z=Q.vr.getViewMatrix(U);if(Z)return Z}return Jn(U?U:jh(),Q._eye,Q._center,Q._up)},wj=function(M,x){if(M.vr.enable){var J=M.vr.getProjectMatrix();if(J)return J}if(!x&&M._computedProjectMatrix)return Qp(M._computedProjectMatrix);var Q=M.getAspect(),Y=M._near,N=M._far,r=jh();if(M._ortho){var u=M._orthoWidth/2,U=u/Q;is(r,-u,u,-U,U,Y,N)}else Fl(r,M._fovy,Q,Y,N);return r},fi=function(C,_){if(!C)return Z;var J=0,c=1,r=2,F=[],g=0,v=C.length,N=v/3;if(_){for(;v>g;g++)F[g]=0;for(g=0;g<_.length;g+=3){var m=[],M=[],n=[];m[J]=C[3*_[g+1]+J]-C[3*_[g]+J],m[c]=C[3*_[g+1]+c]-C[3*_[g]+c],m[r]=C[3*_[g+1]+r]-C[3*_[g]+r],M[J]=C[3*_[g+2]+J]-C[3*_[g+1]+J],M[c]=C[3*_[g+2]+c]-C[3*_[g+1]+c],M[r]=C[3*_[g+2]+r]-C[3*_[g+1]+r],n[J]=m[c]*M[r]-m[r]*M[c],n[c]=m[r]*M[J]-m[J]*M[r],n[r]=m[J]*M[c]-m[c]*M[J];for(var Y=0;3>Y;Y++)F[3*_[g+Y]+J]+=n[J],F[3*_[g+Y]+c]+=n[c],F[3*_[g+Y]+r]+=n[r]}}else for(g=0;N>g;g+=3){var m=[],M=[],n=[];m[J]=C[3*(g+1)+J]-C[3*g+J],m[c]=C[3*(g+1)+c]-C[3*g+c],m[r]=C[3*(g+1)+r]-C[3*g+r],M[J]=C[3*(g+2)+J]-C[3*(g+1)+J],M[c]=C[3*(g+2)+c]-C[3*(g+1)+c],M[r]=C[3*(g+2)+r]-C[3*(g+1)+r],n[J]=m[c]*M[r]-m[r]*M[c],n[c]=m[r]*M[J]-m[J]*M[r],n[r]=m[J]*M[c]-m[c]*M[J];for(var Y=0;3>Y;Y++)F[3*(g+Y)+J]=n[J],F[3*(g+Y)+c]=n[c],F[3*(g+Y)+r]=n[r]}for(g=0;v>g;g+=3){var y=[];y[J]=F[g+J],y[c]=F[g+c],y[r]=F[g+r];var H=w(y[J]*y[J]+y[c]*y[c]+y[r]*y[r]);0===H&&(H=Yd),y[J]=y[J]/H,y[c]=y[c]/H,y[r]=y[r]/H,F[g+J]=y[J],F[g+c]=y[c],F[g+r]=y[r]}return new Hf(F)},$d=function(R,n,A,w){if(A||(A=R.createTexture()),n){var D=R.TEXTURE_2D,F=R.REPEAT,g=R.CLAMP_TO_EDGE,i=R.TEXTURE_MIN_FILTER;w=w||Yn;var S=w.minFilter||w.filter||R.LINEAR,c=w.magFilter||w.filter||R.LINEAR;vk(R,A),R.texImage2D(D,0,R.RGBA,R.RGBA,R.UNSIGNED_BYTE,n),Bb(R,R.TEXTURE_MAG_FILTER,c);var Y=n.naturalWidth||n.width,$=n.naturalHeight||n.height;rk.isPOT(Y)&&rk.isPOT($)&&!n.clampToEdge?(Bb(R,R.TEXTURE_WRAP_S,F),Bb(R,R.TEXTURE_WRAP_T,F),Bb(R,i,S===R.NEAREST?R.NEAREST_MIPMAP_NEAREST:R.LINEAR_MIPMAP_LINEAR),w.mipmapMaxLevel!==l&&Bb(R,R.TEXTURE_MAX_LEVEL,w.mipmapMaxLevel),R.generateMipmap(D)):(Bb(R,R.TEXTURE_WRAP_S,g),Bb(R,R.TEXTURE_WRAP_T,g),Bb(R,i,S)),vk(R,Z)}return A},lp=function(G,t){var f=new Uint8Array(4);return t=t||G.createTexture(),vk(G,t),Bb(G,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texImage2D(G.TEXTURE_2D,0,G.RGBA,1,1,0,G.RGBA,G.UNSIGNED_BYTE,f),t},Tk=function(C){C._26I&&C._prg&&(C._26I.deleteProgram(C._prg),C._prg=Z)},$i=function(N,T,f,O){var L=N.createShader(f);return N.shaderSource(L,O),N.compileShader(L),N.attachShader(T,L),L},Li=function(N){return N.createBuffer()},vk=function(K,w){K.bindTexture(K.TEXTURE_2D,w)},Bb=function(K,Y,A){K.texParameteri(K.TEXTURE_2D,Y,A)},Xf=function(k,a){k.enable(k.POLYGON_OFFSET_FILL),k.polygonOffset(a[0],a[1])},Qq=function(l){l.disable(l.POLYGON_OFFSET_FILL)},Ml=function(L,e){if(e){var e=nk(e);L.clearColor(e[0],e[1],e[2],e[3])}},xe=function(T,d){qc(T,d.uFix,!0),Ud(T,d.aNormal)},Oc=function(L,I){qc(L,I.uFix,!1),zs(L,I.aNormal)},Oj=function(C,r,W,M,c,f,A,_){C._picking||(W?(qc(C,r.uBlend,!0),qc(C,r.uBlendColor,W)):qc(C,r.uBlend,!1),qc(C,r.uLight,M==Z?!0:M),gh(c)&&1!==c&&qc(C,r.uPartOpacity,c),qc(C,r.uReverseFlip,f==Z?!1:f),qc(C,r.uFixPickReverseColor,A||nr)),_?C.enable(C.CULL_FACE):C.disable(C.CULL_FACE)},eh=function(U,o){U._picking||qc(U,o.uPartOpacity,1)},ri=function(){var x=[0,0,1,1];return function(p,V,C,$,m,D,e,Z,n){return C?(qc(p,V.uTexture,!0),qc(p,V.uDiscardSelectable,ej($)?$:!0),zs(p,V.aUv),_p(p,m,D,V.aUv,2),n?(qc(p,V.uBlendTexture,!0),p.activeTexture(p.TEXTURE1),vk(p,n),p.uniform1i(V.uBlendSampler,1)):(qc(p,V.uBlendTexture,!1),p.activeTexture(p.TEXTURE1),vk(p,p._emptyBlendTexture)),p.activeTexture(p.TEXTURE0),vk(p,C),p.uniform1i(V.uSampler,0),e?(x[0]=e[0],x[1]=e[1]):(x[0]=0,x[1]=0),Z?(x[2]=Z[0],x[3]=Z[1]):(x[2]=1,x[3]=1),qc(p,V.uOffsetScale,x),void 0):(p.activeTexture(p.TEXTURE0),vk(p,p._emptyTexture),p.activeTexture(p.TEXTURE1),vk(p,p._emptyBlendTexture),void 0)}}(),ll=function(E,K,G){E.activeTexture(E.TEXTURE0),vk(E,Z),E.activeTexture(E.TEXTURE1),vk(E,Z),G&&(Ud(E,K.aUv),qc(E,K.uTexture,!1),qc(E,K.uBlendTexture,!1))},Tr=function(A,z,h,$,U,Q){!h||Fj||zo||A.lineWidth(h),$&&!A._picking&&qc(A,z.uFixPickReverseColor,$),U&&_p(A,U,Q,z.aPosition)},co=function(Q,g,r,H){vq&&(H=Q[vq]),Q.drawArrays(H==Z?Q.TRIANGLES:H,g,r);var t=Q._renderInfo;t&&(t.calls++,t.vertices+=r,(H==Z||H===Q.TRIANGLES)&&(t.faces+=r/3),H===Q.LINES&&(t.lines+=r/2))},nm=function(P,U,j,y){vq&&(y=P[vq]),P.drawElements(y==Z?P.TRIANGLES:y,j,P.UNSIGNED_SHORT,U==Z?0:2*U);var v=P._renderInfo;v&&(v.calls++,v.vertices+=j,(y==Z||y===P.TRIANGLES)&&(v.faces+=j/3),y===P.LINES&&(v.lines+=j/2))},zj=function(S,f,O,o,t){var L=S.ARRAY_BUFFER;S.bindBuffer(L,f),O&&S.bufferData(L,O,S.STATIC_DRAW),o!=Z&&S.vertexAttribPointer(o,t?t:3,S.FLOAT,!1,0,0)},_p=function(q,j,d,y,k){return d?(fb(q,q.ARRAY_BUFFER,j,d),y!=Z&&q.vertexAttribPointer(y,k?k:3,q.FLOAT,!1,0,0),void 0):zj(q,j,d,y,k)},db=function(t,O,c){var n=t.ELEMENT_ARRAY_BUFFER;t.bindBuffer(n,O),c&&t.bufferData(n,c,t.STATIC_DRAW)},sc=function(r,X,p){fb(r,r.ELEMENT_ARRAY_BUFFER,X,p)},fb=function(o,u,A,H){var N=H._bufId;N||(N=H._bufId=a.Math.generateIncreasingID());var A,l=o._bufPool;(A=l[N])&&A._buf?o.bindBuffer(u,A._buf):(A=l[N]={_buf:Li(o)},o.bindBuffer(u,A._buf),o.bufferData(u,H,o.STATIC_DRAW)),A._fid=o._renderInfo.frame},qc=function(q,v,T){if(T!=Z&&v!=Z){T=nk(T);var k=T.length;3===k?q.uniform3fv(v,T):4===k?q.uniform4fv(v,T):16===k?q.uniformMatrix4fv(v,!1,T):ej(T)?q.uniform1i(v,T?1:0):2===k?q.uniform2fv(v,T):q.uniform1f(v,T)}},zs=function(B,e){e!=Z&&e>=0&&B.enableVertexAttribArray(e)},Ud=function(g,t){t!=Z&&t>=0&&g.disableVertexAttribArray(t)},Kn=function(M,j){var Y=M.getGL(),n=M._prg;M._7O=M._8O.pop(),j&&(qc(Y,n.uMVMatrix,M._7O),M._6O=j,qc(Y,n.uNMatrix,j))},Ym=function(v,m){return m||(m=jh()),Vg(m,v),lr(m),No(m),m},_i=function(j,u){var g=j.getGL(),x=j._prg,T=j._7O;u&&(j._8O.push(Qp(T)),qc(g,x.uMMatrix,u),Vf(T,T,u),j._7O=T),qc(g,x.uMVMatrix,T),qc(g,x.uNMatrix,Ym(T,j._6O))},di=function(u,K,y,n,c,e){if(y){if(n){var T=y.value++,l=2147483648|T,p=[(255&l>>16)/255,(255&l>>8)/255,(255&l)/255,(255&l>>24)/255];y[T]={data:c,part:e}}else p=lj;return qc(u,K.uFixPickReverseColor,p),p}},Bl=function(d,J,X){"target"!==X&&(X="source");var D="target"===X?J.getTargetAgent():J.getSourceAgent(),r="edge."+X+".";if(Pr(D)){var q=J.s(r+"anchor.x"),p=J.s(r+"anchor.elevation"),e=J.s(r+"anchor.y"),t=qp(D,d.getMat(D)),K=D.getAnchor3d();return ao([(q===l?.5:q)-K.x,(p===l?.5:p)-K.y,(e===l?.5:e)-K.z],t)}var A=J.s(r+"index"),_=d.getData3dUI(D);if(!_.info||!_.info.list)return!1;if(A>=0){var b,F,f,E,u,G=_.info._lastPointsSegments,R=G.points,x=G.segments,P=-1,S=-1;for(f=0,E=x?x.length:R.length;E>f;f++){if(F=x?x.get(f):1,3===F)u=2;else if(4===F)u=3;else{if(5===F)continue;u=1}if(P+=u,S++,S===A){b=R.get(P);break}}return b||(b=R.get(R.length-1)),[b.x,b.e||0,b.y]}var C=J.s(r+"percent")||.5;if(C=Math.max(0,Math.min(C,1)),!_||!_.getCache)return!1;var z=_.getCache(),E=z[z.length-1].length,G=d.getLineOffset(D,C*E),g=G.point;return[g.x,g.y,g.z]},iq=function(){var U={center:function(V,i,R,y,C){var z=-i[1]/2,B={x:-i[0]/2,y:z,width:i[0],height:i[1]},H=od(V,B,R);return[H.x+y,-H.y-C,of()]},front:function(L,C,t,u,W){var l=-C[1]/2,d={x:-C[0]/2,y:l,width:C[0],height:C[1]},Y=od(L,d,t);return[Y.x+u,-Y.y-W,C[2]/2+of()]},back:function(A,o,S,q,h){var K=-o[0]/2,r=-o[1]/2,s={x:K,y:r,width:o[0],height:o[1]},Z=od(A,s,S);return[-Z.x-q,-Z.y-h,-o[2]/2-of()]},left:function(E,x,P,K,Z){var c=-x[1]/2,Y={x:-x[2]/2,y:c,width:x[2],height:x[1]},m=od(E,Y,P);return[-x[0]/2-of(),-m.y-Z,m.x+K]},right:function(O,K,I,h,s){var _=-K[2]/2,u=-K[1]/2,L={x:_,y:u,width:K[2],height:K[1]},Z=od(O,L,I);return[K[0]/2+of(),-Z.y-s,-Z.x-h]},top:function(v,t,u,B,o){var E={x:-t[0]/2,y:-t[2]/2,width:t[0],height:t[2]},I=od(v,E,u);return[I.x+B,t[1]/2+of(),I.y+o]},bottom:function(W,F,$,j,J){var G=-F[2]/2,y={x:-F[0]/2,y:G,width:F[0],height:F[2]},t=od(W,y,$);return[t.x+j,-F[1]/2-of(),-t.y-J]}};return function(i,W,Z,r,$,_){return U[r](i,W,Z,$||0,_||0)}}(),cf=function(o,P,F,j,G,y,l,N,r,e){if(G&&(P[0]+=G[0],P[1]+=G[1],P[2]+=G[2]),rn(o,F),N){var n=jh();if(He(n,r,e),ao(P,n),rn(o,P),o.auto=N,o.pos=ao([0,0,0],o),y){var Q=o.mat2=jh();He(Q,y,l)}}else He(o,r,e),rn(o,P),j===Bc?ds(o,-x):j===qe?ds(o,x):j===Uh?Cr(o,-x):j===Tg?Cr(o,x):j===Zd&&ds(o,i),He(o,y,l);return o},kb=function(M,Z){var X=Z.auto,D=Z.mat2,P=M.gv;if(X){var u,s=jh(),o=[0,0,0,0];u="string"==typeof X?[X.indexOf("x")<0?P._eye[0]:P._center[0],X.indexOf("y")<0?P._eye[1]:P._center[1],X.indexOf("z")<0?P._eye[2]:P._center[2]]:P._eye,cn(o,Jn(jh(),u,P._center,P._up)),$k(s,Xe(o,o),Z.pos),D&&Vf(s,s,D),_i(P,s)}else _i(P,Z)},Ni=function(f,v,w,T,S){var x=f.s,p=f.gv,$=p.getGL(),L=p._prg,Q=p._buffer,Y=p._1O;$d($,Nc,Y),kb(f,w),Oj($,L,x(v+".blend"),x(v+".light"),x(v+".opacity"),x(v+".reverse.flip"),x(v+".reverse.color"),x(v+".reverse.cull")),ri($,L,Y,S,Q.uv,ae),_p($,Q.vs,T,L.aPosition),_p($,Q.ns,eo,L.aNormal),sc($,Q.is,Hh),nm($,0,Hh.length),ll($,L,Y),eh($,L),Kn(p)},gk=function(k,q,I){var X=k.gv,N=k.data,v=k[q]={blend:X.getBodyColor(N)||X.getFaceBlend(N,q),light:X.getFaceLight(N,q),color:X.getFaceColor(N,q),opacity:X.getFaceOpacity(N,q),transparent:X.getFaceTransparent(N,q),reverseFlip:X.getFaceReverseFlip(N,q),reverseColor:X.getFaceReverseColor(N,q),reverseCull:X.getFaceReverseCull(N,q),texture:X.getFaceImage(N,q),blendTexture:X.getFaceBlendImage(N,q),discardSelectable:X.getFaceDiscardSelectable(N,q)};if("csg"!==q){v.uv=X.getFaceUv(N,q)||I&&I[q+"Uv"],v.uvScale=X.getFaceUvScale(N,q)||I&&I[q+"UvScale"],v.uvOffset=X.getFaceUvOffset(N,q)||I&&I[q+"UvOffset"];var M=X.getFaceMat(N,q);if(M){var z=qp(N,M);N.appendAnchorMatrix3d(z),v.mat=z}}return v},_r=function(A,x,U,$,S){var m=A[$];if(m){if(!S(m.transparent))return;var W=A.data,b=A.gv,E=b._buffer,d=b.getTexture(m.texture,W,$),r=b.getTexture(m.blendTexture,W);ri(x,U,d,m.discardSelectable,E.uv,m.tuv,m.uvOffset,m.uvScale,r),Oj(x,U,m.blend,m.light,m.opacity,m.reverseFlip,m.reverseColor,m.reverseCull),qc(x,U.uDiffuse,m.color||y["color.empty"]),_p(x,E.vs,m.vs,U.aPosition),_p(x,E.ns,m.ns,U.aNormal),co(x,0,m.vs.length/3),eh(x,U),ll(x,U,d)}},ss=function(f,S,E,T,M,z){var p,C,k,n,u,L,c,m,R,U,W,v=[T-S,M-E],d=f?f.length:0;for(k=0;d>k;k++){for(n=2,p=f[k],u=p[0],L=p[1];n+1<p.length;){if(c=p[n],m=p[n+1],C=ff(S,E,T,M,u,L,c,m,!0)){R=[c-u,m-L],U=fm(R),R[0]/=U,R[1]/=U,U=bk(v,R),U=U>0?z:-z,W=[R[0]*U,R[1]*U];break}u=c,L=m,n+=2}if(W)break}if(W)for(T=S+W[0],M=E+W[1],k=0;d>k;k++)for(n=2,p=f[k],u=p[0],L=p[1];n+1<p.length;){if(c=p[n],m=p[n+1],C=ff(S,E,T,M,u,L,c,m,!0))return[0,0];u=c,L=m,n+=2}return W?W:[T-S,M-E]},Hp=a.graph3d={},Hg=function(p,z,j){Im(W+".graph3d."+p,z,j)},vh="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj<*opjujtpQb)4dfw!>!opjujtpQw~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Gf="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw|!*1!?!opjudfsjEqjmDv)!gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<uofdsfQqjmDv!ubpmg!nspgjov<opjudfsjEqjmDv!uoj!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Nh(A,{setBatchInfo:function(g,x){Ao[g]=x},getBatchInfo:function(P){return Ao[P]}},!0);var rs=[1,1,1],bg=[1,0,0,0,0,1,0,1,1,1,1,0],ip=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Wj=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Cj=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Hm=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Zf=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],ih=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],bo=function(O,l){Cd(O,l,"_batchModelMap","_batchIndexMap"),uq(O,l,"_wireframeModelMap","_wireframeIndexMap"),uq(O,l,"_polylineModelMap","_polylineIndexMap"),uq(O,l,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),uq(O,l,"_polylineModelMapSwap","_polylineIndexMapSwap")},Cd=function(_,J,p,w){if(!J)return _[p]={},_[w]={},void 0;var r=J._id,A=_[w],T=A[r];if(T){var l=_[p],i=T.batch,S=l[i],W=S.ds,R=T.index;if(S.invalidate=!0,delete A[r],W.splice(R,1),Eb(W))return delete l[i],void 0;for(var z=T.begin,N=T.size,o=3*z,K=3*N,H=4*z,e=4*N,b=S.vs,Y=S.ps,C=S.uv,O=S.cs,q=S.bs,F=S.rs,Q=S.ns,G=S.ls;R<W.length;R++)T=A[W[R]._id],T.index--,T.begin-=N;b.splice(o,K),Y.splice(H,e),C&&C.splice(2*z,2*N),O&&O.splice(H,e),q&&q.splice(o,K),F&&F.splice(z,N),Q&&Q.splice(o,K),G&&G.splice(z,N)}},uq=Cd,Yl=function(l,L,$,F){if(!F)return Z;var d=L[F];if(!d){var C=Ao[F]||Yn,x=C.image?[]:Z;d=L[F]={vs:[],ns:[],uv:x,cs:x?Z:C.color?Z:[],bs:C.blend?[]:Z,ps:[],rs:C.brightness?[]:Z,ds:[]}}return d.invalidate=!0,l[$._id]={index:d.ds.length,begin:d.vs.length/3,batch:F},d.ds.push($),d},om=function($,Y){return Y!=Z&&1!==Y?[$[0]*Y,$[1]*Y,$[2]*Y,$[3]]:$},xj=function(){var i;return function(x,o,h){var q=x.getData3dUI(o),B=q.shapeModel;B||(B=Xr(q));var F,y=o.s("wf.combineTriangle");if(h.geometry){if(!B&&(o instanceof a.Node&&!(o instanceof a.Shape)?(i||(i={vs:tp,is:up,uv:jr}),B=i):B=[q.left,q.front,q.right,q.back,q.top,q.bottom],!B))return l;if(y?(y=0|Math.min(3,Math.max(1,isNaN(y)?1:y)),F=af[y-1](B)):F=ns(B),!F||0===F.length)return}else F=h.short?Ji:gq;var $=x.getBrightness(o),r=nk(h.color||"white"),u=r[3]<1,V=Math.ceil(h.width)||1,R=(u?"T":"O")+V,k=x._wireframeIndexMap,A=x._wireframeModelMap,s=A[R];s||(s=A[R]={vs:[],cs:[],ps:[],ds:[],T:u,W:V}),s.invalidate=!0;var e=s.vs,f=s.cs,I=s.ds,H=k[o._id]={index:I.length,begin:e.length/3,batch:R};I.push(o);var O=q.mat;o instanceof a.Edge||!(!O||!h.geometry&&o instanceof a.Shape)||(O=qp(o,h.mat),o.appendAnchorMatrix3d(O)),Lm(e,O,F);var n=H.size=e.length/3-H.begin;hp(f,om(r,$),n)}}(),If=function(G,A,d,i,S,t,n,g,Q){var h=G.getBrightness(A);h==Z&&(h=1);var v=om(nk(i),h),y=v[3]<1;t=Math.ceil(t)||1;var x=(y?"T":"O")+t;if(n){var K=n[0],b=(n[1]||K)+K;x+="-"+K+"-"+b,Q&&(x+="-"+jn(Q)+"-"+h,Q=om(nk(Q),h))}var V=G._polylineIndexMap,N=G._polylineModelMap,P=N[x];P||(P=N[x]={vs:[],cs:[],ps:[],ds:[],ls:n?[]:Z,T:y,W:t},n&&(P.D=K,P.G=b,P.A=Q)),P.invalidate=!0;var L,U=P.vs,$=P.cs,_=P.ds,u=P.ls,c=V[A._id]={index:_.length,begin:U.length/3,batch:x};_.push(A),Ad(U,d);var I,H=c.size=U.length/3-c.begin,T=d.length,O=0,F=[];if(n||S)for(L=0;T>L;L+=6)I=fm([d[L],d[L+1],d[L+2]],[d[L+3],d[L+4],d[L+5]]),F.push(I),O+=I;if(O&&S){var R,C=om(nk(S),h),f=[C[0]-v[0],C[1]-v[1],C[2]-v[2],C[3]-v[3]],J=0;for(L=0;T>L;L+=6)R=J/O,hp($,[v[0]+f[0]*R,v[1]+f[1]*R,v[2]+f[2]*R,v[3]+f[3]*R],1),J+=F[L/6],R=J/O,hp($,[v[0]+f[0]*R,v[1]+f[1]*R,v[2]+f[2]*R,v[3]+f[3]*R],1)}else hp($,v,H);if(n)for(J=g||0,L=0;T>L;L+=6)u.push(J),J+=F[L/6],u.push(J)},Id=function(h,X,m){if(X)for(var D=4*X.begin,O=m[X.batch].ps,z=0;z<X.size;z++)O[D++]=h[0],O[D++]=h[1],O[D++]=h[2],O[D++]=h[3]},Mm=function(x,b){var a=b+["32"],M=x[b],n=x[a];M?n&&n.length===M.length?(n.set(M),n._bufId=null):x[a]=new Hf(M):delete x[a]},rm=function(P,g,x,c,t,B,K,$,b){if(sp(x))x.forEach(function(d){rm(P,g,d,c,t,B,K,$,b)});else if(tk(x))rm(P,g,Xr(c,x),c,t,B,K,$,b);else if(Bn(x)){var U,X=Xo(x.mat,g,P),Q=Xo(x.s3,g,P),z=Xo(x.t3,g,P),I=Xo(x.r3,g,P);if((Q||I||z||X)&&(U=xi(X,Q,I,Xo(x.rotationMode,g,P),z),B.push(U)),x.shape3d)rm(P,g,x.shape3d,c,t,B,K,$,x);else{var W=c.s;b=b||Yn;var H=B[0],E=B.length,i=W("shape3d.color",x.color,b.color);if(t||(t=W("shape3d.blend",x.blend,b.blend)),E>1){H=Qp(H);for(var w=1;E>w;w++)Vf(H,H,B[w])}x.vs&&W(oh,x.visible,b.visible)&&ws(H,K,$,x.vs,x.uv,x.is,t,i),x.top_vs&&W(Pm,x.topVisible,b.topVisible)&&ws(H,K,$,x.top_vs,x.top_uv,x.top_is,t,W("shape3d.top.color",x.topColor,b.topColor)||i),x.bottom_vs&&W(gi,x.bottomVisible,b.bottomVisible)&&ws(H,K,$,x.bottom_vs,x.bottom_uv,x.bottom_is,t,W("shape3d.bottom.color",x.bottomColor,b.bottomColor)||i),x.from_vs&&W(Qo,x.fromVisible,b.fromVisible)&&ws(H,K,$,x.from_vs,x.from_uv,x.from_is,t,W("shape3d.from.color",x.fromColor,b.fromColor)||i),x.to_vs&&W(Dc,x.toVisible,b.toVisible)&&ws(H,K,$,x.to_vs,x.to_uv,x.to_is,t,W("shape3d.to.color",x.toColor,b.toColor)||i)}U&&B.pop()}},ws=function(a,f,L,P,v,K,c,B){var g,J=f.cs,y=f.uv,l=f.bs;if(K){g=K.length;for(var F=0;g>F;F++){var N=K[F];Lm(L,a,[P[3*N],P[3*N+1],P[3*N+2]]),y&&Ad(y,[v[2*N],v[2*N+1]])}}else g=P.length/3,Lm(L,a,P),y&&Ad(y,v);J&&hp(J,B,g),l&&(c?Db(l,c,g):Ad(l,rs,g))},ls=function(K,Q,U,Z){var m=[];Z?rm(K.gv,K.data,Z,K,K.getBodyColor(),[Q],U,m):(Ug(K,Bc,Q,U,m),Ug(K,qe,Q,U,m),Ug(K,Qj,Q,U,m),Ug(K,Zd,Q,U,m),Ug(K,Uh,Q,U,m),Ug(K,Tg,Q,U,m),Ug(K,"csg",Q,U,m)),m.length&&(Ad(U.vs,m),Ad(U.ns,fi(m)))},Ug=function(z,I,l,v,n){var j=z[I];if(j){var N=j.tuv;if(N){var H,C,P,y,V=j.uvScale,J=j.uvOffset;if(V)for(H=N.length,C=V[0],P=V[1],y=0;H>y;y+=2)N[y]*=C,N[y+1]*=P;if(J)for(H=N.length,C=J[0],P=J[1],y=0;H>y;y+=2)N[y]+=C,N[y+1]+=P}ws(l,v,n,j.vs,N,Z,j.blend,j.color)}},Nk=function(U,G,w,v,l,O,s,$){var g,u=w.cs,b=w.uv,y=w.bs;if(U.getFaceVisible(G,O)){var I=U.getFaceMat(G,O);if(I&&(l=qp(G,I)),Lm(s,l,$),u&&hp(u,U.getFaceColor(G,O),6),b){var i=U.getFaceUv(G,O)||v[O+"Uv"],X=U.getFaceUvScale(G,O)||v[O+"UvScale"],r=U.getFaceUvOffset(G,O)||v[O+"UvOffset"];i=i?[i[6],i[7],i[0],i[1],i[2],i[3],i[2],i[3],i[4],i[5],i[6],i[7]]:bg;var C=i[0],T=i[1],e=i[2],z=i[3],Y=i[4],a=i[5],t=i[6],D=i[7],E=i[8],h=i[9],H=i[10],F=i[11];if(X){var R=X[0],V=X[1];C*=R,T*=V,e*=R,z*=V,Y*=R,a*=V,t*=R,D*=V,E*=R,h*=V,H*=R,F*=V}if(r){var Q=r[0],d=r[1];C+=Q,T+=d,e+=Q,z+=d,Y+=Q,a+=d,t+=Q,D+=d,E+=Q,h+=d,H+=Q,F+=d}b.push(C,T,e,z,Y,a,t,D,E,h,H,F)}y&&(g=U.getBodyColor(G)||U.getFaceBlend(G,O),g?Db(y,g,6):Ad(y,rs,6))}},ms=function(r,I,R,e){var p=r.getGL(),F=r._prg,f=r._buffer;if(!r.drawFilter&&!rr(I)){_i(r),xe(p,F);for(var P in I){var x=I[P];if(!(e&&!x.T||!e&&x.T)){x.invalidate?(x.invalidate=!1,Mm(x,"vs"),Mm(x,"cs"),Mm(x,"ls"),Mm(x,"ps")):R&&Mm(x,"ps");
        var W=x.vs32,O=R?x.ps32:x.cs32;Tr(p,F,x.W,Z,f.vs,W);var d=x.D,T=!r._dashDisabled&&d;qc(p,F.uAlphaTest,y.alphaTest),T&&(qc(p,F.uDash,!0),qc(p,F.uDashDistance,d),qc(p,F.uDashGapDistance,x.G),zs(p,F.aLineDistance),_p(p,f.lineDistance,x.ls32,F.aLineDistance,1),qc(p,F.uDiffuse,x.A||y["color.empty"]));var k=!r._batchColorDisabled;k&&(qc(p,F.uBatchColor,!0),zs(p,F.aBatchColor),_p(p,f.batchColor,O,F.aBatchColor,4)),ri(p),co(p,0,W.length/3,p.LINES),ll(p),k&&(qc(p,F.uBatchColor,!1),Ud(p,F.aBatchColor)),T&&(qc(p,F.uDash,!1),Ud(p,F.aLineDistance))}}Oc(p,F)}},uk=function(k,i,G){var I,Q,B,R,x,Y,F,v,K,H,T,g=k.getGL(),h=k._prg,V=k._buffer,m=k._batchModelMap;if(!rr(m)&&!k.drawFilter){_i(k);for(I in m)if(Q=Ao[I]||Yn,!(G&&!Q.transparent||!G&&Q.transparent)&&(B=m[I],i||!Q.transparentMask)){var J=G&&Q.autoSort!==!1&&(k._33Q||B.invalidate);if(B.invalidate?(B.invalidate=!1,Mm(B,"vs"),Mm(B,"ns"),Mm(B,"cs"),Mm(B,"rs"),Mm(B,"ps"),Mm(B,"bs"),Mm(B,"uv")):i&&Mm(B,"ps"),x=B.vs32,Y=i?B.ps32:B.cs32,K=B.uv32,F=B.bs32,v=B.rs32,T=x.length/3,J&&(B.is=to(x,k.getEye())),T){R=Q.light,H=k.getTexture(Q.image),Oj(g,h,Z,Q.light,Q.opacity,Q.reverseFlip,Q.reverseColor,Q.reverseCull),Y?k._batchColorDisabled||(qc(g,h.uBatchColor,!0),zs(g,h.aBatchColor),_p(g,V.batchColor,Y,h.aBatchColor,4)):qc(g,h.uDiffuse,Q.color||y["color.empty"]);var n=Q.alphaTest;qc(g,h.uAlphaTest,n===l?y.alphaTest:n),Q.envmap!==l?(qc(g,h.uUseEnvMap,!0),qc(g,h.uReflectivity,Q.envmap)):(qc(g,h.uUseEnvMap,!1),qc(g,h.uReflectivity,0));var _=F&&!k._batchBlendDisabled;_&&(qc(g,h.uBatchBlend,!0),zs(g,h.aBatchBlend),_p(g,V.batchBlend,F,h.aBatchBlend));var W=v&&!k._batchBrightnessDisabled;W&&(qc(g,h.uBatchBrightness,!0),zs(g,h.aBatchBrightness),_p(g,V.batchBrightness,v,h.aBatchBrightness,1)),K?ri(g,h,H,Q.discardSelectable,V.uv,K,Q.uvOffset,Q.uvScale):ri(g),_p(g,V.vs,x,h.aPosition),_p(g,V.ns,B.ns32,h.aNormal),B.is?(db(g,V.is,B.is),nm(g,0,T)):co(g,0,T),K?ll(g,h,H):ll(g),Y&&!k._batchColorDisabled&&(qc(g,h.uBatchColor,!1),Ud(g,h.aBatchColor)),_&&(qc(g,h.uBatchBlend,!1),Ud(g,h.aBatchBlend)),W&&(qc(g,h.uBatchBrightness,!1),Ud(g,h.aBatchBrightness)),eh(g,h)}}}},to=function(y,v){for(var z=y.length/3,U=new Array(z),$=z/3,r=new Array($),P=0;$>P;P++)r[P]=P;r.sort(function(D,I){var Z=9*D,p=[(y[Z]+y[Z+3]+2*y[Z+6])/4,(y[Z+1]+y[Z+4]+2*y[Z+7])/4,(y[Z+2]+y[Z+5]+2*y[Z+8])/4];Z=9*I;var X=[(y[Z]+y[Z+3]+2*y[Z+6])/4,(y[Z+1]+y[Z+4]+2*y[Z+7])/4,(y[Z+2]+y[Z+5]+2*y[Z+8])/4],B=fm(v,p)-fm(v,X);return B>0?-1:0>B?1:0});for(var P=0;$>P;P++){var i=3*P,R=3*r[P];U[i]=R,U[i+1]=R+1,U[i+2]=R+2}return new hl(U)},gf={obj:function(p,F){var K={mat:p.mat,s3:p.s3,r3:p.r3,rotationMode:p.rotationMode,t3:p.t3,cube:p.cube==Z?!0:p.cube,center:p.center==Z?!0:p.center,ignoreMtls:p.ignoreMtls,ignoreTransparent:p.ignoreTransparent,ignoreColor:p.ignoreColor,ignoreImage:p.ignoreImage,ignoreNormal:p.ignoreNormal,prefix:p.prefix,flipY:p.flipY,flipFace:p.flipFace,reverseFlipMtls:p.reverseFlipMtls,finishFunc:function(H,K){if(H){var K=[];for(var k in H){var n=H[k];K.rawS3=n.rawS3,K.push(n),p.eachModel&&p.eachModel(k,n)}K.json=p,F(K)}else F()}};A.loadObj(p.obj,p.mtl,K)}};A.getModelTypeHandlers=function(){return gf},A.setModelTypeHandler=function(m,z){gf[m]=z},A.getModelTypeHandler=function(U){return gf[U]},A.handleModelLoaded=function(){},A.handleUnfoundModel=function(){};var id=Z,Wh=Z,gj=function(y){id&&!y._loadingModelView_&&(Wh||(Wh={}),Wh[y._loadingModelView_=Vc()]=y)},ij=function(g,c){id||(id={});var L=id[g];if(L){if(L.url===c)return;L.request.onload=Wi,L.request.onerror=Wi}var f=new Ar;if(id[g]={request:f,url:c},c=A.beforeLoadURL(c),c.data){var Y=A.parse(c.data);dp(g,Y,c)}else{f.onload=function(){if(200===this.status||0===this.status){delete id[g];var F=A.parse(f.getResponseText());dp(g,F,c)}else Io(g,A.handleUnfoundModel(g,c)||Z)},f.onerror=function(){Io(g,A.handleUnfoundModel(g,c)||Z)};var C={};C.url=encodeURI(c),C.sync=!1,f.send(C)}},dp=function(T,D,H){var g=D.modelType;if(!g)return Io(T,D),A.handleModelLoaded(T,D),void 0;var J=A.getModelTypeHandler(g);if(J){if(id||(id={}),id[T])return;id[T]=!0;var z=function(F){F?(Io(T,F),A.handleModelLoaded(T,F)):Io(T,A.handleUnfoundModel(T,H)||Z)};J(D,z)}else Io(T,A.handleUnfoundModel(T,H)||Z)},Io=function(_,u){if(delete id[_],tk(u)&&Rj.test(u))return ij(_,u),void 0;if(qj[_]=u,rr(id)&&(id=Z,Wh)){for(var G in Wh){var y=Wh[G];y.invalidateAll&&y.invalidateAll(l,"modelLoaded",_),y.redraw&&y.redraw(),y.iv(),delete y._loadingModelView_}Wh=Z}if(u&&Wh)for(var G in Wh){var y=Wh[G];y.invalidateAll&&y.invalidateAll(l,"modelLoading",_),y.redraw&&y.redraw(),y.iv()}},ae=new Hf([0,0,0,1,1,1,1,0]),eo=new Hf([0,0,1,0,0,1,0,0,1,0,0,1]),Hh=new hl([0,1,2,2,3,0]),tp=new Hf([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),up=new hl([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),jr=new Hf([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),fo=fi(tp,up),ce=(new Hf([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new hl([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[Bc,Qj,qe,Zd,Uh,Tg]),gq=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Ji=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],rb=function(B,C,q,N,n,P,K){P=P||16,B=B||16,C=C||0,q=q||B;var z,u,Z,R,b,h,F,w,L,r=.5,H=[],t=[],O=I/B,o=i/P;for(z=0;P>z;z++)for(h=z+1,R=z*o,L=h*o,u=C;q>u;u++)F=u+1,Z=u*O,w=F*O,H.push(r*E(R)*m(Z),r*m(R),-r*E(R)*E(Z),r*E(L)*m(w),r*m(L),-r*E(L)*E(w),r*E(R)*m(w),r*m(R),-r*E(R)*E(w),r*E(R)*m(Z),r*m(R),-r*E(R)*E(Z),r*E(L)*m(Z),r*m(L),-r*E(L)*E(Z),r*E(L)*m(w),r*m(L),-r*E(L)*E(w)),t.push(u/B,z/P,F/B,h/P,F/B,z/P,u/B,z/P,u/B,h/P,F/B,h/P);if(K){var j=[];for(z=0,b=H.length;b>z;z+=3)j.push(2*H[z],2*H[z+1],2*H[z+2])}if(N){var d=[],Q=[];for(Z=C*O,z=0;P>z;z++)h=z+1,R=z*o,L=h*o,d.push(0,0,0,r*E(L)*m(Z),r*m(L),-r*E(L)*E(Z),r*E(R)*m(Z),r*m(R),-r*E(R)*E(Z)),Q.push(0,.5,C/B,h/P,C/B,z/P)}if(n){var f=[],y=[];for(Z=q*O,z=0;P>z;z++)h=z+1,R=z*o,L=h*o,f.push(0,0,0,r*E(R)*m(Z),r*m(R),-r*E(R)*E(Z),r*E(L)*m(Z),r*m(L),-r*E(L)*E(Z)),y.push(1,.5,q/B,z/P,q/B,h/P)}var T={vs:H,uv:t,from_vs:d,from_uv:Q,to_vs:f,to_uv:y};return K&&(T.ns=j),T},Sp=function(k,z,R){k=k||.17,z=z||12,R=R||18,0>k?k=0:k>.25&&(k=.25);var x,c,g,Z,t,O,l,q=.5,Y=[],M=[],f=[],L=I/R,B=I/z,p=q-k;for(c=0;z>=c;c++)for(Z=-i+c*B,O=m(Z),t=E(Z),x=0;R>=x;x++)g=x*L,l=p+k*O,Y.push(m(g)*l,t*k,-E(g)*l),M.push(x/R,1-c/z);for(c=0;z>c;c++){var u=c*(R+1),v=(c+1)*(R+1);for(x=0;R>x;x++)f.push(u+x,v+x+1,v+x,u+x,u+x+1,v+x+1)}return{vs:Y,uv:M,is:f}},Km=function(Z,b,w,c,$,d,z,t){z=z||12,Z=Z||18,b=b||0,w=w||Z,d=d||.17,0>d?d=0:d>.25&&(d=.25);var e,s,Q,T,B,x,y,q,Y,A,j=.5,U=[],C=[],k=I/Z,o=I/z,M=j-d,W=t?[]:l;for(Q=0;z>Q;Q++)for(T=Q+1,y=-i+Q*o,q=-i+T*o,e=b;w>e;e++)s=e+1,B=e*k,x=s*k,Y=M+d*m(y),A=M+d*m(q),U.push(m(B)*Y,E(y)*d,-E(B)*Y,m(x)*Y,E(y)*d,-E(x)*Y,m(x)*A,E(q)*d,-E(x)*A,m(B)*Y,E(y)*d,-E(B)*Y,m(x)*A,E(q)*d,-E(x)*A,m(B)*A,E(q)*d,-E(B)*A),C.push(e/Z,1-Q/z,s/Z,1-Q/z,s/Z,1-T/z,e/Z,1-Q/z,s/Z,1-T/z,e/Z,1-T/z),t&&W.push(m(B)*m(y),E(y),-E(B)*m(y),m(x)*m(y),E(y),-E(x)*m(y),m(x)*m(q),E(q),-E(x)*m(q),m(B)*m(y),E(y),-E(B)*m(y),m(x)*m(q),E(q),-E(x)*m(q),m(B)*m(q),E(q),-E(B)*m(q));if(c){var f=[],L=[];for(Q=0;z>Q;Q++)T=Q+1,y=-i+Q*o,q=-i+T*o,B=b*k,Y=M+d*m(y),A=M+d*m(q),f.push(m(B)*Y,E(y)*d,-E(B)*Y,m(B)*A,E(q)*d,-E(B)*A,m(B)*M,0,-E(B)*M),L.push(.5+.5*m(y),.5-.5*E(y),.5+.5*m(q),.5-.5*E(q),.5,.5)}if($){var N=[],R=[];for(Q=0;z>Q;Q++)T=Q+1,y=-i+Q*o,q=-i+T*o,B=w*k,Y=M+d*m(y),A=M+d*m(q),N.push(m(B)*Y,E(y)*d,-E(B)*Y,m(B)*M,0,-E(B)*M,m(B)*A,E(q)*d,-E(B)*A),R.push(.5-.5*m(y),.5-.5*E(y),.5,.5,.5-.5*m(q),.5-.5*E(q))}var p={vs:U,uv:C,from_vs:f,from_uv:L,to_vs:N,to_uv:R};return t&&(p.ns=W),p},Ye=function(s,j){for(var U,V,H,h=.5,M=16,F=[],f=[],y=[],v=I/M,x=0;M>=x;x++)U=x*v,V=m(U)*h,H=E(U)*h,F.push(V,-h,H,V,h,H),f.push(1-x/M,1,1-x/M,0);for(x=0;M>x;x++)y.push(2*x,2*x+1,2*x+3,2*x,2*x+3,2*x+2);if(j){var L=[],D=[],b=[];for(L.push(0,-h,0),D.push(.5,.5),x=0;M>=x;x++)U=x*v,V=m(U),H=E(U),L.push(V*h,-h,-H*h),D.push(.5+.5*V,.5+.5*H);for(x=0;M>x;x++)b.push(0,x+2,x+1)}if(s){var p=[],o=[],K=[];for(p.push(0,h,0),o.push(.5,.5),x=0;M>=x;x++)U=x*v,V=m(U),H=E(U),p.push(V*h,h,-H*h),o.push(.5+.5*V,.5-.5*H);for(x=0;M>x;x++)K.push(0,x+1,x+2)}return{vs:F,uv:f,is:y,bottom_vs:L,bottom_uv:D,bottom_is:b,top_vs:p,top_uv:o,top_is:K}},cg=function(z,X,r,P,f,l,A,t){z=z||12,X=X||0,r=r||z;for(var i,v,x,D,M,b,p,C,c,$=.5,G=[],N=[],L=I/z,Q=X;r>Q;Q++)i=Q+1,v=Q*L,x=i*L,D=m(v)*$,M=E(v)*$,b=m(x)*$,p=E(x)*$,G.push(D,-$,-M,b,-$,-p,D,$,-M,b,-$,-p,b,$,-p,D,$,-M),N.push(Q/z,1,i/z,1,Q/z,0,i/z,1,i/z,0,Q/z,0);if(t){var g=[];for(Q=0,c=G.length;c>Q;Q+=3)g.push(2*G[Q],0,2*G[Q+2])}if(A){var a=[],e=[];for(Q=X;r>Q;Q++)v=L*Q,x=L*(Q+1),D=m(v),M=E(v),b=m(x),p=E(x),a.push(D*$,-$,-M*$,0,-$,0,b*$,-$,-p*$),e.push(.5+.5*D,.5+.5*M,.5,.5,.5+.5*b,.5+.5*p)}if(l){var j=[],s=[];for(Q=X;r>Q;Q++)v=L*Q,x=L*(Q+1),D=m(v),M=E(v),b=m(x),p=E(x),j.push(D*$,$,-M*$,b*$,$,-p*$,0,$,0),s.push(.5+.5*D,.5-.5*M,.5+.5*b,.5-.5*p,.5,.5)}if(P){var d=[],q=[];v=L*X,D=m(v)*$,M=E(v)*$,C=X/z,d.push(0,$,0,0,-$,0,D,-$,-M,D,-$,-M,D,$,-M,0,$,0),q.push(0,0,0,1,C,1,C,1,C,0,0,0)}if(f){var O=[],K=[];v=L*r,D=m(v)*$,M=E(v)*$,C=r/z,O.push(0,-$,0,0,$,0,D,$,-M,D,$,-M,D,-$,-M,0,-$,0),K.push(1,1,1,0,C,0,C,0,C,1,1,1)}var n={vs:G,uv:N,bottom_vs:a,bottom_uv:e,top_vs:j,top_uv:s,from_vs:d,from_uv:q,to_vs:O,to_uv:K};return t&&(n.ns=g),n},Jb=function(o,s,u,G,Y){s=s||18,u=u||0,G=G==Z?I:G,Y=Y==Z?.5:Y;for(var S,c,J,x,K,P,r=[0,.5,.75,.875,.9375],A=[],j=[],X=[],F=G/s,y=0;y<r.length;y++){var i=0===y%2?0:.5;for(S=0;s>=S;S++)c=(S+i)*F+u,J=1-r[y],A.push(m(c)*Y*J,-Y+2*r[y]*Y,-E(c)*Y*J),j.push((S+i)/s,J)}for(y=0;y<r.length-1;y++){var L=y*(s+1),W=(y+1)*(s+1);for(S=0;s>S;S++)X.push(L+S,W+S+1,W+S,L+S,L+S+1,W+S+1)}for(P=A.length/3-(s+1),S=0;s>S;S++)A.push(0,Y,0),j.push((S+.5)/s,0);for(S=0;s>S;S++)X.push(P+S,P+S+1,P+(s+1)+S);if(o){var l=[],T=[],Q=[];for(l.push(0,-Y,0),T.push(.5,.5),S=0;s>=S;S++)c=S*F+u,x=m(c),K=E(c),l.push(x*Y,-Y,-K*Y),T.push(.5+.5*x,.5+.5*K);for(S=0;s>S;S++)Q.push(0,S+2,S+1)}return{vs:A,uv:j,is:X,bottom_vs:l,bottom_uv:T,bottom_is:Q}},Yo=function(b,d,Y,h,J,Q){b=b||16,d=d||0,Y=Y||b;for(var M=.5,f=[],y=[],Z=I/b,i=d;Y>i;i++){var P=i+1,S=Z*i,n=Z*P;f.push(m(S)*M,-M,-E(S)*M,m(n)*M,-M,-E(n)*M,0,M,0),y.push(i/b,1,P/b,1,(i+P)/2/b,0)}if(Q){var T=[],H=[];for(i=d;Y>i;i++){S=Z*i,n=Z*(i+1);var t=m(S),K=E(S),V=m(n),R=E(n);T.push(t*M,-M,-K*M,0,-M,0,V*M,-M,-R*M),H.push(.5+.5*t,.5+.5*K,.5,.5,.5+.5*V,.5+.5*R)}}if(h){var q=[],O=[];S=Z*d,q.push(0,M,0,0,-M,0,m(S)*M,-M,-E(S)*M),O.push(0,0,0,1,d/b,1)}if(J){var X=[],w=[];S=Z*Y,X.push(0,-M,0,0,M,0,m(S)*M,-M,-E(S)*M),w.push(1,1,1,0,Y/b,1)}return{vs:f,uv:y,bottom_vs:T,bottom_uv:H,from_vs:q,from_uv:O,to_vs:X,to_uv:w}},yo=function(h,S,o,e,L,m,b,N){for(var J=[],V=0;V<h.length-1;V+=2)J.push({x:h[V],y:h[V+1]});return Jo(J,S,o,e,L,m,b,N,!1)},Nd={roundRect:function(H,C){return yo([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],H,C,3)},star:function(P,X){return yo([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],P,X)},rect:function(x,P){return yo([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],x,P)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(Q,Y){return yo([0,-.5,.5,.5,-.5,.5],[1,2,2,5],Q,Y)},rightTriangle:function(G,z){return yo([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],G,z)},parallelogram:function(v,W){return yo([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],v,W)},trapezoid:function(Z,t){return yo([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],Z,t)}},mj={sphere:1,cylinder:1,cone:1,torus:1},je={torus:1,sphere:1},Cf=Nh(Em(Nd),{cylinder:1}),Yk=Nh(Em(Nd),{cylinder:1,cone:1}),so=function(D,h,v){var F,M=Xo(D.anchor3d,v,h),I=Xo(D.mat,v,h),O=Xo(D.s3,v,h),k=Xo(D.t3,v,h),j=Xo(D.r3,v,h),Q=O||j||k||I;if(M||Q){F=Qp(h._6O);var U=Q?xi(I,O,j,Xo(D.rotationMode,v,h),k):jh();M&&rn(U,[.5-M[0],.5-M[1],.5-M[2]]),_i(h,U)}return F},Hr=function(d,V,U,Y,I,S,Q){if(sp(U))U.forEach(function(y){Hr(d,V,y,Y,I,S,Q)});else if(tk(U))Hr(d,V,Xr(Y,U),Y,I,S,Q);else if(Bn(U))if(U.shape3d){var m=so(U,d,V);Hr(d,V,U.shape3d,Y,I,S,U),m&&Kn(d,m)}else Fc(d,V,U,Y.s,I,S,Q)},Fc=function(K,N,z,J,u,S,q){if(q=q||Yn,!S||S(J("shape3d.transparent",z.transparent,q.transparent))){var b=so(z,K,N);yq(z);var I=K._26I,l=K._prg,Q=K._buffer,R=J("shape3d.color",z.color,q.color);u||(u=J("shape3d.blend",z.blend,q.blend));var C,E=z.opacity==Z?q.opacity:z.opacity,W=J("shape3d.opacity");C=W!=Z&&E!=Z?E*W:E!=Z?E:W,Oj(I,l,u,J("shape3d.light",z.light,q.light),C,J("shape3d.reverse.flip",z.reverseFlip,q.reverseFlip),J("shape3d.reverse.color",z.reverseColor,q.reverseColor),J("shape3d.reverse.cull",z.reverseCull,q.reverseCull));var _=J("polygonOffset",z.polygonOffset,q.polygonOffset);z.vs&&J(oh,z.visible,q.visible)&&yj(I,l,Q,R,K.getTexture(J("shape3d.image",z.image,q.image),N),J("shape3d.discard.selectable",z.discardSelectable,q.discardSelectable),z.vs,z.uv,z.ns,z.is,J("shape3d.uv.offset",z.uvOffset,q.uvOffset),J("shape3d.uv.scale",z.uvScale,q.uvScale),_),z.top_vs&&J(Pm,z.topVisible,q.topVisible)&&yj(I,l,Q,J("shape3d.top.color",z.topColor,q.topColor)||R,K.getTexture(J("shape3d.top.image",z.topImage,q.topImage),N,"top"),J("shape3d.top.discard.selectable",z.topDiscardSelectable,q.topDiscardSelectable),z.top_vs,z.top_uv,z.top_ns,z.top_is,J("shape3d.top.uv.offset",z.topUvOffset,q.topUvOffset),J("shape3d.top.uv.scale",z.topUvScale,q.topUvScale),_),z.bottom_vs&&J(gi,z.bottomVisible,q.bottomVisible)&&yj(I,l,Q,J("shape3d.bottom.color",z.bottomColor,q.bottomColor)||R,K.getTexture(J("shape3d.bottom.image",z.bottomImage,q.bottomImage),N,"bottom"),J("shape3d.bottom.discard.selectable",z.bottomDiscardSelectable,q.bottomDiscardSelectable),z.bottom_vs,z.bottom_uv,z.bottom_ns,z.bottom_is,J("shape3d.bottom.uv.offset",z.bottomUvOffset,q.bottomUvOffset),J("shape3d.bottom.uv.scale",z.bottomUvScale,q.bottomUvScale),_),z.from_vs&&J(Qo,z.fromVisible,q.fromVisible)&&yj(I,l,Q,J("shape3d.from.color",z.fromColor,q.fromColor)||R,K.getTexture(J("shape3d.from.image",z.fromImage,q.fromImage),N,"from"),J("shape3d.from.discard.selectable",z.fromDiscardSelectable,q.fromDiscardSelectable),z.from_vs,z.from_uv,z.from_ns,z.from_is,J("shape3d.from.uv.offset",z.fromUvOffset,q.fromUvOffset),J("shape3d.from.uv.scale",z.fromUvScale,q.fromUvScale),_),z.to_vs&&J(Dc,z.toVisible,q.toVisible)&&yj(I,l,Q,J("shape3d.to.color",z.toColor,q.toColor)||R,K.getTexture(J("shape3d.to.image",z.toImage,q.toImage),N,"to"),J("shape3d.to.discard.selectable",z.toDiscardSelectable,q.toDiscardSelectable),z.to_vs,z.to_uv,z.to_ns,z.to_is,J("shape3d.to.uv.offset",z.toUvOffset,q.toUvOffset),J("shape3d.to.uv.scale",z.toUvScale,q.toUvScale),_),eh(I,l),b&&Kn(K,b)}},yj=function(L,K,I,T,n,z,G,N,g,H,B,_,r){G&&(r&&Xf(L,r),qc(L,K.uDiffuse,T||y["color.empty"]),N?ri(L,K,n,z,I.uv,N,B,_):ri(L),_p(L,I.vs,G,K.aPosition),_p(L,I.ns,g,K.aNormal),H?(sc(L,I.is,H),nm(L,0,H.length)):co(L,0,G.length/3),N?ll(L,K,n):ll(L),r&&Qq(L))},Xr=function(q,N){var V=q.s;if(N||(N=V(Sg)),!N)return Z;var w=Yi(N);if(w)return w;if("text"===N){var u={amount:V("shape3d.text.amount"),size:V("shape3d.text.size"),font:V("shape3d.text.font"),style:V("shape3d.text.style"),weight:V("shape3d.text.weight"),fill:V("shape3d.text.fill"),curveSegments:V("shape3d.text.curveSegments"),spacing:V("shape3d.text.spacing")},C=q.gv.getShape3dText(q.data),G=C;for(var $ in u)G+="_"+(u[$]===l?"U":u[$]);return q._cachedTextKey===G?q._cachedTextGeometry:(q._cachedTextKey=G,q._cachedTextGeometry=A.createTextGeometry(C,u))}var $=N;if(mj[N]){var s=V("shape3d.side"),M=V("shape3d.side.from"),x=V("shape3d.side.to"),O=V(Qo),h=V(Dc);3>s?(s=0,M=0,x=0,O=!1,h=!1):((M==Z||0>M)&&(M=0),(x==Z||x>s)&&(x=s),0===M&&x===s&&(O=!1,h=!1));var W="cone"===N?!1:V("shape3d.smooth");$+="-"+s+"-"+M+"-"+x+"-"+O+"-"+h+(W?1:0)}if(Cf[N]){var y=V(Pm);$+="-"+y}if(Yk[N]){var c=V(gi);$+="-"+c}if("torus"===N){var z=V("shape3d.torus.radius");0>z?z=0:z>.25&&(z=.25),$+="-"+z}if(je[N]){var E=V(qd);$+="-"+E}return w=Qm[$],w||("box"===N?w=A.createBoxModel():Nd[N]?w=Nd[N](y,c):"sphere"===N?w=A.createSphereModel(s,M,x,O,h,E,W):N===_m?w=A.createCylinderModel(s,M,x,O,h,y,c,W):"cone"===N?w=A.createConeModel(s,M,x,O,h,c):"torus"===N&&(w=A.createTorusModel(s,M,x,O,h,z,E,W)),Qm[$]=w),w},yq=function(){var i=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],G=["is","top_is","bottom_is","from_is","to_is"];return r=il(vh.substr(vh.indexOf("^#")+2)),Mq(A[kr(Jj+i[15]+"n"+i[16])]())&&_f()?function(f){f&&!f._complete_&&(f._complete_=!0,f.vs&&Eb(f.ns)&&(f.ns=fi(f.vs,f.is)),f.top_vs&&Eb(f.top_ns)&&(f.top_ns=fi(f.top_vs,f.top_is)),f.bottom_vs&&Eb(f.bottom_ns)&&(f.bottom_ns=fi(f.bottom_vs,f.bottom_is)),f.from_vs&&Eb(f.from_ns)&&(f.from_ns=fi(f.from_vs,f.from_is)),f.to_vs&&Eb(f.to_ns)&&(f.to_ns=fi(f.to_vs,f.to_is)),i.forEach(function(h){var Z=f[h];sp(Z)&&(f[h]=new Hf(Z))}),G.forEach(function(A){var q=f[A];sp(q)&&(f[A]=new hl(q))}))}:void 0}(),fr=function(p,j){var i=p[j];sp(i)&&(p[j]=new Hf(i))};Nh(Lc,{_25Q:function(G){G._16O=function(I,B,V,T,p,U,Q,k,u){var X=this.info;if(X){var n,O,K,b,t,g,P=jh();if(Rd[B]?(n=X.p3,O=X.c1,K=X.c2):_o[B]?(O=X.s1||X.c1,K=X.s2||X.c2):(O=X.t1||X.c1,K=X.t2||X.c2),n)g=iq(B,Dj,V,T,k,u);else{var F=bm(K,O),Z=fm(O,K);b=[0,-R(F[2],F[0]),f(F[1]/Z)],t="zyx",n=[(O[0]+K[0])/2,(O[1]+K[1])/2,(O[2]+K[2])/2],g=iq(B,[Z,0,0],V,T,k,u)}return cf(P,g,n,T,p,U,Q,I,b,t)}return Ll},G._80o=function(q,w,f){var V=this,$=V.shapeModel;if($){var p=V.gv;_i(p),Hr(p,V.data,$,V,V.getBodyColor(),f)}},G.createLineModel=function(q,k,F,C,M){for(var z=this,L=z.s,y=Ii(q,k,L(qd)),R=[],r=0;r<y.length;r++){var h=y[r],e=h.length;if(e>1){var t=h[0];R.push(t.x,t.y,t.z);for(var v=1;e-1>v;v++)t=h[v],R.push(t.x,t.y,t.z),R.push(t.x,t.y,t.z);t=h[e-1],R.push(t.x,t.y,t.z)}}var l,x,p,d=L(C+".color"),g=L(M),c=0;return g&&(x=L(M+".color"),l=L(M+".pattern"),c=L(M+".offset"),p=d),If(z.gv,z.data,R,x||d,p?Z:L(C+".gradient.color"),F,l||L(C+".pattern"),c,p),y},G.createTubeModel=function(f,l,m,q){for(var y=this,P=y.s,d=P("shape3d.side")||Aj,k=P("shape3d.start.angle"),F=P("shape3d.sweep.angle"),D=P(Pm)?P("shape3d.top.cap"):Z,R=P(gi)?P("shape3d.bottom.cap"):Z,e="flat"===D,W="flat"===R,h=e&&(q?q.uv:P("shape3d.top.image")),$=W&&(q?q.uv:P("shape3d.bottom.image")),p=q?q.uv:P("shape3d.image"),u={vs:[],uv:p?[]:Z,top_vs:e?[]:Z,top_uv:h?[]:Z,bottom_vs:W?[]:Z,bottom_uv:$?[]:Z},C=Ii(f,l,P(qd),m),s=0,G=C.length;G>s;s++)Pf(u,C[s],P(Do),m,d,k,F,D,R);if(q){var w=[];rm(y.gv,y.data,u,y,y.getBodyColor(),[],q,w),w.length&&(Ad(q.vs,w),Ad(q.ns,fi(w)))}else y.shapeModel=u;return C},G.getCache=function(){var X=this.info;if(X){var n=X.list;if(n){var s=X.cache;return s||(s=X.cache=Gp(n)),s}}return Z}}});var rq=function(e,f){for(var u,V=0,X=e.length,n=0,x=X-1;x>=n;)if(V=H(n+(x-n)/2),u=e[V].length-f,0>u)n=V+1;else{if(!(u>0)){x=V;break}x=V-1}V=x;var J=e[V],E=J.point;return V===X-1||J.length===f||(E=(new Vq).subVectors(e[V+1].point,E).normalize().multiplyScalar(f-J.length).add(E)),{point:E,tangent:J.tangent}},Gp=function(e){for(var X,D,g=[],L=0,f=0;f<e.length;f++){for(var b=e[f],Y=0;Y<b.length;Y++){X=b[Y],D&&(L+=D.distanceTo(X));var q=new Vq,i=b[Y+1];i?q.subVectors(i,X):D?q.subVectors(X,D):q.x=1,q.normalize(),g.push({point:X,length:L,tangent:q}),D=X}D=null}return g},Ii=function(y,o,M,G){M=M||bf;for(var E=[],u=0,J=y.size();J>u;u++){var p=y.get(u);E.push(new Vq(p.x,p.e||0,p.y))}o&&(po(o)&&(o=o._as),o.length||(o=null));for(var H,A,t,c,O,i=[],j=0,v=0,r=o?o.length:J;r>v;v++)if(O=o?o[v]:0===v?1:2,1===O)i.push(t=[]),t.push(E[j++]);else if(2===O||5===O)if(c=2===O?E[j++]:t[0],G){var V=o?o[v+1]:r>v+1?2:Z;if(2===V||5===V){var B=t[t.length-1],e=2===V?E[j]:t[0],T=(new Vq).subVectors(B,c),S=(new Vq).subVectors(e,c),x=T.length(),$=S.length();if(x&&$)if(G>x/2&&G>$/2)t.push(c);else for(T.multiplyScalar(C(G,x/2)/x).add(c),S.multiplyScalar(C(G,$/2)/$).add(c),H=new yf(T,c,S).getPoints(M),A=0;M>=A;A++)t.push(H[A])}else t.push(c)}else t.push(c);else if(3===O)for(H=new yf(t[t.length-1],E[j++],E[j++]).getPoints(M),A=1;M>=A;A++)t.push(H[A]);else if(4===O)for(H=new Zo(t[t.length-1],E[j++],E[j++],E[j++]).getPoints(M),A=1;M>=A;A++)t.push(H[A]);return i},bl=function(N){for(var L,y,Q=new Vq,K=[],g=[],v=[],e=0,_=N.length;_>e;e++)L=N[e],y=N[e+1],y?Q.subVectors(y,L):Q.subVectors(L,N[e-1]),K.push(Q.normalize().clone());var B,D,f,r,k=new Vq,A=new Vq,V=new uo,J=1e-4,z=Number.MAX_VALUE,d=K[0],Y=g[0]=new Vq,h=v[0]=new Vq;for(D=t(d.x),f=t(d.y),r=t(d.z),z>=D&&(z=D,k.set(1,0,0)),z>=f&&(z=f,k.set(0,1,0)),z>=r&&k.set(0,0,1),A.crossVectors(d,k).normalize(),Y.crossVectors(d,A),h.crossVectors(d,Y),e=1;_>e;e++)g[e]=g[e-1].clone(),v[e]=v[e-1].clone(),A.crossVectors(K[e-1],K[e]),A.length()>J&&(A.normalize(),B=S(Bq(K[e-1].dot(K[e]),-1,1)),g[e].applyMatrix4(V.makeRotationAxis(A,B))),v[e].crossVectors(K[e],g[e]);return{B:v,T:K,N:g}},Pf=function(){var h=function(W){for(var l=1;l<arguments.length;l++){var g=arguments[l];W.push(g.x,g.y,g.z)}},U=function(s){for(var G=1;G<arguments.length;G++){var t=arguments[G].uv;s.push(t[0],t[1])}},H=function(z,t,f,Q,G){var c=-Q*m(G),J=Q*E(G);return new Vq(z.x+c*f.x+J*t.x,z.y+c*f.y+J*t.y,z.z+c*f.z+J*t.z)},D=function(k,_,c,J,P,A,N,i){N=N||I;for(var s=[],W=N/P,X=0;P>=X;X++){var u=H(k,_,c,J,X*W+A);s.push(u),i!=Z&&(u.uv=[i,1-X/P])}return s},o=function(A,K,L,p,f,G,w,b,R){R=R||I;var V=K?A.top_vs:A.bottom_vs;if(V)for(var M=K?A.top_uv:A.bottom_uv,s=R/w,$=0;w>$;$++){var z,T;K?(z=$*s+b,T=($+1)*s+b):(T=$*s+b,z=($+1)*s+b),h(V,H(L,p,f,G,z),H(L,p,f,G,T),L),M&&M.push(.5-.5*m(z),.5-.5*E(z),.5-.5*m(T),.5-.5*E(T),.5,.5)}};return function(A,V,c,k,I,f,Q,u,Y){var S=V.length;if(S>1){var j,g,G,x,e,K,$,t=bl(V),C=t.T,O=t.N,z=t.B;"flat"===u&&o(A,!0,V[0],z[0],O[0],k,I,f,Q),"flat"===Y&&o(A,!1,V[S-1],z[S-1],O[S-1],k,I,f,Q);var a,E,s=[],b=p(I/2),L="round"===u,B="round"===Y,n=V[0],X=C[0],R=z[0],r=O[0],v=V[S-1],m=C[S-1],W=z[S-1],q=O[S-1];if(L){for(G=1;b>=G;G++)O.splice(0,0,r),z.splice(0,0,R),C.splice(0,0,X),E=-G/b*k,V.splice(0,0,X.clone().multiplyScalar(E).add(n)),s[b-G]=w(k*k-E*E);S+=b}if(B){for(G=1;b>=G;G++)O.push(q),z.push(W),C.push(m),E=G/b*k,V.push(m.clone().multiplyScalar(E).add(v)),s[V.length-1]=w(k*k-E*E);S+=b}if(A.uv){var N=0,M=0,J=[];for(c&&(N=c),e=V[0],J[0]=0,G=1;S>G;G++)x=V[G],J[G]=e.distanceTo(x),e=x,c||(N+=J[G]);for(a=[],G=0;S>G;G++)M+=J[G],a[G]=N?M/N:0}for(G=0;S>G;G++){if(x=V[G],K=z[G],$=O[G],j=D(x,K,$,s[G]===l?k:s[G],I,f,Q,a?a[G]:Z),g)for(var y=0;I>y;y++){var P=g[y],H=g[y+1]||g[0],_=j[y],T=j[y+1]||j[0];h(A.vs,H,P,_,_,T,H),A.uv&&U(A.uv,H,P,_,_,T,H)}g=j}}}}();Nh(A,{getLineLength:function(O){return O[O.length-1].length},getLineOffset:function(f,y){return rq(f,y)},getLineCacheInfo:function(x,l,A,O){return Gp(Ii(x,l,A,O))}});var lf=a.graph3d.RenderLite={},$g=new Array(0),pi=lf.Buffer=function(I,p,D,r){this.gl=I,this.buffer=I.createBuffer(),this.type=p||I.ARRAY_BUFFER,this.drawType=r||I.STATIC_DRAW,this.data=$g,D&&this.upload(D)};pi.prototype.upload=function(j,k,d){d||this.bind();var a=this.gl;j=j||this.data,k=k||0,this.data.byteLength>=j.byteLength?a.bufferSubData(this.type,k,j):a.bufferData(this.type,j,this.drawType),this.data=j},pi.prototype.bind=function(){var C=this.gl;C.bindBuffer(this.type,this.buffer)},pi.createVertexBuffer=function(z,i,J){return new pi(z,z.ARRAY_BUFFER,i,J)},pi.createIndexBuffer=function(T,w,y){return new pi(T,T.ELEMENT_ARRAY_BUFFER,w,y)},pi.create=function(J,W,C,V){return new pi(J,W,V)},pi.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Xl=lf.Shader=function(W,d,Q){this.gl=W,this.program=hg(W,d,Q),this.attributes=Df(W,this.program);var $=hr(W,this.program);this.uniforms=Ed(W,$)};Xl.prototype.bind=function(){this.gl.useProgram(this.program)},Xl.prototype.destroy=function(){this.gl};var hg=function(w,N,x){var T=Vk(w,w.VERTEX_SHADER,N),L=Vk(w,w.FRAGMENT_SHADER,x);w.getShaderParameter(L,w.COMPILE_STATUS)||console.error(w.getError());var h=w.createProgram();return w.attachShader(h,T),w.attachShader(h,L),w.linkProgram(h),w.getProgramParameter(h,w.LINK_STATUS)||(console.error("Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",w.getProgramParameter(h,w.VALIDATE_STATUS)),console.error("gl.getError()",w.getError()),""!==w.getProgramInfoLog(h)&&console.warn("Warning: gl.getProgramInfoLog()",w.getProgramInfoLog(h)),w.deleteProgram(h),h=null),w.deleteShader(T),w.deleteShader(L),h},Vk=function(y,F,i){var l=y.createShader(F);return y.shaderSource(l,i),y.compileShader(l),y.getShaderParameter(l,y.COMPILE_STATUS)?l:(console.log(y.getShaderInfoLog(l)),null)},hr=function(I,H){for(var l={},w=I.getProgramParameter(H,I.ACTIVE_UNIFORMS),M=0;w>M;M++){var i=I.getActiveUniform(H,M),a=i.name.replace(/\[.*?\]/,""),Q=sr(I,i.type);l[a]={type:Q,size:i.size,location:I.getUniformLocation(H,a),value:zd(Q,i.size)}}return l},Df=function(t,n){for(var h={},b=t.getProgramParameter(n,t.ACTIVE_ATTRIBUTES),$=0;b>$;$++){var c=t.getActiveAttrib(n,$),U=sr(t,c.type);h[c.name]={type:U,size:me(U),gl:t,location:t.getAttribLocation(n,c.name),pointer:El}}return h},El=function(w,y,J,E,M){var d=this.gl;d.enableVertexAttribArray(this.location),w instanceof lf.Buffer||(w=lf.Buffer.createVertexBuffer(d,w)),d.bindBuffer(w.type,w.buffer),d.vertexAttribPointer(this.location,this.size,y||d.FLOAT,J||!1,E||0,M||0)},me=function(t){return oc[t]},oc={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},sr=function(y,C){if(!Eh){var f=Y.keys(Sd);Eh={};for(var c=0;c<f.length;++c){var J=f[c];Eh[y[J]]=Sd[J]}}return Eh[C]},Eh=null,Sd={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},zd=function(Z,J){switch(Z){case"float":return 0;case"vec2":return new Float32Array(2*J);case"vec3":return new Float32Array(3*J);case"vec4":return new Float32Array(4*J);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*J);case"ivec3":return new Int32Array(3*J);case"ivec4":return new Int32Array(4*J);case"bool":return!1;case"bvec2":return Wf(2*J);case"bvec3":return Wf(3*J);case"bvec4":return Wf(4*J);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Wf=function(S){for(var e=new Array(S),L=0;L<e.length;L++)e[L]=!1;return e},Ed=function(E,Q){var s={data:{}};s.gl=E;for(var g=Y.keys(Q),e=0;e<g.length;e++){var r=g[e],x=r.split("."),y=x[x.length-1],P=Ir(x,s),U=Q[r];P.data[y]=U,P.gl=E,Y.defineProperty(P,y,{get:bn(y),set:de(y,U)})}return s},bn=function(r){var l=cl.replace("%%",r);return new Function(l)},de=function(l,k){var z,n=_g.replace(/%%/g,l);return z=1===k.size?Pq[k.type]:Lp[k.type],z&&(n+="\nthis.gl."+z+";"),new Function("value",n)},Ir=function(_,z){for(var K=z,o=0;o<_.length-1;o++){var q=K[_[o]]||{data:{}};K[_[o]]=q,K=q}return K},cl=["return this.data.%%.value;"].join("\n"),_g=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Pq={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Lp={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},pq=a.Light=function(){$f(pq,this),this.s(Ip,y[Ip]),this.s(Sg,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};En("Light",Lo,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(U,X,B){pq.superClass.onStyleChanged.apply(this,arguments),U===Ip&&this.s("shape3d.color",B)}});var Ih=Hp.Graph3dView=function(n,x){var L=this;L._webGLVersion=1,L._attributes=x||A.graph3dViewAttributes,L._25I={},L._view=Wm(1,L);var Y=L._canvas=uh(L._view);T(Y,"webglcontextlost",function(A){A.preventDefault(),Tk(L),L._26I&&L._doBufferGC(L._26I,!0),L._26I=Z,L._1o.texture=Z,L._35O=!0}),T(Y,"webglcontextrestored",function(){L._35O=!1,L.iv()}),L._batchIndexMap={},L._batchModelMap={},L._wireframeIndexMap={},L._wireframeModelMap={},L._wireframeIndexMapSwap={},L._wireframeModelMapSwap={},L._polylineIndexMap={},L._polylineIndexMap={},L._polylineIndexMapSwap={},L._polylineIndexMapSwap={},L._8O=[],L._7O=jh(),L._6O=jh(),L._1o=new Sq(L),L._30O=new Bm(L),L._31O=new mo(L),L._32O=new ed(L),L._raycaster=new ph(L),L._highlightHelper=new hn(L),L._postProcessing=new lq(L),L._cameras=[],L._cameraId=0,L.vr=new ui(L),L._33Q=!0,L._eye=Em(A.graph3dViewEye),L._center=Em(A.graph3dViewCenter),L._up=Em(A.graph3dViewUp),L._lightChanged=!1,L._59O=[],L._spots=[],L._dirs=[],L._frameId=0,L.overlappingBox=new Xn(L),L.dm(n?n:new rc),L._coreInteractor=new mp(this),L.setInteractors([new mh(L)]),L._initView()},Bi={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Vj=function(O,Z,D,U){O.clearColor(0,0,0,0),O.clearDepth(1),O.enable(O.DEPTH_TEST),O.depthFunc(O.LEQUAL),O.disable(O.CULL_FACE),O.enable(O.BLEND),O.blendFuncSeparate(O.SRC_ALPHA,O.ONE_MINUS_SRC_ALPHA,O.ONE,O.ONE_MINUS_SRC_ALPHA),O.useProgram(D),qc(O,D.uBrightness,1),qc(O,D.uOpacity,1),qc(O,D.uPartOpacity,1),qc(O,D.uPick,U._picking),qc(O,D.uTexture,!1),qc(O,D.uBlendTexture,!1),qc(O,D.uAlphaTest,y.alphaTest),qc(O,D.uTransparent,!1),qc(O,D.uFix,!1),qc(O,D.uBatchColor,!1),qc(O,D.uBatchBlend,!1),qc(O,D.uBatchBrightness,!1),qc(O,D.uReflectivity,U._envmapReflectivity),qc(O,D.uCameraPosition,Z.getEye()),qc(O,D.uPMatrix,U._projectMatrix),qc(O,D.uViewMatrix,U._viewMatrix),Z.bindEnvMap(O),U._picking||(ib(Z,O,D),Z._fogDisabled||(qc(O,D.uFogColor,Z._fogColor),qc(O,D.uFogNear,Z._fogNear),qc(O,D.uFogFar,Z._fogFar))),zs(O,D.aPosition),zs(O,D.aNormal),Ud(O,D.aUv),Ud(O,D.aBatchColor),Ud(O,D.aBatchBlend),Ud(O,D.aBatchBrightness),Ud(O,D.aLineDistance),O.depthMask(!0)},Ho=0;Hg("Graph3dView",Y,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",Zb,bq,"firstPersonMode",re,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Ze,Jg,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:A.graph3dViewEditHelperDisabled,_blockSelectable:A.graph3dViewBlockSelectable,_devicePixelRatio:l,_boundaries:l,_moveStep:A.graph3dViewMoveStep,_rotateStep:A.graph3dViewRotateStep,_pannable:A.graph3dViewPannable,_rotatable:A.graph3dViewRotatable,_walkable:A.graph3dViewWalkable,_resettable:A.graph3dViewResettable,_zoomable:A.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:A.graph3dViewFirstPersonMode,_mouseRoamable:A.graph3dViewMouseRoamable,_gridVisible:A.graph3dViewGridVisible,_gridSize:A.graph3dViewGridSize,_gridGap:A.graph3dViewGridGap,_gridColor:A.graph3dViewGridColor,_originAxisVisible:A.graph3dViewOriginAxisVisible,_centerAxisVisible:A.graph3dViewCenterAxisVisible,_axisXColor:A.graph3dViewAxisXColor,_axisYColor:A.graph3dViewAxisYColor,_axisZColor:A.graph3dViewAxisZColor,_ortho:A.graph3dViewOrtho,_orthoWidth:A.graph3dViewOrthoWidth,_fovy:A.graph3dViewFovy,_near:A.graph3dViewNear,_far:A.graph3dViewFar,_headlightColor:A.graph3dViewHeadlightColor,_headlightIntensity:A.graph3dViewHeadlightIntensity,_headlightRange:A.graph3dViewHeadlightRange,_headlightAmbientIntensity:A.graph3dViewHeadlightAmbientIntensity,_headlightDisabled:A.graph3dViewHeadlightDisabled,_rectSelectable:A.graph3dViewRectSelectable,_rectSelectBackground:A.graph3dViewRectSelectBackground,_editSizeColor:A.graph3dViewEditSizeColor,_autoMakeVisible:vc,_fogDisabled:A.graph3dViewFogDisabled,_fogColor:A.graph3dViewFogColor,_fogNear:A.graph3dViewFogNear,_fogFar:A.graph3dViewFogFar,_pickerResolution:A.graph3dViewPickerResolution,_dashDisabled:A.graph3dViewDashDisabled,_batchColorDisabled:A.graph3dViewBatchColorDisabled,_batchBlendDisabled:A.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:A.graph3dViewBatchBrightnessDisabled,addCamera:function(f){var W=Y.freeze({id:this._cameraId++,priority:f.priority||0,ignoreInPick:!!f.ignoreInPick,useDefaultProgram:!!f.useDefaultProgram,render:f.render});
            this._cameras.push(W),this._cameras.sort(function(a,K){return a.priority!==K.priority?a.priority-K.priority:a.id-K.id})},setEye:function(P,i,E){1===arguments.length&&(i=P[1],E=P[2],P=P[0]);var h=this._eye;h[0]=P,h[1]=i,h[2]=E,this.fp(Ze,Z,h)},setCenter:function(W,k,N){1===arguments.length&&(k=W[1],N=W[2],W=W[0]);var c=this._center;c[0]=W,c[1]=k,c[2]=N,this.fp(Jg,Z,c)},setUp:function(q,S,x){1===arguments.length&&(S=q[1],x=q[2],q=q[0]);var D=this._up;D[0]=q,D[1]=S,D[2]=x,this.fp("up",Z,D)},getDevicePixelRatio:function(){return this._devicePixelRatio||vj},isTransparentMask:function(v){return v.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var x=this,i=x._aspect;return i?i:(i=x.getWidth()/x.getHeight(),i||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(s){var M=this,D=M._dataModel,F=M._selectionModel;D!==s&&(D&&(D.ump(M.handleDataModelPropertyChange,M),D.umm(M.handleDataModelChange,M),D.umd(M.handleDataPropertyChange,M),F||D.sm().ums(M.handleSelectionChange,M)),M._dataModel=s,s.mp(M.handleDataModelPropertyChange,M),s.mm(M.handleDataModelChange,M),s.md(M.handleDataPropertyChange,M),F?F._21I(s):s.sm().ms(M.handleSelectionChange,M),M._postProcessing.handleDataModleChange(D,s),M.invalidateAll(!0),M.invalidateLight(),M.fp(Mr,D,s),M._canvas.style.background=s.getBackground()||"")},handleDataModelPropertyChange:function(y){if("background"===y.property){var r=this._canvas.style.background,p=y.newValue||"";this._canvas.style.background=p,this.fp("canvasBackground",r,p)}else"envmap"===y.property&&this.iv()},handleDataPropertyChange:function(R){var P=R.data;this.invalidateData(P),!bb(P)||"s:light.type"!==R.property&&"s:3d.visible"!==R.property||this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(a){var I=this,F=a.property;I.iv(),I._18Q=Z,"eye"===F?I._33Q=!0:"devicePixelRatio"===F?I._42(Z,I.getDevicePixelRatio()):Bi[F]&&Tk(I)},_5O:function(v){var P=v._22Q();return P?new P(this,v):Z},getData3dUI:function(M){var j=this._25I[M._id];return j===l&&(j=this._5O(M),this._25I[M._id]=j),j},invalidateAll:function(q){var c=this;if(q){for(var x in c._25I){var T=c._25I[x];T&&T.dispose()}c._25I={},c.iv(),bo(c)}else bo(c),c.dm().each(function(B){c.invalidateData(B)})},invalidateSelection:function(){var Y=this;Y.sm().each(function(_){Y.invalidateData(_)})},invalidateData:function(B){var a=this,d=a.getData3dUI(B);d&&(d.iv(),a.iv()),bo(a,B)},getShape3dText:function(t){return t.getStyle("shape3d.text")||this.getLabel(t)},invalidateBatch:function(o){var r=this,P=r._batchModelMap,J=P[o],w=[],j={};if(J){J.ds.forEach(function(N){var h=r.getData3dUI(N);h&&h.iv(),delete r._batchIndexMap[N._id],w.push(N._id)}),delete P[o];for(var i,A,T,h,D,Z,B,p,d,g=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],H=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],X=0;X<g.length;X++){var v=r[g[X]],E=r[H[X]];for(j={},p=0;p<w.length;p++){var n=E[w[p]];if(n){delete E[w[p]],d=n.batch,i=v[d];var b=n.begin,f=n.size,U=3*b,Q=3*f,W=4*b,O=4*f;for(A=i.ds,T=i.vs,h=i.cs,D=i.ps,Z=i.ls,B=n.index,i.invalidate=!0,A[B]=l,B=U;U+Q>B;B++)T[B]=l;for(B=W;W+O>B;B++)h[B]=l;for(B=W;W+O>B;B++)D[B]=l;if(Z)for(B=U;U+Q>B;B++)Z[B]=l;j[d]=!0}}for(d in j){i=v[d],A=i.ds,T=i.vs,h=i.cs,D=i.ps,Z=i.ls;var Y=[];for(B=0;B<A.length;B++)A[B]!==l&&Y.push(A[B]);if(0===Y.length)delete v[d];else{for(i.ds=Y,Y=[],B=0;B<T.length;B++)T[B]!==l&&Y.push(T[B]);for(i.vs=Y,Y=[],B=0;B<h.length;B++)h[B]!==l&&Y.push(h[B]);for(i.cs=Y,Y=[],B=0;B<D.length;B++)D[B]!==l&&Y.push(D[B]);if(i.ps=Y,Z){for(Y=[],B=0;B<Z.length;B++)Z[B]!==l&&Y.push(Z[B]);i.ls=Y}}}}r.iv()}},handleDataModelChange:function(l){var t=this,m=l.kind,E=l.data;if("add"===m)t.invalidateData(E),Xi(E)&&E.getEdgeGroup()&&E.getEdgeGroup().eachSiblingEdge(t.invalidateData,t),bb(E)&&t.invalidateLight();else if(m===nd){var g=E._id,u=t._25I[g];u&&(u.dispose(),delete t._25I[g],t.iv()),E===t._currentSubGraph&&t.setCurrentSubGraph(Z),bo(t,E),bb(E)&&t.invalidateLight()}else m===Fh&&(t.invalidateAll(!0),t.setCurrentSubGraph(Z),bo(t),t.invalidateLight())},toCanvas:function(Y,L,E){var $=this,y=$.getGL();if($.validate(),Y){var m=y.getParameter(y.COLOR_CLEAR_VALUE);Ml(y,Y)}$._42(Z,1);var w=$.getWidth()||1,V=$.getHeight()||1,C=new Uint8Array(4*w*V),c=uh(),B=c.getContext("2d");y.readPixels(0,0,w,V,y.RGBA,y.UNSIGNED_BYTE,C),wg(c,w,V,1);for(var h=B.getImageData(0,0,w,V),e=h.data,u=0;u<e.length;u+=4){var g=u/4,N=H(g/w),K=g-N*w;g=4*((V-1-N)*w+K),e[g]=C[u],e[g+1]=C[u+1],e[g+2]=C[u+2],e[g+3]=C[u+3]}if(B.putImageData(h,0,0),Y&&Ml(y,m),$._42(Z,$.getDevicePixelRatio()),L&&E){var r=uh(),Q=r.getContext("2d");return L=L,E=E,wg(r,L,E,1),A.drawImage(Q,c,0,0,L,E),r}return c},toDataURL:function(a,N){var U=this,n=U.getGL();if(U.validate(),a){var z=n.getParameter(n.COLOR_CLEAR_VALUE);Ml(n,a)}U._42(Z,1);var A=U._canvas.toDataURL(N||"image/png",1);return a&&Ml(n,z),U._42(Z,U.getDevicePixelRatio()),A},getGL:function(){var j=this._26I;if(j)return this.acquireProgram(),j;var R=this,k=R._canvas,h=R._attributes;try{j=k.getContext("webgl2",h)||k.getContext("experimental-webgl2",h),j&&(R._webGLVersion=2,R._26I=j)}catch(E){}if(!j)try{j=k.getContext("webgl",h)||k.getContext("experimental-webgl",h)}catch(E){throw new Error("WebGL not supported")}if(!j)throw new Error("WebGL not supported");R._26I=j,R._glExtensions=new b(j),R._glCapabilities=new X(j,R._glExtensions),R._2O={},j._compiledShader={},j._emptyTexture=lp(j),j._emptyBlendTexture=lp(j),j._bufPool={},j._id=++Ho,R._buffer={vs:Li(j),ns:Li(j),is:Li(j),uv:Li(j),batchColor:Li(j),batchBlend:Li(j),batchBrightness:Li(j),lineDistance:Li(j)},R._1O=$d(j);var P=R._cube={vs:Li(j),ns:Li(j),is:Li(j),uv:Li(j)};return zj(j,P.vs,tp),zj(j,P.ns,fo),zj(j,P.uv,jr),db(j,P.is,up),R.acquireProgram(),j},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var N=this,p=N._26I;if(p){var x=A.getImage(N.getEnvmap()),f=x&&x.tagName?!0:!1,O=N._prg&&N._prg.envMapFlag?!0:!1;if(!N._prg||f!==O){var v=N._prg=p.createProgram();if(!v)return Z;v.envMapFlag=f;var w=N._dirs.length,i=N._spots.length,P=N._59O.length,F=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogNear","uFogFar"];w&&F.push("uDirColor","uDirDirection"),i&&F.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),P&&F.push("uPointColor","uPointRange","uPointPosition"),Ml(p,[0,0,0,0]),p.clearDepth(1),p.enable(p.DEPTH_TEST),p.depthFunc(p.LEQUAL),p.enable(p.BLEND),p.blendFuncSeparate(p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA),pl||(vh=il(vh.substring(0,vh.indexOf("^#"))),Gf=il(Gf),pl=!0);var U=["#define MAX_DIR "+w,"#define MAX_SPOT "+i,"#define MAX_POINT "+P,N._fogDisabled?"":"#define FOG",N._dashDisabled?"":"#define DASH",f?"#define USE_ENVMAP":"",N.isOrtho()?"#define ORTHOGRAPHIC":"",N._batchColorDisabled?"":"#define BATCHCOLOR",N._batchBlendDisabled?"":"#define BATCHBLEND",N._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),R=$i(p,v,p.VERTEX_SHADER,vh.replace("PREFIX",U));p.getShaderParameter(R,p.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",p.getShaderInfoLog(R));var V=$i(p,v,p.FRAGMENT_SHADER,Gf.replace("PREFIX",U));p.getShaderParameter(V,p.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",p.getShaderInfoLog(V)),Fj?F.push("aPosition"):(v.aPosition=0,p.bindAttribLocation(v,0,"aPosition")),p.linkProgram(v),F.forEach(function(c){v[c]=/^u/.test(c)?p.getUniformLocation(v,c):p.getAttribLocation(v,c)}),p.useProgram(v),p.deleteShader(R),p.deleteShader(V)}}},getBrightness:function(q){var m=q.s("brightness"),_=this.isSelected(q)?q.s("select.brightness"):Z;return m==Z?_:_==Z?m:m*_},setHighlightMode:function(I){var O;O="selection"===I||"selected"===I?hn.Mode.Selection:"mouseover"===I||"hover"===I?hn.Mode.MouseOver:"style"===I?hn.Mode.Style:hn.Mode.Disable;var u=this._highlightHelper.mode;this._highlightHelper.mode=O,this.firePropertyChange("highlightMode",u,O)},getHighlightMode:function(){var n=this._highlightHelper.mode;return n===hn.Mode.Selection?"selected":n===hn.Mode.MouseOver?"hover":n===hn.Mode.Style?"style":"disabled"},getHighlightColor:function(){return this._highlightHelper.color||y["highlight.color"]},setHighlightColor:function(t){var F=this._highlightHelper.color;this._highlightHelper.color=t,this.firePropertyChange("highlightColor",F,t)},getHighlightWidth:function(){return this._highlightHelper.width||y["highlight.width"]},setHighlightWidth:function(P){var E=this._highlightHelper.width;this._highlightHelper.width=P,this.firePropertyChange("highlightWidth",E,P)},bindEnvMap:function(k){var M=this,v=M._prg,F=5,Y=M.getEnvmap(),R=A.getImage(Y);if(R&&R.tagName){if(Y!==M._lastEnvMap){R=A.resizeImagePOT(R,!0),M._envMapTexture&&k.deleteTexture(M._envMapTexture);var j=M._envMapTexture=k.createTexture();k.activeTexture(k.TEXTURE0),k.bindTexture(k.TEXTURE_CUBE_MAP,j),k.texParameteri(k.TEXTURE_CUBE_MAP,k.TEXTURE_MAG_FILTER,k.LINEAR),k.texParameteri(k.TEXTURE_CUBE_MAP,k.TEXTURE_MIN_FILTER,k.LINEAR),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,R),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,R),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,R),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,R),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,R),k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,k.RGBA,k.RGBA,k.UNSIGNED_BYTE,R),k.bindTexture(k.TEXTURE_CUBE_MAP,null),M._lastEnvMap=Y}k.activeTexture(k.TEXTURE0+F),k.bindTexture(k.TEXTURE_CUBE_MAP,M._envMapTexture),k.uniform1i(v.uEnvMap,F)}},getWireframe:function(S){var o=S.s("wf.visible"),E=S.s("wf.width");return o===!0||E>0&&"selected"===o&&this.isSelected(S)?{color:S.s("wf.color"),width:E,"short":S.s("wf.short"),mat:S.s("wf.mat")}:void 0},_transformPointToViewSpace:function(i){var g=[i[0],i[1],i[2]];return ao(g,this._viewMatrix),g},_transformDirectionToViewSpace:function(r,B){var $=[r[0],r[1],r[2]];ao($,this._viewMatrix);var p=B?[B[0],B[1],B[2]]:[0,0,0];ao(p,this._viewMatrix);var Z=p[0]-$[0],O=p[1]-$[1],J=p[2]-$[2],t=Math.sqrt(Z*Z+O*O+J*J);return t?[Z/t,O/t,J/t]:[Z,O,J]},getWireframeGeometry:function(c){return c.s("wf.geometry")?{color:c.s("wf.color"),width:c.s("wf.width"),mat:c.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(z){return z.s("body.color")},getMat:function(x){return x.getMat?x.getMat():x.s("mat")},getFaceMat:function(Q,H){return Q.getFaceMat?Q.getFaceMat(H):Q.s(H+".mat")},getFaceBlend:function(Y,q){return Y.s(q+".blend")||Y.s("all.blend")},getFaceColor:function(p,G){return p.s(G+".color")||p.s("all.color")},getFaceImage:function(O,U){return O.s(U+".image")||O.s("all.image")},getFaceBlendImage:function(E,v){return E.s(v+".blend.image")||E.s("all.blend.image")},getFaceDiscardSelectable:function(h,w){var B=h.s(w+".discard.selectable");return B==Z?h.s("all.discard.selectable"):B},getFaceUv:function(Y,e){return Y.s(e+".uv")||Y.s("all.uv")},getFaceUvOffset:function(T,Q){return T.s(Q+".uv.offset")||T.s("all.uv.offset")},getFaceUvScale:function(S,H){return S.s(H+".uv.scale")||S.s("all.uv.scale")},getFaceLight:function(a,T){var l=a.s(T+".light");return l==Z?a.s("all.light"):l},getFaceVisible:function(G,S){var z=G.s(S+".visible");return z==Z?G.s("all.visible"):z},getFaceOpacity:function(q,b){var u=q.s(b+".opacity");return u==Z?q.s("all.opacity"):u},getFaceTransparent:function(N,k){var A=N.s(k+".transparent");return A==Z?N.s("all.transparent"):A},getFaceReverseColor:function(g,k){return g.s(k+".reverse.color")||g.s("all.reverse.color")},getFaceReverseFlip:function(H,U){var t=H.s(U+".reverse.flip");return t==Z?H.s("all.reverse.flip"):t},getFaceReverseCull:function(I,X){var C=I.s(X+".reverse.cull");return C==Z?I.s("all.reverse.cull"):C},getTextureMap:function(){return this._2O},deleteTexture:function(m){var e=this,l=e._2O[m];l&&(delete e._2O[m],e.getGL().deleteTexture(l))},invalidateCachedTexture:function(c){var P=this.getData3dUI(c);P.invalidateCachedTexture(this.getGL()),this.invalidateData(c)},invalidateShape3dCachedImage:function(k){this.invalidateCachedTexture(k)},invalidateCachedGeometry:function(M){var r=this.getData3dUI(M);r.invalidateCachedGeometry(),this.invalidateData(M)},isInteractive:function(v){return v.s("interactive")},getTexture:function(E,m,f){if(!E)return Z;var J=this,w=J.getGL(),L=J._2O[E];if(!L){var W=Uj(E),t={mipmapMaxLevel:m?m.s("texture.mipmap.max"):l};if(!W)return w._emptyTexture;if(W.uuid||(W.uuid=a.Math.generateUUID()),W.tagName){if(W.dynamic)return $d(w,W,J._1O,t);L=J._2O[E]=$d(w,W,l,t)}else{var o,y=m&&(m.s("texture.cache")||m.s("shape3d.image.cache")||W.textureCache),O=J.vr.isPresenting();if(O&&(m._textureUpdateFrame===w._renderInfo.frame?y=!0:m._textureUpdateFrame=w._renderInfo.frame),y&&(o=J.getData3dUI(m),L=o.getCachedTexture(f)),!L){var B=w._renderInfo.textureCache;if(y){if(B.time>A.graph3dMaxVectorCacheTime)return J.redraw(),w._emptyTexture;if(!Gk(W,m))return w._emptyTexture}var Y;m&&(1!==m.s("texture.scale")?Y=m.s("texture.scale"):1!==m.s("shape3d.texture.scale")&&(Y=m.s("shape3d.texture.scale"))),Y||(Y=1);var h=m&&(m.s("fixSizeOnScreen")||m.s("shape3d.fixSizeOnScreen")),x=h?w.NEAREST:w.LINEAR;h?"number"==typeof h&&(Y*=0>h?1:h):m&&(m.s("vector.dynamic")||m.s("shape3d.vector.dynamic"))&&(o||(o=J.getData3dUI(m)),h=o.getVectorDynamicSize());var b,c,n,H=m&&m.s("shape3d");"billboard"===H?n=m.getTall()/m.getWidth():"plane"===H&&(n=m.getHeight()/m.getWidth());var z=ab(W,m);if(h){var Q=J.getDevicePixelRatio();b=h[0]>0?h[0]*Q:Y*z*Q,c=h[1]>0?h[1]*Q:Y*(n?kn(W,m,J,Math.min(4096,z*n)):kn(W,m))*Q}else b=Y*z,c=Y*(n?kn(W,m,J,Math.min(4096,z*n)):kn(W,m));if(b>=1&&c>=1){var _=0;(y||O)&&(_=Date.now());var P=Zi(b,c);if(!o&&m&&(o=J.getData3dUI(m)),o&&o.interactiveInfo){var j=E;"object"==typeof j&&(j=j.uuid||(j.uuid=a.Math.generateUUID()));var C=o.interactiveInfo[j]={};P.interactiveInfo=C.bodyInfo={compInfos:[],matrix:new dd,rect:{x:0,y:0,width:b,height:c}}}nn(P,W,0,0,b,c,m,J),P.interactiveInfo&&(P.interactiveInfo=null),P.restore(),B.count++,B.pixels+=b*c,m?(t.minFilter=m.s("texture.filter.min")||m.s("texture.filter")||x,t.magFilter=m.s("texture.filter.mag")||m.s("texture.filter")||x):t.minFilter=t.magFilter=x,y||O?(L=$d(w,Nc,null,t),o.setCachedTexture(L,f),B.time+=Date.now()-_,Nc=null):L=$d(w,Nc,J._1O,t)}}}}return L},redraw:function(){this.iv()},validateImpl:function(){var P=this;if(P._lightChanged){P._lightChanged=!1;var r=[],V=[],M=[];P.dm().each(function(c){if(bb(c)&&P.isVisible(c)){var H=c.s("light.type");H===Hd?r.push(c):H===Je?V.push(c):H===Hl&&M.push(c)}}),(r.length!==P._59O.length||V.length!==P._spots.length||M.length!==P._dirs.length)&&Tk(P),P._59O=r,P._spots=V,P._dirs=M}P._42(),P._1o.iv()},getRenderInfo:function(){var N=this.getGL();return N?N._renderInfo:void 0},getDebugTip:function(){var T=this,F=T.getRenderInfo();if(F){var P=T.getGL()._validBufCount||0,y="Draw Calls: "+F.calls+"<br/>"+"Vertices: "+F.vertices+"<br/>"+"Faces: "+F.faces+"<br/>"+"Lines: "+F.lines+"<br/>"+"Buffers: "+P+"<br/>"+"Cache Models: "+Y.keys(Qm).length+"<br/>"+"Shape3d Models: "+Y.keys(qj).length;T.vr.isPresenting()&&(y+="<br/>VR fps: "+T.vr.getFps());var U=F.textureCache.count;if(y+="<br/>2D Dynamic Textures: "+F.textureCache.count,U>0){var D,X=F.textureCache.pixels;D=X>1e6?Math.round(X/1e6)+"M":X>1e3?Math.round(X/1e3)+"K":Math.round(X),y+="<br/>2D Dynamic pixels: "+D}return y}},_42:function(l,q){var g=this;if(!g._35O&&(!Wk||fg(Wk))){var A,j;l&&(l instanceof Lo?j=l:A=l);var w=g._canvas,O=g.getGL(),d=g._prg;if(O){var $=g.getWidth(),Q=g.getHeight();if($&&Q){q?l||wg(w,$,Q,q):(q=g.getDevicePixelRatio(),l||$===w.clientWidth&&Q===w.clientHeight||(wg(w,$,Q,q),$&&Math.abs(O.drawingBufferWidth-$*q)>1&&(g.setDevicePixelRatio(q=O.drawingBufferWidth/$),wg(w,$,Q,q)))),O.clear(O.COLOR_BUFFER_BIT),g.drawFilter||(O._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:l?g._frameId:++g._frameId,textureCache:{time:0,count:0,pixels:0},reflectDepth:0});var X,K=this._cameras,t=0,V=K.length,Y=!1,M=a.Default.cameraPriority.skybox,S=a.Default.cameraPriority.main,r=a.Default.cameraPriority.top,I=$*q,P=Q*q,k=function(){g.overlappingBox.clear(),g._81O=Z,O.clear(O.DEPTH_BUFFER_BIT),O._picking=!!l;var U={_picking:!!l,_envmapReflectivity:g._envmapReflectivity||.5,_projectMatrix:g._projectMatrix=wj(g),_viewMatrix:Uk(g,g._7O)};if(g._viewMatrix=Qp(g._7O),j){Vj(O,g,d,U);var q=O.getParameter(O.COLOR_CLEAR_VALUE);O.clearColor(0,0,0,0),O.disable(O.BLEND),Ud(O,d.aNormal),zj(O,g._cube.vs,Z,d.aPosition),db(O,g._cube.is),ie(j,g,Bc,0),ie(j,g,Qj,6),ie(j,g,qe,12),ie(j,g,Zd,18),ie(j,g,Uh,24),ie(j,g,Tg,30),zs(O,d.aNormal),Ml(O,q)}else if(A){for(A.value=2;V>t;t++)if(X=K[t],!X.ignoreInPick){if(X.priority>=S)break;X.useDefaultProgram&&Vj(O,g,d,U),X.render(O,g,A)}Vj(O,g,d,U);var q=O.getParameter(O.COLOR_CLEAR_VALUE);for(O.clearColor(0,0,0,0),O.disable(O.BLEND),O.textureBatch&&!fg[(ONE_FRAME_TIME-6)/2]||g._95I(O,d,A),uk(g,A),ms(g,g._polylineModelMap,A),ms(g,g._wireframeModelMap,A),qc(O,d.uTransparent,!0),g._95I(O,d,A,!0),uk(g,A,!0),ms(g,g._polylineModelMap,A,!0),ms(g,g._wireframeModelMap,A,!0),qc(O,d.uTransparent,!1);V>t;t++)if(X=K[t],!X.ignoreInPick){if(X.priority>=r)break;X.useDefaultProgram&&Vj(O,g,d,U),X.render(O,g,A),Y=!0}for(Y&&(Vj(O,g,d,U),Y=!1),O.clear(O.DEPTH_BUFFER_BIT),g._swapLineMap(),g._95I(O,d,A,!1,!0),ms(g,g._polylineModelMap,A),ms(g,g._wireframeModelMap,A),g._swapLineMap(),g._swapLineMap(),g._95I(O,d,A,!1,!0),ms(g,g._polylineModelMap,A),ms(g,g._wireframeModelMap,A),qc(O,d.uTransparent,!0),g._95I(O,d,A,!0,!0),ms(g,g._polylineModelMap,A,!0),ms(g,g._wireframeModelMap,A,!0),qc(O,d.uTransparent,!1),g._swapLineMap(),O.disable(O.DEPTH_TEST),g.drawFilter||g._30O._42(O,d,A),O.enable(O.DEPTH_TEST);V>t;t++)X=K[t],X.ignoreInPick||(X.useDefaultProgram&&Vj(O,g,d,U),X.render(O,g,A));Ml(O,q)}else{for(;V>t&&(X=K[t],!(X.priority>=M));t++)X.useDefaultProgram&&Vj(O,g,d,U),X.render(O,g);for(Vj(O,g,d,U),O.disable(O.BLEND),g.drawSky(O,d),g.drawReflectors(O,I,P,k,l)&&(U._projectMatrix=g._projectMatrix=wj(g),U._viewMatrix=Uk(g,g._7O),g._viewMatrix=Qp(g._7O),Vj(O,g,d,U));V>t&&(X=K[t],!(X.priority>=S));t++)X.useDefaultProgram&&Vj(O,g,d,U),X.render(O,g),Y=!0;for(Y&&(Vj(O,g,d,U),Y=!1),g._31O._42(O,d),g._95I(O,d),uk(g),ms(g,g._polylineModelMap),ms(g,g._wireframeModelMap),O.enable(O.BLEND),O.depthMask(!1),qc(O,d.uTransparent,!0),g._95I(O,d,Z,!0),uk(g,Z,!0),ms(g,g._polylineModelMap,Z,!0),ms(g,g._wireframeModelMap,Z,!0),O.depthMask(!0),qc(O,d.uTransparent,!1);V>t&&(X=K[t],!(X.priority>=r));t++)X.useDefaultProgram&&Vj(O,g,d,U),X.render(O,g),Y=!0;for(Y&&(Vj(O,g,d,U),Y=!1),O.clear(O.DEPTH_BUFFER_BIT),g._swapLineMap(),O.disable(O.BLEND),g._95I(O,d,Z,!1,!0),ms(g,g._polylineModelMap),ms(g,g._wireframeModelMap),O.enable(O.BLEND),qc(O,d.uTransparent,!0),O.depthMask(!1),g._95I(O,d,Z,!0,!0),ms(g,g._polylineModelMap,Z,!0),ms(g,g._wireframeModelMap,Z,!0),O.depthMask(!0),qc(O,d.uTransparent,!1),g._swapLineMap(),O.disable(O.DEPTH_TEST),O.disable(O.BLEND),g._32O._42(O,d),g._30O._42(O,d),g._highlightHelper._42(O,d),O.enable(O.DEPTH_TEST);V>t;t++)X=K[t],X.useDefaultProgram&&Vj(O,g,d,U),X.render(O,g)}zj(O,Z),db(O,Z)},E=!1,R=g.vr;R.enable&&R._42(O,I,P,k)&&(E=!0);var u=g.envRenderer;u&&u.enable&&u._42(O,I,P,k)&&(E=!0);var o=g._postProcessing;o._42(O,I,P,k,l)&&(E=!0),E||(g.setViewport(O,0,0,$*q,Q*q),k()),g._33Q=!1,g.drawFilter||g.countFrame(),g._doBufferGC(O)}}}},drawReflectors:function(f,C,X,D,P){f._renderInfo.reflectDepth++;var r,M,w,B=this,L=B._dataModel.getReflectors(),A=!1;for(r in L)M=L[r],B.isVisible(M)&&(w=B.getData3dUI(M),w&&w.drawReflector(f,C,X,D,P)&&(A=!0));return f._renderInfo.reflectDepth--,A},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(j,p){return this._postProcessing.enableModule(j,p)},getPostProcessingModule:function(i){return this._postProcessing.getModule(i)},getPostProcessingValue:function(y,o){var F=this._postProcessing.getModule(y);return F?F[o]:l},setPostProcessingValue:function(m,o,O){var e=this.getPostProcessingValue(m),d=this._postProcessing.getModule(m,o);d&&e!==O&&("enable"===o?this.enablePostProcessing(m,O):d[o]=O,this.firePropertyChange("postProcessing."+m+"."+o,e,O))},setViewport:function(h,E,x,Y,I){this._viewport=[E,x,Y,I],h.viewport(E,x,Y,I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(D){this._bufferGCInterval=D},_doBufferGC:function(J,L){var y,o,l=J._bufPool,r=0,_=0,q=J._renderInfo.frame,N=this._bufferGCInterval||10;for(y in l)r++,o=l[y],o&&(L||q-o._fid>N?(J.deleteBuffer(o._buf),o._buf=null,l[y]=null):_++);if(r/2>_&&r>128){var Q={};for(y in l)l[y]&&(Q[y]=l[y]);J._bufPool=Q}J._validBufCount=_},_swapLineMap:function(){var R=this;Hb=R._polylineModelMap,R._polylineModelMap=R._polylineModelMapSwap,R._polylineModelMapSwap=Hb,Hb=R._wireframeModelMap,R._wireframeModelMap=R._wireframeModelMapSwap,R._wireframeModelMapSwap=Hb,Hb=R._polylineIndexMap,R._polylineIndexMap=R._polylineIndexMapSwap,R._polylineIndexMapSwap=Hb,Hb=R._wireframeIndexMap,R._wireframeIndexMap=R._wireframeIndexMapSwap,R._wireframeIndexMapSwap=Hb},_updateSkyBox:function(T){if(this._skyBox&&T){var R=T.property,Y=!1,y=this._skyBox;if("eye"===R||"forceUpdate"===R){var _=this._eye;y.p3(_[0],_[1],_[2]),Y=!0}if("near"===R||"far"===R||"forceUpdate"===R){var U=this._near,v=this._far,q=y.getFinalScale3d();if(q[0]/=2,q[1]/=2,q[2]/=2,q[0]<=U||q[0]>=v||q[1]<=U||q[1]>=v||q[2]<=U||q[2]>=v){var p=2*U*v/(U+v),g=Math.min(q[0],q[1],q[2]),u=p/g,c=y.getScale3d();y.setScale3d(c[0]*u,c[1]*u,c[2]*u),Y=!0}}Y&&this.invalidateData(y)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(Q){var w=this._skyBox;w&&(this._skyBoxStyleMap&&w.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&w.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&w.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=Q,this.ump(this._updateSkyBox,this),Q&&(Q.dm()&&Q.dm().remove(Q),this._skyBoxStyleMap=a.Default.clone(Q.getStyleMap()),this._skyBoxAnchor3d=Q.getAnchor3d(),Q.setAnchor3d(.5,.5,.5),this._skyBoxP3=Q.p3().slice(0),Q.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",w,Q)},drawSky:function(R,p,j){var S=this,z=S._skyBox;if(z){var L=S._headlightIntensity,o=nk(S._headlightColor),p=S._prg;1!==L&&(o=[o[0]*L,o[1]*L,o[2]*L]),qc(R,p.uHeadlightColor,[o[0],o[1],o[2],1]);var E=S.getData3dUI(z);if(E){var N,r=S.isOrtho(),K=r||this._computedProjectMatrix;K&&(N=S._projectMatrix,r&&(S._ortho=!1),qc(R,p.uPMatrix,S._projectMatrix=wj(S,!0)));var e=z.p3(),A=this._eye;(e[0]!==A[0]||e[1]!==A[1]||e[2]!==A[2])&&(z._position.x=A[0],z._54O=A[1],z._position.y=A[2]),E._42(R,p,j,function(){return!0}),K&&(r&&(S._ortho=!0),qc(R,p.uPMatrix,S._projectMatrix=N))}R.clear(R.DEPTH_BUFFER_BIT),qc(R,p.uHeadlightColor,[o[0],o[1],o[2],S._headlightDisabled?1:0])}},_95I:function(T,u,$,R,X){function L(x){if(!(!x.s("alwaysOnTop")&&!x.s("shape3d.alwaysOnTop"))==!!X&&w.isVisible(x)&&(!V||J)){if(!$&&w.isTransparentMask(x))return;var l=w.getData3dUI(x);l&&l._42(T,u,$,H)}}var w=this,H=function(G){return R?G:!G};w.sky&&T.clear(T.DEPTH_BUFFER_BIT);var Z=w.drawFilter;Z?w.dm().each(function($){Z($)||L($)}):w.dm().each(function(b){L(b)})},getLogicalPoint:function(i){return kk(i,this._canvas)},isRectOverlapping:function(v){var G=this.getData3dUI(v);return G._rectOverlapping},getHitFaceInfo:function(X){X.target&&(X=this.lp(X));var J=this.getDataInfoAt(X);if(J){var Y=this._1o.face(J.data,pg(X.x,X.y));if(Y)return{data:J.data,face:Y}}return Z},unproject:function(g,U){var r=this,Q=r.getWidth(),v=r.getHeight(),w=g.target?r.lp(g):g,k=w.x-Q/2,$=w.y-v/2,p=2*(k/Q),M=2*(-1*$/v);U=U||0;var V=jh(),Y=wj(r),u=Uk(r);Vf(V,Y,u),lr(V);var d=wq([p,M,U,1],V);return[d[0]/d[3],d[1]/d[3],d[2]/d[3]]},getDataAt:function(c){var g=this.getDataInfoAt(c);return g?g.data:Z},getDataInfoAt:function(f,z){return f.target&&(f=this.lp(f)),this._1o.get(pg(f.x,f.y,z),!0)},getDatasInRect:function(L){return this._1o.get(L)},setEditable:function($){var o=this,f=o._editable;o._editable=$,this.fp(Mn,f,$)},isEditable:function(L){var S=this;return S._editable?Pr(L)?L.s("3d.editable")?S._editableFunc?S._editableFunc(L):!0:!1:!1:!1},isSelectable:function(b){return b.s("3d.selectable")&&this.sm().isSelectable(b)},isMovable:function(H){var S=this;return Xi(H)&&H.getStyle(vf)!==rd?!1:H.s("3d.movable")?S._movableFunc?S._movableFunc(H):!0:!1},isSizeEditable:function(t){return Pr(t)?this._sizeEditableFunc?this._sizeEditableFunc(t):!0:!1},isRotationEditable:function(f){return Pr(f)&&f.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(f):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(_){this.setZoom(ag,_)},zoomOut:function(T){this.setZoom(1/ag,T)},setZoom:function(){var x=new um,A=new um,Z=new um,S=new um;return function(J,V){if(1!==J){var G=this;G._14o&&G._14o.stop(!0);var y,w=1/J;x.copy(G.getCenter()),A.copy(G.getEye());var R=G._ortho;if(R){if(y=G._orthoWidth,y<G._moveStep&&J>1)return}else if(x.distanceTo(A)<G._moveStep&&1>w)return;var F=!1;return G._zoomToCenter===!1&&G._lastZoomLP&&(Z.copy(A).sub(x).normalize(),G._81O=null,S.copy(G.getHitPosition(G._lastZoomLP,x.toArray(),Z.toArray())),F=!0,G._lastZoomHit=S),(V=Zc(V))?(V.action=function(f){G.fi({kind:G._zooming?"betweenZoom":"beginZoom"}),G._zooming=1;var z=(w-1)*f+1;R&&G.setOrthoWidth(y*z),F?(G.setEye(Z.lerpVectors(S,A,z).toArray()),G.setCenter(Z.lerpVectors(S,x,z).toArray())):R||G.setEye(Z.lerpVectors(x,A,z).toArray())},V._37o=function(){delete G._14o,delete G._zooming,G.fi({kind:"endZoom"}),G.onZoomEnded()},G._14o=we(V)):(R&&G.setOrthoWidth(y*w),F?(G.setEye(Z.lerpVectors(S,A,w).toArray()),G.setCenter(Z.lerpVectors(S,x,w).toArray())):R||G.setEye(Z.lerpVectors(x,A,w).toArray()),void 0)}}}(),setOrthoZoom:function(H,n){return this.setZoom(H,n)},getPositionInfo:function(i){var x=this,E=x._eye,S=x._center,D=x.getAspect(),O=i?bk(bm(S,E,!0),bm(i,E)):fm(E,S);if(x._ortho){var L=x._orthoWidth;return{length:O,height:L/D,width:L}}var n=2*F(x._fovy/2)*O;return{length:O,height:n,width:n*D}},getCenterInfo:function(){var d=this;return d._81O||(d._81O=d.getPositionInfo()),Em(d._81O)},rotate:function(f,W,e,_){var g=this;if(f||W){_==Z&&(_=g._firstPersonMode),g._88O&&g._88O.stop(!0);var C=g._center,L=g._eye,r=g.getCenterInfo().length,M=_?C:L,z=_?L:C,b=bm(M,z),N=R(b[0],b[2]),F=R(w(b[0]*b[0]+b[2]*b[2]),b[1]),n=_?Jg:Ze;return _&&(W=-W),(e=Zc(e))?(e.action=function(U){g.fi({kind:g._rotating?"betweenRotate":"beginRotate"}),g._rotating=1;var I=N+f*U,C=F+W*U;C=_?i-Cc(i-C):Cc(C),b[0]=r*E(C)*E(I),b[1]=r*m(C),b[2]=r*E(C)*m(I),M[0]=z[0]+b[0],M[1]=z[1]+b[1],M[2]=z[2]+b[2],g.fp(n,Z,M)},e._37o=function(){delete g._88O,delete g._rotating,g.fi({kind:"endRotate"}),g.onRotateEnded()},g._88O=we(e)):(N+=f,F+=W,F=_?i-Cc(i-F):Cc(F),b[0]=r*E(F)*E(N),b[1]=r*m(F),b[2]=r*E(F)*m(N),M[0]=z[0]+b[0],M[1]=z[1]+b[1],M[2]=z[2]+b[2],g.fp(n,Z,M),void 0)}},pan:function(X,I,_,o){if(X||I){var d=this;o==Z&&(o=d._firstPersonMode),d._89O&&d._89O.stop(!0);var j=Uk(d),y=[j[0]*X,j[4]*X,j[8]*X],A=[j[1]*I,j[5]*I,j[9]*I],W=y[0]+A[0],K=y[1]+A[1],U=y[2]+A[2],x=d._center,H=d._eye;if(o){var O=ss(d.getBoundaries(),H[0],H[2],H[0]+W,H[2]+U,w(W*W+U*U));W=O[0],U=O[1]}if(_=Zc(_)){var T=Em(H),S=Em(x);return _.action=function($){d.fi({kind:d._panning?"betweenPan":"beginPan"}),d._panning=1,x[0]=S[0]+W*$,x[1]=S[1]+K*$,x[2]=S[2]+U*$,H[0]=T[0]+W*$,H[1]=T[1]+K*$,H[2]=T[2]+U*$,d.fp(Ze,Z,H),d.fp(Jg,Z,x)},_._37o=function(){delete d._89O,delete d._panning,d.fi({kind:"endPan"}),d.onPanEnded()},d._89O=we(_)}x[0]+=W,x[1]+=K,x[2]+=U,H[0]+=W,H[1]+=K,H[2]+=U,d.fp(Ze,Z,H),d.fp(Jg,Z,x)}},walk:function(q,L,A){if(q){var j=this;A==Z&&(A=j._firstPersonMode),j._90O&&j._90O.stop(!0);var v=j._center,M=j._eye,u=bm(v,M,!0);if(A){var P=ss(j.getBoundaries(),M[0],M[2],M[0]+u[0]*q,M[2]+u[2]*q,t(q));if(q=fm(P),!q)return;u=[P[0]/q,0,P[1]/q]}if(L=Zc(L)){var g=Em(M),R=Em(v);return L.action=function(n){j.fi({kind:j._walking?"betweenWalk":"beginWalk"}),j._walking=1;var s=q*n;M[0]=g[0]+u[0]*s,M[1]=g[1]+u[1]*s,M[2]=g[2]+u[2]*s,v[0]=R[0]+u[0]*s,v[1]=R[1]+u[1]*s,v[2]=R[2]+u[2]*s,j.fp(Ze,Z,M),j.fp(Jg,Z,v)},L._37o=function(){delete j._90O,delete j._walking,j.fi({kind:"endWalk"}),j.onWalkEnded()},j._90O=we(L)}M[0]+=u[0]*q,M[1]+=u[1]*q,M[2]+=u[2]*q,v[0]+=u[0]*q,v[1]+=u[1]*q,v[2]+=u[2]*q,j.fp(Ze,Z,M),j.fp(Jg,Z,v)}},handleScroll:function(c,b){c.preventDefault();var l=this,A=l._moveStep,t=l.getDataInfoAt(c);if(t){var p=t.data;if(p&&l.isInteractive(p)){var Z=l.intersectObject(c,p);if(Z){var X=Z.part,U=Uj(p.s(X+".image")||p.s("shape3d."+X+".image")||p.s("all.image")||p.s("shape3d.image"));if(U&&Xo(U.scrollable,p,l))return}}}return l.isFirstPersonMode()?(l.isPannable()&&l.pan(0,b>0?A:-A),void 0):(l.isZoomable()&&(l._lastZoomLP=l.lp(c),l.setZoom(0>b?1/Br:Br),l._lastZoomLP=l._lastZoomHit=null),void 0)},handlePinch:function(h,t){if(this.isZoomable()){if(Math.abs(h-t)<A.pinchZoomThreshold)return;this.setZoom(t>h?1/rf:rf)}},reset:function(){this.setCenter(A.graph3dViewCenter),this.setEye(A.graph3dViewEye),this.setUp(A.graph3dViewUp)},moveSelection:function(Y,t,c){var M=this;M.dm().beginTransaction(),Ge(this.sm().toSelection(this.isMovable,this),Y,t,c),M.dm().endTransaction()},getMoveMode:function(R,v){var l=v.s("3d.move.mode");if(l)return l;var c="88",o="89",m="90";return _d(R)||_n[c]&&_n[o]&&_n[m]?"xyz":_n[c]&&_n[o]?"xy":_n[c]&&_n[m]?"xz":_n[o]&&_n[m]?"yz":_n[c]?"x":_n[o]?"y":_n[m]?"z":"xz"},handleTick:function(){var U=this,t=!1,E=U._moveStep,J=E,R=!1,K=!0,Z=U._rotateStep*(K?-1:1);if(U.isWalkable()||(J=0),U.isPannable()||(E=0),U.isRotatable()||(Z=0),U._32Q){var n=(xk()-U._32Q)/50;J*=n,E*=n,Z*=n}U._31Q&&(wr(U._31Q),delete U._31Q,delete U._32Q),wf()&&(t=!0,U.pan(-E,0,R,K)),pk()&&(t=!0,U.pan(E,0,R,K)),Oh()&&(t=!0,_d()?U.pan(0,E,R,K):U.walk(J,R,K)),Kh()&&(t=!0,_d()?U.pan(0,-E,R,K):U.walk(-J,R,K)),Bg()&&(t=!0,U.rotate(-Z,0,R,K)),Pn()&&(t=!0,U.rotate(Z,0,R,K)),yb()&&(t=!0,U.rotate(0,-Z/2,R,K)),Vl()&&(t=!0,U.rotate(0,Z/2,R,K)),t&&(U._32Q=xk(),U._31Q=ys(U.handleTick,U))},handleKeyDown:function(I){var h=this;!oe(I)&&Re[I.keyCode]?h.handleTick():Dn(I)?h.selectAll():Go(I)?h.handleDelete(I):nb(I)&&this.isResettable()&&h.reset()},checkDoubleClickOnNote:function(C,P,s){var l=this;if(s===sl){if(P.s("note.toggleable"))return P.s(ac,!P.s(ac)),l.fi({kind:"toggleNote",event:C,data:P,part:s}),!0}else if(s===Am&&P.s("note2.toggleable"))return P.s(Rc,!P.s(Rc)),l.fi({kind:"toggleNote2",event:C,data:P,part:s}),!0;return!1},checkDoubleClickOnRotation:function(w,t,Q){return Q===qo?(t.setRotationX(0),!0):Q===_c?(t.setRotationY(0),!0):Q===zb?(t.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(L){var M=this;if(M.isOrtho())return M.getWidth()/M.getOrthoWidth();
            var a=M.getCenter(),D=M.getHeight(),C=M.getEye(),_=[a[0]-C[0],a[1]-C[1],a[2]-C[2]],S=[L[0]-C[0],L[1]-C[1],L[2]-C[2]],Q=Math.sqrt(_[0]*_[0]+_[1]*_[1]+_[2]*_[2]),X=1/Math.tan(M.getFovy()/2);return D*Q*X/(S[0]*_[0]+S[1]*_[1]+S[2]*_[2])},inViewSpace:function(C){var f,z=this,y=z._transformPointToViewSpace(C),x=z.getAspect(),S=z.getNear(),A=z.getFar();return-y[2]<S||-y[2]>A?!1:z.isOrtho()?(f=z.getOrthoWidth()/2,Math.abs(y[0])<=f&&Math.abs(y[1]*x)<=f):(f=Math.sqrt(y[0]*y[0]+y[1]*y[1]+y[2]*y[2])*Math.tan(z.getFovy()/2),Math.abs(y[1]<=f)&&Math.abs(y[0])<=f*x)},getPVMatrix:function(){var C=this,K=C.getWidth()/2,x=C.getHeight()/2,I=C._18Q;return I&&I._wh===K/x||(I=wj(C),C._18Q=Vf(I,I,Uk(C)),C._18Q._wh=K/x),I},getFrustum:function(){var Y=new ke,i=new Fq,R=new Array(16);return function(){for(var V=this.getPVMatrix(),g=!1,K=0;16>K;K++)V[K]!==R[K]&&(g=!0,R[K]=V[K]);return g&&i.setFromMatrix(Y.fromArray(V)),i}}(),toViewPosition:function(X){var R=this,e=R.getWidth()/2,h=R.getHeight()/2,u=R.getPVMatrix();return X=wq([X[0],X[1],X[2],1],u),{x:e+e*X[0]/X[3],y:h-h*X[1]/X[3],z:X[2]/X[3]}},getHitPosition:function(V,F,M){var $=this,x=$.getWidth(),i=$.getHeight(),t=V.target?$.lp(V):V,q=t.x-x/2,s=t.y-i/2,D=$.getCenterInfo(),r=Uk($);F=F?F:[0,0,0],M=M?M:[0,1,0],q=q/x*D.width,s=-1*s/i*D.height;var _=[r[0]*q,r[4]*q,r[8]*q],p=[r[1]*s,r[5]*s,r[9]*s],f=[_[0]+p[0],_[1]+p[1],_[2]+p[2]],v=$.getCenter(),U=Rn($,F,M,[f[0]+v[0],f[1]+v[1],f[2]+v[2]]);return U?U:[0,0,0]},intersectObject:function(J,F){return this._raycaster.intersectObject(J,F)},intersectObjects:function(n,H,Z){return this._raycaster.intersectObjects(n,H,Z)},getLineLength:function(n){this.validate();var g=this.getData3dUI(n);if(g&&g.getCache){var V=g.getCache();if(V)return V[V.length-1].length}return 0},getLineOffset:function(i,t){var r=this.getData3dUI(i);if(r&&r.getCache){var v=r.getCache();if(v){var K=rq(v,t);if(!i.r3)return K;var N=i.r3();if(0===N[0]&&0===N[1]&&0===N[2])return K;var b=new um(i.p3()),X=new um(K.point).sub(b),O=new um(K.tangent).add(X),z=(new Rl).setFromEuler(new kd(N,i.getRotationMode(),!0));return X.applyQuaternion(z),O.applyQuaternion(z),{point:X.add(b),tangent:O.sub(X).normalize()}}}return Z},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(G,O,x){var D=this,n=D.getEye();n=[n[0],n[1],n[2]];var g=D.getCenter();if(g=[g[0],g[1],g[2]],G||(G=n),O||(O=g),D._flyAnim&&D._flyAnim.stop(!0),x=Zc(x),!x)return D.setEye(G[0],G[1],G[2]),D.setCenter(O[0],O[1],O[2]),delete D._flyAnim,!0;var h=[G[0]-n[0],G[1]-n[1],G[2]-n[2]],l=[O[0]-g[0],O[1]-g[1],O[2]-g[2]];return x.action=function(x){D.setCenter(g[0]+l[0]*x,g[1]+l[1]*x,g[2]+l[2]*x),D.setEye(n[0]+h[0]*x,n[1]+h[1]*x,n[2]+h[2]*x)},x._37o=function(){delete D._flyAnim},D._flyAnim=we(x)},flyTo:function(){function H(A,m,I){if(I instanceof a.Node){k.fromArray(qp(I,m.getMat(I)));var c=I.getAnchor3d();A.push((new um).set(0-c.x,0-c.y,0-c.z).applyMatrix4(k)),A.push((new um).set(0-c.x,0-c.y,1-c.z).applyMatrix4(k)),A.push((new um).set(0-c.x,1-c.y,0-c.z).applyMatrix4(k)),A.push((new um).set(0-c.x,1-c.y,1-c.z).applyMatrix4(k)),A.push((new um).set(1-c.x,0-c.y,0-c.z).applyMatrix4(k)),A.push((new um).set(1-c.x,0-c.y,1-c.z).applyMatrix4(k)),A.push((new um).set(1-c.x,1-c.y,0-c.z).applyMatrix4(k)),A.push((new um).set(1-c.x,1-c.y,1-c.z).applyMatrix4(k))}}var d=new um,K=new um,v=new um,C=new um,k=new ke,p=new a.Math.Quaternion,O=new kd;return function(j,h,r){var S=this;if(r!==l)h={animation:h,ratio:r};else{var U=typeof h;("boolean"===U||"object"===U&&h.duration)&&(h={animation:h})}h=h||{},d.fromArray(S.getEye()),K.fromArray(S.getCenter());var g,w,V=[],z=h.center,o=h.distance===l;if(z&&v.fromArray(z),j instanceof a.Node)z||v.fromArray(j.p3()),o&&(H(V,S,j),g=V.length);else{if(j||(j=S.dm().getDatas()),!j.length)return;if((o||!z)&&(V=[],j.forEach(function(I){H(V,S,I)}),g=V.length,!g))return;if(!z){for(v.set(0,0,0),w=0;g>w;w++)v.add(V[w]);v.multiplyScalar(1/g)}}if(S.setCenter(v.x,v.y,v.z),C.subVectors(d,K),h.direction||h.worldDirection){!h.worldDirection&&j instanceof a.Node?p.setFromEuler(O.set(j.r3(),j.getRotationMode(),!0)):p.set(0,0,0,1);var B=C.length();C.fromArray(h.worldDirection||h.direction).applyQuaternion(p).setLength(B)}var N=0;if(o){var s,q,W,r=h.ratio||.8,$=h.xRatio||r,u=h.yRatio||r;if(S.isOrtho()){var T=-1/0;for(S._eye[0]=C.x+v.x,S._eye[1]=C.y+v.y,S._eye[2]=C.z+v.z,s=wj(S),Vf(s,s,Uk(S)),w=0;g>w;w++)W=V[w],q=wq([W.x,W.y,W.z,1],s),T=Math.max(T,Math.max(Math.abs(q[0])/$,Math.abs(q[1])/u));N=S.getOrthoWidth()*T,C.add(v)}else{for(var n,y,t=S.getNear(),Z=10;Z--;){for(S._eye[0]=C.x+v.x,S._eye[1]=C.y+v.y,S._eye[2]=C.z+v.z,s=wj(S),Vf(s,s,Uk(S)),n=!0,y=-1/0,w=0;g>w;w++){if(W=V[w],q=wq([W.x,W.y,W.z,1],s),q[3]<t&&Z){C.multiplyScalar(2),n=!1;break}y=Math.max(y,Math.max(Math.abs(q[0])/$,Math.abs(q[1])/u)-q[3])}if(n)break}C.setLength(y+C.length()).add(v)}}else C.setLength(h.distance).add(v);S._flyAnim&&S._flyAnim.stop(!0);var e=Zc(h.animation);if(e){S.setEye(d.x,d.y,d.z),S.setCenter(K.x,K.y,K.z);var Q=(new um).subVectors(C,d),k=(new um).subVectors(v,K);if(N)var f=S.getOrthoWidth();var M=new um,G=new um,m=e.action,D=e._37o,I=d.clone(),J=K.clone();return e.action=function(q,h){M.copy(I).addScaledVector(Q,q),G.copy(J).addScaledVector(k,q),S.setCenter(G.x,G.y,G.z),S.setEye(M.x,M.y,M.z),N&&S.setOrthoWidth((N-f)*q+f),m&&m(q,h)},e._37o=function(){delete S._flyAnim,D&&D()},{lastEye:d,lastCenter:K,eye:C,center:v,orthoWidth:N,animation:S._flyAnim=we(e)}}return S.setEye(C.x,C.y,C.z),N&&S.setOrthoWidth(N),delete S._flyAnim,{lastEye:d,lastCenter:K,eye:C,center:v,orthoWidth:N}}}(),getBoundingBox:function(){function D(D,f,E){e.fromArray(qp(E,f.getMat(E)));var _=E.getAnchor3d();D.push((new um).set(0-_.x,0-_.y,0-_.z).applyMatrix4(e)),D.push((new um).set(0-_.x,0-_.y,1-_.z).applyMatrix4(e)),D.push((new um).set(0-_.x,1-_.y,0-_.z).applyMatrix4(e)),D.push((new um).set(0-_.x,1-_.y,1-_.z).applyMatrix4(e)),D.push((new um).set(1-_.x,0-_.y,0-_.z).applyMatrix4(e)),D.push((new um).set(1-_.x,0-_.y,1-_.z).applyMatrix4(e)),D.push((new um).set(1-_.x,1-_.y,0-_.z).applyMatrix4(e)),D.push((new um).set(1-_.x,1-_.y,1-_.z).applyMatrix4(e))}var e=new ke;return function(s){if(s=s||this.sm().getSelection(),s instanceof a.Node&&(s=[s]),0===s.length)return Z;var T=[];s.forEach(function(X){D(T,this,X)},this);var j=[1/0,1/0,1/0],S=[-1/0,-1/0,-1/0];return T.forEach(function($){j[0]=Math.min($.x,j[0]),j[1]=Math.min($.y,j[1]),j[2]=Math.min($.z,j[2]),S[0]=Math.max($.x,S[0]),S[1]=Math.max($.y,S[1]),S[2]=Math.max($.z,S[2])}),{min:j,max:S}}}()}),Hp.RenderEnv=function(M){this.gv=M,this.enable=!1},Y.defineProperties(Hp.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(o){this._debugOn=o,this.capture&&this.capture()}}}),Y.assign(Hp.RenderEnv.prototype,{renderEnvToCube:function(M,d,W,O){var c=this,L=c.gv;if(!M||!d||!W)return c.enable=!1,c._42=null,void 0;c.enable=!0;var V=Math.floor(O/M*d),x=L.getGL(),P=c._renderTargets;P?P.length<W&&(P=c._renderTargets=P.concat(new Array(W-P.length))):P=c._renderTargets=new Array(W);for(var q=0;W>q;q++)P[q]?P[q].setSize(x,O,V):P[q]=new Hp.RenderTarget(L,x,O,V);var F=!1;c.capture=function(){F=!0,L._42(),F=!1};var u=new um,g=new um,J=new um,G=new um,j=(new um).setY(0),l=2*Math.PI/W,H=M/2/Math.tan(Math.PI/W),r=2*Math.atan2(d/2,H),w=M/d;c._42=function(i,D,R,p){var Z=c._debugOn;if(!F&&!Z)return!1;u.copy(L.getEye()),G.copy(L.getCenter()).sub(u);var s=Math.atan2(G.z,G.x),a=L.getNear(),z=L.getFovy(),M=L.getAspect();g.copy(L.getCenter());for(var h,Y=0;W>Y;Y++)if(h=P[Y],j.setZ(Math.cos(s)).setX(Math.sin(s)).multiplyScalar(H),s-=l,J.addVectors(u,j),L.setNear(H),L.setCenter([J.x,J.y,J.z]),L.setFovy(r),L.setAspect(w),Z){var y=Math.round(D/W);i.viewport(y*Y,0,y,R),p()}else Qk(i,h.frame),i.viewport(0,0,h.width,h.height),i.clear(i.COLOR_BUFFER_BIT),p(),Or(i),h.assureTexture();return L.setNear(a),L.setCenter([g.x,g.y,g.z]),L.setFovy(z),L.setAspect(M),!0},c.capture()},getTextureInfo:function(t){var o=this._renderTargets;if(!o)return null;var s=this._renderTargets[t];return s?{index:t,texture:s.texture,textureName:s.uuid}:null}}),Y.assign(Hp.Graph3dView.prototype,{renderEnvToCube:function(t,v,$,E){var u=this;u.envRenderer||(u.envRenderer=new Hp.RenderEnv(u)),u.envRenderer.renderEnvToCube(t,v,$,E)}}),Hp.RenderTarget=function(m,y,i,k,X){var D=this;X=X||{},X.samples=Math.min(m._glCapabilities.maxSamples,X.samples&&X.samples>1&&2===m._webGLVersion?X.samples:0),D.options=X,D.uuid=a.Math.generateUUID(),D.gv=m,D.init(m,y,X),X.samples&&!m._glCapabilities._maxSamplesChecked?D.setSize(y,i||1,k||1):D.setSize(y,i,k)},Y.assign(Hp.RenderTarget.prototype,{bind:function(x){Qk(x,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(S){Or(S),this.options.samples&&(S.bindFramebuffer(S.READ_FRAMEBUFFER,this._MSAAFbo),S.bindFramebuffer(S.DRAW_FRAMEBUFFER,this.frame),S.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,S.COLOR_BUFFER_BIT,S.NEAREST),S.bindFramebuffer(S.READ_FRAMEBUFFER,null),S.bindFramebuffer(S.DRAW_FRAMEBUFFER,null))},init:function(q,l,f){var x=this,g=x.texture=l.createTexture();l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,g);var t=f.samples,n=t?l.NEAREST:l.LINEAR;l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,f.minFilter||n),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,f.magFilter||n),l.bindTexture(l.TEXTURE_2D,null),x.render=l.createRenderbuffer(),x.frame=l.createFramebuffer(),q._2O[x.uuid]=g},assureTexture:function(){var m=this,V=m.uuid,P=m.gv._2O;P[V]||(P[V]=m.texture)},setSize:function(W,O,q){var a=this;if(O&&q&&(a.width!==O||a.height!==q)){var Q=W.RGBA,G=W.TEXTURE_2D,f=W.RENDERBUFFER,w=W.FRAMEBUFFER,V=a.options.samples;if(vk(W,a.texture),W.texImage2D(G,0,Q,O,q,0,Q,W.UNSIGNED_BYTE,Z),rk.isPOT(O)&&rk.isPOT(q)&&!a.options.clampToEdge?(W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.REPEAT),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.REPEAT)):(W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE)),W.bindRenderbuffer(f,a.render),V){var X=a.gv._glCapabilities;if(X._maxSamplesChecked)W.renderbufferStorageMultisample(f,V,W.DEPTH_COMPONENT16,O,q);else{for(W.getError();V>1&&(W.renderbufferStorageMultisample(f,V,W.DEPTH_COMPONENT16,O,q),W.getError());)V=Math.floor(V>>1);1>=V&&(V=0,W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,a.options.minFilter||W.LINEAR),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,a.options.magFilter||W.LINEAR),W.renderbufferStorage(f,W.DEPTH_COMPONENT16,O,q)),X._maxSamplesChecked=!0,X.maxSamples=a.options.samples=V}}else W.renderbufferStorage(f,W.DEPTH_COMPONENT16,O,q);V&&!a._MSAAFbo&&(a._MSAAFbo=W.createFramebuffer(),a._MSAARbO=W.createRenderbuffer()),Qk(W,a.frame),W.framebufferTexture2D(w,W.COLOR_ATTACHMENT0,G,a.texture,0),V||W.framebufferRenderbuffer(w,W.DEPTH_ATTACHMENT,f,a.render),Or(W),V&&(W.bindRenderbuffer(W.RENDERBUFFER,a._MSAARbO),W.renderbufferStorageMultisample(W.RENDERBUFFER,V,W.RGBA8,O,q),Qk(W,a._MSAAFbo),W.framebufferRenderbuffer(W.FRAMEBUFFER,W.COLOR_ATTACHMENT0,W.RENDERBUFFER,a._MSAARbO),W.framebufferRenderbuffer(w,W.DEPTH_ATTACHMENT,f,a.render),Or(W)),vk(W,Z),W.bindRenderbuffer(f,Z),a.width=O,a.height=q}},toCanvas:function(){var v=this,y=v.gv.getGL();Qk(y,v.frame);var P=v.width,F=v.height,x=new Uint8Array(4*P*F);y.readPixels(0,0,P,F,y.RGBA,y.UNSIGNED_BYTE,x),Or(y);var U=D.createElement("canvas");U.width=P,U.height=F;var V=U.getContext("2d"),w=V.createImageData(P,F);return w.data.set(x),V.putImageData(w,0,0),U}});var hk=Hp.Interactor=function(t){this.gv=this.g3d=t};Hg("Interactor",Y,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var mh=Hp.DefaultInteractor=function(s){$f(mh,this,[s])};Hg("DefaultInteractor",hk,{getDataInfoAt:function(u,s){var F=this.gv,C=F.getDataInfoAt(u);if(!F.isBlockSelectable()||!C||!C.data)return C;if(!s&&F.isSelected(C.data))return C;for(var $=C.data;($=$.getParent())&&$ instanceof a.Block&&F.isSelectable($);){var _=F.isSelected($);if(_&&s)break;if(C={data:$,part:C},_&&!s)break}return C},handle_contextmenu:function(q){td(q)},handle_mousewheel:function(P){this.gv.handleScroll(P,P.wheelDelta/40)},handle_DOMMouseScroll:function(J){2===J.axis&&this.gv.handleScroll(J,-J.detail)},handle_keydown:function(l){this.gv.handleKeyDown(l)},handle_mousedown:function(d){this.handle_touchstart(d)},handle_touchstart:function(C){td(C);var J=this,F=J.gv,p=Vi(C),w=J.getDataInfoAt(C),x=w?w.data:Z,v=w?w.part:Z,T=F.sm(),S=th(C),U=bp(C);F.setFocus(C)&&(J._62O=Z,J._57I=Z,J.pendingClickThrough=Z,J.__lastClientPoint__=zn(C),x?oe(C)?T.co(x)?T.rs(x):T.as(x):T.co(x)?x instanceof Ic&&x.isClickThroughEnabled()&&Vi(C)&&(J.pendingClickThrough=zn(C)):T.ss(x):p&&(oe(C)?F.isRectSelectable()&&(J._62O=ql):J._57I=zn(C)),J._31Q&&(wr(J._31Q),delete J._31Q,delete J._32Q),J._62O||(F.isFirstPersonMode()&&(_d(C)||ge(C)||U>2?J._62O="pan":F.isMouseRoamable()||Fe(C)?(J._62O="roaming",J.foward=S&&Vi(C),J._32Q=xk(),J._31Q=ys(J.tick,J)):p||(J._62O="roaming")),J._62O||(p&&S&&jm[v]?(J._62O=v,J.p3=x.p3()):p&&S&&Pr(x)&&F.isSelected(x)?F.isMovable(x)?(J._62O="move",J.p3=x.p3(),J.movedata=x):F._39Q(x)&&(J._62O="none"):Fe(C)&&(U>2?J._62O="pan":2===U&&(J.dist=Lf(C),J._62O="pinch")))),J.point=F.lp(C),Oi(J,C),Ko(C)?F.handleDoubleClick(C,x,v):F.handleClick(C,x,v))},tick:function(){var s=this,A=s.gv,T=A._moveStep;s.point&&A.isWalkable()&&(s._32Q&&(T*=(xk()-s._32Q)/50),A.walk(s.foward?T:-T),s._32Q=xk(),s._31Q=ys(s.tick,s))},handle_mouseup:function(q){this.handle_touchend(q)},handle_touchend:function(z){var q=this._57I;if(q&&(fm(q,zn(z))<=1&&this.gv.sm().cs(),this._57I=Z),q=this.pendingClickThrough){if(fm(q,zn(z))<=1){var m=this.getDataInfoAt(z);m&&m.data instanceof Ic&&m.data.isClickThroughEnabled()&&(m=this.getDataInfoAt(z,!0),m&&(z.clickThrough=!0,this.gv.sm().ss(m.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(g){this.handleWindowTouchMove(g)},handleWindowTouchMove:function(i){var z,h,P=this,N=P.gv,b=P._62O,U=P.point,w=N.dm(),G=N.lp(i),X=G.x-U.x,f=G.y-U.y,j=N.getWidth(),y=N.getHeight();if(j&&y){var v=zn(i),J=Gm(N,v,P.__lastClientPoint__),Q=fm({x:0,y:0},J),L=-I*X/j,H=-I*f/y;if("roaming"===b)P.rotate(i,L/2,H/2);else if(b===qo||b===_c||b===zb)N._86O||w.beginTransaction(),N.fi({kind:N._86O?"betweenEditRotation":"beginEditRotation",event:i}),N._86O=1,N.sm().each(function(K){if(Pr(K)&&N.isRotationEditable(K)){var s=t(L)>t(H)?L:H;b===qo?K.setRotationX(K.getRotationX()+s):b===_c?K.setRotationY(K.getRotationY()+s):b===zb&&K.setRotationZ(K.getRotationZ()+s)}});else if("move"===b||jm[b]){if(b===Jd||b===Cl||b===yr)N._87O||w.beginTransaction(),N.fi({kind:N._87O?"betweenEditScale":"beginEditScale",event:i}),N._87O=1;else{if(!N._moving){if(Q<A.touchMoveThreshold)return;w.beginTransaction()}N.fi({kind:N._moving?"betweenMove":"beginMove",event:i}),N._moving=1}var g,s=P.p3,x=N.getPositionInfo(s),q=Uk(N);g=b===Wo?"x":b===Tj?"y":b===Dk?"z":b===Jd?"sx":b===Cl?"sy":b===yr?"sz":N.getMoveMode(i,P.movedata),X=X/j*x.width,f=-1*f/y*x.height;var l,R,Y=[q[0]*X,q[4]*X,q[8]*X],M=[q[1]*f,q[5]*f,q[9]*f],o=Y[0]+M[0],T=Y[1]+M[1],r=Y[2]+M[2],m=[s[0]+o,s[1]+T,s[2]+r],u=bm(N.getEye(),m,!0);if("xyz"===g?(l=m,N.moveSelection(o,T,r)):"xz"===g?(l=Rn(N,s,[0,1,0],m),l&&N.moveSelection(l[0]-s[0],0,l[2]-s[2])):"xy"===g?(l=Rn(N,s,[0,0,1],m),l&&N.moveSelection(l[0]-s[0],l[1]-s[1],0)):"yz"===g?(l=Rn(N,s,[1,0,0],m),l&&N.moveSelection(0,l[1]-s[1],l[2]-s[2])):"x"===g||"sx"===g?(u[0]=0,l=Rn(N,s,u,m),l&&(R=l[0]-s[0],"x"===g?N.moveSelection(R,0,0):N.sm().each(function(C){Pr(C)&&N.isSizeEditable(C)&&(z=C.getScaleX()+R/100,h=z/C.getScaleX(),C.setScaleX(z),_d(i)&&(C.setScaleY(C.getScaleY()*h),C.setScaleTall(C.getScaleTall()*h)))}))):"y"===g||"sy"===g?(u[1]=0,l=Rn(N,s,u,m),l&&(R=l[1]-s[1],"y"===g?N.moveSelection(0,R,0):N.sm().each(function(O){Pr(O)&&N.isSizeEditable(O)&&(z=O.getScaleTall()+R/100,h=z/O.getScaleTall(),O.setScaleTall(z),_d(i)&&(O.setScaleY(O.getScaleY()*h),O.setScaleX(O.getScaleX()*h)))}))):("z"===g||"sz"===g)&&(u[2]=0,l=Rn(N,s,u,m),l&&(R=l[2]-s[2],"z"===g?N.moveSelection(0,0,R):N.sm().each(function(r){Pr(r)&&N.isSizeEditable(r)&&(z=r.getScaleY()+R/100,h=z/r.getScaleY(),r.setScaleY(z),_d(i)&&(r.setScaleX(r.getScaleX()*h),r.setScaleTall(r.getScaleTall()*h)))}))),!l)return;P.p3=l}else if(b===ql){var c=P.div;c||(c=P.div=Sr(),Jp(P.getView(),c),c.op=U,c.style.background=N.getRectSelectBackground()),N.fi({kind:N._rectSelecting?"betweenRectSelect":"beginRectSelect",event:i}),N._rectSelecting=1,c.rect=rl(c.op,G),Vn(c,c.rect)}else if("pinch"===b&&2===bp(i)){N.fi({kind:N._pinching?"betweenPinch":"beginPinch",event:i}),N._pinching=1;var R=Lf(i);N._lastZoomLP||(N._lastZoomLP=hd(i)),N.handlePinch(R,P.dist),P.dist=R}else"pan"===b||_d(i)||ge(i)?P.pan(i,X,f):"none"===b||N.isFirstPersonMode()||P.rotate(i,L,H);P.point=G}},pan:function(T,$,n){var p=this.gv;if(p.isPannable()){var D=p.getWidth(),o=p.getHeight();if(!D||!o)return;var s=p.getCenterInfo(),j=$/D*s.width,S=-1*n/o*s.height;p.fi({kind:p._panning?"betweenPan":"beginPan",event:T}),p._panning=1,p.pan(-j,-S)}},rotate:function(t,U,D){var u=this.gv;u.isRotatable()&&(u.fi({kind:u._rotating?"betweenRotate":"beginRotate",event:t}),u._rotating=1,u.rotate(U,D))},handleWindowMouseUp:function(k){this.handleWindowTouchEnd(k)},handleWindowTouchEnd:function(t){var f=this,L=f.gv,_=L.dm(),h=f.div;if(h){var U=L.getDatasInRect(h.rect);if(!U.isEmpty()){var a=L.sm(),E=a.toSelection();U.each(function(h){a.co(h)?E.remove(h):E.add(h)}),a.ss(E)}pf(h)}L._moving&&(delete L._moving,L.fi({kind:"endMove",event:t}),L.onMoveEnded(),_.endTransaction()),L._panning&&(delete L._panning,L.fi({kind:"endPan",event:t}),L.onPanEnded()),L._rotating&&(delete L._rotating,L.fi({kind:"endRotate",event:t}),L.onRotateEnded()),L._86O&&(delete L._86O,L.fi({kind:"endEditRotation",event:t}),_.endTransaction()),L._87O&&(delete L._87O,L.fi({kind:"endEditScale",event:t}),_.endTransaction()),L._pinching&&(delete L._pinching,L.fi({kind:"endPinch",event:t}),L.onPinchEnded()),L._rectSelecting&&(delete L._rectSelecting,L.fi({kind:"endRectSelect",event:t}),L.onRectSelectEnded()),L._walking&&(delete L._walking,L.fi({kind:"endWalk",event:t}),L.onWalkEnded()),L._lastZoomLP=L._lastZoomHit=null,f.dist=f.point=f._62O=f.p3=f.movedata=f.div=f._57I=f.pendingClickThrough=f._32Q=f._31Q=f.foward=Z,f.__lastClientPoint__=Z}});var Lg=Hp.MapInteractor=function(G){$f(Lg,this,[G]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this.maxPhi=5*Math.PI/12};Hg("MapInteractor",hk,{handle_contextmenu:function(E){td(E)},handle_mousewheel:function(i){this.gv.handleScroll(i,i.wheelDelta/40)},handle_DOMMouseScroll:function(M){2===M.axis&&this.gv.handleScroll(M,-M.detail)},handle_keydown:function(I){this.gv.handleKeyDown(I)},handle_mousedown:function(R){this.handle_touchstart(R)},handle_touchstart:function(J){td(J);var C=this,D=C.gv;if(D.setFocus(J)){var z=D.getDataInfoAt(J),l=z?z.data:Z,v=z?z.part:Z,S=C.editing={point:D.lp(J)};Fe(J)?S.touch=!0:(S.touch=!1,S.clickLeft=Vi(J),S.pan=ge(J)?!0:"left"===this.panButton===S.clickLeft),l&&D._39Q(l)&&(S.preventDefault=!0),Oi(C,J),Ko(J)?D.handleDoubleClick(J,l,v):D.handleClick(J,l,v)}},handle_mouseup:function(J){this.handle_touchend(J)},handle_touchend:function(){},handleWindowMouseMove:function(P){this.handleWindowTouchMove(P)},handleWindowTouchMove:function(e){var p=this,k=p.gv,_=p.editing;if(_){var t=k.lp(e),L=_.point,C=t.x-L.x,J=t.y-L.y;if(!_.moved){if(Math.abs(C)<p.threshold&&Math.abs(J)<p.threshold&&!(e.touches&&e.touches.length>1))return;_.moved=!0}if(!_.preventDefault)if(_.point=t,_.touch){var g=e.touches.length;if(2!==g)p.pan(e,C,J);else{if(1>=g)return;var s=e.touches,X={x:s[0].clientX,y:s[0].clientY},K={x:s[1].clientX,y:s[1].clientY},v={x:K.x-X.x,y:K.y-X.y},l=_.lastCenter,Q=Math.atan2(v.y,v.x),E=_.theta,b=0;E==Z?E=_.theta=Q:(b=Q-E,_.thetaStarted||Math.abs(b)>p.touchRotateThreshold?(_.thetaStarted=!0,_.theta=Q):b=0);var d=i*(X.y+K.y)/2/k.getHeight(),F=_.phi,z=0;F==Z?F=_.phi=d:(z=d-F,_.phiStarted||Math.abs(z)>p.touchRotateThreshold?(_.phiStarted=!0,_.phi=d):z=0);var V,j=Math.sqrt(v.x*v.x+v.y*v.y),c=_.vlen;if(c){var W=X.x-l.x,M=X.y-l.y,w=K.x-l.x,O=K.y-l.y,A=Math.sqrt(W*W+M*M),f=Math.sqrt(w*w+O*O),U=c/2,o=p._sign2(A-U),S=p._sign2(f-U);0>o*S||0===o&&0===S?(V=1,_.vlen=j):(V||(V=j/c),_.scaleStarted||Math.abs(V-1)>p.touchScaleThreshold?(_.vlen=j,_.scaleStarted=!0):V=1)}else c=_.vlen=j,V=1;1!==V&&k.setZoom(V),(z||b)&&p.rotate(e,b,-z),_.lastCenter={x:(K.x+X.x)/2,y:(K.y+X.y)/2}}}else if(_.pan)p.pan(e,C,J);else{var h=k.getWidth(),Y=k.getHeight();if(!h||!Y)return;var n=-I*C/h,B=-I*J/Y;p.rotate(e,n,B)}}},_sign2:function(q){return Math.abs(q)<this._touchScaleCheckAccuracy?0:q>0?1:-1},handleWindowMouseUp:function(s){this.handleWindowTouchEnd(s)},handleWindowTouchEnd:function(_){var I=this,N=I.editing;if(I.editing=null,N){var Z=I.gv;if(N.moved||!N.clickLeft&&!N.touch)Z._panning=null,Z._rotating=null,Z.fi({kind:N.pan?"endPan":"endRotate",event:_});else{var C=Z.getDataAt(_);C?Z.sm().setSelection([C]):Z.sm().clearSelection()}}},pan:function(h,w,M){var $=this,s=$.gv;if(s.isPannable()){var U=s.getWidth(),R=s.getHeight();if(U&&R){var g=s.getCenterInfo(),d=-w/U*g.width,u=1*M/R*g.height;s.fi({kind:s._panning?"betweenPan":"beginPan",event:h}),s._panning=1;var q=$.keepHorizon,C=$.editing.touch;if((C&&h.touches&&h.touches.length>1||!C&&_d(h))&&(q=!q),!q)return s.pan(d,u);if(d||u){var L=Uk(s),p=[L[0]*d,L[4]*d,L[8]*d],H=[L[1],0,L[9]],x=Math.sqrt(H[0]*H[0]+H[2]*H[2]);x&&(H=[H[0]/x*u,0,H[2]/x*u]);var A=p[0]+H[0],D=p[1]+H[1],V=p[2]+H[2],c=s._center,v=s._eye;c[0]+=A,c[1]+=D,c[2]+=V,v[0]+=A,v[1]+=D,v[2]+=V,s.fp(Ze,Z,v),s.fp(Jg,Z,c)}}}},rotate:function(c,v,F){var r=this,M=r.gv;if(M.isRotatable()){var x=M._center,s=M._eye,i=bm(s,x),A=R(w(i[0]*i[0]+i[2]*i[2]),i[1]),n=Cc(A+F);F=n-A,M.fi({kind:M._rotating?"betweenRotate":"beginRotate",event:c}),M._rotating=1,M.rotate(v,F)}}}),Y.defineProperties(Lg.prototype,{panButton:{get:function(){return this._panButton},set:function($){this._panButton=$}},minPhi:{get:function(){return A.graph3dViewMinPhi},set:function(D){A.graph3dViewMinPhi=D}},maxPhi:{get:function(){return A.graph3dViewMaxPhi},set:function(B){A.graph3dViewMaxPhi=B}},keepHorizon:{get:function(){return this._keepHorizon},set:function(m){this._keepHorizon=m}},threshold:{get:function(){return this._threshold},set:function(s){this._threshold=s}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(O){this._touchScaleThreshold=O}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(C){this._touchRotateThreshold=C}}});var te,Rp="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Lk=32,Ke=Hp.GlobeInteractor=function(I,B){$f(Ke,this,[I]);var c,H=B.radius||6378137,A=this,F=null;te||(te=Sr(),te.style.border="",te.style.backgroundImage="url("+Rp+")");var g=new Rl,W=new um,C=new um,n=new um,J=new Jl,Q="number"==typeof H?{x:H,y:H,z:H}:H,y={center:new um(0,0,0),radius:Q},f=function(G){I._81O=null;var r=I.getHitPosition(G,I.getCenter(),W.copy(I.getEye()).sub(C.copy(I.getCenter())).toArray());return J.origin.copy(I.getEye()),J.direction.copy(r).sub(J.origin).normalize(),J.intersectEllipsoid(y)},G=function(m,t){I._81O=null,J.origin.copy(I.getEye());for(var E,F,P=I.getCenter(),n=W.copy(I.getEye()).sub(C.copy(I.getCenter())).toArray(),d=1,X=16,S=0,e=1,Q={x:0,y:0};X--;){if(Q.x=t.x+(m.x-t.x)*d,Q.y=t.y+(m.y-t.y)*d,E=I.getHitPosition(Q,P,n),J.direction.copy(E).sub(J.origin).normalize(),F=J.intersectEllipsoid(y),F&&1===d)return{hit:F};F?S=d:e=d,d=(S+e)/2}return{hit:F,out:1>d}},r=function(v,h){if(F){var c=Date.now();F.deltaTime=F.lastTime?c-F.lastTime:1e3,F.lastTime=c,F.lastAxis=v,F.lastAngle=h}h&&(g.setFromAxisAngle(v,h),I.setEye(W.copy(I.getEye()).applyQuaternion(g).toArray()),I.setCenter(W.copy(I.getCenter()).applyQuaternion(g).toArray()),I.setUp(W.copy(I.getUp()).applyQuaternion(g).toArray()))};A._showCrossIcon=function(p){Jp(A.getView(),te),Vn(te,{x:p.clientX-Lk/2,y:p.clientY-Lk/2,width:Lk,height:Lk})},A._hideCrossIcon=function(){pf(te)},A._scrollImpl=function(X,z){F={point:I.lp(X),screen:zn(X),hit:f(X),type:"right"},F.hitNormalize=F.hit?F.hit.clone().normalize():new um;var a={clientX:F.screen.x,clientY:F.screen.y+10*z};A._handleMoveImpl(a),A._endMoveImpl(a)},A._startMoveImpl=function(Q){c&&(c.stop(!0),c=null),F={point:I.lp(Q),screen:zn(Q),hit:f(Q)},F.hitNormalize=F.hit?F.hit.clone().normalize():new um,Fe(Q)?1===Q.touches.length?F.hit&&(F.type="left"):2===Q.touches.length&&(F.type="touch2"):(Vi(Q)?F.hit&&(F.type="left"):Pi(Q)?F.type="right":ge(Q)&&F.hit&&(F.type="middle"),!F.hit||"right"!==F.type&&"middle"!==F.type||A._showCrossIcon(Q)),F.type&&Oi(A,Q)},A._handleMoveImpl=function(O){if(F)switch(F.type){case"left":return A._handleLeft(O);case"right":return A._handleRight(O);case"middle":return A._handleMiddle(O);case"touch2":return A._handleTouch2(O)}},A._endMoveImpl=function(){if(F){if(this._hideCrossIcon(),"left"===F.type||"middle"===F.type){var b=1e3*(F.lastAngle/(F.deltaTime||30)),e=F.lastAxis,Y=F.lastTime,i=function(){var K=Date.now(),t=(K-Y)/1e3;return Y=K,b*=Math.pow(Math.abs(A.decelerationRate),3*t),Math.abs(b)<.01?(b=0,c&&c.stop(),void 0):(r(e,b*t),void 0)};c=we({action:function(){i(arguments)},duration:5e3})}F=null}},A._handleLeft=function(n){if(!F.finished){var d=zn(n),j=G(d,F.lastScreen||F.screen);if(F.lastScreen=d,!j.hit)return F.finished=!0,A._endMoveImpl(n),void 0;var t=j.hit;t.normalize();var H=F.hitNormalize,f=Math.acos(t.dot(H)),_=t.cross(H).normalize();r(_,f),j.out&&(F.finished=!0,A._endMoveImpl(n))}},A._handleRight=function(d){var i=F.lastScreen||F.screen,w=i.y;i=F.lastScreen=zn(d);var O=i.y,m=O-w;if(m){var s=Math.min(.5,m*A.scaleSpeed);W.copy(I.getEye());var U=F.hit;U||(U=W.clone().divide(Q).normalize().multiply(Q)),C.copy(W).lerp(U,s),I.setEye(C.toArray()),W.copy(I.getUp()),C.normalize();var l=W.clone().cross(C).normalize();if(n.copy(I.getCenter()),n.sub(l.multiplyScalar(n.dot(l))),I.setCenter(n.toArray()),F.hit){var K=f(F.screen),Z=F.hitNormalize;if(K){K.normalize();var u=Math.acos(K.dot(Z)),a=K.cross(Z).normalize();u&&r(a,u)}}}};var t=function(C){return Math.abs(C)<.01?0:C>0?1:-1};A._handleTouch2=function(a){var x=a.touches.length;if(2===x){var v=a.touches,y={x:v[0].clientX,y:v[0].clientY},w={x:v[1].clientX,y:v[1].clientY},i={x:w.x-y.x,y:w.y-y.y},p=F.lastCenter,R=Math.atan2(i.y,i.x),O=F.theta,n=0;O==Z?O=F.theta=R:(n=R-O,F.thetaStarted||Math.abs(n)>.03?(F.thetaStarted=!0,F.theta=R):n=0);var P,$=Math.sqrt(i.x*i.x+i.y*i.y),m=F.vlen;if(m){var T=y.x-p.x,U=y.y-p.y,A=w.x-p.x,o=w.y-p.y,z=Math.sqrt(T*T+U*U),E=Math.sqrt(A*A+o*o),J=m/2,q=t(z-J),G=t(E-J);0>q*G||0===q&&0===G?(P=1,F.vlen=$):(P||(P=$/m),F.scaleStarted||Math.abs(P-1)>.05?(F.vlen=$,F.scaleStarted=!0):P=1)}else m=F.vlen=$,P=1;var i=C.copy(I.getEye()).clone();1!==P&&I.setEye(i.setLength((i.length()-H)/P+H).toArray()),n&&r(i.normalize(),n),F.lastCenter={x:(w.x+y.x)/2,y:(w.y+y.y)/2}}},A._handleMiddle=function(x){var G=zn(x),S=F.screen;F.screen=G;var f=(G.y-S.y)/180*Math.PI*A.rollSpeed;C.copy(I.getCenter()).sub(W.copy(I.getEye())).normalize(),W.copy(I.getUp()).cross(C).normalize(),C.copy(I.getEye()).sub(F.hit).applyAxisAngle(W,f).add(F.hit);var w=C.clone();C.copy(I.getCenter()).sub(F.hit).applyAxisAngle(W,f).add(F.hit);var P=C.clone(),D=C.copy(I.getUp()).applyAxisAngle(W,f).clone(),i=!1;f>0&&(n.copy(D),C.copy(P).sub(w).normalize(),W.copy(w).multiplyScalar(-1).normalize(),W.dot(n)-C.dot(n)>0&&(i=!0)),i||n.copy(F.hit).sub(w).dot(F.hitNormalize)>=0&&(i=!0),i||(I.setEye(w.toArray()),I.setCenter(P.toArray()),I.setUp(D.toArray()));var L=-(G.x-S.x)/180*Math.PI*A.rotateSpeed;r(F.hitNormalize,L)}};Hg("GlobeInteractor",hk,{handle_contextmenu:function(j){td(j)},handle_mousewheel:function(A){this._scrollImpl(A,A.wheelDelta/40)},handle_DOMMouseScroll:function(f){2===f.axis&&this._scrollImpl(f,-f.detail)},handle_keydown:function(D){this.gv.handleKeyDown(D)},handle_mousedown:function(w){this.handle_touchstart(w)},handle_touchstart:function(Q){td(Q);var f=this.gv;if(f.setFocus(Q)){var U=f.getDataInfoAt(Q),n=U?U.data:Z;n&&f.isInteractive(n)||this._startMoveImpl(Q);var a=U?U.part:Z;Ko(Q)?f.handleDoubleClick(Q,n,a):f.handleClick(Q,n,a)}},handle_mouseup:function(l){this.handle_touchend(l)},handle_touchend:function(){},handleWindowMouseMove:function(h){this.handleWindowTouchMove(h)},handleWindowTouchMove:function(h){this._handleMoveImpl(h)},handleWindowMouseUp:function($){this.handleWindowTouchEnd($)},handleWindowTouchEnd:function(A){this._endMoveImpl(A)}}),Y.defineProperties(Ke.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(S){this._rotateSpeed=S}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(l){this._rollSpeed=l}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(v){this._scaleSpeed=v}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(v){this._decelerationRate=v}}});var Sq=function(d){this.gv=d};Im(Sq,Y,{_iv:!0,iv:function(){this._iv=!0},face:function(D,C){var q=this,Q=q.gv.getGL();if(!Q||!Pr(D))return Z;var d=q._resolution,F=Math.round(C.x*d),R=Math.ceil(C.width*d),$=Math.ceil(C.height*d),a=q.height-Math.round(C.y*d)-$,K=H(R/2),x=new Uint8Array(4*R*$),O=0;for(q.iv(),q.validate(D),Qk(Q,q.frame),Q.readPixels(F,a,R,$,Q.RGBA,Q.UNSIGNED_BYTE,x),Or(Q),q.iv();K>=O;O++)for(var b=K-O,k=K+O,Y=b;k>=Y;Y++)for(var w=b;k>=w;w++)if(Y===b||Y===k||w===b||w===k){var v=Ap.m[x[4*(Y*R+w)]];if(v)return v}},get:function(l,s){this.validate();var n=this,v=n.gv.getGL();if(!v)return Z;var f,I,D=n._resolution,A=Math.round(l.x*D),E=Math.ceil(l.width*D),X=Math.ceil(l.height*D),N=n.height-Math.round(l.y*D)-X,R=H(E/2),u=new Uint8Array(4*E*X),Y=0,Q=u.length,h=s?Z:new Nj,L=s?Z:{};if(Qk(v,n.frame),v.readPixels(A,N,E,X,v.RGBA,v.UNSIGNED_BYTE,u),Or(v),s){for(;R>=Y;Y++)for(var k=R-Y,z=R+Y,p=k;z>=p;p++)for(var T=k;z>=T;T++)if((p===k||p===z||T===k||T===z)&&(f=n.info(u,4*(p*E+T))))return f}else for(;Q>Y;Y+=4)f=n.info(u,Y),f&&(I=f.data,L[I._id]||(h.add(I),L[I._id]=I));return h},info:function(s,P){return this.colorMap[(s[P]<<16)+(s[P+1]<<8)+s[P+2]+((127&s[P+3])<<24)]},validate:function(S){var y=this,f=y.gv,o=f.getGL();if(o){var V=y._resolution=f._pickerResolution*f.getDevicePixelRatio(),q=Math.round(V*f.getWidth()),H=Math.round(V*f.getHeight()),T=o.RGBA,e=o.TEXTURE_2D,n=o.RENDERBUFFER,h=o.FRAMEBUFFER;
            y.texture||(y.texture=$d(o),y.render=o.createRenderbuffer(),y.frame=o.createFramebuffer()),(y.width!==q||y.height!==H)&&(vk(o,y.texture),o.texImage2D(e,0,T,q,H,0,T,o.UNSIGNED_BYTE,Z),Bb(o,o.TEXTURE_MIN_FILTER,o.LINEAR),o.bindRenderbuffer(n,y.render),o.renderbufferStorage(n,o.DEPTH_COMPONENT16,q,H),Qk(o,y.frame),o.framebufferTexture2D(h,o.COLOR_ATTACHMENT0,e,y.texture,0),o.framebufferRenderbuffer(h,o.DEPTH_ATTACHMENT,n,y.render),vk(o,Z),o.bindRenderbuffer(n,Z),Or(o),y.width=q,y.height=H),y._iv&&(y._iv=!1,Qk(o,y.frame),f._42(S||(y.colorMap={}),V),Or(o))}}});var mo=function(y){this.gv=y};Im(mo,Y,{gap:0,size:0,_42:function(V,a){var S=this,P=S.gv,C=P._gridGap,g=P._gridSize;if(P._gridVisible){if(S.gap!==C||S.size!==g){for(var O=[],q=P._gridSize/2,J=C*q,l=0;2*q+1>l;l++){var x=6*l,y=6*(2*q+1)+x;O[x]=-J,O[x+1]=0,O[x+2]=-J+l*C,O[x+3]=J,O[x+4]=0,O[x+5]=-J+l*C,O[y]=-J+l*C,O[y+1]=0,O[y+2]=-J,O[y+3]=-J+l*C,O[y+4]=0,O[y+5]=J}S.vs=new Hf(O),S.gap=C,S.size=g}_i(P),xe(V,a),ri(V),Tr(V,a,1,P._gridColor,P._buffer.vs,S.vs),co(V,0,S.vs.length/3,V.LINES),ll(V),Oc(V,a)}else S.vs=S.gap=S.size=Z}});var ed=function(I){this.gv=I};Im(ed,Y,{_42:function(X,f){var A=this.gv,k=A._buffer.vs,j=A._axisXColor,I=A._axisYColor,T=A._axisZColor,i=A._originAxisVisible,U=A._centerAxisVisible;if(i||U){var a=Fj?X.TRIANGLES:X.TRIANGLE_FAN,V=X.LINES;if(_i(A),xe(X,f),ri(X),i){var p=A.getCenterInfo(),L=C(p.width,p.height)/5,l=.8*L,m=.05*L;Tr(X,f,1.5,j,k,new Hf([0,0,0,L,0,0,l,m,0,l,0,m,l,-m,0,l,0,-m,l,m,0,0,0,0,0,L,0,m,l,0,0,l,m,-m,l,0,0,l,-m,m,l,0,0,0,0,0,0,L,m,0,l,0,m,l,-m,0,l,0,-m,l,m,0,l])),co(X,0,2,V),co(X,1,6,a),Tr(X,f,Z,I),co(X,7,2,V),co(X,8,6,a),Tr(X,f,Z,T),co(X,14,2,V),co(X,15,6,a)}if(U){var s=A._center,u=s[0],N=s[1],E=s[2],p=A.getPositionInfo(s);L=C(p.width,p.height)/20,Tr(X,f,1.5,j,k,new Hf([u,N,E,u+L,N,E,u,N,E,u,N+L,E,u,N,E,u,N,E+L])),co(X,0,2,V),Tr(X,f,Z,I),co(X,2,2,V),Tr(X,f,Z,T),co(X,4,2,V)}ll(X),Oc(X,f)}}});var hn=function(A){this.gv=A,this.onMouseOver=this.onMouseOver.bind(this),this.mode=hn.Mode.Style,this.color=l,this.width=l};hn.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Im(hn,Y,{onMouseOver:function($){A.preventDefault($);var V=this.gv.getDataAt($);V!==this.mouseOverData&&(this.mouseOverData=V,this.gv.iv())},setFetchTargetFunc:function(g){this.fetchTargetFunc=g},_42:function(a,F){var S,c,A=this,N=A._mode;if(!a._renderInfo.reflectDepth&&N!==hn.Mode.Disable){if(N===hn.Mode.Selection?S=A.gv.sm().getSelection().toArray(function(D){return D.s("highlight.visible")}):N===hn.Mode.MouseOver&&A.mouseOverData&&A.mouseOverData.s("highlight.visible")&&(S=[A.mouseOverData]),A.fetchTargetFunc&&(S=A.fetchTargetFunc(S)),N===hn.Mode.Style)S=S||[],c=function(t){if(S.indexOf(t)>=0)return!1;var q=t.s("highlight.mode");return q===!1?!0:q===!0?!1:"selected"===q?A.gv.isSelected(t)?!1:!0:"hover"===q?t===A.mouseOverData?!1:!0:!0};else{if(!S||!S.length)return;c=function(G){return S.indexOf(G)<0?!0:void 0}}var U=A.gv,Z=U.vr.isPresenting(),h=U.getWidth();if(Z){var v=U.getWidth;h/=2,U.getWidth=function(){return h};var T=U.getViewport()}var f,e=U.getDevicePixelRatio(),E=h*e,I=U.getHeight()*e;(f=A._renderTarget)?f.setSize(a,E,I):A._renderTarget=f=new Hp.RenderTarget(U,a,E,I),Qk(a,f.frame),U.drawFilter=c,U._42({}),U.drawFilter=null,Or(a),Fj&&Ud(a,F.aPosition),Ud(a,F.aNormal),Z&&(U.getWidth=v,U.setViewport(a,T[0],T[1],T[2],T[3]));var W=a._compiledShader.highlight;W||(W=a._compiledShader.highlight=new lf.Shader(a,Lr.vs,Lr.fs)),W.bind(),a.enable(a.BLEND),a.activeTexture(a.TEXTURE0+0),a.bindTexture(a.TEXTURE_2D,f.texture),W.uniforms.image=0,W.uniforms.textureSize=[E,I],W.uniforms.edgeWidth=U.getHighlightWidth();var K=U.getHighlightColor();if(A._lastHighlightColor!==K){var x=jn(A._lastHighlightColor=K);A._highlightColorData=[x[0]/255,x[1]/255,x[2]/255,x[3]/255]}W.uniforms.edgeColor=A._highlightColorData,A.ibuffer?(A.ibuffer.upload(),A.vbuffer.upload()):(A.ibuffer=lf.Buffer.createIndexBuffer(a,new Uint16Array([0,2,1,1,2,3])),A.vbuffer=lf.Buffer.createVertexBuffer(a,new Float32Array([0,0,1,0,0,1,1,1]))),W.attributes.pos.pointer(A.vbuffer),a.drawElements(a.TRIANGLES,6,a.UNSIGNED_SHORT,0),a.disable(a.BLEND),a.bindTexture(a.TEXTURE_2D,null),a.useProgram(F),Fj&&zs(a,F.aPosition)}}}),Y.defineProperties(hn.prototype,{mode:{get:function(){return this._mode},set:function(F){var M=this._mode;F!==M&&(this._mode=F,F===hn.Mode.MouseOver||F===hn.Mode.Style?T(this.gv.getView(),"mousemove",this.onMouseOver):(M===hn.Mode.MouseOver||M===hn.Mode.Style)&&K(this.gv.getView(),"mousemove",this.onMouseOver))}}});var Lr={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Bm=function(u){this.gv=u},Wo="edit_tx",Tj="edit_ty",Dk="edit_tz",qo="edit_rx",_c="edit_ry",zb="edit_rz",Jd="edit_sx",Cl="edit_sy",yr="edit_sz",jm={};jm[Wo]=1,jm[Tj]=1,jm[Dk]=1,jm[qo]=1,jm[_c]=1,jm[zb]=1,jm[Jd]=1,jm[Cl]=1,jm[yr]=1,Im(Bm,Y,{_42:function(U,M,T){var z=this,g=z.gv,P=g.sm().ld();if(P&&g.isEditable(P)&&!g.isEditHelperDisabled()&&Pr(P)&&(!g.isFirstPersonMode()||!g.isMouseRoamable()&&!ng)){_i(g);var k,G,S=g.isMovable(P),J=g.isRotationEditable(P),m=g.isSizeEditable(P),t=g._axisXColor,V=g._axisYColor,x=g._axisZColor,X=g._editSizeColor,b=P.p3(),A=fm(g.getEye(),b)/10,$=A/(T?5:10),Y=.7*A,c=.4*Y,y=b[0],d=b[1],o=b[2];k=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],S&&z._17O(U,M,P,T,Wo,t,k,[y,d-$,o,y+Y,d-$,o,y+Y,d,o,y+Y,d,o,y,d,o,y,d-$,o,y,d-$,o+$,y+Y,d-$,o+$,y+Y,d-$,o,y+Y,d-$,o,y,d-$,o,y,d-$,o+$]),G=y+Y,m&&z._17O(U,M,P,T,Jd,X,k,[G,d-$,o,G+c,d-$,o,G+c,d,o,G+c,d,o,G,d,o,G,d-$,o,G,d-$,o+$,G+c,d-$,o+$,G+c,d-$,o,G+c,d-$,o,G,d-$,o,G,d-$,o+$]),G+=c,J&&z._17O(U,M,P,T,qo,t,k,[G,d-$,o,G+c,d-$,o,G+c,d,o,G+c,d,o,G,d,o,G,d-$,o,G,d-$,o+$,G+c,d-$,o+$,G+c,d-$,o,G+c,d-$,o,G,d-$,o,G,d-$,o+$]),k=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],S&&z._17O(U,M,P,T,Tj,V,k,[y,d,o,y,d+Y,o,y-$,d+Y,o,y-$,d+Y,o,y-$,d,o,y,d,o,y,d,o,y,d,o-$,y,d+Y,o-$,y,d+Y,o-$,y,d+Y,o,y,d,o]),G=d+Y,m&&z._17O(U,M,P,T,Cl,X,k,[y,G,o,y,G+c,o,y-$,G+c,o,y-$,G+c,o,y-$,G,o,y,G,o,y,G,o,y,G,o-$,y,G+c,o-$,y,G+c,o-$,y,G+c,o,y,G,o]),G+=c,J&&z._17O(U,M,P,T,_c,V,k,[y,G,o,y,G+c,o,y-$,G+c,o,y-$,G+c,o,y-$,G,o,y,G,o,y,G,o,y,G,o-$,y,G+c,o-$,y,G+c,o-$,y,G+c,o,y,G,o]),k=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],S&&z._17O(U,M,P,T,Dk,x,k,[y,d,o,y,d,o+Y,y,d-$,o+Y,y,d-$,o+Y,y,d-$,o,y,d,o,y,d-$,o,y-$,d-$,o,y-$,d-$,o+Y,y-$,d-$,o+Y,y,d-$,o+Y,y,d-$,o]),G=o+Y,m&&z._17O(U,M,P,T,yr,X,k,[y,d,G,y,d,G+c,y,d-$,G+c,y,d-$,G+c,y,d-$,G,y,d,G,y,d-$,G,y-$,d-$,G,y-$,d-$,G+c,y-$,d-$,G+c,y,d-$,G+c,y,d-$,G]),G+=c,J&&z._17O(U,M,P,T,zb,x,k,[y,d,G,y,d,G+c,y,d-$,G+c,y,d-$,G+c,y,d-$,G,y,d,G,y,d-$,G,y-$,d-$,G,y-$,d-$,G+c,y-$,d-$,G+c,y,d-$,G+c,y,d-$,G])}},_17O:function(q,u,N,c,j,C,o,i){var Y=this.gv._buffer;di(q,u,c,!0,N,j),Oj(q,u,Z,!0,Z,!0,Z,!1),qc(q,u.uDiffuse,C),zj(q,Y.vs,new Hf(i),u.aPosition),zj(q,Y.ns,new Hf(o),u.aNormal),ri(q),co(q,0,12),ll(q),eh(q,u)}});var ph=a.Raycaster=function(s){this.gv=s,this.maxTriangleTest=1/0,this.backfaceCulling=!0};En("Raycaster",Y,{intersect:function(c){var E=this,Q=E.gv,r=Q.getDataAt(c);return r?E.intersectObject(c,r):null},intersectObjects:function(r,I,S){var p,H,U,C,x=this,m=1/0,X=r.origin||(new um).fromArray(x.gv.getEye()),G=x.maxTriangleTest,k=[];return I.forEach(function($){S&&S($)===!1||$.s("intersect")!==!1&&k.push($)}),k.sort(function(z,j){return X.distanceToSquared2(z.p3())-X.distanceToSquared2(j.p3())}),x.countTriangles=0,k.forEach(function(c){x.countTriangles>G||(p=x.intersectObject(r,c),p&&(H=X.distanceToSquared(p.world),m>H&&(U=c,C=p,m=H)))}),x.countTriangles=0,{data:U,intersect:C}},intersectObject:function(I,J){if(I instanceof Jl)return this._intersectObjectImpl(I,J);var O=this,g=O.gv,i=g.unproject(I),V=new um,l=g.getEye(),y=new um;if(g.isOrtho()){var x=new um(l);y.copy(g.getCenter()).sub(x).normalize();var N=V.copy(i).sub(x).dot(y);V.copy(y).setLength(-N).add(x.copy(i))}else V.copy(l),y.copy(i).sub(V).normalize();var s=new a.Math.Ray(V,y);return O._intersectObjectImpl(s,J)},_intersectObjectImpl:function(){function u(){var L=new um;return L.subVectors(j,p),X.subVectors(Z,p),L.cross(X).normalize(),L}function w(z,C,K,r,F,b,V){return Tm.barycoordFromPoint(z,C,K,r,P),F.multiplyScalar(P.x),b.multiplyScalar(P.y),V.multiplyScalar(P.z),F.add(b).add(V),F.clone()}function n(_,H,U){sp(_)?_.forEach(function(C){n(C,H,U)}):tk(_)?n(Xr(H,_),H,U):Bn(_)&&(_.shape3d?n(_.shape3d,H,U):U.push(_))}var q=new ke,x=new ke,d=new Jl,Y=new um,f=new um,J=new um,m=new um,T=new um,Z=new um,p=new um,j=new um,G=new Sf,y=new Sf,k=new Sf,X=new um,N={vs:tp,is:up,uv:jr},P=new um;return function(s,D){var _=this.gv.getData3dUI(D),P=D.mat||_.mat;if(P){q.fromArray(P),x.getInverse(q),d.copy(s).applyMatrix4(x);var E,r,c="body",i=_.shapeModel;if(i||(i=Xr(_)),i||(D instanceof a.Node&&!(D instanceof a.Shape)?(E=!0,i=N):(r=!0,i=[_.left,_.front,_.right,_.back,_.top,_.bottom])),!i)return console.log("Can not find shape model."),null;sp(i)||(i=[i]);var K,F,H,V,X,l,z,o,C,B,U,b,M,S,e,R,O=1/0,L=["","top_","bottom_"],t=!1,A=this.backfaceCulling,h=[];for(n(i,_,h),K=0,F=h.length;F>K;K++)if(M=h[K])for(H=0,V=L.length;V>H;H++)if(S=L[H],z=M[S+"vs"],o=M[S+"is"],C=M[S+"uv"]||M[S+"tuv"],z){if(e=M[S+"boundingBox"]){var U=d.intersectBox(e);if(!U)continue;if(d.origin.distanceTo(U)>O)continue;R=!1}else M[S+"boundingBox"]=e=new a.Math.Box3,R=!0;for(X=0,l=o?o.length:z.length/3;l>X;X+=3)this.countTriangles++,o?(f.fromArray(z,3*o[X]),J.fromArray(z,3*o[X+1]),m.fromArray(z,3*o[X+2])):(f.fromArray(z,3*X),J.fromArray(z,3*(X+1)),m.fromArray(z,3*(X+2))),R&&(e.expandByPoint(f),e.expandByPoint(J),e.expandByPoint(m)),B=d.intersectTriangle(f,J,m,A,Y),B&&(b=d.origin.distanceTo(B),O>b&&(O=b,T.copy(B),Z.copy(f),p.copy(J),j.copy(m),""!==S?c=S.slice(0,-1):E?c=ce[Math.floor(X/6)]:r&&(c=ce[K]),C&&(t=!0,o?(G.fromArray(C,2*o[X]),y.fromArray(C,2*o[X+1]),k.fromArray(C,2*o[X+2])):(G.fromArray(C,2*X),y.fromArray(C,2*(X+1)),k.fromArray(C,2*(X+2))))))}if(!isFinite(O))return null;var v,I=T.clone().applyMatrix4(q);t&&(v=w(T,Z,p,j,G,y,k));var $=u(Z,p,j),W=u(Z.applyMatrix4(q),p.applyMatrix4(q),j.applyMatrix4(q)),Q=d.direction.dot($);return Q>0&&($.multiplyScalar(-1),W.multiplyScalar(-1)),{world:I,local:T.clone(),worldNormal:W,normal:$,uv:v,part:c}}}}()});var us=function(M,s){this.gv=M,this.s=function(N,L,g){return L==Z&&(L=g),L==Z?s.getStyle(N):Xo(L,s,M)},this.data=s};Im(us,Y,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(j,d,B,K){var G,P,q,H,b,T,U,i=this,J=i.data,$=i.gv,p=J._id,D=i.s("alwaysOnTop")||i.s("shape3d.alwaysOnTop")?null:i.s("batch"),c=$._batchIndexMap,g=$._batchModelMap,u=$.isSelectable(J),k=$.getBrightness(J),y=k!=Z&&1!==k;if(us.getTitle===l){us.getTitle=0;for(var o in A)if(o.length===kh.length+1&&o[kh.length]===fd[4].toUpperCase()&&o[kh.length-1]===fd[kh.length+1].toUpperCase()){us.getTitle=Xg;break}}if(!us.getTitle||fg[kh.length+2]){if(us.getHead===l){us.getHead=0;for(var o in s){var w="box-sizing";if(6===o.length&&o[0]===fd[4]&&o[3]===w[0]&&o[4]===w[1]&&o[5]===w[2]){us.getHead=Xg;break}}}if(!us.getHead||fg[kh.length]){if(i.needValidate(j)){q=Yl(c,g,J,D);var V=i.validate(q,D?Ao[D]||Yn:Z);if(q&&(H=c[p],b=H.size=q.vs.length/3-H.begin,U=q.rs))for(k=y?k:1,T=0;b>T;T++)U.push(k);var n=$.getWireframeGeometry(J);if(n)xj($,J,n);else if(Pr(J)){var F=$.getWireframe(J);F&&xj($,J,F)}i.labelInfo=i.label2Info=i.noteInfo=i.note2Info=i._38o=Z,i._24O(Rh,"getLabel"),i._24O(kh,"getLabel2"),i._26O(sl,"getNote"),i._26O(Am,"getNote2"),i._15O(),i.interactiveInfo=$.isInteractive(J)?{}:Z,V!==!1&&(i._iv=!1)}y&&qc(j,d.uBrightness,k),qc(j,d.uAlphaTest,i.s("alphaTest")),qc(j,d.uUseEnvMap,J.s("envmap")?!0:!1),qc(j,d.uReflectivity,J.s("envmap")||.01);var C=i.s("3d.clip.direction"),_=!0;if(C){var E=i.s("3d.clip.percentage");switch(0===E&&(_=!1),C){case"left":C=2;break;case"top":C=3;break;case"bottom":C=4;break;case"front":C=5;break;case"back":C=6;break;case"right":default:C=1}if(0===C%2&&(E=1-E),J instanceof a.Shape){var M=J.s3(),N=J.p3(),f=J.getAnchor3d();E=3>C?(E-f.x)*M[0]+N[0]:5>C?(E-f.y)*M[1]+N[1]:(E-f.z)*M[2]+N[2]}else E-=.5;qc(j,d.uClipPercent,E)}j.uniform1i(d.uClipDirection,C||0),P=di(j,d,B,u,J,Wb),P&&(Id(P,c[p],g),Id(P,$._polylineIndexMap[p],$._polylineModelMap),Id(P,$._wireframeIndexMap[p],$._wireframeModelMap)),!c[p]&&_&&i._80o(j,d,K),$.isLabelVisible(J)&&((G=i.labelInfo)&&(di(j,d,B,u,J,Rh),i._28O(G,Rh,K)),(G=i.label2Info)&&(di(j,d,B,u,J,kh),i._28O(G,kh,K))),$.isNoteVisible(J)&&((G=i.noteInfo)&&(di(j,d,B,u,J,sl),i._29O(G,sl,K)),(G=i.note2Info)&&(di(j,d,B,u,J,Am),i._29O(G,Am,K))),(G=i._38o)&&i._99O(j,d,G,B,u,K),y&&qc(j,d.uBrightness,1),C&&j.uniform1i(d.uClipDirection,0)}}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Ll},_80o:function(){},dispose:function(){},getBodyColor:function(y){var Q=this.data,I=this.gv.getBodyColor(Q);return I?I:y?Q.getStyle(y):Z},getCachedTexture:function(h){var l=this._cachedTextures;return l?l[h||"main"]:null},setCachedTexture:function(K,b){var C=this._cachedTextures;return C||(C=this._cachedTextures={}),C[b||"main"]=K,K},invalidateCachedTexture:function(s){var U=this._cachedTextures;for(var p in U)s.deleteTexture(U[p]);this._cachedTextures={}},invalidateCachedGeometry:function(){},_24O:function(v,c){var z=this,j=z.data,W=z.gv,X=z.s,_=W[c](j);if(_!=Z){var R=X(v+".scale"),w=X(v+".max"),E=z[v+"Info"]={label:_,textureScale:X(v+".texture.scale"),color:W[c+"Color"](j),font:X(v+".font"),align:X(v+".align"),background:W[c+"Background"](j)},m=E.rect=jj(E,_);w>0&&w<m.width&&(E.labelWidth=m.width,m.width=w),m.x=m.y=0,m.width*=R,m.height*=R,E.mat=z._16O(X(v+".autorotate"),X(v+".position"),m,X(v+".face"),X(v+".t3"),X(v+".r3"),X(v+".rotationMode"));var h=m.width/2,o=m.height/2;E.vs=new Hf([-h,o,0,-h,-o,0,h,-o,0,h,o,0]),m.width/=R,m.height/=R}},_26O:function(S,A){var i=this,f=i.data,D=i.gv,k=i.s,P=D[A](f);if(P!=Z){var Y=k(S+".scale"),H=this[S+"Info"]={note:P,textureScale:k(S+".texture.scale"),expanded:k(S+".expanded"),font:k(S+".font"),color:k(S+".color"),align:k(S+".align"),borderWidth:k(S+".border.width"),borderColor:k(S+".border.color"),background:D[A+"Background"](f)};if(H.expanded){var V=k(S+".max"),T=jj(H,P);T.width+=6,T.height+=2,V>0&&V<T.width&&(H.labelWidth=T.width,T.width=V);var Q={x:-T.width/2,y:-8-T.height,width:T.width,height:T.height+8}}else Q={x:-6,y:-18,width:12,height:18};H.mat=i._16O(k(S+".autorotate"),k(S+".position"),Z,k(S+".face"),k(S+".t3"),k(S+".r3"),k(S+".rotationMode")),H.rect=Q,1!==Y&&(Q=Em(Q),Q.x*=Y,Q.height*=Y,Q.y=-Q.height,Q.width*=Y);var I=Q.x,E=Q.y,h=Q.width,n=Q.height;H.vs=new Hf([I,-E,0,I,-E-n,0,I+h,-E-n,0,I+h,-E,0])}},_28O:function(N,o,u){if(u(this.s(o+".transparent"))){var t=N.rect,l=N.textureScale,w=t.width*l,U=t.height*l;if(w>=1&&U>=1){var q=Zi(w,U);1!==l&&(q.translate(q,t.x,t.y),q.scale(l,l),q.translate(q,-t.x,-t.y)),Fk(q,N),q.restore(),Ni(this,o,N.mat,N.vs,!0)}}},_29O:function(Y,D,C){if(C(this.s(D+".transparent"))){var r=Y.rect,T=Y.textureScale,J=r.x,Q=r.y,g=r.width*T,B=r.height*T;if(g>=1&&B>=1){r.x=r.y=0;var M=Zi(g,B);1!==T&&M.scale(T,T),yd(M,Y),M.restore(),r.x=J,r.y=Q,Ni(this,D,Y.mat,Y.vs,!1)}}},_99O:function(N,D,p,i,L,S){if(p){var H=this,V=H.gv,t=H.data,M=V._buffer,n=V._1O,b=p.icons;for(var T in b){var C=b[T],G=p.rects[T];if(G&&S(Xo(C.transparent,t,V))){di(N,D,i,L,t,T);var x=Xo(C.shape3d,t,V),f=x?[x]:Xo(C.names,t,V),$=f?f.length:0,r=Xo(C.textureScale,t,V)||1,m=Xo(C.light,t,V);m==Z&&(m=x?!0:!1),Oj(N,D,Xo(C.blend,t,V),m,Xo(C.opacity,t,V),Xo(C.reverseFlip,t,V),Xo(C.reverseColor,t,V),Xo(C.reverseCull,t,V));for(var P=0;$>P;P++){var c=f[P],k=G[P];if(kb(H,k.mat),x)Hr(V,t,Xr(H,x),H);else{var X=Uj(c);if(X){var z=k.width*r,R=k.height*r;if(z>=1&&R>=1){var A=Zi(z,R);cj(A,X,Xo(C.stretch,t,V),0,0,z,R,t,V),A.restore(),$d(N,Nc,n),ri(N,D,n,Xo(C.discardSelectable,t,V),M.uv,ae),zj(N,M.vs,k.vs,D.aPosition),_p(N,M.ns,eo,D.aNormal),sc(N,M.is,Hh),nm(N,0,Hh.length),ll(N,D,n)}}}Kn(V)}eh(N,D)}}}}});var dj=function(b,S){$f(dj,this,[b,S])};Im(dj,us,{_16O:function(e,h,z,v,T,l,n,i,o){var Z=this.data,k=Z.getFinalScale3d(),B=iq(h,k,z,v,i,o);if(Z.hasOwnProperty("_anchor")||Z.hasOwnProperty("_anchorElevation")){var M=Z.getAnchor3d();B[0]-=(M.x-.5)*k[0],B[1]-=(M.y-.5)*k[1],B[2]-=(M.z-.5)*k[2]}return cf(jh(),B,Z.p3(),v,T,l,n,e,Z.getFinalRotation3d(),Z.getRotationMode())},clear:function(){var H=this;H.faceMat=H.mat=H.shapeModel=H.left=H.right=H.front=H.back=H.top=H.bottom=H.csg=Z},needValidate:function(X){if(this._iv)return this._validateFrameId=X._renderInfo.frame,!0;if(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var R=X._renderInfo.frame;if(this._validateFrameId!==R)return this._validateFrameId=R,!0}return!1},validate:function(I,v){var b=this,c=b.gv,U=b.data,S=b.shapeName=b.s(Sg),A=Xr(b,S);b._updateAutoRotation(),b._updateFixSize2d(),b._updateOverlapping(),(this.s("autorotate")||this.s("shape3d.autorotate")||this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen"))&&(uq(c,U,"_wireframeModelMap","_wireframeIndexMap"),uq(c,U,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var X=qp(U,c.getMat(U),A?b.s("shape3d.scaleable"):!0);if(U.appendAnchorMatrix3d(X),U.mat=X,b.clear(),A||!S)if(I){var z=[];A?rm(c,U,A,b,b.getBodyColor(),[X],I,z):(Nk(c,U,I,v,X,Bc,z,ip),Nk(c,U,I,v,X,qe,z,Wj),Nk(c,U,I,v,X,Uh,z,Cj),Nk(c,U,I,v,X,Tg,z,Hm),Nk(c,U,I,v,X,Qj,z,Zf),Nk(c,U,I,v,X,Zd,z,ih)),z.length&&(Ad(I.vs,z),Ad(I.ns,fi(z)))}else b.mat=X,(b.shapeModel=A)||(b._cubeUvs=null,b.vf(Bc,0),b.vf(qe,16),b.vf(Qj,8),b.vf(Zd,24),b.vf(Uh,32),b.vf(Tg,40))},_updateAutoRotation:function(){var y=new kd,i=new ke,S=new um,r=new um,o=new um;return function(){var v=this,F=v.data,g=v.s("autorotate")||v.s("shape3d.autorotate");if(!g)return F._dynamicRotation&&delete F._dynamicRotation,void 0;var $=v.gv;o.copy(v.s("shape3d.autorotate.up")||$._up);var B;B="string"==typeof g?[g.indexOf("x")<0?$._eye[0]:$._center[0],g.indexOf("y")<0?$._eye[1]:$._center[1],g.indexOf("z")<0?$._eye[2]:$._center[2]]:$._eye;var s=$._center,A=F.p3();S.copy(A),r.set(B[0]-s[0],B[1]-s[1],B[2]-s[2]).add(S),i.lookAt(r,S,o),y.set(0,0,0,F.getRotationMode(),!0).setFromRotationMatrix(i);var Q=F._dynamicRotation;Q&&Math.abs(Q[0]-y.x)<1e-5&&Math.abs(Q[1]-y.y)<1e-5&&Math.abs(Q[2]-y.z)<1e-5||(F._dynamicRotation=[y.x,y.y,y.z])}}(),_updateFixSize2d:function(){var y=this,s=y.data,S=y.s("fixSizeOnScreen")||y.s("shape3d.fixSizeOnScreen");if(!S)return s._dynamicScale3d&&delete s._dynamicScale3d,void 0;var B=y.gv,p=qp(s,B.getMat(s)),x=ao([0,0,0],p),Z=B.toViewPosition(x);if(!isNaN(Z.x)&&!isNaN(Z.y)){var W=ao([1,0,0],p),N=B.toViewPosition(W),z=ao([0,1,0],p),Y=B.toViewPosition(z),A=N.x-Z.x,P=Y.y-Z.y;if(A&&P){var K,j,V=s._dynamicScale3d||[1,1,1],T=Uj(s.s("shape3d.image"));if(S[0]>0&&(K=S[0]),S[1]>0&&(j=S[1]),!K||!j){var X=S>0?S:1;K||(K=(ab(T,s)||s.getWidth())*X),j||(j=(kn(T,s)||s.getTall())*X)}var G=Math.abs(A/K),n=Math.abs(P/j);Math.abs(G-1)<.001&&Math.abs(n-1)<.001||(s._dynamicScale3d=[V[0]/G,V[1]/n,V[2]])}}},_updateOverlapping:function(){var u=this,z=u.s("hide.overlapping.group");if(!z)return u._rectOverlapping&&(u._rectOverlapping=l),void 0;var L,m,O,R=u.gv,M=u.data,W=qp(M,R.getMat(M)),J=1/0,y=1/0,e=-1/0,f=-1/0,j=M.getAnchor3d(),a=j.x,G=j.y,w=j.z;for(L=0;8>L;L++){if(m=ao([(L>>2)-a,(1&L>>1)-G,(1&L)-w],W),O=R.toViewPosition(m),isNaN(O.x)||isNaN(O.y))return;J=Math.min(J,O.x),e=Math.max(e,O.x),y=Math.min(y,O.y),f=Math.max(f,O.y)}var A={x:J,y:y,w:e-J,h:f-y};u._rectOverlapping=R.overlappingBox.isOverlapping(z,A)},getVectorDynamicSize:function(){var R,s=this,d=s.s("shape3d"),I=s.data;if("billboard"===d||"plane"===d||(R=I._currentCubeElementId)!=Z){var f,Y,r=s.gv,h=qp(I,r.getMat(I)),n=I.getAnchor3d(),Q=.5-n.x,H=.5-n.y,B=.5-n.z,W=s.s("vector.dynamic.maxsize"),D=function(A,$){A[0]+=Q,A[1]+=H,A[2]+=B,$[0]+=Q,$[1]+=H,$[2]+=B;var Z=r.toViewPosition(ao(A,h)),E=r.toViewPosition(ao($,h)),y=Z.x-E.x,D=Z.y-E.y;return Math.min(W,Math.sqrt(y*y+D*D))};if("billboard"===d)f=D([-.5,0,0],[.5,0,0]),Y=D([0,-.5,0],[0,.5,0]);else if("plane"===d)f=D([-.5,0,0],[.5,0,0]),Y=D([0,0,-.5],[0,0,.5]);else if(I._currentCubeElementId!=Z){var c=3*up[R+1],p=3*up[R],i=3*up[R+2];f=D([tp[c],tp[c+1],tp[c+2]],[tp[i],tp[i+1],tp[i+2]]),Y=D([tp[c],tp[c+1],tp[c+2]],[tp[p],tp[p+1],tp[p+2]])}return[f,Y]}},vf:function(N,K){var h=this;if(h.gv.getFaceVisible(h.data,N)){var d=gk(h,N);d.mat&&(h.faceMat=!0);var t=d.uv;if(t){var x=h._cubeUvs;x||(x=h._cubeUvs=new Hf([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var i=0;8>i;i++)x[K+i]=t[i]}return d}},_billboardInView:function(){var c=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],F=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],f=new Ik,k=new um,N=new ke;return function(E){var i=this;if(!i.mat)return!0;var M=i.gv.getFrustum(),q="billboard"===E?c:F;f.makeEmpty(),N.fromArray(i.mat);for(var v=0,g=q.length;g>v;v+=3)f.expandByPoint(k.fromArray(q,v).applyMatrix4(N));return M.intersectsBox(f)}}(),_80o:function(K,B,i){var E=this;if(E._rectOverlapping)return!0;var z=E.shapeModel;if(z||!E.shapeName){var u=E.s("shape3d");if(("billboard"===u||"plane"===u)&&!E._billboardInView(u))return!0;var k=E.gv,C=E.data,e=k._cube;_i(k,E.mat),E.s("shape3d.reflector")&&!K._picking||(z?Hr(k,C,z,E,E.getBodyColor(),i):(zj(K,e.vs,Z,B.aPosition),zj(K,e.ns,Z,B.aNormal),db(K,e.is),E._18O(K,B,"left",0,i),E._18O(K,B,"front",6,i),E._18O(K,B,"right",12,i),E._18O(K,B,"back",18,i),E._18O(K,B,"top",24,i),E._18O(K,B,"bottom",30,i))),Kn(k),E.faceMat&&(E._18O(K,B,"left",0,i,!0),E._18O(K,B,"front",6,i,!0),E._18O(K,B,"right",12,i,!0),E._18O(K,B,"back",18,i,!0),E._18O(K,B,"top",24,i,!0),E._18O(K,B,"bottom",30,i,!0))}},_18O:function(M,G,t,K,o,p){var z=this[t];if(z){if(!o(z.transparent))return;if(p&&!z.mat||!p&&z.mat)return;var F=this.data.s("polygonOffset");F&&Xf(M,F),p&&_i(this.gv,z.mat);var q=this,r=q.data;r._currentCubeElementId=K;var D=q.gv,e=D.getTexture(z.texture,r,t),k=z.uv,Q=z.uvScale,j=z.uvOffset,i=z.discardSelectable;e?k?ri(M,G,e,i,D._buffer.uv,q._cubeUvs,j,Q):ri(M,G,e,i,D._cube.uv,Z,j,Q):ri(M),Oj(M,G,z.blend,z.light,z.opacity,z.reverseFlip,z.reverseColor,z.reverseCull),qc(M,G.uDiffuse,z.color||y["color.empty"]),nm(M,K,6),eh(M,G),ll(M,G,e),p&&Kn(D),F&&Qq(M),r._currentCubeElementId=null}},drawReflector:function(){var U=new um,P=new um,g=new kd,W=new ke,f=new um,x=new um,s=new um,O=new um,q=new ke,m=new ke,i=new ho,n=new op,h=new op,G=function(s,V,L){s[L]=V[0],s[L+1]=V[1],s[L+2]=V[2]},C=function(B,K){G(B,K.getEye(),0),G(B,K.getCenter(),3),G(B,K.getUp(),6)},w=function(y,V){V._eye=[y[0],y[1],y[2]],V._center=[y[3],y[4],y[5]],V._up=[y[6],y[7],y[8]],V._18Q=Z;var F=V._skyBox;F&&(F.p3([y[0],y[1],y[2]]),V.getData3dUI(F).iv())};return function(d,N,o,j,M){var Y=this;Y._reflectorInfo=null;var I=Y.data;if(I._reflecting)return!1;var X=Y.gv;if(M)return!1;var v=Y._reflectorRenderTarget;v?v.setSize(d,N,o):v=Y._reflectorRenderTarget=new Hp.RenderTarget(X,d,N,o),U.copy(I.p3()),P.copy(X.getEye()),W.makeRotationFromEuler(g.set(I.r3(),I.getRotationMode(),!0));var D;if(!Y._reflectNormal){var D=Xr(Y,Y.s("shape3d"));if(!D)return!1;if(!D.ns&&D.length&&(D=D[0]),!D.ns||!D.vs)return!1;Y._reflectNormal=[D.ns[0],D.ns[1],D.ns[2]],Y._reflectorVbuffer=lf.Buffer.createVertexBuffer(d,new Float32Array(D.vs))}if(f.copy(Y._reflectNormal),f.applyMatrix4(W),x.subVectors(U,P),x.dot(f)>0)return!1;x.reflect(f).negate(),x.add(U),s.copy(X.getCenter()).negate().add(U),s.reflect(f).negate(),s.add(U),O.copy(X.getUp()),O.reflect(f);var F=[0,0,0,0,0,0,0,0,0];C(F,X),X._eye=x.toArray(),X._center=s.toArray(),X._up=O.toArray(),X._18Q=Z;var K=X._skyBox;K&&(K.p3(X._eye),X.getData3dUI(K).iv()),Qk(d,v.frame),d.viewport(0,0,v.width,v.height),d.clearColor(0,0,0,1),d.clear(d.COLOR_BUFFER_BIT);var H=wj(X),L=Uk(X);i.setFromNormalAndCoplanarPoint(f,U),i.applyMatrix4(m.fromArray(L)),n.set(i.normal.x,i.normal.y,i.normal.z,i.constant),h.x=(Math.sign(n.x)+H[8])/H[0],h.y=(Math.sign(n.y)+H[9])/H[5],h.z=-1,h.w=(1+H[10])/H[14],n.multiplyScalar(2/n.dot(h));var k=I.s("shape3d.reflector.clip"),r=k===l?.003:k;H[2]=n.x,H[6]=n.y,H[10]=n.z+1-r,H[14]=n.w;var e=X._computedProjectMatrix;X._computedProjectMatrix=H,I._reflecting=!0,j(),X._computedProjectMatrix=e,q.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),q.multiply(m.fromArray(X._projectMatrix)),q.multiply(m.fromArray(X._viewMatrix)),Or(d),w(F,X);var T=d._compiledShader.reflector;return T||(T=d._compiledShader.reflector=new lf.Shader(d,Vh.Reflector.vs,Vh.Reflector.fs)),T.bind(),d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,v.texture),T.uniforms.tDiffuse=0,T.uniforms.color=nk(I.s("shape3d.reflector.color")||"rgb(128,128,128)"),T.uniforms.textureMatrix=q.toArray(),T.uniforms.modelMatrix=qp(I),T.uniforms.viewMatrix=Uk(X),T.uniforms.projectionMatrix=wj(X),Y._reflectorVbuffer.upload(),T.attributes.pos.pointer(Y._reflectorVbuffer),d.drawArrays(d.TRIANGLES,0,6),I._reflecting=!1,d.useProgram(X._prg),!0}}()}),Vh.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var An=function(U,t){$f(An,this,[U,t])};Im(An,dj,{_80o:function(){}});var Ne=function(z,x){$f(Ne,this,[z,x])};Im(Ne,us,{_25Q:1,validate:function(F){var v=this;if(!v.s("geometry.cache")||!v.info){var W=v.gv,r=v.data,j=v.s,Q=j("edge.width"),l=r._40I,T=r._41I;if(v.shapeModel=v.info=Z,l&&T){var N,O,D,Y,J,p,b,E,w,G,s=r.isLooped(),I=j(vf),o=A.getEdgeType(I);if(o){var n=o(r,Kf(v,W,r,s,I),W,v._19Q);if(!n.points||n.points.isEmpty())return;p=v.info={},b=n.segments,J=n.points,E=J.size();for(var X=l.getElevation(),S=T.getElevation(),x=0;E>x;x++){var H=J.get(x);H.e==Z&&(H.e=X+(S-X)*x/(E-1))}w=Qr(J.get(0)),G=Qr(J.get(E-1));var g=E%2;0===g?(p.c1=Qr(J.get(E/2-1)),p.c2=Qr(J.get(E/2))):p.p3=Qr(J.get((E-g)/2)),p.s1=w,p.s2=Qr(J.get(1)),p.t1=Qr(J.get(E-2)),p.t2=G}else{J=new Nj,p=v.info={};var B=j("edge.offset"),P=j("edge.center"),U=j("edge.source.t3"),u=j("edge.target.t3"),$=Bl(W,r,"source"),m=Bl(W,r,"target");if(!$||!m)return W.invalidateData(r),delete v.info,!1;if(U&&($[0]+=U[0],$[1]+=U[1],$[2]+=U[2]),u&&(m[0]+=u[0],m[1]+=u[1],m[2]+=u[2]),I===rd){b=j("edge.segments");var f=p.points=j(xq)||el;if(E=f.size()){w=Qr(f.get(0)),G=Qr(f.get(E-1)),!P&&B&&(D=bm(w,$,!0),B=C(B,fm($,w)),$=[$[0]+D[0]*B,$[1]+D[1]*B,$[2]+D[2]*B],D=bm(m,G,!0),B=C(B,fm(G,m)),m=[m[0]-D[0]*B,m[1]-D[1]*B,m[2]-D[2]*B]);var g=E%2;0===g?(N=Qr(f.get(E/2-1)),O=Qr(f.get(E/2))):p.p3=Qr(f.get((E-g)/2)),p.s1=$,p.s2=w,p.t1=G,p.t2=m}else!P&&B&&(D=bm(m,$,!0),Y=fm($,m),B=gp(B,Y),$=[$[0]+D[0]*B,$[1]+D[1]*B,$[2]+D[2]*B],m=[m[0]-D[0]*B,m[1]-D[1]*B,m[2]-D[2]*B]),N=$,O=m;J.add({x:$[0],y:$[2],e:$[1]}),J.addAll(f),J.add({x:m[0],y:m[2],e:m[1]})}else{var z=Kf(v,W,r,s,I);if(v._19Q||(z=-z),s){var R=$[0],i=$[1],V=$[2],_=l.getTall()/2+z;N=[R-z,i+_,V],O=[R+z,i+_,V],J.add({x:R-z,y:V,e:i}),J.add({x:R-z,y:V,e:i+_}),J.add({x:R+z,y:V,e:i+_}),J.add({x:R+z,y:V,e:i})}else{D=bm(m,$,!0),Y=fm($,m);var L={x:$[0],y:$[2]},q={x:m[0],y:m[2]},k=vp(Z,L,q,z),e=k.x-L.x,y=k.y-L.y;B=gp(B,Y),D[0]*=B,D[1]*=B,D[2]*=B,N=[$[0]+D[0]+e,$[1]+D[1],$[2]+D[2]+y],O=[m[0]-D[0]+e,m[1]-D[1],m[2]-D[2]+y],P?(J.add({x:$[0],y:$[2],e:$[1]}),J.add({x:N[0],y:N[2],e:N[1]}),J.add({x:O[0],y:O[2],e:O[1]}),J.add({x:m[0],y:m[2],e:m[1]})):(J.add({x:N[0],y:N[2],e:N[1]}),J.add({x:O[0],y:O[2],e:O[1]}))}}p.c1=N,p.c2=O}p._lastPointsSegments={points:J,segments:b},p.list=j(Sg)===_m?v.createTubeModel(J,b,Q/2,F):v.createLineModel(J,b,Q,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=Z}});var Od=function(W,D){$f(Od,this,[W,D])};Im(Od,dj,{_80o:function(B,o,E){var A=this,r=A.gv,d=A.shapeModel;_i(r,A.mat),d?Hr(r,A.data,d,A,A.getBodyColor(),E):(_r(A,B,o,"left",E),_r(A,B,o,"front",E),_r(A,B,o,"right",E),_r(A,B,o,"back",E),_r(A,B,o,"top",E),_r(A,B,o,"bottom",E)),Kn(r)},validate:function($,a){var g,A,v=this,M=v.s,W=v.data,N=(W.p3(),W._thickness/2),U=W.isClosePath(),i=W.getPoints(),y=W.getSegments(),c=M(qd),G=$&&$.uv;if(v.clear(),0>N){try{A=v.shapeModel=Jo(i,y,M(Pm),M(gi),c,M(Do),W.getTall(),W.getShapeElevation(),U)}catch(F){A=v.shapeModel={}}M(oh)?M("shape3d.image")||delete A.uv:(delete A.vs,delete A.ns,delete A.uv),M("shape3d.top.image")||delete A.top_uv,M("shape3d.bottom.image")||delete A.bottom_uv}else if(M(Sg)===_m)g=Ai(i,y,c,U),A=v.shapeModel={vs:[]},M("shape3d.image")&&(A.uv=[],A.sum=M(Do)||gc(g)||1,A.len=0),M(Pm)&&!U&&(A.top_vs=[],M("shape3d.top.image")&&(A.top_uv=[])),M(gi)&&!U&&(A.bottom_vs=[],M("shape3d.bottom.image")&&(A.bottom_uv=[])),v._12O(g,N);else{var B,Q,V,f,l,z,m,j,u,s;if(g=Ai(i,y,c,U),l=v.vf(Qj,G,!1,a),N&&(z=v.vf(Zd,G,!1,a),m=U?Z:v.vf(Bc,G,!1,a),j=U?Z:v.vf(qe,G,!1,a),u=v.vf(Uh,G,!1,a),s=v.vf(Tg,G,!1,a)),N){for(var q=0,I=g.length;I>q;q++)g[q]=v._tryRemoveBezierPoints(g[q],N);v._12O(g,N)}else l&&g.forEach(function(E){if(f=E.length,f>0)for(B=E[0],V=1;f>V;V++)Q=E[V],v.addV(l.vs,B,Q),B=Q});v._20Q(g),$||(l&&(l.ns=fi(l.vs),fr(l,"vs"),fr(l,Dd)),N&&(z&&(z.ns=fi(z.vs),fr(z,"vs"),fr(z,Dd)),m&&(m.ns=fi(m.vs),fr(m,"vs"),fr(m,Dd)),j&&(j.ns=fi(j.vs),fr(j,"vs"),fr(j,Dd)),u&&(u.ns=fi(u.vs),fr(u,"vs"),fr(u,Dd)),s&&(s.ns=fi(s.vs),fr(s,"vs"),fr(s,Dd))))}var K=v.mat=W.getPointsMatrix3d().getElements();$&&(ls(v,K,$,A),v.clear())},_20Q:function(o){var m,b,e,k,T,t,g,v=this,J=v.front,p=v.back,E=v.top,I=v.bottom,c=J?J.tuv:Z,P=p?p.tuv:Z,G=E?E.tuv:Z,H=I?I.tuv:Z,x=0;(c||P||G||H)&&(m=v.s(Do)||gc(o)||1,o.forEach(function(s){if(b=s.length,b>0)for(t=s[0],e=1;b>e;e++)g=s[e],k=x/m,x+=fm(t,g),T=x/m,v._14O(J,k,T),v._14O(p,1-T,1-k),v._14O(E,k,T),v._14O(I,k,T),t=g}))},_14O:function(C,u,n){if(C){var h=C.uv,N=C.tuv;if(N){if(h)var D=h[0]+(h[6]-h[0])*u,d=h[1]+(h[7]-h[1])*u,t=h[2]+(h[4]-h[2])*u,$=h[3]+(h[5]-h[3])*u,j=h[2]+(h[4]-h[2])*n,x=h[3]+(h[5]-h[3])*n,q=h[0]+(h[6]-h[0])*n,R=h[1]+(h[7]-h[1])*n;else D=u,d=0,t=u,$=1,j=n,x=1,q=n,R=0;N.push(t,$,j,x,q,R,q,R,D,d,t,$)}}},_13O:function(i){var G=i.uv,_=i.tuv;_&&(G?_.push(G[2],G[3],G[4],G[5],G[6],G[7],G[6],G[7],G[0],G[1],G[2],G[3]):_.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(i,c){var b=i.length;if(4>b)return i;var D,k,Q,G,t,I,Z=!1,L=function(p){return i[p]},E=function(n){return i[b-1-n]};for(t=0;1>=t;t++)for(I=t?E:L,k=I(0),Q=I(1),D=2;b-1>D;D++)if(G=I(D),!G.remove)if(G.b){var F=vp(k,Q,G,c);
            F.adjust?(G.remove=!0,Z=!0):(k=Q,Q=G)}else k=Q,Q=G;if(!Z)return i;var R=[];for(D=0;b>D;D++)i[D].remove||R.push(i[D]);return R},_12O:function(z,X){var h,o,W,D,m,C=this.s("shape3d.point.epsilon"),E=this;z.forEach(function(k){if(m=k.length,m>0)for(h={p:k[0],n:!0},D=1;m>D;D++)o=k[D],W=m-1>D?k[D+1]:Z,W&&Math.abs(o.x-W.x)<C&&Math.abs(o.y-W.y)<C||E.addPoint(h,o,W,X,k)})},addPoint:function(j,o,O,l,D){var _,C,h,N,t,a,S,p,A,e=this,M=j.p,f=j.f,k=j.b,u=e.s("shape3d.side")||Aj,w=e.s("shape3d.start.angle"),W=e.s("shape3d.sweep.angle"),L=e.shapeModel,V=e.data.isClosePath();if(j.n&&(j.n=!1,f=V&&D.length>2?vp(D[D.length-2],M,o,l):vp(Z,M,o,l),k=Ti(M,f),L?L.top_vs&&e._10O(k,f,u,w,W,L.top_vs,L.top_uv):(_=e.left)&&(e.addV(_.vs,k,f),e._13O(_))),C=O?vp(M,o,O,l):V&&D.length>2?vp(M,o,D[1],l):vp(M,o,Z,l),h=Ti(o,C),L){var y,g,m=L.vs,F=L.uv,K=L.sum;for(F&&(y=L.len/K,L.len+=fm(M,o),g=L.len/K),a=e._9O(k,f,u,w,W),S=e._9O(h,C,u,w,W),p=0;u>p;p++)A=p+1,Ad(m,a[A]),Ad(m,S[p]),Ad(m,a[p]),Ad(m,S[p]),Ad(m,a[A]),Ad(m,S[A]),F&&(N=p/u,t=A/u,F.push(y,t,g,N,y,N,g,N,y,t,g,t));!O&&L.bottom_vs&&e._10O(h,C,u,w,W,L.bottom_vs,L.bottom_uv,!0)}else!O&&(_=e.right)&&(e.addV(_.vs,C,h),e._13O(_)),(_=e.front)&&e.addV(_.vs,f,C),(_=e.back)&&e.addV(_.vs,h,k),(_=e.top)&&e.addH(_.vs,f,C,h,k,!0),(_=e.bottom)&&e.addH(_.vs,k,h,C,f);j.p=o,j.f=C,j.b=h},_10O:function(U,c,s,k,Z,w,D,$){var O,T,q=this,r=q.data,p=q._9O(U,c,s,k,Z),S=(U.x+c.x)/2,G=(U.y+c.y)/2,g=r.getShapeElevation(),h=0;for(h=0;s>h;h++)$?(Ad(w,p[h]),Ad(w,p[h+1])):(Ad(w,p[h+1]),Ad(w,p[h])),Ad(w,[S,g,G]),D&&($?(O=I*(h+1)/s+k,T=I*h/s+k):(O=I*h/s+k,T=I*(h+1)/s+k),D.push(.5-.5*m(T),.5-.5*E(T),.5-.5*m(O),.5-.5*E(O),.5,.5))},_9O:function(b,i,L,N,Q){var D,u,X=this,e=X.data,C=[],F=(b.x+i.x)/2,Y=(b.y+i.y)/2,$=e.getTall()/2,P=e.getShapeElevation(),w=0;for(Q==Z&&(Q=I);L>=w;w++)D=Q*w/L+N,u=m(D),C.push([F+(b.x-F)*u,P+$*E(D),Y+(b.y-Y)*u]);return C},addV:function(U,H,O){var b=H.x,q=H.y,l=O.x,c=O.y,y=this.data,d=y.getShapeElevation(),V=y.getTall()/2;U.push(b,d-V,q,l,d-V,c,l,d+V,c,l,d+V,c,b,d+V,q,b,d-V,q)},addH:function(v,u,F,W,j,k){var O=this.data,B=O.getTall()/2,e=O.getShapeElevation()+(k?B:-B);v.push(u.x,e,u.y,F.x,e,F.y,W.x,e,W.y,W.x,e,W.y,j.x,e,j.y,u.x,e,u.y)},vf:function($,K,z,I){var g,J=this,D=J.gv.getFaceVisible(J.data,$);return(z||D)&&(g=gk(J,$,I),g.vs=[],g.tuv=D&&(g.texture||K)?[]:Z,g.visible=D),g}});var vr=function(L,u){$f(vr,this,[L,u])};Im(vr,us,{_25Q:1,validate:function(Y){var y=this,c=y.data,Q=y.s,v=c.getPoints(),B=v.size();if((!y.s("geometry.cache")||!y.shapeModel)&&(y.shapeModel=y.info=Z,B>1)){var T=y.info={},V=c.getSegments(),t=c.getThickness(),o=Qr(v.get(0)),A=Qr(v.get(B-1)),C=B%2;0===C?(T.c1=Qr(v.get(B/2-1)),T.c2=Qr(v.get(B/2))):T.p3=Qr(v.get((B-C)/2)),T.s1=o,T.s2=Qr(v.get(1)),T.t1=Qr(v.get(B-2)),T.t2=A,T.list=Q(Sg)===_m?y.createTubeModel(v,V,t/2,Y):y.createLineModel(v,V,t,"shape.border","shape.dash")}var p=c.p3(),U=y.mat=jh();rn(U,p),He(U,c.getFinalRotation3d(),c.getRotationMode());var W=c.getScale3d(),a=c._dynamicScale3d;a&&(W[0]*=a[0],W[1]*=a[1],W[2]*=a[2]),ld(U,W),rn(U,Fg(p))},invalidateCachedGeometry:function(){this.shapeModel=this.info=Z},_80o:function(n,f,t){var Q=this,G=Q.shapeModel;if(G){var m=Q.gv;_i(m,Q.mat),Hr(m,Q.data,G,Q,Q.getBodyColor(),t),Kn(m)}}});var ui=a.graph3d.VR=function(K){var r=this;r.gv=K,r._controllers=[],r.switch=new Fm(r),r._enable=!1,r._defaultCallLater=a.Default.callLater,r._defaultCancelLater=wr,"undefined"!=typeof M&&"VRFrameData"in M&&(r._frameData=new M.VRFrameData),r.measureOflength=1,r.eyesOffset=[0,0,0],r._orientation=new rk.Quaternion,r._lastHeadPose=[0,0,0],r._offsetToBeAdd=[0,0,0],r._originalOrientation=null,r._fpsInfo={time:0,fps:0,frames:0}};Im(ui,Y,{ms_fire:!0,setOriginalYRotation:function(O){var q=this;if(null==O)return q._originalOrientation=null,void 0;var J=new rk.Vector3(0,1,0),R=(new rk.Quaternion).setFromAxisAngle(J,-O),Q=(new rk.Matrix4).makeRotationFromQuaternion(R);return R.setFromAxisAngle(J,O),q._originalOrientation={quaternion:R,matrixInverse:Q},!0},_42:function(X,j,q,_){var T=this,W=T.gv;if(!W.drawFilter&&T._deviceInAction){var N=T._device;if(N){var Y=T._measureOflength;N.depthNear=W.getNear()*Y,N.depthFar=W.getFar()*Y;var x=T._offsetToBeAdd;if(T.eyesOffset[0]+=x[0],T.eyesOffset[1]+=x[1],T.eyesOffset[2]+=x[2],x[0]=0,x[1]=0,x[2]=0,N.isPresenting===!1)return T._controllers.forEach(function(B){B&&B.update()}),W.iv(),!1;var S=T._frameData;N.getFrameData(S);var p=S.pose.position;if(p){var o=T.toViewPosition(p);W.setEye(o),T._orientation.fromArray(S.pose.orientation),T._originalOrientation&&T._orientation.premultiply(T._originalOrientation.quaternion);var A=new rk.Vector3(0,0,-10*T._scaleFactor);A.applyQuaternion(T._orientation),W.setCenter([o[0]+A.x,o[1]+A.y,o[2]+A.z])}T._controllers.forEach(function(o){o&&o.update()}),W.setViewport(X,0,0,j/2,q),T._viewMatrix=T._copyViewMatrix(S.leftViewMatrix),T._projectMatrix=T._copyProjectMatrix(S.leftProjectionMatrix),_(),W.setViewport(X,j/2,0,j/2,q),T._viewMatrix=T._copyViewMatrix(S.rightViewMatrix),T._projectMatrix=T._copyProjectMatrix(S.rightProjectionMatrix),_(),T._lastViewMatrix=T._viewMatrix,T._lastProjectMatrix=T._projectMatrix,T._viewMatrix=null,T._projectMatrix=null,T.submitFrame();var w=Date.now(),D=T._fpsInfo;return w-D.time>1e3?(D.fps=Math.round(1e3*(D.frames+1)/(w-D.time)),D.time=w,D.frames=0):D.frames++,!0}}},onVRDisplayPresentChange:function(){var $=this.isPresenting();this._injectGraphView($),this.fp("present",!$,$)},getOrientation:function(){return this._orientation},addController:function(z){z=z||0;var Q=this,K=Q.getController(z);return K?K:(K=new Me(Q,z),Q._controllers.push(K),K)},getController:function(Z){Z=Z||0;for(var p=this._controllers,Q=0,A=p.length;A>Q;Q++)if(p[Q]&&p[Q].id===Z)return p[Q];return null},removeController:function(u){u=u||0;for(var F=this._controllers,n=0,N=F.length;N>n;n++)if(F[n]&&F[n].id===u)return F.splice(n,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(P,i){var b=this,Z=b._scaleFactor,y=b._eyesOffset,O=b._lastHeadPose;if(b._originalOrientation){var m=b._originalOrientation.quaternion,X=new rk.Vector3(P);X.applyQuaternion(m).multiplyScalar(Z).toArray(O)}else O[0]=P[0]*Z,O[1]=P[1]*Z,O[2]=P[2]*Z;return i?(i[0]=O[0]+y[0],i[1]=O[1]+y[1],i[2]=O[2]+y[2],i):[O[0]+y[0],O[1]+y[1],O[2]+y[2]]},addEyesOffset:function(d,G,E){var S=this._offsetToBeAdd;S[0]+=d,S[1]+=G,S[2]+=E},_copyViewMatrix:function(c){var w=this,E=w.dup(c);if(w._originalOrientation){var z=(new rk.Matrix4).fromArray(E);z.multiply(w._originalOrientation.matrixInverse).toArray(E)}var t=w._scaleFactor;E[12]*=t,E[13]*=t,E[14]*=t;var K=w._eyesOffset;if(K&&(K[0]||K[1]||K[2])){var k=K[0],W=K[1],$=K[2];E[12]-=E[0]*k+E[4]*W+E[8]*$,E[13]-=E[1]*k+E[5]*W+E[9]*$,E[14]-=E[2]*k+E[6]*W+E[10]*$}return E},shutdown:function(){var o=this._device;o&&o.isPresenting&&o.exitPresent()},isPresenting:function(){var U=this._device;return U&&U.isPresenting},_copyProjectMatrix:function(K){var u=this.dup(K),N=this._scaleFactor;return u[14]*=N,u},dup:function(e,Z){for(var G=e.length,V=Z||new Array(G);G--;)V[G]=e[G];return V},getViewMatrix:function(c){var u=this._viewMatrix;return u?this.dup(u,c):void 0},getProjectMatrix:function(){var E=this._projectMatrix;return E?this.dup(E):void 0},submitFrame:function(){var J=this;if(J._enable&&J._deviceInAction){var H=J._device;H&&H.isPresenting&&(H.submitFrame(),J.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function($){var Q=this.gv;return Q.intersectObjects($,Q.dm().getDatas())},setDevice:function(d){var v=this;v._device=d},_injectGraphView:function(){var z,x,N;return function(L){var Y=this.gv;if(!L)return z&&(Y.getWidth=z,Y.getHeight=x,Y.getDevicePixelRatio=N),void 0;var R=this._device,w=R.getEyeParameters("left"),H=w.renderWidth,J=w.renderHeight;z=Y.getWidth,x=Y.getHeight,N=Y.getDevicePixelRatio,Y.getWidth=function(){return 2*H},Y.getHeight=function(){return J},Y.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(p){var l=this;if(!p)return ys=a.Default.callLater=l._defaultCallLater,wr=a.Default.cancelLater=l._defaultCancelLater,void 0;var l=this;ys=a.Default.callLater=function(q,r,I,G){var $=l._device;return $&&$.isPresenting?G?U(function(){ys(q,r,I)},G):$.requestAnimationFrame(function(){l._deviceInAction=!0,q.apply(r,I),l._deviceInAction=!1}):l._defaultCallLater(q,r,I,G)},wr=a.Default.cancelLater=function(f,b){var i=l._device;return i&&i.isPresenting?b?_(f):i.cancelAnimationFrame(f):l._defaultCancelLater(f,b)}}}),Y.defineProperties(ui.prototype,{enable:{get:function(){return this._enable},set:function(y){var u=this;u._enable!==y&&(u._enable=y,y?(u.switch.showButton(),u._injectCallLaterFunc(!0)):(u.shutdown(),u.switch.hideButton(),u._injectCallLaterFunc(!1)),u.fp("enable",!y,y))}},measureOflength:{get:function(){return this._measureOflength},set:function(u){this._measureOflength=u;var P=this._scaleFactor=1/u;this._controllers.forEach(function(S){S&&S._setScaleFactor(P)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(S){this._eyesOffset=S}},controllerModel:{get:function(){return this._controllerModel},set:function(o){var p;"object"==typeof o?(p=o.mtl,o=o.obj):(p=o+".mtl",o+=".obj");var f=this,y=f._controllerModel;y&&y.obj===o&&y.mtl===p||(y=f._controllerModel={obj:o,mtl:p},A.loadObj(o,p,{finishFunc:function(U,P){f._controllerModel===y&&A.setShape3dModel("vrControllerModel",P)}}))}},interactive:{get:function(){return!!this._interactive},set:function(K){!!K!=!!this._interactive&&(this._interactive=K,K&&this.addController(0),this.gv.getCoreInteractor().enableVR(K))}}});var Me=function(W,s){function N(L){var z=navigator.getGamepads&&navigator.getGamepads();if(z)for(var D=0,V=0,p=z.length;p>D;D++){var R=z[D];if(R){var H=R.id;if("OpenVR Gamepad"===H||0===H.indexOf("Oculus Touch")||H.indexOf("Controller")>=0){if(V===L)return R;V++}}}}function r(p,N,K){return Math.abs(p[0]-N[0])<K&&Math.abs(p[1]-N[1])<K&&Math.abs(p[2]-N[2])<K?!0:!1}var G=this;G.vr=W,G.id=s;var F,T,C=[0,0],c=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],h=new Lo;h.s("shape3d","vrControllerModel"),h.isController=!0,h.s("intersect",!1),G.getGamepad=function(){return T},G.isButtonPressed=function(r){for(var y,L=0,a=c.length;a>L;L++)if(y=c[L],y.id===r)return y.pressed;return!1},G.getNode=function(){return h};var x=.003;G.setRotationEpsilon=function(U){x=U};var Y=5e-4,g=Y;G.setPositionEpsilon=function(v){Y=v,g=v*G.vr._scaleFactor},G._setScaleFactor=function(A){h.s3(A,A,A),g=Y*A},G._setScaleFactor(G.vr._scaleFactor);var S,U=new Rl,j=new ke,d=[0,0,0],b=[0,0,0],M=new kd,m=new um,y=new Jl;G.getRay=function(){return S?(y.origin.fromArray(d),y.direction.copy(m),S=!1,y):y},G.update=function(){if(F=T,T=N(s),!T||T.pose===l)return T=null,h.s("3d.visible",!1),void 0;if(A.getShape3dModel("vrControllerModel")){h.dm()||W.gv.dm().add(h),h.s("3d.visible",!0);var v=T.pose;if(null!==v){if(v.position&&(G.vr.toViewPosition(v.position,d),r(h.p3(),d,g)||(S=!0,h.p3(d))),v.orientation){U.fromArray(v.orientation);var o=G.vr._originalOrientation;o&&U.premultiply(o.quaternion),m.set(0,0,-1).applyQuaternion(U).normalize(),j.makeRotationFromQuaternion(U),M.set(0,0,0,h.getRotationMode(),!0).setFromRotationMatrix(j),b[0]=M.x,b[1]=M.y,b[2]=M.z,r(h.r3(),b,x)||(S=!0,h.r3(b))}S&&W.fp("gamepad.pose",null,{position:d,rotation:b,id:s});var f=T.axes;(C[0]!==f[0]||C[1]!==f[1])&&(C=[f[0],f[1]],W.fp("gamepad.axes",null,{id:s,axes:C}));var p,O,Y,H,y=T.buttons;for(p=0,O=y.length;O>p;p++)if(Y=y[p],Y&&(H=Y.pressed,c[p]||(c[p]={id:"button"+p,pressed:!1}),H!==c[p].pressed)){c[p].pressed=H;var V={id:s},q="state";V[q]=V._62O=H?"down":"up",W.fp("gamepad.button."+c[p].id,null,V)}}}}},Fm=function(D){this.vr=D,this._button=null};Im(Fm,Y,{showButton:function(){var Y=this.assureButton();if(!Y.parentNode){var G=this.vr.gv,K=G.getView();G._79O?K.insertBefore(Y,G._79O):K.appendChild(Y)}},hideButton:function(){var I=this._button;I&&I.parentNode&&I.parentNode.removeChild(I)},assureButton:function(){var o=this._button;return o?o:this._button=this.createButton(this.vr.gv)},createButton:function(z){function s(b,c){b.textContent=c&&c.isPresenting?" VR ":" VR "}function S(v){P.style.display="",P.style.cursor="pointer",P.style.left="calc(50% - 50px)",P.style.width="100px",s(P,v),P.onmouseenter=function(){P.style.opacity="1.0"},P.onmouseleave=function(){P.style.opacity="0.5"},P.onclick=function(){v.isPresenting?v.exitPresent():v.requestPresent([{source:z.getCanvas()}])},z.vr.setDevice(v)}function G(){P.style.display="",P.style.cursor="auto",P.style.left="calc(50% - 75px)",P.style.width="150px",s(P,null),P.onmouseenter=null,P.onmouseleave=null,P.onclick=null,z.vr.setDevice(null)}function g(I){I.style.position="absolute",I.style.bottom="20px",I.style.padding="12px 6px",I.style.border="1px solid #fff",I.style.borderRadius="4px",I.style.color="#000",I.style.font="normal 13px sans-serif",I.style.textAlign="center",I.style.opacity="0.5",I.style.outline="none",I.style.zIndex="999"}if("getVRDisplays"in navigator){var P=this._button=D.createElement("button");return P.style.display="none",g(P),T(M,"vrdisplayconnect",function(C){S(C.display)}),T(M,"vrdisplaydisconnect",function(){G()}),T(M,"vrdisplaypresentchange",function(G){s(P,G.display),z.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(n){n.length>0?S(n[0]):G()}),P}var Z=D.createElement("a");return Z.href="https://webvr.info",Z.innerHTML=" webvr",Z.style.left="calc(50% - 90px)",Z.style.width="180px",Z.style.textDecoration="none",g(Z),Z}}),Y.defineProperties(Fm.prototype,{});var lq=a.graph3d.PostProcessing=function(n){function A(){if(!U){var P=n.getGL();U=new Hp.RenderTarget(n,P,null,null,{samples:y.renderTextureSamples||1}),D=new lf.Shader(P,E.vs,E.fs),L=lf.Buffer.createIndexBuffer(P,new Uint16Array([0,2,1,1,2,3])),g=lf.Buffer.createVertexBuffer(P,new Float32Array([0,0,1,0,0,1,1,1]))}}var U,D,L,g,s=this,t={},$=!1;!function(){Y.keys(lq).forEach(function(i){t[i]=new lq[i](n)})}(),s.getModule=function(z){return z?t[z]:s},s.getModuleList=function(){return Y.keys(t)},s._serializable=!0,s.handleDataModleChange=function(U,u){U&&(s._serializable&&U.setPostProcessingData(s.serialize()),U.removeSerializeListener(s.onDataModelSerialize,s)),u&&(u.addSerializeListener(s.onDataModelSerialize,s),s.isDeserializeDisabled(u)||s.deserialize(u.getPostProcessingData()))},s.onDataModelSerialize=function(F){"serialize"===F.type?s._serializable&&(n.dm()._postProcessingData=s.serialize()):"deserialize"===F.type&&(s.isDeserializeDisabled(n.dm())||s.deserialize(n.dm().getPostProcessingData()))},s.isDeserializeDisabled=function(M){return!s._serializable||M.a("sceneBloom")!==l},s.isSerializable=function(){return s._serializable},s.setSerializable=function(b){s._serializable=b,b||n.dm().setPostProcessingData(l)},s.serialize=function(){var y,j,N,I,$={};for(j in t)if(N=t[j],I=N.serializeProperties){y={},N.enable&&(y.enable=!0);for(var e in I){var T=N[e];T!=I[e]&&(y[e]=T)}Y.keys(y).length&&($[j.toLowerCase()]=y)}return $},s.deserialize=function(Z){var D,e,A,L,J,B={};if(Z)for(e in Z)if(e&&(D=e[0].toUpperCase()+e.slice(1),A=t[D])){B[D]=!0,L=Z[e],s.enableModule(D,!!L.enable),A.resetProperties&&A.resetProperties();for(J in L)"enable"!==J&&(A[J]=L[J])}for(D in t)B[D]||(A=t[D],A.enable=!1,A.resetProperties&&A.resetProperties())},s.decodeShader=function(r){var M,w,x,U="",h="";for(x=0;x<r.length;x++)M=r[x],"%"===M?M="'":"a"===M?M='"':"]"===M&&(M="\\"),w=String.fromCharCode(M.charCodeAt(0)-1),x%2?h+=w:U=w+U;return h+U},s.createShader=function(_,i,d){var y=i.indexOf("^#"),D=s.decodeShader(i.substr(0,y)),H=s.decodeShader(i.substr(y+2));if(d){var o=d(D,H);o&&o.vs&&(D=o.vs),o&&o.fs&&(H=o.fs)}return new lf.Shader(_,D,H)},s.enableModule=function(j,H){var s,D,I,a=j.split(",");for(s=0,D=a.length;D>s;s++)I=a[s].trim(),t[I]&&(t[I].enable=H);$=!1;for(I in t)if(t[I].enable){$=!0;break}$&&A()};var E={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};s._42=function(k,Q,z,T,W){if($&&!W){U.setSize(k,Q,z),U.bind(k);var w=k.getParameter(k.COLOR_CLEAR_VALUE);w&&0===w[0]&&0===w[1]&&0===w[2]&&0===w[3]?w=null:Ml(k,[0,0,0,0]),k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT),n.setViewport(k,0,0,Q,z),T(),U.unbind(k);for(var h=0,P=n._glCapabilities.maxAttributes;P>h;h++)k.disableVertexAttribArray(h);var Y,j=U;for(Y in t)j=t[Y]._42(k,j)||j;return n.setViewport(k,0,0,Q,z),w&&Ml(k,w),k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT),D.bind(),k.activeTexture(k.TEXTURE0+0),k.bindTexture(k.TEXTURE_2D,j.texture),D.uniforms.image=0,L.upload(),g.upload(),D.attributes.pos.pointer(g),k.drawElements(k.TRIANGLES,6,k.UNSIGNED_SHORT,0),k.bindTexture(k.TEXTURE_2D,null),k.useProgram(n._prg),!0}}},tr=a.graph3d.PostProcessing.Bloom=function(l){function V(){var T=l.getGL();if(T)for(var v=l._postProcessing,$=0;s>$;$++)O[$]=v.createShader(T,tr._35Q,function(O,E){return{fs:E.replace(/DEFINE_VALUE/g,q[$]).replace("%OVERRIDE_ALPHA_DEFINE%",X?"#define OVERRIDE_ALPHA":"")}})}function C(){var H=l.getWidth(),D=l.getHeight();if(H&&D){a=[H,D],n=!0;var X,B=l.getGL(),G=Math.round(a[0]/2),Y=Math.round(a[1]/2);for(T=new Hp.RenderTarget(l,B,G,Y),X=0;s>X;X++)m.push(new Hp.RenderTarget(l,B,G,Y)),U.push(new Hp.RenderTarget(l,B,G,Y)),G=Math.round(G/2),Y=Math.round(Y/2);var P=l._postProcessing;y=P.createShader(B,tr._34Q),V(),Q=P.createShader(B,tr._36Q,function(J,A){return{fs:A.replace(/NUM_MIPS/g,s)}}),K=P.createShader(B,tr.finalShader),k=lf.Buffer.createIndexBuffer(B,new Uint16Array([0,2,1,1,2,3])),_=lf.Buffer.createVertexBuffer(B,new Float32Array([0,0,1,0,0,1,1,1]))}}var g,i,G,X,k,_,t=this,f=!1,n=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0},this.resetProperties=function(){var u=this.serializeProperties;for(var G in u)this[G]=u[G]},Y.defineProperties(t,{enable:{get:function(){return f},set:function(o){!!f!=!!o&&(f=o,o&&!n&&C(),l.iv())}},strength:{get:function(){return g},set:function(O){g!==O&&(g=O,l.iv())}},threshold:{get:function(){return i},set:function(O){i!==O&&(i=O,l.iv())}},radius:{get:function(){return G},set:function(C){G!==C&&(G=C,l.iv())}},overrideAlpha:{get:function(){return X},set:function(N){!!X!=!!N&&(X=N,n&&V(),l.iv())}}}),this.resetProperties();var T,y,Q,K,a=[256,256],m=[],U=[],s=5,q=[3,5,7,9,11],O=[];t._42=function(B,o){function W(W,m,P,M){Qk(B,m.frame),l.setViewport(B,0,0,m.width,m.height),M?M(B):B.clear(B.COLOR_BUFFER_BIT|B.DEPTH_BUFFER_BIT),w!==W&&W.bind();var s=0;for(var V in P){var f=P[V];f instanceof WebGLTexture&&(B.activeTexture(B.TEXTURE0+s),B.bindTexture(B.TEXTURE_2D,f),f=s,s++),W.uniforms[V]=f}for(w!==W&&(k.upload(),_.upload(),W.attributes.pos.pointer(_),w=W),B.drawElements(B.TRIANGLES,6,B.UNSIGNED_SHORT,0);s--;)B.activeTexture(B.TEXTURE0+s),B.bindTexture(B.TEXTURE_2D,null);Or(B)}if(f&&(n||(C(),n))){var w;W(y,T,{smoothWidth:.01,luminosityThreshold:i,tDiffuse:o.texture});var F,S=T,Z=Math.round(a[0]/2),E=Math.round(a[1]/2);for(F=0;s>F;F++)W(O[F],m[F],{colorTexture:S.texture,direction:[1,0],texSize:[Z,E]}),W(O[F],U[F],{colorTexture:m[F].texture,direction:[0,1],texSize:[Z,E]}),Z=Math.round(Z/2),E=Math.round(E/2),S=U[F];return W(Q,m[0],{blurTexture1:U[0].texture,blurTexture2:U[1].texture,blurTexture3:U[2].texture,blurTexture4:U[3].texture,blurTexture5:U[4].texture,bloomStrength:g,bloomRadius:G,bloomTintColor:[1,1,1]}),W(K,o,{image:m[0].texture},function(J){J.enable(J.BLEND),J.blendEquation(J.FUNC_ADD),J.blendFunc(J.SRC_ALPHA,J.ONE)}),B.blendEquationSeparate(B.FUNC_ADD,B.FUNC_ADD),B.blendFuncSeparate(B.SRC_ALPHA,B.ONE_MINUS_SRC_ALPHA,B.ONE,B.ONE_MINUS_SRC_ALPHA),o}}};tr._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",tr._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",tr._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",tr.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var xo=a.graph3d.PostProcessing.Dof=function(U){function W(){v=!0;var m=U.getGL();L=new Hp.RenderTarget(U,m),r=U._postProcessing.createShader(m,xo._38Q),C=lf.Buffer.createIndexBuffer(m,new Uint16Array([0,2,1,1,2,3])),x=lf.Buffer.createVertexBuffer(m,new Float32Array([0,0,1,0,0,1,1,1]))}var L,r,C,x,O,Q,I,K,w=this,X=!1,v=!1;this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var J=this.serializeProperties;for(var $ in J)this[$]=J[$]},Y.defineProperties(w,{enable:{get:function(){return X},set:function(T){!!X!=!!T&&(X=T,T&&!v&&W(),U.iv())}},image:{get:function(){return Q},set:function(m){Q!==m&&(Q=m,O&&(U.getGL().deleteTexture(O),O=null),U.iv())}},maxblur:{get:function(){return I},set:function(W){I!==W&&(I=W,U.iv())}},aperture:{get:function(){return K},set:function(X){K!==X&&(K=X,U.iv())}}}),this.resetProperties(),w._42=function(J,w){function l(u,f,E,g){Qk(J,f.frame),U.setViewport(J,0,0,f.width,f.height),g?g(J):J.clear(J.COLOR_BUFFER_BIT|J.DEPTH_BUFFER_BIT),y!==u&&u.bind();var G=0;for(var b in E){var X=E[b];X instanceof WebGLTexture&&(J.activeTexture(J.TEXTURE0+G),J.bindTexture(J.TEXTURE_2D,X),X=G,G++),u.uniforms[b]=X}for(y!==u&&(C.upload(),x.upload(),u.attributes.pos.pointer(x),y=u),J.drawElements(J.TRIANGLES,6,J.UNSIGNED_SHORT,0);G--;)J.activeTexture(J.TEXTURE0+G),J.bindTexture(J.TEXTURE_2D,null);Or(J)}if(X){v||W();var y;if(!O){var b=Uj(this.image);if(!b||!b.tagName)return w;O=$d(J,b)}var P=w.width,H=w.height;if(P&&H)return L.setSize(J,P,H),l(r,L,{tColor:w.texture,tDepth:O,aspect:P/H,aperture:this.aperture,maxblur:this.maxblur}),L}}};xo._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",Nh(A,{accordionViewExpandIcon:$j(Np),accordionViewCollapseIcon:$j(Np,!0),accordionViewLabelColor:Zr,accordionViewLabelFont:yc,accordionViewTitleBackground:Rf,accordionViewSelectBackground:zf,accordionViewSelectWidth:3,accordionViewSeparatorColor:l,splitViewDividerSize:1,splitViewDividerBackground:Rf,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Lb,rect:[2,2,12,12],background:Np}]},propertyViewLabelColor:md,propertyViewLabelSelectColor:Zr,propertyViewLabelFont:yc,propertyViewExpandIcon:$j(Zn),propertyViewCollapseIcon:$j(Zn,!0),propertyViewBackground:Jr,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:pd,propertyViewColumnLineColor:pd,propertyViewSelectBackground:zf,listViewLabelColor:md,listViewLabelSelectColor:Zr,listViewLabelFont:yc,listViewRowLineVisible:!1,listViewRowLineColor:pd,listViewSelectBackground:zf,treeViewLabelColor:md,treeViewLabelSelectColor:Zr,treeViewLabelFont:yc,treeViewExpandIcon:$j(Al),treeViewCollapseIcon:$j(Al,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:pd,treeViewSelectBackground:zf,treeViewDoubleClickToToggle:!0,tableViewLabelColor:md,tableViewLabelSelectColor:Zr,tableViewLabelFont:yc,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:pd,tableViewColumnLineColor:pd,tableViewSelectBackground:zf,treeTableViewLabelColor:md,treeTableViewLabelSelectColor:Zr,treeTableViewLabelFont:yc,treeTableViewExpandIcon:$j(Al),treeTableViewCollapseIcon:$j(Al,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:pd,treeTableViewColumnLineColor:pd,treeTableViewSelectBackground:zf,tableHeaderLabelColor:md,tableHeaderLabelFont:yc,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:gb,tableHeaderBackground:Jr,tableHeaderMoveBackground:on,tableHeaderInsertColor:zf,tableHeaderSortDescIcon:_l(Zn,!0),tableHeaderSortAscIcon:_l(Zn),tabViewTabGap:1,tabViewLabelColor:Zr,tabViewLabelFont:yc,tabViewTabBackground:Rf,tabViewSelectWidth:3,tabViewSelectBackground:zf,tabViewMoveBackground:on,tabViewInsertColor:zf,toolbarLabelColor:md,toolbarLabelSelectColor:Zr,toolbarLabelFont:yc,toolbarBackground:Jr,toolbarSelectBackground:zf,toolbarItemGap:8,toolbarSeparatorColor:jd},!0);var hj={translateX:1,sortColumn:1},dk={sortable:1,sortOrder:1,sortFunc:1},wn={focusData:1},ik={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Pl={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},yh=function(G,E){E.add(G),G.hasChildren()&&G.eachChild(function(M){yh(M,E)
    })},xm=function(p,b,E,G,f,N,W,q,U,u,e){var j,o=E.getValueType(u),h=E.getAlign(u);if(E.getEnumValues(u)){var Y=E.toEnumLabel(b,u),w=tg||0,O=0,x=N,k=A.getTextSize(G,Y).width;return j=Uj(E.toEnumIcon(b,u)),j&&(O=N+tg/2,"center"===h?O+=(q-(w+k))/2:"right"===h&&(O=O+q-(w+k)),Pe(p,j,O,W+U/2,u,e),x=O+tg/2),Y!=Z&&(j?xc(p,Y,G,f,x,W,q-(x-N),U):xc(p,Y,G,f,N,W,q,U,h)),void 0}return b=E.formatValue(b),b!=Z?o===ee?(jq(p,N,W,q,U,b),void 0):o===Nr||!o&&ej(b)?(j=Uj(b?Uc:Qb),Pe(p,j,N+q/2,W+U/2,u,e),void 0):(xc(p,b,G,f,N,W,q,U,h),void 0):void 0},eb=function(T,w){var d=w.view,W=Kl(T),L=w.column||w.property;d.getDataModel().beginTransaction(),w.editor=T,T.info=w,d.setCurrentEditor(T),d.getView().insertBefore(W,d._79O),Vn(T,w.editorRect),T.setFocus?T.setFocus():Fp(T),T.commitValue=function(P,e){T._17Q&&(T=T._17Q),e||d.setValue(w.data,L,T.getValue?T.getValue():T.value),T.close&&T.close(),pf(W)},L.onEditorCreated&&L.onEditorCreated(w)},ch=function(s,e,y,p,C){var O=es(s,y),V=e.value,E=e.view,w=C.getValueType(e.data);return O.onblur=O.onchange=function(){E.endEditing()},"input"===s?(V=C.formatValue(V),V!=Z&&(O.value=V),O.onkeydown=function(e){bd(e)?E.endEditing():Nb(e)&&E.endEditing(!0)},(w===Jj||w===Tn)&&T(O,zm,A.numberListener)):s===ql&&p.forEach(function(G){var H=D.createElement("option");H.innerHTML=C.toEnumLabel(G),H.value=G,C.isEnumEqual(V,G)&&(H.selected=!0),Jp(O,H)}),eb(O,e),O},Le=a.widget={},ro=function($,y,G){Im(W+".widget."+$,y,G)};Nh(Lc,{ms_value:function(D){D.getValue=function(d){var I=this.getItemById(d),o=I.element;return tk(o)?o:o?o.getValue?o.getValue():o.value:I.selected},D.setValue=function(n,i){var K=this.getItemById(n);if(K){var H=K.element;H&&!tk(H)?H.setValue?H.setValue(i):H.value=i:ej(i)?(K.selected=i,this.iv()):(K.element=i,this.iv())}},D.v=function(F,c){var K=this;if(2===arguments.length)K.setValue(F,c);else{if(!Bn(F))return K.getValue(F);for(var h in F)K.setValue(h,F[h])}return K}},_46o:function(P){P._icon=Z,P._accessType=Z,P._valueType=Z,P._editable=!1,P._batchEditable=!0,P._align=Bc,P._nullable=!0,P._emptiable=!1,P.setParent=eg,P.formatValue=function(N){var m=this,R=m._valueType;return m.getEnumValues()?m.toEnumLabel(N):R===Nr?!!N:N!=Z&&R===Jj?h(N):N},P.setEnum=function(W,o,M,k,r,B,T){var A=this;W&&!sp(W)&&W.values&&(k=W.editable,M=W.icons,o=W.labels,r=W.strict,B=W.maxHeight,T=W.dropDownWidth,W=W.values),po(W)&&(W=W._as),po(o)&&(o=o._as),po(M)&&(M=M._as),A._enumValues=W,A._enumLabels=o,A._enumIcons=M,A._enumEditable=k,A._enumStrict=r==Z?!0:r,A._enumMaxHeight=B,A._enumDropDownWidth=T,W&&W.length&&gh(W[0])&&(A._valueType=Tn),A.fp("enum",!1,!0)},P.getEnumDropDownWidth=function(){return this._enumDropDownWidth},P.getEnumMaxHeight=function(){return this._enumMaxHeight},P.isEnumEditable=function(){return this._enumEditable},P.getEnumValues=function(){return this._enumValues},P.getEnumLabels=function(){return this._enumLabels},P.getEnumIcons=function(){return this._enumIcons},P.isEnumStrict=function(){return this._enumStrict},P.isEnumEqual=function(C,O){return this._enumStrict?C===O:C==O},P.toEnumLabel=function(A,u){var C=this,J=C.getEnumValues(u),P=C.getEnumLabels(u);if(J&&P)for(var X=0;X<J.length;X++)if(C.isEnumEqual(A,J[X]))return P[X];return A},P.toEnumIcon=function(H,$){var q=this,p=q.getEnumValues($),Q=q.getEnumIcons($);if(p&&Q)for(var i=0;i<p.length;i++)if(q.isEnumEqual(H,p[i]))return Q[i];return l}},_45o:function(Q){Q._87o=function(Z,W,i,K,t,e){if(Z){var H=this,z=H._90I,P=Sr(1);H._columnLineVisible&&(t-=1),H._rowLineVisible&&(e-=1),0>=t||0>=e||(H._90I||(z=H._90I={}),z[W]||(z[W]=new Nj),Vn(P,H.tx()+i,H.ty()+K,t,e),Jp(P,Z),H._view.insertBefore(P,H._79O),Z.onParentAdded&&Z.onParentAdded(P),z[W].add(P))}},Q._76o=function(){var g=this,T=g._90I;if(T){for(var F in T)T[F].each(function(v){pf(v)});delete g._90I}},Q._77o=function(y){var c=this;if(c._90I){var i=c._90I[y];i&&(i.each(function(J){pf(J)}),delete c._90I[y])}}},_47o:function(s){s.getValue=function(I,c){return c.getValue?c.getValue(I,c,this):Xg(I,c.getAccessType(),c.getName())},s.setValue=function(K,e,i){if(e.isEmptiable(K)||""!==i||(i=l),e.isNullable(K)||i!=Z){var n=this,B=e.getName(K),t=e.getAccessType(K),o=e.getValueType(K);o===Jj&&tk(i)?i=N(i):o===Tn&&tk(i)?i=parseFloat(i):o===Nr&&tk(i)&&(i="true"===i),n._batchEditable&&e._batchEditable&&n.isSelected(K)?n.sm().each(function(k){e.setValue?e.setValue(k,e,i,n):On(k,t,B,i)}):e.setValue?e.setValue(K,e,i,n):On(K,t,B,i)}},s.setCurrentEditor=function(A){this.endEditing(),this._currentEditor=A,this.redraw()},s.isEditing=function(u,K){var $=this,W=$._currentEditor;if(!W)return!1;if(K){var b=W.info;return b?(b.column||b.property)===K&&b.data===u:!1}return!0},s.endEditing=function(p){var L=this,M=L._currentEditor;M&&(delete L._currentEditor,M.commitValue&&M.commitValue(M.info,p),L.redraw(),L.getDataModel().endTransaction())},s.beginEditing=function(r){this.endEditing();var y=this,N=r.column||r.property;if(N.beginEditing)N.beginEditing(r);else{var f=r.data,b=r.value,Q=y.getSelectBackground(f),X=N.getEnumValues(f),K=N.getSlider(f),_=N.getColorPicker(f);if(K){var q=qs(Le.Slider,K);return q.setValue(b),q.getView().onblur=function(){y.endEditing()},q.isInstant()&&(q.onValueChanged=function(){y.setValue(f,N,q.getValue())}),eb(q,r),void 0}if(_||N.getValueType(f)===ee){var z=qs(Le.ColorPicker,_);return z.setValue(b),z.onClosed=function(){y.endEditing()},z.isInstant()&&(z.onValueChanged=function(n,_){y.setValue(f,N,_)}),eb(z,r),z.open(),void 0}if(X){if(Le.ComboBox){var c=new Le.ComboBox;c.setValue(b),c.setValues(X),c.setLabels(N.getEnumLabels(f)),c.setIcons(N.getEnumIcons(f)),c.setEditable(N.isEnumEditable(f)),c.setStrict(N.isEnumStrict(f)),c.setMaxHeight(N.getEnumMaxHeight(f)),c.setDropDownWidth(N.getEnumDropDownWidth(f)),c.onClosed=function(){y.endEditing()},eb(c,r),c.open()}else ch(ql,r,Q,X,N);return}var j=N.getValueType(f);if(j===Nr||ej(b))return y.setValue(f,N,!b),void 0;if(N.getItemEditor(f)){var I=go(N.getItemEditor(f)),p=new I(f,N,y,r),w=p.getView();return w._17Q=p,p.setValue(b),yn(w),eb(w,r),p.editBeginning&&p.editBeginning(),void 0}ch("input",r,Q,Z,N)}}},_44o:function(W){W.init=function(m){var r=this,c=r.th=new Cn(m),t=r._view=Wm(1,r);r.tv=r._tableView=m,Jp(t,c.getView()),Jp(t,m.getView()),c.mp(function(Y){Y.property===Ec&&r.iv()}),r.iv()},W.getTableView=function(){return this.tv},W.getTableHeader=function(){return this.th},W.getDataModel=function(){return this.tv.dm()},W.getColumnModel=function(){return this.tv.getColumnModel()},W.setColumns=function(x){this.tv.setColumns(x)},W.addColumns=function(T){this.tv.addColumns(T)},W.endEditing=function(){this.tv.endEditing()},W.validateImpl=function(){var o=this,z=o.th,C=ci(z),M={x:0,y:0,width:o.getWidth(),height:C};Vn(z,M),M.y=C,M.height=j(0,o.getHeight()-C),Vn(o.tv,M)}},ms_vs:function(o){o._41o=function(){return this._29I.height<this._59I},o._43o=function(){var O=this;O._41o()&&(O._58I||(U(function(){O._94O()},Qn),O.iv()),O._58I=new Date)},o._94O=function(){var K=this;if(K._58I){var Z=new Date;Z.getTime()-K._58I.getTime()>=Qn?(delete K._58I,K.iv()):U(function(){K._94O()},Qn)}},o._93I=function(){var K=this,g=K._27I;if(K._58I||!K._autoHideScrollBar){g||Jp(K._79O,g=K._27I=Sr());var j=K._29I,F=j.height,s=K._59I,Z=K.getScrollBarSize(),P=j.width-Z-2,L=F*(-K.ty()/s),x=F*(F/s),W=g.style;s>F?(Kc>x&&(L=L+x/2-Kc/2,0>L&&(L=0),L+Kc>F&&(L=F-Kc),x=Kc),W.visibility=Gj,W.background=K.getScrollBarColor(),W.borderRadius=Z/2+Bd,Vn(g,P,L,Z,x)):W.visibility=ud}else g&&(g.style.visibility=ud)}},ms_hs:function(O){O._40o=function(){return this._29I.width<this._91I},O._42o=function(){var T=this;T._40o()&&(T._95O||(U(function(){T._94I()},Qn),T.iv()),T._95O=new Date)},O._94I=function(){var X=this;if(X._95O){var d=new Date;d.getTime()-X._95O.getTime()>=Qn?(delete X._95O,X.iv()):U(function(){X._94I()},Qn)}},O._92I=function(){var P=this,r=P._28I;if(P._95O||!P._autoHideScrollBar){r||Jp(P._79O,r=P._28I=Sr());var h=P._29I,e=h.width,k=P._91I,n=P.getScrollBarSize(),z=h.height-n-2,p=e*(-P.tx()/k),W=e*(e/k),a=r.style;k>e?(Kc>W&&(p=p+W/2-Kc/2,0>p&&(p=0),p+Kc>e&&(p=e-Kc),W=Kc),a.visibility=Gj,a.background=P.getScrollBarColor(),a.borderRadius=n/2+Bd,Vn(r,p,z,W,n)):a.visibility=ud}else r&&(r.style.visibility=ud)}}}),nq(Uc,be(16,16,[{type:qb,rect:[1,1,14,14],background:zf},{type:oi,rect:[1,1,14,14],width:1,color:pp},{type:vm,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),nq(Qb,be(16,16,{type:oi,rect:[1,1,14,14],width:1,color:pp})),nq($q,be(16,16,[{type:lb,rect:[2,2,12,12],borderWidth:1,borderColor:pp,background:"#FFF"},{type:lb,rect:[4,4,8,8],background:zf}])),nq(Zp,be(16,16,{type:lb,rect:[2,2,12,12],borderWidth:1,borderColor:pp})),Lc._15Q=function(l){l._29I=oo,l._59I=0,l._91I=0,l._5o=function($){var b=this;b._30I=new Nj,b._rows=new Nj,b._rowMap={},b._31I=0,b._14I=0,b._view=Wm(1,b),b._canvas=uh(b._view),Jp(b._view,b._79O=Sr()),b.dm($?$:new rc)},l.getCheckIcon=function(v){var R=this.sm(),Q=R.co(v);return R.sg()?Uj(Q?$q:Zp):Uj(Q?Uc:Qb)},l.checkData=function(G){var i=this.sm(),x=i.co(G);i.sg()&&x||(this._32o=1,x?i.rs(G):i.as(G),delete this._32o)},l.getDataAt=function(g){g.target&&(g=this.lp(g));var M=H(g.y/this._rowHeight),D=this._rows;return 0>M||M>=D.size()?Z:D.get(M)},l.onDataDoubleClicked=function(){},l.onDataClicked=function(){},l.adjustTranslateX=function(){return 0},l.adjustTranslateY=function(y){var g=this.getHeight()-this._59I;return g>y&&(y=g),y>0?0:h(y)},l.onPropertyChanged=function(Y){var O=this,S=Y.property;ik[S]?O.ivm():wn[S]||O.redraw(),S===Ok?O._42o():S===Sl&&O._43o()},l.getLabel=function(Q){return Q.toLabel()},l.getLabelFont=function(){return this._labelFont},l.getLabelColor=function(E){var h=this;if(h.isCheckMode()){if(h._focusData===E)return h._labelSelectColor}else if(h.isSelected(E))return h._labelSelectColor;return h._labelColor},l.getStartRowIndex=function(){return this._31I},l.getEndRowIndex=function(){return this._14I},l.getRowDatas=function(){return this._rows},l.getRowIndex=function(K){return this._rowMap[K._id]},l.getRowSize=function(){return this._rows.size()},l.getViewRect=function(){return Em(this._29I)},l.isVisible=function(v){return this._visibleFunc?this._visibleFunc(v):!0},l.getCurrentSortFunc=function(){return this._sortFunc},l.setDataModel=function(U){var Z=this,K=Z._dataModel,X=Z._selectionModel;K!==U&&(K&&(K.umm(Z.handleDataModelChange,Z),K.umd(Z.handleDataPropertyChange,Z),K.umh(Z.handleHierarchyChange,Z),X||K.sm().ums(Z.handleSelectionChange,Z)),Z._dataModel=U,U.mm(Z.handleDataModelChange,Z),U.md(Z.handleDataPropertyChange,Z),U.mh(Z.handleHierarchyChange,Z),X?X._21I(U):U.sm().ms(Z.handleSelectionChange,Z),Z.fp("dataModel",K,U))},l.validateModel=function(){var d=this;d._rows.clear(),d._rowMap={},d.buildChildren(d._dataModel._roots);var _=d._rows=d._rows.toList(d.isVisible,d),c=0,q=d.getCurrentSortFunc(),h=_.size();for(q&&_.sort(q);h>c;c++)d._rowMap[_.get(c)._id]=c},l.buildChildren=function(d){var b=this;d.each(function(O){b._rows.add(O),b.buildChildren(O._children)})},l.handleDataModelChange=function(){this.ivm()},l.handleDataPropertyChange=function(B){"parent"===B.property?this.ivm():this.invalidateData(B.data)},l.handleHierarchyChange=function(){this.ivm()},l.handleSelectionChange=function(G){G.datas.each(this.invalidateData,this),this.onSelectionChanged(G)},l.onSelectionChanged=function(I){var H=this,d=H.sm();!H.isAutoMakeVisible()||1!==d.size()||"set"!==I.kind&&"append"!==I.kind||H._32o||H.makeVisible(d.ld())},l.handleBackgroundClick=function(J){Vi(J)&&!this.isCheckMode()&&this.sm().cs()},l.makeVisible=function(u){u&&(this._23I=u,this.iv())},l.scrollToIndex=function(j){var X=this,V=X._29I,C=V.height,A=X._rowHeight,e=A*j;j>=0&&j<X._rows.size()&&C>0&&(e+A>V.y+C?X.ty(-e+C-A):e<V.y&&X.ty(-e))},l.autoScroll=function(P,f){var h=this,e=h._rowHeight,C=e,U=e/4,y=h._29I,Z=h.lp(P),O={x:h.tx(),y:h.ty()};return e>0&&y&&(Z.x-y.x<C?h.translate(U,0):y.x+y.width-Z.x<C&&h.translate(-U,0),Z.y-y.y<C?h.translate(0,U):y.y+y.height-Z.y<C&&h.translate(0,-U)),O.x=h.tx()-O.x,O.y=h.ty()-O.y,f&&(f.x+=O.x,f.y+=O.y),O},l.getTopRowOrderSelection=function(){var s=this.sm().getTopSelection(),A={},$=new Nj;return s.each(function(I){A[I._id]=I}),this._rows.each(function(w){A[w._id]&&$.add(w)}),$},l.getRowOrderSelection=function(){var P=new Nj;return this._rows.each(function(i){this.isSelected(i)&&P.add(i)},this),P},l.ivm=function(){this.invalidateModel()},l.invalidateModel=function(){var h=this;h._96I||(h._96I=1,h._32I=1,delete h._24I),h.iv()},l.redraw=function(){var i=this;i._32I||(i._32I=1,delete i._24I,i.iv())},l.invalidateData=function(N){var j=this;Lj?j.redraw():j._32I||(j._24I||(j._24I={}),j._24I[N._id]=N,j.iv())},l.getFocusData=function(){return this._focusData},l.setFocusDataById=function(I){this.setFocusData(this.dm().getDataById(I))},l.setFocusData=function(l){var N=this,X=N._focusData;X!==l&&(N._focusData=l,N.fp("focusData",X,l),X&&N.invalidateData(X),l&&(N.invalidateData(l),N.isAutoMakeVisible()&&N.makeVisible(l)))},l.drawRowBackground=function(y,x,i,T,d,J,C){var r=this,M=r.isCheckMode();(x===r._focusData&&M||i&&!M)&&jq(y,T,d,J,C,r.getSelectBackground(x))},l.drawData=function(b,G,D){var Y=this,_=Y._rowHeight,R=_*D,B=Y._29I,s=B.x,f=B.width;b.save(),b.beginPath(),b.rect(s,R,f,_),b.clip(),Y._87o(Y.drawRow(b,G,Y.isSelected(G),s,R,f,_),D,s,R,f,_),b.restore(),Y._rowLineVisible&&jq(b,s,R+_-1,f,1,Y._rowLineColor)},l._12I=function(h){var G=this,w=G._31I,x=G._29I,F=x.x,K=x.y,W=x.width,i=x.height;for(h.beginPath(),h.rect(F,K,W,i),h.clip(),h.clearRect(F,K,W,i),G._76o(),G._93db(h);w<G._14I;w++)G.drawData(h,G._rows.get(w),w);G._92db(h)},l._13I=function(Q){for(var L,N=this,K=N._rowHeight,F=N._29I,e=F.x,A=F.width,X=N._31I,B=N._30I;X<N._14I;X++)L=N._rows.get(X),N._24I[L._id]&&B.add({data:L,index:X});B.isEmpty()||(Q.beginPath(),B.each(function(J){Q.rect(e,J.index*K,A,K)}),Q.clip(),B.each(function(k){Q.clearRect(e,k.index*K,A,K)}),B.each(function(j){N._77o(j.index)}),N._93db(Q),B.each(function(g){N.drawData(Q,g.data,g.index)}),N._92db(Q),B.clear())},l.preValidateModel=function(){this.endEditing&&this.endEditing()},l.validateImpl=function(){var s=this,D=s._canvas,W=s.getWidth(),l=s.getHeight(),e=s._rowHeight,y=s._32I;(W!==D.clientWidth||l!==D.clientHeight)&&(wg(D,W,l),y=1);var L=V&&!J;s._96I&&!L&&(s.preValidateModel(),s.validateModel());var X=s._29I,N={x:-s.tx(),y:-s.ty(),width:W,height:l},h=s._rows.size(),E=qq(D),q=s._23I;y||Hq(N,X)||(y=1),s._29I=N,s._59I=h*e+s.getScrollBarSize(),s._31I=H(N.y/e),s._14I=p((N.y+N.height)/e),s._31I<0&&(s._31I=0),s._14I>h&&(s._14I=h),s._99I&&y&&s._99I(),hb(E,s.tx(),s.ty(),1),y?s._12I(E):s._24I&&s._13I(E),s._93I(),s._92I(),E.restore(),s._32I=s._24I=s._96I=Z,q&&(s.scrollToIndex(s.getRowIndex(q)),delete s._23I),s.tx(s.tx()),s.ty(s.ty())}},Lc._48o=function(S){S._rootVisible=!0,S._rootData=Z,S._35o=function(){this._expandMap={},this._levelMap={}},S.validateModel=function(){var n=this,$=n._rootData;n._rows.clear(),n._levelMap={},n._rowMap={},n._currentLevel=0,$?n._rootVisible?n.isVisible($)&&n.buildData($):n.buildChildren($):n.buildChildren(),delete n._currentLevel},S.buildData=function(k){var f=this,p=k._id,V=f._rows;f._rowMap[p]=V.size(),V.add(k),f._levelMap[p]=f._currentLevel,f.isExpanded(k)&&(f._currentLevel++,f.buildChildren(k),f._currentLevel--)},S.buildChildren=function(N){var w=this,T=N?N._children:w._dataModel._roots,m=w.getCurrentSortFunc();m&&w.isChildrenSortable(N)?T.toList(w.isVisible,w).sort(m).each(w.buildData,w):T.each(function(R){w.isVisible(R)&&w.buildData(R)})},S.getLevel=function(x){return this._levelMap[x._id]},S.getToggleIcon=function(b){var I=this,y=I._loader,h=I._collapseIcon;return y&&!y.isLoaded(b)?h:b.hasChildren()?I.isExpanded(b)?I._expandIcon:h:Z},S.isCheckMode=function(){return this._checkMode!=Z},S.isChildrenSortable=function(){return!0},S.handleDataModelChange=function(p){var L=this;p.kind===nd?delete L._expandMap[p.data._id]:p.kind===Fh&&(L._expandMap={}),L.ivm()},S.toggle=function(j){var H=this;H.isExpanded(j)?H.collapse(j):H.expand(j)},S.isExpanded=function(N){return 1===this._expandMap[N._id]},S.expand=function(z){var J=this,h=J._loader;J.isExpanded(z)||(h&&!h.isLoaded(z)&&h.load(z),J._expandMap[z._id]=1,J.ivm(),J.onExpanded(z))},S.onExpanded=function(){},S.collapse=function(P){var M=this;M.isExpanded(P)&&(delete M._expandMap[P._id],M.ivm(),M.onCollapsed(P))},S.onCollapsed=function(){},S.expandAll=function(e){if(e)this.expand(e),e.eachChild(function(O){this.expandAll(O)},this);else{var V=this;V._dataModel.each(function(C){C.hasChildren()&&(V._expandMap[C._id]=1)}),V.ivm()}},S.collapseAll=function(){this._expandMap={},this.ivm()},S.makeVisible=function(y){if(y){var w=this;if(!w._rootData||y.isDescendantOf(w._rootData)){for(var B=y._parent;B;)w.expand(B),B=B._parent;w._23I=y,w.iv()}}},S.checkData=function(a){var u,j=this,l=j._checkMode,o=j.sm(),i=o.co(a);if(!o.sg()||!i){if(j._32o=1,l===aj)i?o.rs(a):o.as(a);else if(l===oj)u=new Nj(a),u.addAll(a._children);else if("descendant"===l)u=new Nj,yh(a,u);else if("all"===l&&(u=new Nj,yh(a,u),!i))for(var M=a._parent;M;)u.add(M),M=M._parent;u&&(i?o.rs(u):o.as(u)),delete j._32o}},S._97I=function(B,u,F,R,b,O,z){var e=this,i=e._indent,C=e._levelMap[u._id],L=e.getIconWidth(u),s=Uj(e.getToggleIcon(u));s?(R+=i*C,Pe(B,s,R+i/2,b+z/2,u,e),R+=i):R+=i*(C+1),e._checkMode&&(Pe(B,e.getCheckIcon(u),R+i/2,b+z/2,u,e),R+=i),e.drawIcon(B,u,R,b,L,z),e.drawLabel(B,u,R+L,b,z)}},Lc._14Q=function(f){f.getIcon=function(f){return f.getIcon()},f.getIconWidth=function(s){return this.getIcon(s)?this._indent:0},f.drawIcon=function(f,Z,p,Q,L,k){if(L){var U=this,o=U.getBodyColor(Z),F=Uj(U.getIcon(Z),o);F&&(k-=U.isRowLineVisible()?1:0,cj(f,F,Po,p,Q,L,k,Z,U,o),lk(f,U.getBorderColor(Z),p,Q,L,k))}},f.drawLabel=function(W,L,z,J,j){var f=this;xc(W,f.getLabel(L),f.getLabelFont(L),f.getLabelColor(L),z,J,0,j)}},Lc._50o=function(N){N._98I=function(){var Y=this,N=Y._39o=new rc;Y._60I=new Nj,N.mm(Y._17o,Y),N.md(Y._18o,Y),N.mh(Y._19o,Y)},N.setColumns=function(l){this._39o.clear(),this.addColumns(l)},N.addColumns=function(h){var U=this._39o;h.forEach(function(m){if(!(m instanceof Wn)){var Z=go(m.className);m=qs(Z?Z:Wn,m)}U.add(m)})},N.onColumnClicked=function(){},N.onCheckColumnClicked=function(){},N._3Q=function(k){for(var V,P=0,z=this._60I,q=z.size();q>P;P++)if(V=z.get(P),V.column===k)return V;return Z},N.getColumnAt=function(n){var p=this._4Q(n);return p?p.column:Z},N._4Q=function(B){for(var l=this,x=B.target?l.lp(B).x:B.x,N=l._60I,h=0;h<N.size();h++){var p=N.get(h),W=p.startX;if(x>=W&&x<W+p.column.getWidth())return p}return Z},N.getToolTip=function(o){var s=this,l=s.getDataAt(o),a=s.getColumnAt(o);return l&&a?a.getToolTip(l,s):Z},N.adjustTranslateX=function(L){var w=this.getWidth()-this._91I;return w>L&&(L=w),L>0?0:h(L)},N._99I=function(){var c=this,N=c._29I,u=c._60I;u.clear(),c._91I=0,c._39o._roots.each(function(I){if(I.isVisible()){var $=c._91I+I.getWidth();c._91I<=N.x+N.width&&$>=N.x&&u.add({column:I,startX:c._91I}),c._91I=$}}),c._91I+=c.getScrollBarSize()},N.drawData=function(T,Y,y){var m=this,B=m._rowHeight,R=B*y,s=m.isSelected(Y),b=m._29I,K=b.x,Z=b.width;m.drawRowBackground(T,Y,s,K,R,Z,B),m._60I.each(function(G){var J=G.column,r=G.startX,C=J.getWidth();C>0&&!m.isEditing(Y,J)&&(T.save(),T.beginPath(),T.rect(r,R,C,B),T.clip(),m._87o(m.drawCell(T,Y,s,J,r,R,C,B),y,r,R,C,B),m._columnLineVisible&&jq(T,r+C-1,R,1,B,m._columnLineColor),T.restore())}),m._rowLineVisible&&jq(T,K,R+B-1,Z,1,m._rowLineColor)},N.drawCell=function(N,j,l,u,C,x,K,E){var s=this;if(u.drawCell)return u.drawCell(N,j,l,u,C,x,K,E,s);var v=s.getValue(j,u);xm(N,v,u,s.getLabelFont(j,u,v),s.getLabelColor(j,u,v),C,x,K,E,j,s)},N.getColumnModel=function(){return this._39o},N._17o=function(){this.redraw()},N._18o=function(R){var C=this;R.data===C._sortColumn&&dk[R.property]?C.ivm():(C._42o(),C.redraw())},N._19o=function(){this.redraw()},N.getCurrentSortFunc=function(){var i=this,O=i._sortColumn;if(O&&O.isSortable()){var _=O.getSortFunc(),q=Ag===O.getSortOrder()?1:-1;return _||(_=dn),function(g,U){return _.call(i,i.getValue(g,O),i.getValue(U,O),g,U)*q}}return i._sortFunc},N.isCellEditable=function(p,F,r){return F.isEditable()&&this.isEditable()?F.isCellEditable?F.isCellEditable(p,F,r,this):!0:!1},N._37O=function(Q,X){if(Vi(X))for(var f=this,Z=f.lp(X),G=f._60I,a=f._rowHeight,s=f._29I,D=s.x,b=s.y,o=s.width,h=s.height,z=0;z<G.size();z++){var B=G.get(z),P=B.startX,U=B.column,u=U.getWidth();if(U!==f._31o&&U!==f._4o&&Z.x>=P&&Z.x<P+u&&f.isCellEditable(Q,U,X)){var $={x:P,y:f.getRowIndex(Q)*a,width:u,height:a},q={x:$.x+f.tx(),y:$.y+f.ty(),width:$.width,height:$.height},y=0,C=0;return $.x<D?y=$.x-D:$.x+$.width>D+o&&(y=$.x+$.width-D-o),y&&(f.tx(f.tx()-y),q.x-=y),$.y<b?C=$.y-b:$.y+a>b+h&&(C=$.y+a-b-h),C&&(f.ty(f.ty()-C),q.y-=C),f.beginEditing({data:Q,column:U,value:f.getValue(Q,U),event:X,rect:$,editorRect:q,view:f}),void 0}}}},Le.BaseItemEditor=function(F,Z,A,e){this._data=F,this._column=Z,this._master=A,this._editInfo=e},ro("BaseItemEditor",Y,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var wl=a.Tab=function(){$f(wl,this)};En("Tab",ob,{ms_ac:["view","closable","disabled","visible"],_icon:Z,_closable:!1,_disabled:!1,_visible:!0,setParent:eg});var Wn=a.Column=function(){$f(Wn,this)};En("Column",ob,{_46o:1,ms_ac:["accessType","valueType",Gj,Mn,ei,fk,"align",ee,"sortOrder",Yc,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Ag,_sortFunc:Z,_sortable:!0,_clickable:!0,setWidth:function(D){16>D&&(D=16);var F=this._width;this._width=D,this.fp(fk,F,D)},getToolTip:function(P,T){return this.formatValue(T.getValue(P,this))}});var Bh=a.Property=function(){$f(Bh,this)};En("Property",ob,{_46o:1,ms_ac:["accessType","valueType",Mn,ei,"categoryName",ee,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:Z,getToolTip:function(z,l,J){var r=this;return l?r.formatValue(J.getValue(z,r)):J.getPropertyName(r)}}),Le.AccordionView=function(){var T=this;T._20o={},T._21o=new Nj,T._10o=Z,T._9o=Z,T._11o=Z,T._view=Wm(0,T),T.iv()},ro("AccordionView",Y,{ms_v:1,ms_fire:1,ms_ac:[kf,Ql,"titleHeight",Yr,Pg,"titleBackground","selectWidth",Dh,"orientation","separatorColor"],_expandIcon:A.accordionViewExpandIcon,_collapseIcon:A.accordionViewCollapseIcon,_titleHeight:Hj,_labelColor:A.accordionViewLabelColor,_labelFont:A.accordionViewLabelFont,_titleBackground:A.accordionViewTitleBackground,_selectBackground:A.accordionViewSelectBackground,_selectWidth:A.accordionViewSelectWidth,_orientation:"v",_separatorColor:A.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(Z,d,S,W){var u=this,G=Sr(),p={content:d,div:G,canvas:uh(G),icon:W};if(u._20o[Z])throw Z+" already exists";var D=p.downEventFunc=function(b){td(b)},A=p.upEventFunc=function(L){td(L),Vi(L)&&(u._10o===Z?u.collapse():u.expand(Z))};[tb,Jq].forEach(function(o){T(G,o,D)}),[Xk,qr].forEach(function(x){T(G,x,A)}),G.style.cursor=Yp,Jp(u._view,G),u._20o[Z]=p,u._21o.add(Z),S&&u.expand(Z),u.iv()},remove:function(k){var W=this,I=W._20o[k];if(I){var V=I.div;pf(V),[tb,Jq].forEach(function(x){K(V,x,I.downEventFunc)}),[Xk,qr].forEach(function(T){K(V,T,I.upEventFunc)}),delete W._20o[k],W._21o.remove(k),W.iv()}},clear:function(){var L=this;L._21o.toArray().forEach(L.remove,L),L._20o={},L._21o.clear(),L.iv()},isExpanded:function(v){return this._10o===v},expand:function(x){var F=this;F._20o[x]&&F._10o!==x&&(F._10o=x,F.onExpanded(x),F.iv())},onExpanded:function(){},collapse:function(){var r=this;r._10o&&(r.onCollapsed(r._10o),delete r._10o,r.iv())},onCollapsed:function(){},initCanvas:function(h,e,X){wg(h,e,X);var N=qq(h);return hb(N,0,0,1),N.clearRect(0,0,e,X),N},drawTitle:function(W,Z,I,K,D){var y=this,S=Uj(D.icon),r=y.isExpanded(Z),h=y._titleHeight,B=y._titleBackground,m=y._selectWidth,v=y._separatorColor,R=Uj(r?y._expandIcon:y._collapseIcon),f=m+4;jq(W,0,0,I,K,B),r&&m&&jq(W,0,0,m,K,y._selectBackground),(r||y._21o.get(y._21o.size()-1)!==Z)&&jq(W,0,K-1,I,1,v?v:Bo(B)),S&&(Pe(W,S,f+ab(S)/2,h/2),f+=ab(S)+2),xc(W,Z,y.getLabelFont(Z),y.getLabelColor(Z),f,0,0,h),R&&Pe(W,R,I-ab(R)/2-4,h/2)},validateImpl:function(){var z=this,D=z._view,F=0,K=0,Y=z.getWidth(),q=z.getHeight(),e=z._titleHeight,G=z._21o.size()*e,k=z._11o,d=z._9o;delete z._11o,delete z._9o,z._21o.each(function(r){var U,R,w=z._20o[r],M=w.content,o=z._10o===r;sh(z)?(Vn(w.div,F,0,e,q),U=z.initCanvas(w.canvas,e,q),Yf(U,0,q),cr(U,-x),z.drawTitle(U,r,q,e,w),U.restore(),o?(R=j(0,Y-G),M&&(z._11o=M,z._9o=Kl(M),Vn(M,F+e,0,R,q)),F+=e+R):F+=e):(Vn(w.div,0,K,Y,e),U=z.initCanvas(w.canvas,Y,e),z.drawTitle(U,r,Y,e,w),U.restore(),o?(R=j(0,q-G),M&&(z._11o=M,z._9o=Kl(M),Vn(M,0,K+e,Y,R)),K+=e+R):K+=e)});var p=z._9o;k&&k!==z._11o&&k.endEditing&&k.endEditing(),p&&p!==d&&Jp(D,p),d&&d!==p&&pf(d)}}),Le.SplitView=function(E,Y,i,p){var s=this,S=s._dividerDiv=Sr(),N=s._60O=uh(),n=s._61O=uh(),g=N.style,o=n.style;s._view=Wm(1,s),Jp(s._view,S),g.msTouchAction=Wc,g.pointerEvents=Wc,g.cursor=Yp,o.msTouchAction=Wc,o.pointerEvents=Wc,o.cursor=Yp,E&&s.setLeftView(E),Y&&s.setRightView(Y),i&&s.setOrientation(i),p!=Z&&s.setPosition(p),s.setStatus(Xh),new xr(s)},ro("SplitView",Y,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:A.splitViewDividerSize,_dividerBackground:A.splitViewDividerBackground,_dragOpacity:A.splitViewDragOpacity,_toggleIcon:A.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(f,C){var x=this,H=x._position;isNaN(f)||(C||(x._82O=0>f?-1:f>1?1:0),x._position=f,x.fp(fh,H,f))},getLeftView:function(){return this._leftView},setLeftView:function(N){var t=this,f=t._leftView,n=t._view;if(t._leftView!==N){if(f&&f!==t._rightView){var o=Kl(f);o.parentNode===n&&pf(o)}if(t._leftView=N,N){var v=Kl(N);v.parentNode!==n&&n.insertBefore(v,t._dividerDiv)}t.fp("leftView",f,N)}},getRightView:function(){return this._rightView},setRightView:function(T){var $=this,G=$._rightView,o=$._view;if($._rightView!==T){if(G&&G!==$._leftView){var f=Kl(G);f.parentNode===o&&pf(f)}if($._rightView=T,T){var P=Kl(T);P.parentNode!==o&&o.insertBefore(P,$._dividerDiv)}$.fp("rightView",G,T)}},validateImpl:function(){var Q=this,l=Q._draggable,H=Q._position,c=Q.getWidth(),u=Q.getHeight(),t=Q._dividerSize,y=Q._dividerBackground,X=ng?18:8,N=Q._dividerDiv,z=Q._82O,e=Q._60O,g=Q._61O,O=Q._toggleIcon,F=Q._status,A=N.style,T=null,U=ng?20:4,P=O.comps[0];t>=X||0===t?Q._coverDiv&&(pf(Q._coverDiv),delete Q._coverDiv):Q._coverDiv||(Q._coverDiv=Sr(),Fj&&(Q._coverDiv.style.background=dm),Jp(N,Q._coverDiv)),Q._togglable?e.parentNode||(Jp(N,e),Jp(N,g)):(pf(e),pf(g));var o=Q._coverDiv,w=Q._leftView,J=Q._rightView;if(sh(Q)){if(t>c&&(t=c),F===Xh)if(1===z)var r=C(H,c),Y=j(0,c-t-r);else-1===z?(Y=C(-H,c),r=j(0,c-t-Y)):(r=h((c-t)*H),Y=j(0,c-t-r));else"cl"===F?(r=0,Y=j(0,c-t)):"cr"===F&&(Y=0,r=j(0,c-t));w&&Vn(w,0,0,r,u),J&&Vn(J,r+t,0,Y,u),Vn(N,r,0,t,u),Q._22o=r,o&&(Vn(o,t/2-X/2,0,X,u),o.style.cursor=l?fc:""),N.style.cursor=l?fc:"";var v=N.clientHeight/2,K=N.clientWidth;wg(e,K,K),Vn(e,0,v-K-U,K,K),T=qq(e),hb(T,0,0,1),P.rotation=-x,nn(T,O,0,0,K,K),T.restore(),wg(g,K,K),Vn(g,0,v+U,K,K),T=qq(g),hb(T,0,0,1),P.rotation=x,nn(T,O,0,0,K,K),T.restore()}else{if(t>u&&(t=u),F===Xh)if(1===z)var q=C(H,u),k=j(0,u-t-q);else-1===z?(k=C(-H,u),q=j(0,u-t-k)):(q=h((u-t)*H),k=j(0,u-t-q));else"cl"===F?(q=0,k=j(0,u-t)):"cr"===F&&(k=0,q=j(0,u-t));w&&Vn(w,0,0,c,q),J&&Vn(J,0,q+t,c,k),Vn(N,0,q,c,t),Q._22o=q,o&&(Vn(o,0,t/2-X/2,c,X),o.style.cursor=l?Pb:""),A.cursor=l?Pb:"";var R=N.clientWidth/2,K=N.clientHeight;wg(e,K,K),Vn(e,R-K-U,0,K,K),T=qq(e),hb(T,0,0,1),P.rotation=0,nn(T,O,0,0,K,K),T.restore(),wg(g,K,K),Vn(g,R+U,0,K,K),T=qq(g),hb(T,0,0,1),P.rotation=i,nn(T,O,0,0,K,K),T.restore()}A.background=y}});var xr=function($){this.sv=$,this.addListeners()};Im(xr,Y,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(c){var i=this,r=i.sv,Y=r._dividerDiv,W=r._60O,S=r._61O,d=r._status,F=c.target;if(F===W)d===Xh?r.setStatus("cl"):"cr"===d&&r.setStatus(Xh);else if(F===S)d===Xh?r.setStatus("cr"):"cl"===d&&r.setStatus(Xh);else if(th(c)&&(F===Y||F===r._coverDiv)&&(td(c),r.isDraggable())){r.getLeftView(),r.getRightView();var n=i.maskDiv=Sr();if(n.style.left=0,n.style.top=0,n.style.width=r.getWidth()+"px",n.style.height=r.getHeight()+"px",r.getView().appendChild(n),!r.isContinuousLayout()){var j=i.resizeDiv=Sr();j.style.left=Y.style.left,j.style.top=Y.style.top,j.style.width=Y.style.width,j.style.height=Y.style.height,j.style.opacity=r.getDragOpacity(),j.style.background=r.getDividerBackground(),Jp(i.getView(),j)}i._lastAbsPosition=r._22o,i._86o=sh(r)?zn(c).x:zn(c).y,Oi(i,c)}},handleWindowTouchMove:function(j){th(j)&&this.update(j,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(D){var C=this;C.update(D,!0),C.sv.setStatus(Xh),C.maskDiv&&pf(C.maskDiv),C.resizeDiv&&pf(C.resizeDiv),C.maskDiv=C.resizeDiv=Z},handle_mousedown:function(s){Vi(s)&&this.handle_touchstart(s)},handleWindowMouseMove:function(h){this.handleWindowTouchMove(h)},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},update:function(R,L){var t=this,k=t.sv,z=sh(k)?k.getWidth():k.getHeight(),O=k._dividerSize,E=t._lastAbsPosition-t._86o;sh(k)?(E+=zn(R).x,E>z-O&&(E=z-O),0>E&&(E=0),t.resizeDiv&&(t.resizeDiv.style.left=E+Bd)):(E+=zn(R).y,E>z-O&&(E=z-O),0>E&&(E=0),t.resizeDiv&&(t.resizeDiv.style.top=E+Bd)),L&&z!==O&&(1===k._82O?k.setPosition(E,1):-1===k._82O?k.setPosition(E-z+O,1):k.setPosition(E/(z-O),1))}}),Le.TabView=function(){var N=this,U=N._view=Wm(1,N),Q=N._91O=Sr(1),w=N._tabModel=new rc,K=w.sm(),W=N.invalidate;N._7o=new Nj,N._canvas=uh(Q),Jp(U,Q),Jp(U,N._92O=Sr(1)),K.setSelectionMode(Yh),K.ms(N.handleSelectionChange,N),w.mm(W,N),w.mh(W,N),w.md(W,N),N._interactor=new Bs(N),N.iv()},ro("TabView",Y,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Yr,Pg,"tabHPadding","tabBackground","selectWidth",Dh,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Uh,_tabHeight:Hj,_tabGap:A.tabViewTabGap,_labelColor:A.tabViewLabelColor,_labelFont:A.tabViewLabelFont,_tabBackground:A.tabViewTabBackground,_selectWidth:A.tabViewSelectWidth,_selectBackground:A.tabViewSelectBackground,_moveBackground:A.tabViewMoveBackground,_insertColor:A.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(b,D,F){var x,z=this._tabModel;return b instanceof wl?(x=b,D&&x.setView(D)):(x=new wl,x.setName(b),x.setView(D)),z.add(x),F&&z.sm().ss(x),x},getLabel:function(h){return h.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(J){this._23o=J,this.iv()},get:function(X){var V=this,o=V._tabModel;if(gh(X))return o._roots.get(X);if(tk(X)){var Q;return o.each(function(n){X===V.getLabel(n)&&(Q=n)}),Q}return X instanceof wl?X:Z},select:function(f){this._tabModel.sm().ss(this.get(f))},remove:function(U){var T=this;if(U=T.get(U)){var F=T._tabModel,W=F._roots.indexOf(U);T._tabModel.remove(U),T.selectByIndex(--W)}},getCurrentTab:function(){return this._8o},hideTabView:function(n,I){I.parentNode===this._92O&&(Ah(I)?(I.style.display=rg,I._tab_=n):pf(I),Kp())},showTabView:function(e,K){Ah(K)&&(K.style.display="block",K._tab_=e),K.parentNode!==this._92O&&(Jp(this._92O,K),Kp())},_24o:function(){var F,Y=this,W=Y._8o,T=Y._9o,A=Y._tabModel.sm().ld();A&&(F=Kl(A.getView())),F!==T&&(T&&(W.getView()&&W.getView().endEditing&&W.getView().endEditing(),Y.hideTabView(W,T)),F&&Y.showTabView(A,F)),Y._8o=A,Y._9o=F,W!==A&&Y.onTabChanged(W,A)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(g,Y){this.selectByIndex(--Y)
        },selectByIndex:function(M){var K=this,E=K._tabModel,U=E.size();if(U&&!E.sm().ld()){M==Z&&(M=0),M>=U&&(M=U-1),0>M&&(M=0);for(var p=M;p>=0;p--){var n=K.get(p);if(!n.isDisabled())return K.select(n),n}for(p=M+1;U>p;p++)if(n=K.get(p),!n.isDisabled())return K.select(n),n}},getTabWidth:function(x){var p=this.getTabHPadding(),W=4+2*p,e=Uj(x.getIcon());e&&(W+=ab(e,x)+4);var j=this.getLabel(x);return j&&(W+=hh(this.getLabelFont(x),j).width+4),x.isClosable()&&(W+=10),W},drawTab:function(D,H,g,F,a,c,U){var e,q=this,T=q._tabPosition,E=this.getTabHPadding(),N=g+4+E,m=q._selectWidth,_=Uj(H.getIcon()),l=H.isDisabled(),K=q.getLabelColor(H),X=q.getLabelFont(H),j=q.getLabel(H),P=q._selectBackground,Y=T===Bc+"-vertical",O=T===qe+"-vertical";(Y||O)&&(N=F+4+E),l&&(D.globalAlpha=Ph),jq(D,g,F,a,c,U),H===q._8o&&m&&(T===Uh?jq(D,g,F+c-m,a,m,P):T===Bc?jq(D,g+a-m,F,m,c,P):T===qe?jq(D,g,F,m,c,P):Y?jq(D,g+a-m,F,m,c,P):O?jq(D,g,F,m,c,P):jq(D,g,F,a,m,P));var $=a/2;if(Y&&(Yf(D,$,F+c/2),cr(D,i),Yf(D,-$,-F-c/2)),_){var z=kn(_,H),G=ab(_,H);if(Y||O){var V=g+a/2,Q=N+z/2;Yf(D,V,Q),cr(D,x),Yf(D,-V,-Q),Pe(D,_,g+a/2,N+z/2,H,q),Yf(D,V,Q),cr(D,-x),Yf(D,-V,-Q),N+=z+4}else Pe(D,_,N+G/2,F+c/2,H,q),N+=G+4}return Y||O?(Yf(D,a/2,N+a/2),cr(D,x),Yf(D,-a/2,-N-a/2),xc(D,j,X,K,g,N,c,a),Yf(D,a/2,N+a/2),cr(D,-x),Yf(D,-a/2,-N-a/2)):xc(D,j,X,K,N,F,a,c),Y&&(Yf(D,$,F+c/2),cr(D,-i),Yf(D,-$,-F-c/2)),H.isClosable()&&(e=O?{x:g+a-12,y:F+c-12,width:12,height:12}:{x:g+a-12,y:F+2,width:12,height:12},this.drawCloseIcon(H,D,K,e)),l&&(D.globalAlpha=1),e},drawCloseIcon:function(E,Z,F,W){var A=W.x,X=W.y;Z.strokeStyle=F,Z.lineWidth=1,Z.beginPath(),Z.moveTo(A+2,X+8),Z.lineTo(A+8,X+2),Z.moveTo(A+8,X+8),Z.lineTo(A+2,X+2),Z.stroke()},getTabAt:function(w){var k=this._interactor._8Q(w);return k?k.tab:null},validateImpl:function(){var R=this;R._24o();var L,m=R._canvas,d=R._tabPosition,l=R._91O,z=R._92O,i=R._tabModel,M=R.getWidth(),r=R.getHeight(),y=R._tabHeight,G=R._7o,A=R._tabGap,B=d===Uh,c=d===Bc,F=d===qe,o=d===Bc+"-vertical",J=d===qe+"-vertical",C=R._23o,q=0;if((c||F)&&i._roots.each(function(N){q=j(R.getTabWidth(N),q)}),B?(Vn(l,0,0,M,y),L={x:0,y:y,width:M,height:j(0,r-y)}):c?(Vn(l,0,0,q,r),L={x:q,y:0,width:j(0,M-q),height:r}):F?(Vn(l,M-q,0,q,r),L={x:0,y:0,width:j(0,M-q),height:r}):o?(Vn(l,0,0,y,r),L={x:y,y:0,width:j(0,M-y),height:r}):J?(Vn(l,M-y,0,y,r),L={x:0,y:0,width:j(0,M-y),height:r}):(Vn(l,0,r-y,M,y),L={x:0,y:0,width:M,height:j(0,r-y)}),Vn(z,L),o||J){R._9o&&(L.x=0,Vn(R._8o.getView(),L)),wg(m,y,r);var $=qq(m),K=0;if(hb($,0,R.ty(),1),$.clearRect(0,0,y,r),G.clear(),i._roots.each(function(U){if(U.isVisible()){var p,f=R.getTabWidth(U);C&&C.tab===U||(p=R.drawTab($,U,0,K,y,f,R._tabBackground)),G.add({_75o:p,tab:U,startY:K,endY:K+f,height:f}),K+=f+A}}),R._23Q=j(0,K-A),C){var S=C.position;R.drawTab($,C.tab,0,C.startY,y,C.height,R._moveBackground),jq($,0,S,y,1,R._insertColor)}if($.restore(),R._selectionChanged){R._selectionChanged=!1;for(var u=R.ty(),g=0;g<G.size();g++){var Y=G.get(g);if(Y.tab===R._8o){if(Y.endY+u<0){R.ty(-Y.startY);break}if(Y.startY+u>r){R.ty(r-Y.endY);break}}}}R.ty(R.ty())}else if(c||F){R._9o&&(L.x=0,Vn(R._8o.getView(),L)),wg(m,q,r);var $=qq(m),K=0;if(hb($,0,R.ty(),1),$.clearRect(0,0,q,r),G.clear(),i._roots.each(function(u){if(u.isVisible()){var i;C&&C.tab===u||(i=R.drawTab($,u,0,K,q,y,R._tabBackground)),G.add({_75o:i,tab:u,startY:K,endY:K+y,height:y}),K+=y+A}}),R._23Q=j(0,K-A),C){var S=C.position;R.drawTab($,C.tab,0,C.startY,q,C.height,R._moveBackground),jq($,0,S,q,1,R._insertColor)}if($.restore(),R._selectionChanged){R._selectionChanged=!1;for(var u=R.ty(),g=0;g<G.size();g++){var Y=G.get(g);if(Y.tab===R._8o){if(Y.endY+u<0){R.ty(-Y.startY);break}if(Y.startY+u>r){R.ty(r-Y.endY);break}}}}R.ty(R.ty())}else{R._9o&&(L.y=0,Vn(R._8o.getView(),L)),wg(m,M,y);var $=qq(m),E=0;if(hb($,R.tx(),0,1),$.clearRect(0,0,M,y),G.clear(),i._roots.each(function(e){if(e.isVisible()){var r,Q=R.getTabWidth(e);C&&C.tab===e||(r=R.drawTab($,e,E,0,Q,y,R._tabBackground)),G.add({_75o:r,tab:e,startX:E,endX:E+Q,width:Q}),E+=Q+A}}),R._64I=j(0,E-A),C){var S=C.position;R.drawTab($,C.tab,C.startX,0,C.width,y,R._moveBackground),ii($,R._insertColor,S,0,y)}if($.restore(),R._selectionChanged){R._selectionChanged=!1;for(var t=R.tx(),g=0;g<G.size();g++){var Y=G.get(g);if(Y.tab===R._8o){if(Y.endX+t<0){R.tx(-Y.startX);break}if(Y.startX+t>M){R.tx(M-Y.endX);break}}}}R.tx(R.tx())}for(var U=[],e=z.children,g=0;g<e.length;g++){var T=e[g],x=T._tab_;x&&!i.contains(x)&&U.push(T)}U.forEach(function(h){z.removeChild(h)})}});var Bs=function(z){this.tv=z,this.addListeners()};Im(Bs,Y,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(C){this.handleScroll(C,10*(C.wheelDelta/40))},handle_DOMMouseScroll:function(_){this.handleScroll(_,10*-_.detail)},handleScroll:function(y,N){td(y);var g=this.tv,G=g._tabPosition;!g._40o()||G!==Uh&&G!==Tg||g.tx(this.tv.tx()+N),!g._41o()||G!==Bc&&G!==qe&&G!==Bc+"-vertical"&&G!==qe+"-vertical"||g.ty(this.tv.ty()+N)},_8Q:function(r){var w,H,Y=this.tv,A=Y._tabPosition,d=Y._7o;if(A===Uh||A===Tg){var Q=Y.lp(r).x;for(w=0;w<d.size();w++)if(H=d.get(w),H.startX<=Q&&Q<=H.endX)return H}else if(A===Bc||A===qe||A===Bc+"-vertical"||A===qe+"-vertical"){var N=Y.lp(r).y;for(w=0;w<d.size();w++)if(H=d.get(w),H.startY<=N&&N<=H.endY)return H}return Z},isClickable:function(W){var V=this.tv,r=V._tabPosition,I=this._73o=this._8Q(W);return!V._40o()||r!==Uh&&r!==Tg?!V._41o()||r!==Bc&&r!==qe&&r!==Bc+"-vertical"&&r!==qe+"-vertical"?I&&(!I.tab.isDisabled()||V.isMovable()):!0:!0},handle_mousemove:function(G){var I=this;Xm?I._74o=I._8Q(G):I.getView().style.cursor=I.isClickable(G)?Yp:""},handle_mousedown:function(g){this.handle_mousemove(g),this.handle_touchstart(g)},handle_touchstart:function(R){var Z=this,d=Z.tv,$=d._tabPosition;td(R),Vi(R)&&Z.isClickable(R)&&($===Uh||$===Tg?(Z.x=zn(R).x,Z.lp=d.lp(R),Z.tx=d.tx()):(Z.y=zn(R).y,Z.lp=d.lp(R),Z.ty=d.ty()),Oi(Z,R))},handleWindowMouseMove:function(U){this.handleWindowTouchMove(U)},handleWindowTouchMove:function(f){var G,e=this,Z=e.tv,u=Z._tabPosition,$=e._73o;if(u===Uh||u===Tg){if(G=zn(f).x-e.x,!e._25o&&!e.moving&&t(G)>2&&(Z._40o()&&!oe(f)?e._25o=1:$&&Z.isMovable()&&(e.moving=1)),e._25o)Z.tx(e.tx+G);else if(e.moving){var B=e.lp.x+G,s=Z._tabGap/2;Z._7o.each(function(i){var X=i.endX,N=B-i.startX<X-B;B>=i.startX&&X>=B&&Z._7Q({tab:$.tab,startX:$.startX+G,width:$.width,front:N,insertTab:i.tab,position:N?j(0,i.startX-s):C(Z._64I,X+s)})})}}else if(G=zn(f).y-e.y,!e._25o&&!e.moving&&t(G)>2&&(Z._41o()&&!oe(f)?e._25o=1:$&&Z.isMovable()&&(e.moving=1)),e._25o)Z.ty(e.ty+G);else if(e.moving){var c=e.lp.y+G,s=Z._tabGap/2;Z._7o.each(function(M){var t=M.endY,v=c-M.startY<t-c;c>=M.startY&&t>=c&&Z._7Q({tab:$.tab,startY:$.startY+G,height:$.height,front:v,insertTab:M.tab,position:v?j(0,M.startY-s):C(Z._23Q,t+s)})})}},handleWindowMouseUp:function(i){this.handleWindowTouchEnd(i)},handleWindowTouchEnd:function(){var k=this,Y=k.tv,d=Y._tabPosition,G=Y.getTabModel(),V=G._roots,D=k._73o;if(k.moving){var m=Y._23o;if(m&&m.insertTab!==m.tab){var O=m.tab,U=V.remove(O),q=V.indexOf(m.insertTab);q>=0&&(m.front||q++,q<=V.size()&&(V.add(O,q),G._38I(O,U,q)))}Y._7Q(Z),delete k.moving}else if(!k._25o&&D){O=D.tab;var T=k._74o;if(!T||T.tab===O)if(!O.isDisabled()&&or(D._75o,k.lp)){var z=function(){var c=V.indexOf(O);G.remove(O),Y.onTabClosed(O,c)};Y.onTabClosing(O,z)&&z()}else O.isDisabled()||Y._8o===O||G.sm().ss(O)}k._25o=k._73o=k._74o=d===Uh||d===Tg?k.x=k.lp=k.tx=Z:k.y=k.lp=k.ty=Z}}),Le.PropertyView=function(n){var m=this;m._view=Wm(1,m),m._canvas=uh(m._view),Jp(m._view,m._79O=Sr()),m._rows=new Nj,m._28o=new Nj,m._26o={},m._26Q={};var c=m._propertyModel=new rc,W=m.ivm;c.mm(W,m),c.md(W,m),c.mh(W,m),m.dm(n?n:new rc),new Ki(m)},ro("PropertyView",Y,{ms_ac:[Yr,$n,Pg,Mn,ei,"categorizable",bi,Yc,re,kf,Ql,dr,Om,Nl,"selectRowIndex",Dh,"background",Th,Zg,lm,rj,fd],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:oo,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:tg,_background:A.propertyViewBackground,_expandIcon:A.propertyViewExpandIcon,_collapseIcon:A.propertyViewCollapseIcon,_scrollBarColor:Tc,_scrollBarSize:Tl,_autoHideScrollBar:vg,_selectBackground:A.propertyViewSelectBackground,_rowHeight:ve,_rowLineVisible:A.propertyViewRowLineVisible,_rowLineColor:A.propertyViewRowLineColor,_10I:.5,_columnLineVisible:A.propertyViewColumnLineVisible,_columnLineColor:A.propertyViewColumnLineColor,_labelColor:A.propertyViewLabelColor,_labelSelectColor:A.propertyViewLabelSelectColor,_labelFont:A.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function($){0>$&&($=0),$>1&&($=1);var q=this,Q=q._10I;q._10I=$,q.fp("columnPosition",Q,$)},getPropertyName:function(C){return C.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(s,b,S){return S===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(m,q){return q===this._selectRowIndex?this._labelSelectColor:m.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(s){var w=this.getHeight()-this._59I;return w>s&&(s=w),s>0?0:h(s)},isExpanded:function(n){if(!n)return!0;var W=this._26o[n];return W?W.isExpanded:!(this._26Q[n]===!1)},toggle:function(m){var n=this;n.isExpanded(m)?n.collapse(m):n.expand(m)},expandAll:function(){this.validate();for(var i in this._26o)this.expand(i)},expand:function(I){if(I&&I!==rg){var y=this,k=y._26o[I];k&&!k.isExpanded&&(k.isExpanded=!0,y.onExpanded(I),y.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var u in this._26o)this.collapse(u)},collapse:function(O){if(O&&O!==rg){var u=this,p=u._26o[O];p&&p.isExpanded&&(p.isExpanded=!1,u.onCollapsed(O),u.ivm())}},onCollapsed:function(){},getCategoryName:function(n){if(!this.isCategorizable())return rg;var K=n.getCategoryName();return K?K:rg},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(M){var L=this,E=L._dataModel;E!==M&&(E&&(E.umd(L.handlePropertyChange,L),L._selectionModel||E.sm().ums(L.handleSelectionChange,L)),L._dataModel=M,M.md(L.handlePropertyChange,L),L._selectionModel?L._selectionModel._21I(M):M.sm().ms(L.handleSelectionChange,L),L.fp(Mr,E,M))},isVisible:function(o){return this._visibleFunc?this._visibleFunc(o):!0},onPropertyChanged:function(U){var H=this,e=U.property;Pl[e]?H.ivm():H.iv(),e===Sl&&H._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:el},handlePropertyChange:function(I){this._27o===I.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var o=this;o._96I||(o.setSelectRowIndex(-1),o._96I=1,o.iv())},redraw:function(){this.iv()},validateModel:function(){var E=this,c=E._rows,s=E._28o,M={},q=new Nj,Q=E._27o;E.updateCurrentData(),Q!==E._27o&&E.endEditing(),c.clear(),s.clear(),E.getRawProperties().each(function(T){if(E.isVisible(T)){q.add(T);var z=E.getCategoryName(T);M[z]||(s.add(z,z===rg?0:l),M[z]={isExpanded:E.isExpanded(z),properties:new Nj})}}),E._sortFunc&&q.sort(E._sortFunc);for(var a in E._26o)E._26Q[a]=E.isExpanded(a);E._26o=M,s.each(function(u){u!==rg&&c.add(u);var l=M[u];l.isExpanded&&q.each(function(q){E.getCategoryName(q)===u&&(l.properties.add(q),c.add({property:q,data:E._27o}))},E)})},validateImpl:function(){var e=this;e._76o(),e._96I&&(e.validateModel(),delete e._96I);var k=e._canvas,D=e.getWidth(),i=e.getHeight(),F=-e.ty(),m=e._rowHeight,c=e._indent,P=D-c,Y=e._rows,X=Y.size(),d=e._9I=c+P*e._10I,z=e._59I=X*m;wg(k,D,i),e._29I={x:0,y:F,width:D,height:i},e._31I=H(F/m),e._14I=p((F+i)/m),e._31I<0&&(e._31I=0),e._14I>X&&(e._14I=X);var N,M=qq(k),o=e._background;hb(M,0,-F,1),M.beginPath(),M.rect(0,F,D,i),M.clip(),M.clearRect(0,F,D,i),e._93db(M),o&&jq(M,0,0,c,z,o);for(var E=e._31I;E<e._14I;E++){var x=Y.get(E),F=m*E;if(tk(x))o&&jq(M,c,F,P,m,o),N=Uj(e.isExpanded(x)?e._expandIcon:e._collapseIcon),N&&cj(M,N,Po,0,F,c,m),M.save(),M.beginPath(),M.rect(c,F,P,m),M.clip(),e.drawCategoryName(M,x,E,c,F,P,m),M.restore();else{var r=x.property,C=x.data,N=Uj(r.getIcon()),t=e._selectRowIndex===E?e.getSelectBackground():Z;if(N&&cj(M,N,Po,0,F,c,m),t&&jq(M,c,F,P,m,t),M.save(),M.beginPath(),M.rect(c,F,d-c,m),M.clip(),e.drawPropertyName(M,r,E,c,F,d-c,m),M.restore(),!e.isEditing(C,r)){var R=d+1,j=D-d-1;M.save(),M.beginPath(),M.rect(R,F,j,m),M.clip(),e._87o(e.drawPropertyValue(M,r,e.getValue(C,r),E,R,F,j,m,C),E,R,F,j,m),M.restore()}}e._rowLineVisible&&jq(M,c,F+m-1,P,1,e._rowLineColor)}e._columnLineVisible&&(jq(M,d,0,1,z,e._columnLineColor),jq(M,D-1,0,1,z)),e._92db(M),e._93I(),M.restore(),e.ty(e.ty())},drawCategoryName:function(t,u,I,v,B,K,l){xc(t,u,this.getCategoryFont(u),this.getCategoryColor(u),v,B,K,l)},drawPropertyName:function(C,e,_,E,c,U,k){return e.drawPropertyName?(e.drawPropertyName(C,e,_,E,c,U,k,this),void 0):(xc(C,this.getPropertyName(e),this.getPropertyFont(e,_),this.getPropertyColor(e,_),E,c,U,k),void 0)},drawPropertyValue:function(g,b,o,z,V,c,x,$,Z){return b.drawPropertyValue?b.drawPropertyValue(g,b,o,z,V,c,x,$,Z,this):(xm(g,o,b,this.getLabelFont(b,o,z),this.getLabelColor(b,o,z),V,c,x,$,Z,this),void 0)},isPropertyEditable:function(E){return E.isEditable()&&this.isEditable()},setProperties:function(B){this._propertyModel.clear(),this.addProperties(B)},addProperties:function(W){if(W){var L=this._propertyModel;W.forEach(function(i){if(!(i instanceof Bh)){var x=go(i.className);i=qs(x?x:Bh,i)}L.add(i)})}},getRowIndexAt:function(n){var h=this,y=H(h.lp(n).y/h._rowHeight);return y>=0&&y<h._rows.size()?y:-1},getPropertyAt:function(W){var d=this,i=d.getRowIndexAt(W);return i>=0?d._rows.get(i).property:Z},getToolTip:function($){var r=this,D=r.getPropertyAt($),f=r._27o;return D&&f?D.getToolTip(f,r._9I<r.lp($).x,r):Z}});var Ki=function(L){this.pv=L,this.addListeners()};Im(Ki,Y,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(l){this.getView().style.cursor=l},clear:function(){var P=this;P._62O=P.cp=P.ty=P.p=Z,P.setCursor(aj)},handle_mousedown:function(H){this.handle_touchstart(H)},handle_touchstart:function(r){var L=this,J=L.pv;td(r),J.setFocus(r)&&(Vi(r)?(L.cp=zn(r),L.ty=J.ty(),L.p=J.getColumnPosition(),L.handle_touchmove(r)):J.setSelectRowIndex(J.getRowIndexAt(r)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(b){this.handle_touchend(b)},handle_touchend:function(f){var X=this;if(X.cp&&!X._62O){var R=X.pv,G=R.lp(f),x=G.x,Q=G.y,L=R._indent,t=R.getRowIndexAt(f),U=R._9I;if(t>=0){var s=R._rowHeight,$=s*t,P=R._rows.get(t),Z=P.property;if(tk(P))Uj(R.isExpanded(P)?R._expandIcon:R._collapseIcon)&&x>=0&&L>=x&&Q>=$&&$+s>=Q?R.toggle(P):Ko(f)&&R.toggle(P);else if(x>U&&R.isPropertyEditable(Z,f)){var l={x:U+1,y:$,width:R.getWidth()-U-1,height:s},O={x:l.x+R.tx(),y:l.y+R.ty(),width:l.width,height:l.height},j=0,c=R._29I;l.y<c.y?j=l.y-c.y:l.y+s>c.y+c.height&&(j=l.y+s-c.y-c.height),j&&(R.ty(R.ty()-j),O.y-=j),R.beginEditing({data:P.data,property:Z,value:R.getValue(P.data,Z),event:f,rect:l,editorRect:O,view:R})}}R.setSelectRowIndex(t)}X.clear()},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(q){var e=this,W=e.pv,y=e.ty,B=e.cp,A=zn(q),O=e._62O;if("p"===O)W.setTranslateY(y+A.y-B.y);else if("c"===O){var z=W.getWidth()-W._indent;if(z>16){var l=e.p-(B.x-A.x)/z,$=16/z;$>l&&(l=$),l>1-$&&(l=1-$),W.setColumnPosition(l)}}else"s"===O&&W.setTranslateY(y+(B.y-A.y)*W._59I/W._29I.height)},handle_mousemove:function(w){this.handle_touchmove(w)},handle_touchmove:function(F){if(!Xm&&Vi(F)){var q=this,O=q.pv,r=t(O.lp(F).x-O._9I)<=(ng?8:3);q.cp?q._62O||(r?(q._62O="c",Oi(q,F)):t(zn(F).y-q.cp.y)>=2&&(q._62O=q.isV(F)?"s":"p",Oi(q,F))):(r?q.setCursor(fc):q.setCursor(aj),q.isV(F)&&O._43o())}},isV:function(U){var Z=this.pv,f=Z._29I;return Z._41o()&&f.x+f.width-Z.lp(U).x<Vp},handle_mousewheel:function(A){this.handleScroll(A,A.wheelDelta/40)},handle_DOMMouseScroll:function(c){2===c.axis&&this.handleScroll(c,-c.detail)},handleScroll:function(r,D){var N=this.pv;td(r),N.endEditing(),N.translate(0,D*N.getRowHeight())},handle_keydown:function(j){var Q=this.pv,$=Q._rows.size(),H=Q._selectRowIndex+(yb(j)?-1:1);(yb(j)||Vl(j))&&(0>H&&(H=0),H>=$&&(H=$-1),Q.setSelectRowIndex(H))}}),Le.ListView=function(N){this._5o(N),new ok(this)},ro("ListView",Y,{ms_ac:[Yr,$n,Pg,Th,bi,Zg,lm,Yc,re,dr,Om,Nl,bq,Dh],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:tg,_rowHeight:ve,_rowLineVisible:A.listViewRowLineVisible,_rowLineColor:A.listViewRowLineColor,_scrollBarColor:Tc,_scrollBarSize:Tl,_autoMakeVisible:vc,_autoHideScrollBar:vg,_selectBackground:A.listViewSelectBackground,_labelColor:A.listViewLabelColor,_labelSelectColor:A.listViewLabelSelectColor,_labelFont:A.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(R){var L=this,m=L._checkMode;L._checkMode=R,L.fp(ym,m,R)},drawRow:function(Q,H,a,D,R,T,g){var X=this,t=0,Y=X._indent,e=X.getIconWidth(H);X.drawRowBackground(Q,H,a,D,R,T,g),X._checkMode&&(Pe(Q,Uj(X.getCheckIcon(H)),t+Y/2,R+g/2,H,X),t+=Y),X.drawIcon(Q,H,t,R,e,g),X.drawLabel(Q,H,t+e,R,g)}});var ok=function(o){this.list=o,this._lastSelectDataTime=xk(),this.addListeners()};Im(ok,Y,{ms_listener:1,getView:function(){return this.list._view},clear:function(F){var r=this,C=r.list;F&&"d"===r._62O&&!r.dragCancel&&C.handleDragAndDrop(F,"end"),C.draggingData&&(C.draggingData=null,C.redraw()),r.dragCancel=r._62O=r._isV=r._isH=r.cp=r.tx=r.ty=Z},handle_mousedown:function(F){this.handle_touchstart(F)},handle_touchstart:function(h){var Q=this,B=Q.list;if(td(h),B.setFocus(h)){var c=B.getDataAt(h);Q.cp=zn(h),Q.tx=B.tx(),Q.ty=B.ty(),Vi(h)?c&&B.handleDragAndDrop&&!Q.isV(h)&&!Q.isH(h)&&(B.draggingData=c,B.redraw(),B.handleDragAndDrop(h,"prepare")):(c&&Q._33o(h,c),Q.clear(h))}},handleWindowMouseUp:function(s){this.clear(s)},handleWindowTouchEnd:function(X){this.clear(X)},handle_mouseup:function(i){this.handle_touchend(i)},handle_touchend:function(f){var u=this,D=u.list;if(!u._isV&&!u._isH&&u.cp&&!u._62O){var M=D.getDataAt(f);M?(D.isCheckMode()?u._34o(f,M):u._33o(f,M),Ko(f)?D.onDataDoubleClicked(M,f):D.onDataClicked(M,f)):D.handleBackgroundClick(f)}u.clear(f)},handleWindowMouseMove:function(f){this.handleWindowTouchMove(f)},handleWindowTouchMove:function(b){var v=this,M=v.list,Q=v._62O,p=v.tx,U=v.ty,q=v.cp,Y=zn(b),P=M._29I;"p"===Q?M.setTranslate(p+Y.x-q.x,U+Y.y-q.y):"v"===Q?M.ty(U+(q.y-Y.y)*M._59I/P.height):"h"===Q?M.tx(p+(q.x-Y.x)*M._91I/P.width):"d"===Q&&(v.dragCancel||M.handleDragAndDrop(b,"between"))},handle_mousemove:function(Y){this.handle_touchmove(Y)},handle_touchmove:function(E){if(!Xm&&Vi(E)){var q=this,F=q.list;if(q._isV=q.isV(E),q._isH=q.isH(E),q.cp){if(!q._62O){if(fm(zn(E),q.cp)<2)return;q._isV?q._62O="v":q._isH?q._62O="h":F.draggingData&&!this.dragCancel?(q._62O="d",F.handleDragAndDrop(E,"begin")):q._62O="p",q._62O&&"d"!==q._62O&&F.draggingData&&(F.draggingData=null,F.redraw()),Oi(q,E)}}else q._isV&&F._43o(),q._isH&&F._42o()}},isV:function(I){var q=this.list,p=q._29I;return q._41o()&&p.x+p.width-q.lp(I).x<Vp},isH:function(i){var F=this.list,g=F._29I;return F._40o()&&g.y+g.height-F.lp(i).y<Vp},handle_mousewheel:function(_){this.handleScroll(_,_.wheelDelta/40,_.wheelDelta!==_.wheelDeltaX)},handle_DOMMouseScroll:function(Q){this.handleScroll(Q,-Q.detail,1)},handleScroll:function(M,e,j){var f=this.list;td(M),f.endEditing&&f.endEditing(),j&&f._41o()?f.translate(0,e*f.getRowHeight()):f._40o()&&f.translate(10*e,0)},handle_keydown:function(h){if(!A.isInput(h.target)){var Z,X=this.list,p=X.sm(),U=X._rows,W=U.size();if(Dn(h))X.selectAll();else if(Go(h))X.handleDelete&&X.handleDelete(h);else if(Nb(h))"d"!==this._62O||this.dragCancel||(X.handleDragAndDrop(h,"cancel"),this.dragCancel=!0);else if(nb(h))X.isCheckMode()&&(Z=X.getFocusData(),Z&&X.checkData(Z));else if(yb(h)||Vl(h)){var V=X.isCheckMode();if(Z=V?X.getFocusData():p.ld()){var D=X.getRowIndex(Z);D>=0&&(yb(h)?0!==D&&(Z=U.get(D-1),V?X.setFocusData(Z):p.ss(Z)):D!==W-1&&(Z=U.get(D+1),V?X.setFocusData(Z):p.ss(Z)))}else W>0&&(Z=U.get(0),V?X.setFocusData(Z):p.ss(Z))}}},_34o:function(H,f){var o=this.list,d=o.lp(H).x;return d>=0&&d<=o._indent?(o.checkData(f),void 0):(o.setFocusData(f),void 0)},_33o:function(T,b){var _=this.list,o=_.sm(),v=o.ld();if(oe(T))_.isSelected(b)?o.rs(b):o.as(b);else if(_d(T))if(v)for(var D=_.getRowIndex(v),u=_.getRowIndex(b);D!==u;)D+=u>D?1:-1,o.as(_._rows.get(D));else o.ss(b);else if(Vi(T)){var E=xk();if(o.contains(b)){var n=E-this._lastSelectDataTime;_.handleDataDoubleSelect&&n>500&&1500>n&&_.handleDataDoubleSelect(T,b)}o.ss(b),this._lastSelectDataTime=E}else o.contains(b)||o.ss(b)}}),Le.TreeView=function(E){var W=this;W._35o(),W._5o(E),new Dg(W)},ro("TreeView",Y,{ms_ac:[Yr,$n,Pg,"rootVisible",ym,"rootData",Yc,re,dr,Om,Nl,bi,Th,Zg,lm,kf,Ql,bq,Dh,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:Z,_indent:tg,_rowHeight:ve,_rowLineVisible:A.treeViewRowLineVisible,_rowLineColor:A.treeViewRowLineColor,_scrollBarColor:Tc,_scrollBarSize:Tl,_autoHideScrollBar:vg,_expandIcon:A.treeViewExpandIcon,_collapseIcon:A.treeViewCollapseIcon,_autoMakeVisible:vc,_selectBackground:A.treeViewSelectBackground,_labelColor:A.treeViewLabelColor,_labelSelectColor:A.treeViewLabelSelectColor,_labelFont:A.treeViewLabelFont,_doubleClickToToggle:A.treeViewDoubleClickToToggle,drawRow:function(i,F,v,O,x,c,I){var $=this;$.drawRowBackground(i,F,v,O,x,c,I),$._97I(i,F,v,0,x,c,I)},isOnToggleIcon:function(W){var i=this.getDataAt(W);if(i){var x=this.getIndent(),g=this.lp(W).x;if(Uj(this.getToggleIcon(i))){var G=x*this.getLevel(i);if(g>=G&&G+x>=g)return!0}}return!1}});var Dg=function(x){$f(Dg,this,[x])};Im(Dg,ok,{toggle:function(b,k,N,U){var Y=this.list,P=Y.lp(b).x;if(Uj(Y.getToggleIcon(k))){var l=N*U;if(P>=l&&l+N>=P)return Y.toggle(k),!0}return Y.isDoubleClickToToggle()&&Ko(b)?(Y.toggle(k),!0):!1},_34o:function(u,U){var N=this.list,G=N.lp(u).x,s=N._levelMap[U._id],j=N._indent,T=j*(s+1);return G>=T&&T+j>=G?(N.checkData(U),void 0):(this.toggle(u,U,j,s)||N.setFocusData(U),void 0)},_33o:function(h,I){var Z=this,M=Z.list;if(!Z.toggle(h,I,M._indent,M.getLevel(I)))if(_d(h)){var o=M.sm();if(o.size()>0){for(var Y=M._rows,f=null,J=0,l=Y.size();l>J;J++)if(M.isSelected(Y.get(J))){f=J;break}for(var w=null,J=Y.size()-1;J>=0;J--)if(M.isSelected(Y.get(J))){w=J;break}var p,B,C=M.getRowIndex(I);for(f>C?(p=C-1,B=f):C>w?(p=w,B=C):(p=f,B=w);p!==B;)p++,o.as(M._rows.get(p))}else o.ss(I)}else Dg.superClass._33o.call(Z,h,I)},handle_keydown:function($){if(Bg($)||Pn($)){var k=this.list,x=k._rows,u=k.isCheckMode(),J=k.sm(),m=u?k.getFocusData():J.ld();m?m.hasChildren()&&(Bg($)?k.collapse(m):k.expand(m)):x.size()>0&&(m=x.get(0),u?k.setFocusData(m):J.ss(m))}else Dg.superClass.handle_keydown.call(this,$)}});var Mc=Le.TableView=function(N){this._98I(),this._5o(N),new Qe(this)};ro("TableView",Y,{ms_ac:[Yr,$n,Pg,"sortMode",Mn,ei,Th,Zg,lm,rj,fd,"sortColumn",Yc,re,dr,Om,Nl,bq,Dh],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Zl,_editable:!0,_batchEditable:!1,_rowHeight:ve,_rowLineVisible:A.tableViewRowLineVisible,_rowLineColor:A.tableViewRowLineColor,_columnLineVisible:A.tableViewColumnLineVisible,_columnLineColor:A.tableViewColumnLineColor,_scrollBarColor:Tc,_scrollBarSize:Tl,_autoHideScrollBar:vg,_autoMakeVisible:vc,_selectBackground:A.tableViewSelectBackground,_labelColor:A.tableViewLabelColor,_labelSelectColor:A.tableViewLabelSelectColor,_labelFont:A.tableViewLabelFont,getCheckColumn:function(){var M=this;if(!M._31o){var X=M._31o=new Wn;X.setEditable(!0),X.setWidth(40),X.getValue=M.getCheckColumValue,X.drawCell=M.drawCheckColumnCell}return M._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(L){var _=this,v=_._39o,n=_.getCheckColumn();L!==_.isCheckMode()&&(L?v.add(n,0):v.remove(n),_.fp(ym,!L,L))},getCheckColumValue:function(O,o,k){return k.isSelected(O)},drawCheckColumnCell:function(J,k,y,A,B,F,N,C,j){Pe(J,j.getCheckIcon(k),B+N/2,F+C/2,k,j)}});var Qe=function(w){$f(Qe,this,[w])};Im(Qe,ok,{_34o:function(M,Q){var s=this.list,B=s._31o;if(s.isCellEditable(Q,B,M)){var A=s._3Q(B),P=s.lp(M).x;if(A&&P>=A.startX&&P<A.startX+B.getWidth())return s.checkData(Q),void 0}s._37O(Q,M),s.setFocusData(Q)},_33o:function(C,p){this.list._37O(p,C),Qe.superClass._33o.apply(this,arguments)}});var tl=Le.TreeTableView=function(F){var V=this,h=V._4o=new Wn;V._35o(),V._98I(),V._5o(F),h.setDisplayName("Name"),h.setEditable(!0),h.setWidth(180),h.drawCell=Uo,h.getValue=jf,V._39o.add(h),new gg(V)},Uo=function(k,R,r,t,M,J,I,g,u){u._97I(k,R,r,M,J,I,g)},jf=function(j,W,t){return t.getLabel(j)};ro("TreeTableView",Y,{ms_ac:[Yr,$n,Pg,"sortMode",Mn,ei,bi,ym,"rootData","rootVisible",Yc,re,"sortColumn",kf,Ql,dr,Om,Nl,bq,lm,Th,Zg,rj,fd,Dh,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Zl,_checkMode:Z,_editable:!0,_batchEditable:!1,_indent:tg,_rowHeight:ve,_rowLineVisible:A.treeTableViewRowLineVisible,_rowLineColor:A.treeTableViewRowLineColor,_columnLineVisible:A.treeTableViewColumnLineVisible,_columnLineColor:A.treeTableViewColumnLineColor,_expandIcon:A.treeTableViewExpandIcon,_collapseIcon:A.treeTableViewCollapseIcon,_scrollBarColor:Tc,_scrollBarSize:Tl,_autoHideScrollBar:vg,_autoMakeVisible:vc,_selectBackground:A.treeTableViewSelectBackground,_labelColor:A.treeTableViewLabelColor,_labelSelectColor:A.treeTableViewLabelSelectColor,_labelFont:A.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var gg=function(m){$f(gg,this,[m])};Im(gg,ok,{_34o:function(x,X){var P=this.list,U=P._4o,e=P._3Q(U),K=P.lp(x).x;if(e){var O=P._indent,Y=e.startX+O*P.getLevel(X);if(Uj(P.getToggleIcon(X))&&K>=Y&&Y+O>=K)return P.toggle(X),void 0;if(P.isCellEditable(X,U)&&(Y+=O,K>=Y&&Y+O>=K))return P.checkData(X),void 0}P._37O(X,x),P.setFocusData(X)},_33o:function(F,x){var C=this.list,D=C.lp(F).x;if(Uj(C.getToggleIcon(x))){var i=C._3Q(C._4o);if(i){var Z=C._indent,S=i.startX+Z*C.getLevel(x);if(D>=S&&S+Z>=D)return C.toggle(x),void 0}}C._37O(x,F),gg.superClass._33o.apply(this,arguments)}});var Cn=Le.TableHeader=function(f){var a=this,K=a._view=Wm(1,a),R=a._39o=f.getColumnModel(),e=a.iv;a.tv=a._tableView=f,a._60I=new Nj,a._canvas=uh(K),K.style.background=A.tableHeaderBackground||"",K.style.height=Gg+Bd,R.mm(e,a),R.md(e,a),R.mh(e,a),f.mp(function(k){hj[k.property]&&a.iv()},a),new uj(a),a.iv()};ro("TableHeader",Y,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Yr,Pg,bi,"moveBackground","insertColor",rj,fd,"resizable","movable"],_checkIcon:Qb,_movable:!0,_resizable:!0,_labelColor:A.tableHeaderLabelColor,_labelFont:A.tableHeaderLabelFont,_columnLineColor:A.tableHeaderColumnLineColor,_columnLineVisible:A.tableHeaderColumnLineVisible,_sortDescIcon:A.tableHeaderSortDescIcon,_sortAscIcon:A.tableHeaderSortAscIcon,_moveBackground:A.tableHeaderMoveBackground,_insertColor:A.tableHeaderInsertColor,_indent:tg,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(N){return N.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(M){return M.getColor()||this._labelColor},getLabelAlign:function(C){return C._align},onPropertyChanged:function(){this.iv()},_5Q:function(V){this._61I=V,this.iv()},getLogicalPoint:function(N){return kk(N,this._canvas,this.tv.tx())},validateImpl:function(){var b=this,G=b._canvas,m=b.getWidth(),h=b.getHeight(),y=b.tv,z=b._60I,o=b._61I,W=-y.tx(),c=0;(m!==G.clientWidth||h!==G.clientHeight)&&wg(G,m,h),z.clear(),b._39o._roots.each(function(M){if(M.isVisible()){var P=c+M.getWidth();W+m>=c&&P>=W&&z.add({column:M,startX:c}),c=P}});var p=qq(G);if(hb(p,-W,0,1),p.beginPath(),p.rect(W,0,m,h),p.clip(),p.clearRect(W,0,m,h),z.each(function(C){var S=C.column,i=C.startX,r=S.getWidth();r>0&&(p.save(),p.beginPath(),p.rect(i,0,r,h),p.clip(),o&&o.column===S||b.drawColumn(p,S,i,0,r,h),b._columnLineVisible&&jq(p,i+r-1,0,1,h,b._columnLineColor),p.restore())}),o){var I=o.column,c=o.startX,u=o.position,j=I.getWidth();p.save(),p.beginPath(),p.rect(c,0,j,h),p.clip(),p.fillStyle=b._moveBackground,p.fill(),b.drawColumn(p,I,c,0,j,h),p.restore(),ii(p,b._insertColor,u,0,h)}p.restore()},_6Q:function(P){var c=this.tv;return c._31o===P&&c.sm().getSelectionMode()===Xq},drawColumn:function(c,C,z,t,i,B){var m=this,n=m.tv,u=Uj(C.getIcon()),x=m.getLabelAlign(C);if(m._6Q(C)){var a=Uj(m._checkIcon);Pe(c,a,z+i/2,t+B/2,C,m)}else{var w=m.getLabel(C),_=m.getLabelFont(C),I=m.getLabelColor(C),H=hh(_,w).width,g=u?m._indent:0;x===Bc?(u&&cj(c,u,Po,z,t,g,B),xc(c,w,_,I,z+g,t,i,B,Bc)):x===qe?(u&&cj(c,u,Po,z+i-H-g,t,g,B),xc(c,w,_,I,z,t,i,B,qe)):(u&&cj(c,u,Po,z+(i-H-g)/2,t,g,B),xc(c,w,_,I,z+(i-H+g)/2,t,0,B,Bc))}if(C.isSortable()&&n.getSortColumn()===C&&(u=Uj(C.getSortOrder()===Ag?m._sortAscIcon:m._sortDescIcon))){var W=ab(u,C)/2+2;Pe(c,u,x===qe?z+W:z+i-W,t+B/2,C,n)}}});var uj=function($){var u=this;u.th=$,u.tv=$._tableView,u.addListeners()};Im(uj,Y,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(k){this.getView().style.cursor=k},handle_mousemove:function(O){if(!Xm){var u=this;delete u._29o,u.setCursor(aj);for(var $=u.th,i=$._60I,q=$.lp(O).x,Z=i.size()-1;Z>=0;Z--){var V=i.get(Z),p=V.column,m=V.startX+p.getWidth();if($.isResizable()&&t(m-q)<=(ng?10:3))return u._29o=V,u.setCursor(fc),void 0;q>V.startX&&m>q&&(u._29o=V),(p.isClickable()||p.isSortable()||$.isMovable()||u.tv.getCheckColumn&&p===u.tv.getCheckColumn())&&q>V.startX&&m>q&&u.setCursor(Yp)}}},handle_mousedown:function(e){this.handle_touchstart(e)},handle_touchstart:function(t){var L=this;td(t),L.tv.endEditing(),L.handle_mousemove(t),L._29o&&(L.x=zn(t).x,L.lx=L.th.lp(t).x,L.w=L._29o.column.getWidth(),Oi(L,t))},handleWindowMouseMove:function(k){this.handleWindowTouchMove(k)},handleWindowTouchMove:function(C){var E=this,l=E.th,r=E.getView().style.cursor,o=E._29o,p=zn(C).x-E.x;if(E.resizing||E.moving||(r===fc?E.resizing=1:l.isMovable()&&r===Yp&&t(p)>2&&(E.moving=1)),E.resizing)o.column.setWidth(E.w+p);else if(E.moving){var g=E.lx+p;l._60I.each(function(A){var G=A.startX,b=G+A.column.getWidth();if(g>=G&&b>=g){var Q={column:o.column,startX:o.startX+p,front:b-g>g-G,insertColumn:A.column};Q.position=Q.front?G:b,l._5Q(Q)}})}},_16Q:function(B,w){var T=this,d=T.tv,q=T.th,a=q._checkIcon;if(q._6Q(B)){var J=Uj(a),n=T.lx,U=B.getWidth(),C=ab(J,B);if(n>=w+U/2-C&&w+U/2+C>=n){q.setCheckIcon(a===Uc?Qb:Uc);var y=d.sm(),e=d._rows;return a===Uc?y.rs(e):y.ss(e),d.onCheckColumnClicked(B),!0}}return!1},handleWindowMouseUp:function(y){this.handleWindowTouchEnd(y)},handleWindowTouchEnd:function(J){var v=this,h=v.tv,i=v.th,E=v._29o;if(v.moving){var n=i._61I;if(n&&n.insertColumn!==n.column){var m=n.column,D=h.getColumnModel()._roots,b=D.remove(m),l=D.indexOf(n.insertColumn);l>=0&&(n.front||l++,l<=D.size()&&(D.add(m,l),h.getColumnModel()._38I(m,b,l)))}i._5Q(Z),delete v.moving}else if(!v.resizing&&E){m=E.column;var F=i.lp(J).x,R=E.startX,V=!0;if(i.onColumnClicked){var j=i.onColumnClicked(m,J,R);j===!1&&(V=!1)}if(V&&F>=R&&F<=R+m.getWidth()&&!v._16Q(m,R)){if(m.isSortable()){var K=h.getSortMode(),C=m.getSortOrder();K===Zl?h.getSortColumn()===m?(C===Wd&&h.setSortColumn(Z),m.setSortOrder(C===Ag?Wd:Ag)):h.setSortColumn(m):"bistate"===K&&(h.getSortColumn()===m?m.setSortOrder(C===Ag?Wd:Ag):h.setSortColumn(m))}h.onColumnClicked(m,J,R)}}v._29o=v.resizing=v.x=v.lx=v.w=Z}}),Le.TablePane=function(q){this.init(new Mc(q))},ro("TablePane",Y,{ms_v:1,_44o:1}),Le.TreeTablePane=function(L){this.init(new tl(L))
    },ro("TreeTablePane",Y,{ms_v:1,_44o:1}),Le.Toolbar=function(B){var R=this,U=R._view=Wm(1,R),w=U.style;w.background=A.toolbarBackground||"",w.height=Hj+Bd,R._canvas=uh(U),R._30o=new Nj,R._90I=new Nj,R.setItems(B||[]),U.handleGroupSelectedChanged=function(W){if(W.isSelected()){var z=W.getGroupId();null!=z&&R._items.forEach(function(w){var q=w.element;q&&q!==W&&q.setSelected&&q.getGroupId&&q.getGroupId()===z&&q.setSelected(!1)})}},new kc(R)},ro("Toolbar",Y,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[pc,Yr,Pg,$n,Dh,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:A.toolbarLabelColor,_labelSelectColor:A.toolbarLabelSelectColor,_labelFont:A.toolbarLabelFont,_selectBackground:A.toolbarSelectBackground,_itemGap:A.toolbarItemGap,_separatorColor:A.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(o){var x=this.getItemInfoAt(o);return x?x.item.toolTip:Z},getLabelColor:function(P){return P&&P.selected&&P.type!==Uc&&P.type!==ek?this._labelSelectColor:this._labelColor},onPropertyChanged:function(i){this.iv(),i.property===pc&&this._items.forEach(function(x){Kb(x)})},redraw:function(){this.iv()},addItem:function(M,h){var c=this._items;h==Z?c.push(M):c.splice(h,0,M),this.fp(pc,Z,c)},removeItem:function(U){if(U)for(var m=this._items,a=0;a<m.length;a++)U===m[a]&&(m.splice(a,1),this.fp(pc,Z,m))},removeItemById:function(H){if(H!=Z)for(var O=this._items,q=0;q<O.length;q++)if(H===O[q].id){var C=O.splice(q,1)[0];return this.fp(pc,Z,O),C}},getItemById:function(S){if(S!=Z)for(var $=this._items,v=0;v<$.length;v++){var a=$[v];if(S===a.id)return a}},setItemVisible:function(M,T){var N=this.getItemById(M);N&&(N.visible=T)},getItemInfos:function(){return this._30o},getItemInfoAt:function(i){var G=this,J=0,k=G._30o,N=G.lp(i),T=N.x,X=N.y;if(X>=0&&X<=G.getHeight())for(;J<k.size();J++){var f=k.get(J);if(f.startX<=T&&T<=f.endX)return f}return Z},drawItem:function(c,D,T,h,$){if(D.visible===!1)return 0;if(vi(D.visible)&&!D.visible())return 0;var m=this,v=D.disabled;v&&(c.globalAlpha=Ph);var N=m.drawItemImpl(c,D,T,h,$),M=m._itemGap;return v&&(c.globalAlpha=1),this._currentItem!==D||"separator"===D||D.separator===!0||D.unfocusable||lk(c,m._separatorColor,T-M/2,0,N+M,h),N},drawItemImpl:function(g,c,i,Q,z){var p=this,k=p._view,y=p._itemGap,C=Q/2,Y=c.type,h=c.element,v=c.label;tk(h)&&(v=h,h=Z);var V,P=p.getLabelFont(c),D=p.getLabelColor(c),X=c.selected,d=Uj(c.icon),j=ab(d,c),t=0,f=j+(v?hh(P,v).width:0);if("separator"===c||c.separator===!0)return ii(g,p._separatorColor,i,Q/4,C),1;if(h){d&&Pe(g,d,i+j/2,C,c,p),xc(g,v,P,D,i+j,0,0,Q);var o=Kl(h);z||p._90I.add(o),o.parentNode!==k&&Jp(k,o),h.iv&&h.iv(),h.validate&&h.validate();var O=o.getBoundingClientRect(),J=O.width,W=o.style;return yn(o),W.left=p.tx()+i+f+Bd,W.top=(Q-O.height)/2+Bd,f+J}return Y===ek?V=Uj(X?$q:Zp):Y===Uc&&(V=Uj(X?Uc:Qb)),V?(t=ab(V,c),Pe(g,V,i+t/2,C,c,p),i+=t,f+=t):X&&jq(g,i-y/2,0,f+y,Q,p.getSelectBackground(c)),d&&Pe(g,d,i+j/2,C,c,p),xc(g,v,P,D,i+j,0,0,Q),f},validateImpl:function(){var Q=this,h=Q._canvas,T=Q.getWidth(),l=Q.getHeight(),F=Q._30o,L=Q._items;wg(h,T,l);var K=qq(h),P=Q._itemGap,A=P/2;hb(K,Q.tx(),0,1),K.clearRect(0,0,T,l);var z=Q._90I;Q._90I=new Nj,F.clear(),L.forEach(function(H){var j=Q.drawItem(K,H,A,l);F.add({item:H,startX:A,endX:A+j,width:j}),j&&(A+=j+P)}),z.each(function(B){Q._90I.contains(B)||pf(B)});var i=Q._64I;Q._64I=j(0,A),K.restore(),Q._stickToRight?(Q._65O=0,K=qq(h),A=T-Q._64I+P,hb(K,0,0,1),K.clearRect(0,0,T,l),F.clear(),L.forEach(function(D){var R=Q.drawItem(K,D,A,l,!0);F.add({item:D,startX:A,endX:A+R,width:R}),R&&(A+=R+P)}),K.restore()):Q.tx(Q.tx()),i!==Q._64I&&Q.onSumWidthChanged(i,Q._64I)},onSumWidthChanged:function(){},handleClick:function(Y,I){var w=this,e=Y.type,N=Y.action,P=Y.groupId,S=Y.selected;Y.disabled||(P!=Z?S||(Y.selected=!0,this._items.forEach(function(Q){Q.groupId===P&&Y!==Q&&(Q.selected=!1)}),N&&Y.action(Y,w,I)):e===Uc||"toggle"===e?(Y.selected=!S,N&&Y.action(Y,w,I)):N&&Y.action(Y,w,I)),Kp(),w.iv()}});var kc=function(k){this.tb=k,this.addListeners()};Im(kc,Y,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(t){this.handleScroll(t,10*(t.wheelDelta/40))},handle_DOMMouseScroll:function(R){this.handleScroll(R,10*-R.detail)},handleScroll:function(K,j){td(K);var n=this.tb;n.isScrollable()&&!n._stickToRight&&(n.tx(n.tx()+j),dg())},handle_mousemove:function(G){var P=this;Xm||P.setItem(G)},handle_mouseout:function(O){var N=this;O.target===N.getView()?N.tb.setCurrentItem(Z):N.handle_mousemove(O)},handle_mousedown:function(M){this.handle_mousemove(M),this.handle_touchstart(M)},handle_touchstart:function(B){var b=this,n=b.tb,N=B.target;Vi(B)&&(N===b.getView()||N===n._canvas)&&(td(B),n.setFocus(B)&&(this.setItem(B,!0),(n.isScrollable()||b.info&&!b.info.item.disabled)&&(b.x=zn(B).x,b.tx=n.tx(),Oi(b,B))))},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowTouchMove:function(o){var w=this,n=w.tb;if(!n._stickToRight){var A=zn(o).x-w.x;!w._25o&&t(A)>2&&n.isScrollable()&&(w._25o=1),w._25o&&n.tx(w.tx+A)}},handleWindowMouseUp:function(b){this.handleWindowTouchEnd(b)},handleWindowTouchEnd:function(s){var d=this,h=d.tb,W=d.info,H=d.tb.getItemInfoAt(s);if(!d._25o&&W){var B=W.item;H&&H.item===B&&h.handleClick(B,s)}d._25o=d.x=d.tx=Z,d.setItem()},setItem:function(j,c){var z=this,A=z.tb,W=z.info=j?A.getItemInfoAt(j):Z,r=W?W.item:Z;A.setCurrentItem(r),c&&r&&vi(r.onDown)&&r.onDown(j)}}),Le.BorderPane=function(){this._view=Wm(1,this),this.iv()},ro("BorderPane",Y,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(N,Y){this._12o("leftView",N),Y!=Z&&this.setLeftWidth(Y)},getRightView:function(){return this._rightView},setRightView:function(p,j){this._12o("rightView",p),j!=Z&&this.setRightWidth(j)},getTopView:function(){return this._topView},setTopView:function(M,C){this._12o("topView",M),C!=Z&&this.setTopHeight(C)},getBottomView:function(){return this._bottomView},setBottomView:function(N,p){this._12o("bottomView",N),p!=Z&&this.setBottomHeight(p)},getCenterView:function(){return this._centerView},setCenterView:function(Q){this._12o("centerView",Q)},_12o:function(R,d){var u=this,n="_"+R,h=u._view,T=u[n];T!==d&&(T&&(T.getView?pf(T.getView()):pf(T)),u[n]=d,d&&(d.getView?Jp(h,d.getView(),1):Jp(h,d,1)),u.fp(R,T,d))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var N=this,n=N._topView,c=N._bottomView,r=N._leftView,S=N._rightView,L=N._centerView,C=N.getWidth(),F=N.getHeight(),G=0,M=0,$=C,O=F,l=0,W=0,V=0,D=0;n&&(l=N._topHeight==Z?ci(n):N._topHeight,M=l),c&&(W=N._bottomHeight==Z?ci(c):N._bottomHeight,O=F-W),r&&(V=N._leftWidth==Z?mc(r):N._leftWidth,G=V),S&&(D=N._rightWidth==Z?mc(S):N._rightWidth,$=C-D);var Q=j(0,$-G),I=j(0,O-M);n&&Vn(n,0,0,C,l),c&&Vn(c,0,O,C,W),r&&Vn(r,0,M,V,I),S&&Vn(S,$,M,D,I),L&&Vn(L,G,M,Q,I)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
