!function(Q,J){"use strict";var k="position",G="absolute",w="relative",b="px",$="left",M="right",d="top",A="bottom",n="display",B="none",r="block",I=ht.Default,x=I.getInternal(),X=Math.floor,W=Math.ceil,u=Math.PI,q=null,s=Q.parseInt,z=function(U){return U.getContext("2d")},H=function(){return document},S=function(p){return H().createElement(p)},F=function(){return S("canvas")},h=function(N,x,h){N.style.setProperty(x,h,q)},D=function(F,O,f){I.def(ht.widget[F],O,f)},c=function(Z,L){Z.appendChild(L)},j=function(y,B){y.removeChild(B)},P=function(v,R,b,u){v.addEventListener(R,b,!!u)},v=function(g,U,z,l){g.removeEventListener(U,z,!!l)};ht.widget.RulerFrame=function(e){var z=this,s=z._view=x.createView(null,z),T=z.$1k=F(),v=z.$2k=F(),t=z.$3k=F(),m=z.$4k=F();z._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},z._topRulerConfig={visible:!0},z._rightRulerConfig={visible:!1},z._bottomRulerConfig={visible:!1},z._leftRulerConfig={visible:!0},c(s,T),c(s,t),c(s,v),c(s,m),h(s,k,w),h(s,"box-sizing","border-box"),h(s,"-moz-box-sizing","border-box"),h(T,k,G),h(v,k,G),h(t,k,G),h(m,k,G),z.$14k=function(){z.$13k=1,z.iv()},z.$15k=function(f){if(z._topRulerConfig.guideVisible||z._rightRulerConfig.guideVisible||z._bottomRulerConfig.guideVisible||z._leftRulerConfig.guideVisible||z._defaultRulerConfig.guideVisible||(z._topRulerConfig.guideTipVisible||z._rightRulerConfig.guideTipVisible||z._bottomRulerConfig.guideTipVisible||z._leftRulerConfig.guideTipVisible||z._defaultRulerConfig.guideTipVisible)&&z._component){var o=s.getBoundingClientRect();z.$16k={x:f.clientX-o.left,y:f.clientY-o.top},z.$5k()}},z.setComponent(e)},D("RulerFrame",J,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(U){var Z=this,N=Z._component,B=Z.getView();if(B){if(Z._component=U,Z.fp("component",N,U),N){var f=Z.getComponentView(N);j(B,f),v(B,"mousemove",Z.$15k),Z.removeComponentPropertyChangeListener(N,Z.$14k)}if(U){var T=Z.getComponentView(U);c(B,T),h(T,k,G),P(B,"mousemove",Z.$15k),Z.addComponentPropertyChangeListener(U,Z.$14k)}}},addComponentPropertyChangeListener:function(S,u){S&&S.mp&&S.mp(u)},removeComponentPropertyChangeListener:function(c,J){c&&c.ump&&c.ump(J)},getComponentHZoom:function(e){return e&&e.getZoom?e.getZoom():1},getComponentVZoom:function(f){return f&&f.getZoom?f.getZoom():1},getComponentViewRect:function(c){return c&&c.getViewRect?c.getViewRect():void 0},getComponentView:function(l){return l&&l.getView?l.getView():l},invalidateComponent:function(g){g&&g.iv&&g.iv()},validateComponent:function(L){L&&L.validate&&L.validate()},$7k:function(Q,I,i,N,C,j,f,c,s,D,w,y){if(I.visible){var T=this._defaultRulerConfig,X="borderStyle",M="borderColor",t="borderWidth",L="background",v=I[X]||T[X],l=I[M]||T[M],o=I[t]||T[t],G=I.size!=q?I.size:T.size,Z=I[L]||T[L],b=G+o,O=this.$6k(o,v,l,Q,i,C,b,f,c,s,D,w,y);h(Q,C,"0px"),j?x.setCanvas(Q,N-O,G):x.setCanvas(Q,G,N-O),h(Q,"background",Z),h(Q,n,r)}else h(Q,n,B),h(this.getComponentView(this._component),C,"0px")},$6k:function(J,B,L,W,M,V,G,y,S,o,z,O,j){var k=0;return h(W,M,J+"px "+B+" "+L),h(this.getComponentView(this._component),V,G+b),y?(h(W,S,o+b),k+=o):h(W,S,"0px"),z?(h(W,O,j+b),k+=j):h(W,O,"0px"),k},validateImpl:function(){var Y=this,i=Y._component,E=Y.$1k,J=Y.$2k,m=Y.$3k,S=Y.$4k,k=Y._view,f=Y._defaultRulerConfig,g=Y._topRulerConfig,e=Y._rightRulerConfig,h=Y._bottomRulerConfig,N=Y._leftRulerConfig,U=f.size;if(k&&i){var c=g.size!=q?g.size:U,z=e.size!=q?e.size:U,T=h.size!=q?h.size:U,X=N.size!=q?N.size:U;Y.$7k(E,g,"border-bottom",k.offsetWidth,d,!0,N.visible,$,X,e.visible,M,z),Y.$7k(J,e,"border-left",k.offsetHeight,M,!1,g.visible,d,c,h.visible,A,T),Y.$7k(m,h,"border-top",k.offsetWidth,A,!0,N.visible,$,X,e.visible,M,z),Y.$7k(S,N,"border-right",k.offsetHeight,$,!1,g.visible,d,c,h.visible,A,T),Y.$13k?delete Y.$13k:Y.invalidateComponent(i),Y.validateComponent(i),Y.$5k()}},$5k:function(){function I(T,I,Z,t,r,$){if(I.visible){var V=z(T),H=I[i]||n,U=I[w]!=q?I[w]:K,j=I[E]||S,a=I[c]||y,R=I.size!=q?I.size:Q,Wn=I[l]||v,tf=I[W]||N,ub=I[X]||A,yf=I[k]!=q?I[k]:p,ee=I[F]!=q?I[F]:J,Gh=I[o]!=q?I[o]:h,Ue=I[L]!=q?I[L]:f,fh=I[m]!=q?I[m]:b,qd=I[M]!=q?I[M]:_,zd=I[d]||ch,uq=I[g]||Aq;U&&(H=C[$]=C.$8k(C[$]||H,I[O]||B,I[G]||P,t?s:e,tf)),Z.call(C,V,D,Y,x,u,R,t?s:e,H,j,a,r,Wn,ub);var We=C.$16k;(yf||ee)&&We&&(t?C.$9k(V,We.x,R,zd,uq,yf,ee,Gh,Ue,fh,qd):C.$10k(V,We.y,R,zd,uq,yf,ee,Gh,Ue,fh,qd,r))}}var C=this,R=C.$1k,V=C.$2k,H=C.$3k,a=C.$4k,$=C._topRulerConfig,Z=C._rightRulerConfig,t=C._bottomRulerConfig,r=C._leftRulerConfig,j=C._defaultRulerConfig,T=C._component,U=C.getComponentViewRect(T),s=C.getComponentHZoom(T),e=C.getComponentVZoom(T),D=U.x*s,x=D+U.width*s,Y=U.y*e,u=Y+U.height*e,Q=C._defaultRulerConfig.size,i="defaultMajorTickSpacing",O="maxPhysicalMajorTickSpacing",G="minPhysicalMajorTickSpacing",w="tickSpacingAdaptable",E="majorTickTextFont",c="majorTickTextColor",l="majorTickColor",X="minorTickColor",k="guideVisible",F="guideTipVisible",o="guideTipBorderColor",L="guideTipTextColor",m="guideTipTextFont",M="guideTipBackground",d="guideColor",g="guideWidth",W="minMajorTickSpacing",n=j[i],B=j[O],P=j[G],K=j[w],S=j[E],y=j[c],v=j[l],N=j[W],A=j[X],p=j[k],J=j[F],h=j[o],f=j[L],b=j[m],_=j[M],ch=j[d],Aq=j[g];C._view&&T&&(I(R,$,C.$11k,!0,!1,"_currentTopMajorTickSpacing"),I(V,Z,C.$12k,!1,!0,"_currentRightMajorTickSpacing"),I(H,t,C.$11k,!0,!0,"_currentBottomMajorTickSpacing"),I(a,r,C.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(x,T,d,y,t){return d>x*y?x=X(T/y/t)*t:x*y>T&&(x=W(d/y/t)*t),x},getHTipText:function(l){var J=this,U=J._component,M=0,G=J._view.getBoundingClientRect();return U.lp?M=s(U.lp({clientX:l.x+G.left,clientY:l.y}).x):M-=s(this.getComponentView(U).style.left)||0,M},$9k:function(l,g,I,U,H,_,o,V,m,S,$){var C=this,r=C._component;l.save(),x.translateAndScale(l,0,0,1);var y=g-(s(this.getComponentView(r).style.left)||0),M=0;if(g=C.getHTipText(C.$16k),_&&(l.beginPath(),l.fillStyle=U,l.rect(y,M,H,I),l.fill()),o){l.beginPath(),l.textAlign="center",l.textBaseline="middle",l.font=S;var w=l.measureText(g).width+6;l.fillStyle=$,l.rect(y-w/2,M,w,I),l.fill(),l.strokeStyle=V,l.stroke(),l.beginPath(),l.fillStyle=m,l.fillText(g,y,M+I/2)}l.restore()},getVTipText:function(U){var W=this,Y=W._component,X=0,r=W._view.getBoundingClientRect();return Y.lp?X=s(Y.lp({clientX:U.x,clientY:U.y+r.top}).y):X-=s(this.getComponentView(Y).style.top)||0,X},formatScaleText:function(M){return Math.round(M)},$10k:function(R,m,j,O,I,L,k,J,z,W,o,X){var E=this,N=E._component;R.save(),x.translateAndScale(R,0,0,1);var v=j/2,P=m-(s(this.getComponentView(N).style.top)||0);if(m=E.getVTipText(E.$16k),L&&(R.beginPath(),R.fillStyle=O,R.rect(v-j/2,P,j,I),R.fill()),k){R.translate(v,P),R.rotate((X?90:-90)*u/180),R.translate(-v,-P),R.beginPath(),R.textAlign="center",R.textBaseline="middle",R.font=W;var S=R.measureText(m).width+6;R.fillStyle=o,R.rect(v-S/2,P-j/2,S,j),R.fill(),R.strokeStyle=J,R.stroke(),R.fillStyle=z,R.fillText(m,v,P)}R.restore()},$11k:function(o,Y,T,f,u,$,g,z,K,H,p,L,C){o.save(),T=0;var t=Y,h=f,b=(t+h)/2;Y=0,f=h-t,x.translateAndScale(o,0,0,1);var V=0,D=0,Q=s($/2),n=$-Q,J=p?0:Q,d=z*g,q=d/10;Y-=d,f+=d,o.clearRect(Y,0,f-Y,$),o.beginPath(),o.fillStyle=C;var N=X(b/q)*q-t;for(V=N;f>V;V+=q)o.rect(V,T+J,1,n);for(V=N;V>Y;V-=q)o.rect(V,T+J,1,n);for(o.fill(),J=p?0:1,o.beginPath(),o.fillStyle=L,N=X(b/d)*d-t,V=N;f>V;V+=d)o.rect(V,T+J,1,$-1);for(V=N;V>Y;V-=d)o.rect(V,T+J,1,$-1);o.fill();var c=s(/\d+px/.exec(K)[0]),A=(c||10)/2;o.textBaseline="middle",J=p?$-A-2:A+2,o.beginPath(),o.fillStyle=H,o.font=K;var j=X(b/d)*d/g;for(V=N,D=j;f>V;V+=d,D+=z){var F=this.getHScaleText?this.getHScaleText(V):D;o.fillText(this.formatScaleText(F),V+2,T+J)}for(V=N,D=j;V>Y;V-=d,D-=z){var F=this.getHScaleText?this.getHScaleText(V):D;o.fillText(this.formatScaleText(F),V+2,T+J)}o.restore()},$12k:function(z,R,I,Y,V,Z,P,d,L,B,e,l,U){function J(Z,S,V,c,M,N){M=g.getVScaleText?g.getVScaleText(V):M,M=g.formatScaleText(M),z.translate(Z+S,V),z.rotate(-c),z.translate(-Z-S,-V),z.fillText(M,Z+S+(N?2:1),V),z.translate(Z+S,V),z.rotate(c),z.translate(-Z-S,-V)}z.save(),R=0;var w=I,S=V,a=(w+S)/2;I=0,V=S-w,x.translateAndScale(z,0,0,1);var G=0,g=this,r=0,t=s(Z/2),y=Z-t,H=e?0:t,T=d*P,j=T/10;I-=T,V+=T,z.clearRect(R,0,Z,V-I),z.beginPath(),z.fillStyle=U;var $=X(a/j)*j-w;for(G=$;V>G;G+=j)z.rect(R+H,G,y,1);for(G=$;G>I;G-=j)z.rect(R+H,G,y,1);for(z.fill(),H=e?0:1,z.beginPath(),z.fillStyle=l,$=X(a/T)*T-w,G=$;V>G;G+=T)z.rect(R+H,G,Z-1,1);for(G=$;G>I;G-=T)z.rect(R+H,G,Z-1,1);z.fill();var p=s(/\d+px/.exec(L)[0]),N=(p||10)/2,_=90*u/180;z.textBaseline="middle",H=e?Z-N:N+2,_=e?-_:_,z.beginPath(),z.fillStyle=B,z.font=L;var Q=X(a/T)*T/P;for(G=$,r=Q;V>G;G+=T,r+=d)J(R,H,G,_,r,e);for(G=$,r=Q;G>I;G-=T,r-=d)J(R,H,G,_,r,e);z.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var T=this,Q=T._component,I=T._view;Q&&T.removeComponentPropertyChangeListener(Q,T.$14k),I&&(v(I,"mousemove",T.$15k),j(I.parentNode,I),T._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:this,Object);