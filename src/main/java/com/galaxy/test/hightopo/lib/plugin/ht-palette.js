!function(C,A,g){"use strict";var r="px",c="0",o="innerHTML",a="className",J=ht.Default,I=ht.Color,f=ht.Node,P="position",k="top",M="left",l=J.animate,q=J.getInternal(),N="width",c="0",e="none",n="max-height",d="font",K="background",s="border-box",b="user-select",G="box-sizing",U="overflow",i=J.isTouchable,q=J.getInternal(),m=I.titleIconBackground,Q=J.scrollBarInteractiveSize,S=/msie 9/.test(C.navigator?C.navigator.userAgent.toLowerCase():""),W=null,w=function(){return document},F=function(X){return w().createElement(X)},Y=function(){return F("div")},t=function(){var w=Y(),T=w.style;return T.msTouchAction=e,T.cursor="default",i&&T.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",W),T.position="absolute",T.left=c,T.top=c,w},j=function(){return F("canvas")},E=function(){return document.body},$=function(h,o,R){h.style.setProperty(o,R,W)},R=function(J,_){J.style.removeProperty(_)},v=function(i,e,r){J.def(ht.widget[i],e,r)},u=function(g,s){g.appendChild(s)},z=function(i,e){i.removeChild(e)},Z=function(j,y,n,v){j.addEventListener(y,n,!!v)};q.addMethod(J,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:m,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:m}]},paletteTitleLabelColor:J.labelSelectColor,paletteTitleLabelFont:J.labelFont,paletteContentLabelFont:J.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:J.widgetTitleHeight,paletteTitleBackground:I.titleBackground,paletteTitleHoverBackground:I.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:g,paletteItemHoverBorderColor:I.highlight,paletteItemSelectBackground:I.highlight},!0);var y=".palette-item:hover{border: 1px solid "+J.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+J.paletteTitleHoverBackground+" !important}",x=document.createElement("style");i||(x.styleSheet?x.styleSheet.cssText=y:x.appendChild(w().createTextNode(y))),w().getElementsByTagName("head")[0].appendChild(x);var V=function(u){var s=this;s.$22h=u,s.addListeners()};J.def(V,A,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var G=this;G.$36h&&E().removeChild(G.$36h),G.$23h=G.$24h=G.$25h=G.$35h=G.$36h=W},handle_touchstart:function(b){for(var H,V=this,q=V.$22h,M=b.target,X=q.sm(),u=q.dm(),F="palette-header",h="palette-header-tool",G="palette-item",K=!1,r=!1,k=!1;M&&(M[a]||"").indexOf(F)<0&&(M[a]||"").indexOf(G)<0;)M=M.parentNode;if(M&&M[a].indexOf(h)>=0?K=!0:M&&M[a].indexOf(F)>=0?k=!0:M&&M[a].indexOf(G)>=0&&(r=!0),J.isLeftButton(b))if(V.$27h(b))V.$24h=J.getClientPoint(b),V.$25h=q.ty();else if(K){J.preventDefault(b),H=M.parentNode.$11h;var d=u.getDataById(H),I=d.s("tools")[M.toolIndex];I.action&&I.action.call(q)}else if(k){J.preventDefault(b),H=M.$11h;var d=u.getDataById(H);d.isExpanded()?d.setExpanded(!1):d.setExpanded(!0)}else if(r){H=M.$11h;var D=u.getDataById(H);X.ss(D),q.handleDragAndDrop&&(J.preventDefault(b),D.s("draggable")&&(q.handleDragAndDrop(b,"prepare"),V.$35h=0)),D.s("draggable")||(J.preventDefault(b),V.$24h=J.getClientPoint(b),V.$25h=q.ty())}else J.preventDefault(b),V.$24h=J.getClientPoint(b),V.$25h=q.ty();else V.$26h(b)},handle_mousedown:function(z){this.handle_touchstart(z)},handle_mousewheel:function(S){this.handleScroll(S,S.wheelDelta/40,S.wheelDelta!==S.wheelDeltaX)},handle_DOMMouseScroll:function(c){this.handleScroll(c,-c.detail,1)},handleScroll:function(P,L,Q){var U=this.$22h;J.preventDefault(P),Q&&U._41o()&&U.ty(U.ty()+20*L)},handle_mouseup:function(f){this.handle_touchend(f)},handle_touchend:function(Q){var V=this;V.$37h(Q),V.$26h(Q)},handleWindowMouseUp:function(e){this.handleWindowTouchEnd(e)},handleWindowTouchEnd:function(D){var z=this;z.$37h(D),z.$26h(D)},$37h:function(z){var v=this,b=v.$22h;2===v.$35h&&(v.$35h=3,b.handleDragAndDrop(z,"end"))},handleWindowMouseMove:function(_){this.handleWindowTouchMove(_)},handleWindowTouchMove:function(O){var D=this,w=D.$22h,m=D.$23h,l=D.$24h,X=D.$25h,d=J.getClientPoint(O),a=w._29I,_=D.$36h;if(1===D.$35h||2===D.$35h){if(D.$35h=2,w.handleDragAndDrop(O,"between"),i){var j=O.touches[0];O=j?j:O.changedTouches[0]}_.style.left=O.pageX-parseInt(_.width)/2+r,_.style.top=O.pageY-parseInt(_.height)/2+r}else"p"===m?w.ty(X+d.y-l.y):"v"===m&&w.ty(X+(l.y-d.y)/a.height*w._59I)},handle_mousemove:function(E){this.handle_touchmove(E)},handle_touchmove:function(Z){if(!J.isDragging()&&J.isLeftButton(Z)){var x=this,W=x.$22h,C=x.$27h(Z);if(x.$24h){if(!x.$23h){if(J.getDistance(J.getClientPoint(Z),x.$24h)<2)return;x.$23h=C?"v":"p",J.startDragging(x)}}else if(C)W._43o();else if(0===x.$35h){if(x.$35h=1,W.handleDragAndDrop(Z,"begin"),i){var p=Z.touches[0];Z=p?p:Z.changedTouches[0]}var G=x.$36h=new Image,Y=W.$10h[W.sm().ld().getId()].querySelector(".image-box"),v=parseInt(Y.style.width),b=parseInt(Y.style.height);G.draggable=!1,G.src=Y.toDataURL(),G.width=v,G.height=b,G.style.position="absolute",G.style.left=Z.pageX-v/2+r,G.style.top=Z.pageY-b/2+r,E().appendChild(G),J.startDragging(x)}}},$27h:function(F){var d=this.$22h,L=d.getView(),r=L.getBoundingClientRect(),Y=d._29I,t=F.clientX-r.left+L.scrollLeft;return d._41o()&&Y.x+Y.width-t<Q}}),ht.widget.Palette=function(m){var P=this,p=P._view=q.createView(null,P);P.$9h={},P.$10h={},P.$4h={},P._29I={x:0,y:0,width:0,height:0},P._59I=0,P.dm(m?m:new ht.DataModel),p[a]="ht-widget-palette",P.$29h=new V(P),$(p,K,J.paletteContentBackground),$(p,U,"auto"),$(p,G,s),$(p,"-moz-"+G,s),$(p,"-webkit-"+b,e),$(p,"-moz-"+b,e),$(p,"-ms-"+b,e),$(p,b,e),$(p,"position","absolute"),$(p,"overflow","hidden"),u(p,P._79O=t()),Z(p,"dragstart",function(k){k.dataTransfer&&(k.dataTransfer.setData("Text","nodeid:"+k.target.$11h),k.dataTransfer.effectAllowed="all",P.$29h.$26h())})},v("Palette",A,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:J.autoHideScrollBar,_scrollBarSize:J.scrollBarSize,_scrollBarColor:J.scrollBarColor,getViewRect:function(){return this._29I},ty:function(V){return V?(this.setTranslateY(V),void 0):this.getTranslateY()},setTranslateY:function(G){if(this.$32h==W){var R=this,f=R.$33h(G),C=R.$30h;R.$30h=f,R.fp("translateY",C,f)}},getTranslateY:function(){return this.$30h},setLayout:function(k){var E,z,b=this,Z=b._layout;b._layout=k,"smallicons"===k?E=z=20:"iconsonly"===k?E=z=50:(E=70,z=50),b.setItemImageWidth(E),b.setItemImageHeight(z),b.setItemImagePadding(4),b.fp("layout",Z,k)},getDataAt:function(o){for(var X=o.target;X&&X.$11h==W;)X=X.parentNode;return X&&X.$11h!=W?this.getDataModel().getDataById(X.$11h):void 0},$20h:function(){var R=16;return i&&(R*=1.2),R},$19h:function(){return J.paletteTitleHeight},$18h:function(){var x=J.paletteSeparatorWidth,q=J.paletteTitleBackground,X=J.paletteSeparatorColor||J.brighter(q);return x+r+" solid "+X},$17h:function(S){$(S,"cursor","pointer"),$(S,"display","inline-block"),$(S,"margin-right",(i?8:4)+r),$(S,"vertical-align",k)},$1h:function(l){var w=this,B=Y(),t=Y(),L=F("span");B[a]="palette-header",$(B,P,"relative"),$(B,K,J.paletteTitleBackground),$(B,"color",J.paletteTitleLabelColor),$(B,k,c),$(B,G,s),$(B,"-moz-"+G,s),$(B,"padding","0 5px 0 0"),$(B,"border-top",w.$18h()),$(B,N,"100%"),$(B,"cursor","pointer"),$(B,"white-space","nowrap"),$(B,U,"hidden"),$(B,d,J.paletteTitleLabelFont),$(B,"line-height",w.$19h()+r),B.$11h=l.getId();var Z=j(),H=w.$19h(),m=w.$20h();w.$17h(Z),q.setCanvas(Z,m,H),u(B,Z);var T=l.s("tools");if(T)for(var y=0;y<T.length;y++){var X=j();w.$17h(X),q.setCanvas(X,m,H),X[a]="palette-header-tool palette-header-tool"+l.getId()+"-"+y,X.style.position="absolute",X.style.right=(m+10)*y+"px",X.toolIndex=y,u(B,X)}return Z[a]="palette-toggle-icon-"+l.getId(),t[a]="palette-content",$(t,"max-height",0+r),$(t,d,J.paletteContentLabelFont),$(t,U,"hidden"),t.$11h=l.getId(),w.$9h[l.getId()]=t,L[o]=l.getName(),$(L,d,J.paletteTitleLabelFont),u(B,Z),u(B,L),[B,t]},$2h:function(X){var V=this,K=V._layout,E=S&&X.s("draggable")?F("a"):Y(),N=j(),d=Y(),I=X.getName()||"",G=X.s("title")||X.getToolTip()||I,w=V._itemMargin;N[a]="image-box";var s=V.getItemImageWidth(),l=V.getItemImageHeight();return q.setCanvas(N,s,l),u(E,N),d[o]=I,d[a]="label-box","iconsonly"!==K&&u(E,d),E[a]="palette-item",$(E,"vertical-align",k),$(E,"cursor","pointer"),$(E,"border-radius",5+r),$(E,"border","1px solid transparent"),$(E,"text-align","center"),$(E,"display","inline-block"),$(E,"margin-left",w+r),$(E,"margin-top",w+r),$(E,"color",J.paletteContentLabelColor),"smallicons"===K?($(N,"vertical-align","middle"),$(E,"margin-left",2+r),$(E,"margin-top",2+r),$(E,"padding",2+r),$(E,"text-align",M),$(d,"display","inline-block"),$(d,"min-width",V.$21h+V._itemMargin+r)):"largeicons"===K&&($(d,"max-width",s+r),$(d,"overflow","hidden")),E.$11h=X.getId(),G&&(E.title=G),X.s("draggable")&&!V.handleDragAndDrop&&(S?(E.href="#",$(E,"text-decoration",e)):E.draggable="true"),E},$16h:function(m,K,d,G){var V=q.initContext(m);q.translateAndScale(V,0,0,1),V.clearRect(0,0,d,d);var C=(d-G)/2;J.drawStretchImage(V,J.getImage(K),"fill",0,C,G,G),V.restore()},$15h:function(T){var t=this,r=T.getId(),P=t._view.querySelector(".palette-toggle-icon-"+r),Q=T.isExpanded()?J.paletteCollapseIcon:J.paletteExpandIcon;if(P&&Q){var $=t.$19h(),x=t.$20h();t.$16h(P,Q,$,x)}},_drawToolsIcon:function(t){var d=this,c=t.s("tools");if(c)for(var Z=0;Z<c.length;Z++){var o=d._view.querySelector(".palette-header-tool"+t.getId()+"-"+Z),p=c[Z].icon,Y=d.$19h(),C=d.$20h();d.$16h(o,p,Y,C)}},$14h:function(P){var u=this,Q=P.getId(),k=u.$10h[Q].querySelector(".image-box"),e=P.getImage(),z=P.s("image.stretch");if(k&&e){var b=q.initContext(k),r=u.getItemImagePadding();r="smallicons"===u._layout?r/2:r;var j=u.getItemImageWidth()-2*r,I=u.getItemImageHeight()-2*r;q.translateAndScale(b,0,0,1),b.clearRect(0,0,j,I),J.drawStretchImage(b,J.getImage(e),z,r,r,j,I,P,u),b.restore()}},validateImpl:function(){var X,d,q,w=this,G=w.$9h,O=w._layout,U=w.$10h,k=w.$4h,C=w._view,B=w.dm();if(w.$13h&&(delete w.$13h,k={},B.each(function(r){k[r.getId()]=r})),"smallicons"===O)for(var M in k){var p=k[M];if(p instanceof f){var L=p.getName()||"",e=J.getTextSize(J.paletteContentLabelFont,L).width;w.$21h!=W&&w.$21h>e||(w.$21h=e)}}for(var M in k){q=k[M];var g,H;if(B.contains(q)){if(q instanceof ht.Group){var E,V=w.$1h(q),b=U[q.getId()];b&&(E=b.nextSibling,z(C,E),z(C,b)),d=B.getSiblings(q).indexOf(q);var i=C.children[2*d]||w._79O;i&&i.parentNode?(C.insertBefore(V[0],i),C.insertBefore(E||V[1],i)):(C.appendChild(V[0]),C.appendChild(E||V[1])),U[q.getId()]=V[0],X=G[q.getId()]=E||V[1],H=q.$12h;var Y=q.s("promptText");H||(q.$12h=F("div"),q.$12h[o]=Y||"",H=q.$12h),0===q.getChildren().size()?X.contains(H)||u(X,H):X.contains(H)&&z(X,H)}else if(g=q.getParent()){var I=w.$2h(q),m=U[q.getId()];X=G[g.getId()],m&&z(m.parentNode,m),d=B.getSiblings(q).indexOf(q);var S=X.children[d];S?X.insertBefore(I,S):u(X,I),U[q.getId()]=I,w.$14h(q)}}else{var h=U[q.getId()],_=h.parentNode;if(q instanceof ht.Group){var P=h.nextSibling;z(C,h),z(C,P),delete G[q.getId()]}else z(_,h),0===_.children.length&&(g=B.getDataById(_.$11h),H=g.$12h,H&&!_.contains(H)&&u(_,H));delete U[q.getId()]}}w.$4h={};var Q=function(){var s=w._59I,P=0;w.$32h!=W&&(clearInterval(w.$32h),P=0,delete w.$32h),w.$32h=setInterval(function(){w.$31h(),s===w._59I?(P++,P>=2&&(clearInterval(w.$32h),delete w.$32h)):(P=0,s=w._59I)},30)};for(var A in G)if(X=G[A],q=B.getDataById(G[A].$11h),w.$15h(q),w._drawToolsIcon(q),q.isExpanded()){if(X.style.maxHeight===0+r){var Z=X.scrollHeight+w._itemMargin+r;l(X).duration(200).set(n,Z).set("padding-bottom",w._itemMargin+r).end(function(){return function(){Q()}}(Z))}else X.style.maxHeight=X.scrollHeight+r;X.style.paddingBottom=w._itemMargin+r}else X.style.maxHeight!==0+r&&l(X).duration(200).set(n,c).set("padding-bottom",c).end(function(){return function(){Q()}}(X));w.$28h(),w.$31h()},$31h:function(){for(var n=this,A=n._view,t=0,s=A.children,p=0;p<s.length;p++){var b=s[p];b.className&&b.className.indexOf("palette-")>=0&&(t+=b.offsetHeight)}n._59I=t,n.$30h=n.$33h(n.ty());var I=n.ty();A.scrollTop=-I,n._29I={x:0,y:-I,width:A.clientWidth,height:A.clientHeight},$(n._79O,k,-I+r),n._93I()},$33h:function(b){var y=this,N=y._29I.height-y._59I;return N>b&&(b=N),b>0?0:Math.round(b)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(M){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(M.property)<0&&this.redraw(),"translateY"===M.property&&(this.iv(),this._43o())},findDataByName:function(r){for(var C=this.dm().getDatas(),Q=0;Q<C.size();Q++){var _=C.get(Q);if(_.getName()===r)return _}},setDataModel:function(P){var n=this,$=n._dataModel,w=n._3o;$!==P&&($&&($.umm(n.$6h,n),$.umd(n.$8h,n),$.umh(n.$7h,n),w||$.sm().ums(n.$28h,n)),n._dataModel=P,P.mm(n.$6h,n),P.md(n.$8h,n),P.mh(n.$7h,n),w?w._21I(P):P.sm().ms(n.$28h,n),n.sm().setSelectionMode("single"),n.fp("dataModel",$,P))},$6h:function($){var T=this,j=T._view,X=$.data,J=T.$4h;"add"===$.kind?J[X.getId()]=X:"remove"===$.kind?J[X.getId()]=X:"clear"===$.kind&&(T.$10h={},T.$9h={},T.$4h={},j[o]=""),T.iv()},$7h:function(P){var s=this,Q=P.data;s.$4h[Q.getId()]=Q,s.iv()},$8h:function(Y){var _=this,J=Y.data,v=Y.property;"expanded"===v?_.iv():(_.$4h[J.getId()]=J,_.iv())},$28h:function(){var s,X=this,t=X.sm(),D="palette-item",C=t.ld();this.dm().each(function(g){s=X.$10h[g.getId()],s&&s[a].indexOf(D)>=0&&(g===C?$(s,K,J.paletteItemSelectBackground):R(s,K))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:this,Object);