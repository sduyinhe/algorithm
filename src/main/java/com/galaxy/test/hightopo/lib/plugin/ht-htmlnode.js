!function(j){"use strict";var I="ht",n=j[I],Q=function(){return document},e=function(){return Q().body},O=function(i,N,M){i.style.setProperty(N,M,null)},m=function(n){return Q().createElement(n)},E=function(){return m("div")},$=function(){var N=m("canvas");return N},f=function(n,C){O(n,"-webkit-transform",C),O(n,"-ms-transform",C),O(n,"transform",C)},F=function(z,M){O(z,"-webkit-transform-origin",M),O(z,"-ms-transform-origin",M),O(z,"transform-origin",M)},x=function(B,v){B.appendChild(v)},D=function(s,M){s.removeChild(M)},c=j.parseInt,o=n.Default,y=o.getInternal(),C=Math.PI,_="white-space",T="visibility",M="left",W="top",Y="width",l="height",z="position",r="display",B="z-index",P="px",h="0 0",v="absolute",w="visible",q="hidden",g="none",i="block",S="nowrap",N="rgba(0, 0, 0, 0.005)";o.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var b=n.graph.GraphView.prototype,t=b._42;b.adjustHtmlNodeIndex=!0,b._42=function(L,X){if(t.call(this,L,X),this.adjustHtmlNodeIndex)for(var o=this.getDataModel()._datas._as,M=o.length,e=1,K=0;M>K;K++){var Y=o[K];if(Y instanceof p){var I=this.getDataUI(Y);O(I.$2f,B,e+""),O(I.$3f,B,e+1+""),e+=2}}};var L=n.HtmlNodeUI=function(D,W){var l=this;L.superClass.constructor.call(l,D,W);var X=l.$2f=E(),j=l.$3f=$();O(X,z,v),O(X,T,q),O(X,_,S),j.draggable=!1,O(j,z,v),O(j,r,g),F(j,h),X.addEventListener("change",function(Y){var q=Y.target,m=q.bind||q.getAttribute("bind"),y=q.type&&"checkbox"===q.type?q.checked:q.value,c=W.getContext();m&&c&&(c[m]=y,l.$4f=JSON.stringify(c))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(L){X.addEventListener(L,this.$9f.bind(this))},l)};o.def(L,y.ui().NodeUI,{_visible:!0,$11f:function(){var s=this,U=s.$3f,F=s._data,x=F.getDraggerImageWidth(),H=F.getDraggerImageHeight(),a=F.getDraggerImage(),k=y.initContext(U);k.beginPath(),y.setCanvas(U,x,H),y.translateAndScale(k,0,0,1),k.clearRect(0,0,x,H),o.drawImage(k,o.getImage(a),0,0,x,H),k.restore()},_80o:function(o){L.superClass._80o.call(this,o);var G=this,e=G._data,Q=e._padding,t=2*Q,K=G.$2f,k=G.$3f,a=G.gv,n=a.getZoom(),d=a.getTranslateX(),m=a.getTranslateY(),H=a.getView(),s=G._83o,F=e._width,X=e._height,S=s.position,y=s.rotation,D=(F-t)/e.$5f*n,Z=(X-t)/e.$6f*n,u=G._html,V=e._html,A=e.getHtmlType();if("html"===A){var h=e.getContext()||{},J=G.$4f,U=e.$10f,p=JSON.stringify(h);u&&J&&u===V&&J===p||(G.$4f=p,G._html=V,K.innerHTML=U?U(h):V)}else if(null!=A){var j=e.getHtml();"ht"===A&&(j=j.getView()),u&&u===j&&K.contains(u)||(G._html=j,K.innerHTML="",x(K,j))}if(!K.parentNode){var b=a.$1f;if(!b){var _=E();O(_,z,v),O(_,B,"0"),b=a.$1f=_;var R=a._canvas.nextSibling;R?H.insertBefore(_,R):x(H,_)}x(b,K),x(b,k),e.onContentInitialized&&e.onContentInitialized(K)}if(e._scalable){var $=e.$5f,I=e.$6f;f(K,"rotate("+180*(y/C)+"deg) scale("+D+","+Z+")"),O(K,Y,""),O(K,l,""),O(K,M,(S.x-$/n/2)*n+d+P),O(K,W,(S.y-I/n/2)*n+m+P)}else{var ep=c(K.style.width),Qo=c(K.style.height),Ko=c((F-t)*n),fb=c((X-t)*n),zj="100%",hl=K.children[0];O(hl,Y,zj),O(hl,l,zj),(ep!==Ko||Qo!==fb)&&(O(K,Y,Ko+P),O(K,l,fb+P),"ht"===A&&V.invalidate()),f(K,"rotate("+180*(y/C)+"deg)"),O(K,M,(S.x-Ko/n/2)*n+d+P),O(K,W,(S.y-fb/n/2)*n+m+P)}var xd=G.dragRect;a.isMovable(e)&&a.isSelected(e)&&xd?(o.save(),o.fillStyle=N,o.fillRect(xd.x,xd.y,xd.width,xd.height),o.restore(),O(k,M,xd.x*n+d+P),O(k,W,xd.y*n+m+P),f(k,"scale("+n+","+n+")"),O(k,r,i),G.$11f()):O(k,r,g),O(K,T,this._visible?w:q)},dispose:function(){var F=this.gv.$1f;F.removeChild(this.$2f),F.removeChild(this.$3f)},_84o:function(o){this._visible=o,O(this.$2f,T,o?w:q),O(this.$3f,r,o?i:g)},_3O:function(){var m=this,x=m._data;L.superClass._3O.call(m);var g=x.getRect();m.dragRect={x:g.x+g.width+x._padding,y:g.y+10,width:x.getDraggerImageWidth(),height:x.getDraggerImageHeight()},m._68o(m.dragRect)},rectIntersects:function(C){var A=this._79o();return n.Default.intersection(A,C)?!0:void 0},$9f:function(Q){var V=this.gv,L=this._data;V.sm().contains(L)&&Q.stopPropagation()}});var p=n.HtmlNode=function(){p.superClass.constructor.call(this)};n.Default.def(p,n.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:n.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(G){var d=this,B=d._html;d._html=G,"html"===d.getHtmlType()&&"Handlebars"in j&&(d.$10f=Handlebars.compile(G)),d.$13f(),d.fp("html",B,G)},setContext:function(i){var t=this,m=t._context;t._context=i,t.fp("context",m,i),t.$13f()},setScalable:function(C){var y=this,R=y._scalable;y._scalable=C,y.fp("scalable",R,C),y.$13f()},getHtmlType:function(){var y=this._html;return y?"string"==typeof y?"html":y.getView?"ht":"dom":null},$13f:function(){var m=this,h=m._html,w=m.$10f;if(h){var F=E(),X=!1,r=m.getHtmlType();if(O(F,z,v),O(F,_,S),O(F,T,q),"html"===r?(F.innerHTML=w?w(m.getContext()||{}):h,X=!0):"ht"===r?(x(F,h.getView()),X=!0):"dom"===r&&(x(F,h),X=!0),X){var s=2*m._padding;x(e(),F),m.$5f=F.scrollWidth,m.$6f=F.scrollHeight,m._width=m.$5f+s,m._height=m.$6f+s,m._originWidth=m._width,m._originHeight=m._height,D(e(),F)}}},getUIClass:function(){return n.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:this,Object);